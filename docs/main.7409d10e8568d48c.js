(self.webpackChunkgps_tracking_app=self.webpackChunkgps_tracking_app||[]).push([[179],{2762:(zr,qn,Ke)=>{"use strict";Ke.d(qn,{L:()=>an,a:()=>hn,b:()=>st,c:()=>Ae,d:()=>De,g:()=>Xe}),Ke(3162);const an="ionViewWillEnter",hn="ionViewDidEnter",st="ionViewWillLeave",Ae="ionViewDidLeave",De="ionViewWillUnload",Xe=ge=>ge.classList.contains("ion-page")?ge:ge.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||ge},3162:(zr,qn,Ke)=>{"use strict";Ke.d(qn,{a:()=>pn,c:()=>fn,g:()=>De});class We{constructor(){this.m=new Map}reset(ge){this.m=new Map(Object.entries(ge))}get(ge,be){const fe=this.m.get(ge);return void 0!==fe?fe:be}getBoolean(ge,be=!1){const fe=this.m.get(ge);return void 0===fe?be:"string"==typeof fe?"true"===fe:!!fe}getNumber(ge,be){const fe=parseFloat(this.m.get(ge));return isNaN(fe)?void 0!==be?be:NaN:fe}set(ge,be){this.m.set(ge,be)}}const fn=new We,De=Xe=>xt(Xe),pn=(Xe,ge)=>("string"==typeof Xe&&(ge=Xe,Xe=void 0),De(Xe).includes(ge)),xt=(Xe=window)=>{if(typeof Xe>"u")return[];Xe.Ionic=Xe.Ionic||{};let ge=Xe.Ionic.platforms;return null==ge&&(ge=Xe.Ionic.platforms=Mt(Xe),ge.forEach(be=>Xe.document.documentElement.classList.add(`plt-${be}`))),ge},Mt=Xe=>{const ge=fn.get("platform");return Object.keys(ut).filter(be=>{const fe=ge?.[be];return"function"==typeof fe?fe(Xe):ut[be](Xe)})},ct=Xe=>!!(at(Xe,/iPad/i)||at(Xe,/Macintosh/i)&&bn(Xe)),mt=Xe=>at(Xe,/android|sink/i),bn=Xe=>on(Xe,"(any-pointer:coarse)"),lt=Xe=>Je(Xe)||Yt(Xe),Je=Xe=>!!(Xe.cordova||Xe.phonegap||Xe.PhoneGap),Yt=Xe=>{const ge=Xe.Capacitor;return!!ge?.isNative},at=(Xe,ge)=>ge.test(Xe.navigator.userAgent),on=(Xe,ge)=>{var be;return null===(be=Xe.matchMedia)||void 0===be?void 0:be.call(Xe,ge).matches},ut={ipad:ct,iphone:Xe=>at(Xe,/iPhone/i),ios:Xe=>at(Xe,/iPhone|iPod/i)||ct(Xe),android:mt,phablet:Xe=>{const ge=Xe.innerWidth,be=Xe.innerHeight,fe=Math.min(ge,be),Z=Math.max(ge,be);return fe>390&&fe<520&&Z>620&&Z<800},tablet:Xe=>{const ge=Xe.innerWidth,be=Xe.innerHeight,fe=Math.min(ge,be),Z=Math.max(ge,be);return ct(Xe)||(Xe=>mt(Xe)&&!at(Xe,/mobile/i))(Xe)||fe>460&&fe<820&&Z>780&&Z<1400},cordova:Je,capacitor:Yt,electron:Xe=>at(Xe,/electron/i),pwa:Xe=>{var ge;return!!(null!==(ge=Xe.matchMedia)&&void 0!==ge&&ge.call(Xe,"(display-mode: standalone)").matches||Xe.navigator.standalone)},mobile:bn,mobileweb:Xe=>bn(Xe)&&!lt(Xe),desktop:Xe=>!bn(Xe),hybrid:lt}},2282:(zr,qn,Ke)=>{"use strict";Ke.d(qn,{c:()=>hn});var We=Ke(1848);let fn;const x=(st,Ae,De)=>{const pn=Ae.startsWith("animation")?(st=>(void 0===fn&&(fn=void 0===st.style.animationName&&void 0!==st.style.webkitAnimationName?"-webkit-":""),fn))(st):"";st.style.setProperty(pn+Ae,De)},an=(st=[],Ae)=>{if(void 0!==Ae){const De=Array.isArray(Ae)?Ae:[Ae];return[...st,...De]}return st},hn=st=>{let Ae,De,pn,xt,Mt,nt,Qe,en,$t,at,Nt,ct=[],It=[],pt=[],mt=!1,bt={},Ze=[],bn=[],ze={},lt=0,Je=!1,Yt=!1,on=!0,ut=!1,Gn=!0,gt=!1;const Xe=st,ge=[],be=[],fe=[],Z=[],Ye=[],qt=[],kt=[],Lt=[],jt=[],mn=[],di=[],Ui="function"==typeof AnimationEffect||void 0!==We.w&&"function"==typeof We.w.AnimationEffect,ri="function"==typeof Element&&"function"==typeof Element.prototype.animate&&Ui,ur=()=>di,Vn=(He,St)=>{const ii=St.findIndex(Gi=>Gi.c===He);ii>-1&&St.splice(ii,1)},Ne=(He,St)=>((St?.oneTimeCallback?be:ge).push({c:He,o:St}),Nt),wn=()=>{ri&&(di.forEach(He=>{He.cancel()}),di.length=0)},Fn=()=>{qt.forEach(He=>{He?.parentNode&&He.parentNode.removeChild(He)}),qt.length=0},Nn=()=>void 0!==Mt?Mt:Qe?Qe.getFill():"both",mo=()=>void 0!==en?en:void 0!==nt?nt:Qe?Qe.getDirection():"normal",go=()=>Je?"linear":void 0!==pn?pn:Qe?Qe.getEasing():"linear",Zr=()=>Yt?0:void 0!==$t?$t:void 0!==De?De:Qe?Qe.getDuration():0,io=()=>void 0!==xt?xt:Qe?Qe.getIterations():1,ue=()=>void 0!==at?at:void 0!==Ae?Ae:Qe?Qe.getDelay():0,kn=()=>{0!==lt&&(lt--,0===lt&&((()=>{jt.forEach(Di=>Di()),mn.forEach(Di=>Di());const He=on?1:0,St=Ze,ii=bn,Gi=ze;Z.forEach(Di=>{const br=Di.classList;St.forEach(Hr=>br.add(Hr)),ii.forEach(Hr=>br.remove(Hr));for(const Hr in Gi)Gi.hasOwnProperty(Hr)&&x(Di,Hr,Gi[Hr])}),$t=void 0,en=void 0,at=void 0,ge.forEach(Di=>Di.c(He,Nt)),be.forEach(Di=>Di.c(He,Nt)),be.length=0,Gn=!0,on&&(ut=!0),on=!0})(),Qe&&Qe.animationFinish()))},Dn=()=>{(()=>{kt.forEach(Gi=>Gi()),Lt.forEach(Gi=>Gi());const He=It,St=pt,ii=bt;Z.forEach(Gi=>{const Di=Gi.classList;He.forEach(br=>Di.add(br)),St.forEach(br=>Di.remove(br));for(const br in ii)ii.hasOwnProperty(br)&&x(Gi,br,ii[br])})})(),ct.length>0&&ri&&(Z.forEach(He=>{const St=He.animate(ct,{id:Xe,delay:ue(),duration:Zr(),easing:go(),iterations:io(),fill:Nn(),direction:mo()});St.pause(),di.push(St)}),di.length>0&&(di[0].onfinish=()=>{kn()})),mt=!0},xi=He=>{He=Math.min(Math.max(He,0),.9999),ri&&di.forEach(St=>{St.currentTime=St.effect.getComputedTiming().delay+Zr()*He,St.pause()})},pi=He=>{di.forEach(St=>{St.effect.updateTiming({delay:ue(),duration:Zr(),easing:go(),iterations:io(),fill:Nn(),direction:mo()})}),void 0!==He&&xi(He)},bi=(He=!1,St=!0,ii)=>(He&&Ye.forEach(Gi=>{Gi.update(He,St,ii)}),ri&&pi(ii),Nt),mi=()=>{mt&&(ri?di.forEach(He=>{He.pause()}):Z.forEach(He=>{x(He,"animation-play-state","paused")}),gt=!0)},Xo=He=>new Promise(St=>{He?.sync&&(Yt=!0,Ne(()=>Yt=!1,{oneTimeCallback:!0})),mt||Dn(),ut&&(ri&&(xi(0),pi()),ut=!1),Gn&&(lt=Ye.length+1,Gn=!1);const ii=()=>{Vn(Gi,be),St()},Gi=()=>{Vn(ii,fe),St()};Ne(Gi,{oneTimeCallback:!0}),((He,St)=>{fe.push({c:He,o:{oneTimeCallback:!0}})})(ii),Ye.forEach(Di=>{Di.play()}),ri?(di.forEach(He=>{He.play()}),(0===ct.length||0===Z.length)&&kn()):kn(),gt=!1}),ir=(He,St)=>{const ii=ct[0];return void 0===ii||void 0!==ii.offset&&0!==ii.offset?ct=[{offset:0,[He]:St},...ct]:ii[He]=St,Nt};return Nt={parentAnimation:Qe,elements:Z,childAnimations:Ye,id:Xe,animationFinish:kn,from:ir,to:(He,St)=>{const ii=ct[ct.length-1];return void 0===ii||void 0!==ii.offset&&1!==ii.offset?ct=[...ct,{offset:1,[He]:St}]:ii[He]=St,Nt},fromTo:(He,St,ii)=>ir(He,St).to(He,ii),parent:He=>(Qe=He,Nt),play:Xo,pause:()=>(Ye.forEach(He=>{He.pause()}),mi(),Nt),stop:()=>{Ye.forEach(He=>{He.stop()}),mt&&(wn(),mt=!1),Je=!1,Yt=!1,Gn=!0,en=void 0,$t=void 0,at=void 0,lt=0,ut=!1,on=!0,gt=!1,fe.forEach(He=>He.c(0,Nt)),fe.length=0},destroy:He=>(Ye.forEach(St=>{St.destroy(He)}),(He=>{wn(),He&&Fn()})(He),Z.length=0,Ye.length=0,ct.length=0,ge.length=0,be.length=0,mt=!1,Gn=!0,Nt),keyframes:He=>{const St=ct!==He;return ct=He,St&&(He=>{ri&&ur().forEach(St=>{const ii=St.effect;if(ii.setKeyframes)ii.setKeyframes(He);else{const Gi=new KeyframeEffect(ii.target,He,ii.getTiming());St.effect=Gi}})})(ct),Nt},addAnimation:He=>{if(null!=He)if(Array.isArray(He))for(const St of He)St.parent(Nt),Ye.push(St);else He.parent(Nt),Ye.push(He);return Nt},addElement:He=>{if(null!=He)if(1===He.nodeType)Z.push(He);else if(He.length>=0)for(let St=0;St<He.length;St++)Z.push(He[St]);else console.error("Invalid addElement value");return Nt},update:bi,fill:He=>(Mt=He,bi(!0),Nt),direction:He=>(nt=He,bi(!0),Nt),iterations:He=>(xt=He,bi(!0),Nt),duration:He=>(!ri&&0===He&&(He=1),De=He,bi(!0),Nt),easing:He=>(pn=He,bi(!0),Nt),delay:He=>(Ae=He,bi(!0),Nt),getWebAnimations:ur,getKeyframes:()=>ct,getFill:Nn,getDirection:mo,getDelay:ue,getIterations:io,getEasing:go,getDuration:Zr,afterAddRead:He=>(jt.push(He),Nt),afterAddWrite:He=>(mn.push(He),Nt),afterClearStyles:(He=[])=>{for(const St of He)ze[St]="";return Nt},afterStyles:(He={})=>(ze=He,Nt),afterRemoveClass:He=>(bn=an(bn,He),Nt),afterAddClass:He=>(Ze=an(Ze,He),Nt),beforeAddRead:He=>(kt.push(He),Nt),beforeAddWrite:He=>(Lt.push(He),Nt),beforeClearStyles:(He=[])=>{for(const St of He)bt[St]="";return Nt},beforeStyles:(He={})=>(bt=He,Nt),beforeRemoveClass:He=>(pt=an(pt,He),Nt),beforeAddClass:He=>(It=an(It,He),Nt),onFinish:Ne,isRunning:()=>0!==lt&&!gt,progressStart:(He=!1,St)=>(Ye.forEach(ii=>{ii.progressStart(He,St)}),mi(),Je=He,mt||Dn(),bi(!1,!0,St),Nt),progressStep:He=>(Ye.forEach(St=>{St.progressStep(He)}),xi(He),Nt),progressEnd:(He,St,ii)=>(Je=!1,Ye.forEach(Gi=>{Gi.progressEnd(He,St,ii)}),void 0!==ii&&($t=ii),ut=!1,on=!0,0===He?(en="reverse"===mo()?"normal":"reverse","reverse"===en&&(on=!1),ri?(bi(),xi(1-St)):(at=(1-St)*Zr()*-1,bi(!1,!1))):1===He&&(ri?(bi(),xi(St)):(at=St*Zr()*-1,bi(!1,!1))),void 0!==He&&!Qe&&Xo(),Nt)}}},8958:(zr,qn,Ke)=>{"use strict";Ke.d(qn,{E:()=>pn,a:()=>We,s:()=>Ae});const We=xt=>{try{if(xt instanceof st)return xt.value;if(!x()||"string"!=typeof xt||""===xt)return xt;if(xt.includes("onload="))return"";const Mt=document.createDocumentFragment(),nt=document.createElement("div");Mt.appendChild(nt),nt.innerHTML=xt,hn.forEach(mt=>{const Qe=Mt.querySelectorAll(mt);for(let bt=Qe.length-1;bt>=0;bt--){const Ze=Qe[bt];Ze.parentNode?Ze.parentNode.removeChild(Ze):Mt.removeChild(Ze);const bn=X(Ze);for(let ze=0;ze<bn.length;ze++)fn(bn[ze])}});const ct=X(Mt);for(let mt=0;mt<ct.length;mt++)fn(ct[mt]);const It=document.createElement("div");It.appendChild(Mt);const pt=It.querySelector("div");return null!==pt?pt.innerHTML:It.innerHTML}catch(Mt){return console.error(Mt),""}},fn=xt=>{if(xt.nodeType&&1!==xt.nodeType)return;if(typeof NamedNodeMap<"u"&&!(xt.attributes instanceof NamedNodeMap))return void xt.remove();for(let nt=xt.attributes.length-1;nt>=0;nt--){const ct=xt.attributes.item(nt),It=ct.name;if(!an.includes(It.toLowerCase())){xt.removeAttribute(It);continue}const pt=ct.value,mt=xt[It];(null!=pt&&pt.toLowerCase().includes("javascript:")||null!=mt&&mt.toLowerCase().includes("javascript:"))&&xt.removeAttribute(It)}const Mt=X(xt);for(let nt=0;nt<Mt.length;nt++)fn(Mt[nt])},X=xt=>null!=xt.children?xt.children:xt.childNodes,x=()=>{var xt;const Mt=window,nt=null===(xt=Mt?.Ionic)||void 0===xt?void 0:xt.config;return!nt||(nt.get?nt.get("sanitizerEnabled",!0):!0===nt.sanitizerEnabled||void 0===nt.sanitizerEnabled)},an=["class","id","href","src","name","slot"],hn=["script","style","iframe","meta","link","object","embed"];class st{constructor(Mt){this.value=Mt}}const Ae=xt=>{const Mt=window,nt=Mt.Ionic;if(!nt||!nt.config||"Object"===nt.config.constructor.name)return Mt.Ionic=Mt.Ionic||{},Mt.Ionic.config=Object.assign(Object.assign({},Mt.Ionic.config),xt),Mt.Ionic.config},pn=!1},4813:(zr,qn,Ke)=>{"use strict";Ke.d(qn,{C:()=>an,a:()=>X,d:()=>x});var We=Ke(5861),fn=Ke(4298);const X=function(){var hn=(0,We.Z)(function*(st,Ae,De,pn,xt,Mt){var nt;if(st)return st.attachViewToDom(Ae,De,xt,pn);if(!(Mt||"string"==typeof De||De instanceof HTMLElement))throw new Error("framework delegate is missing");const ct="string"==typeof De?null===(nt=Ae.ownerDocument)||void 0===nt?void 0:nt.createElement(De):De;return pn&&pn.forEach(It=>ct.classList.add(It)),xt&&Object.assign(ct,xt),Ae.appendChild(ct),yield new Promise(It=>(0,fn.c)(ct,It)),ct});return function(Ae,De,pn,xt,Mt,nt){return hn.apply(this,arguments)}}(),x=(hn,st)=>{if(st){if(hn)return hn.removeViewFromDom(st.parentElement,st);st.remove()}return Promise.resolve()},an=()=>{let hn,st;return{attachViewToDom:function(){var pn=(0,We.Z)(function*(xt,Mt,nt={},ct=[]){var It,pt;let mt;if(hn=xt,Mt){const bt="string"==typeof Mt?null===(It=hn.ownerDocument)||void 0===It?void 0:It.createElement(Mt):Mt;ct.forEach(Ze=>bt.classList.add(Ze)),Object.assign(bt,nt),hn.appendChild(bt),mt=bt,yield new Promise(Ze=>(0,fn.c)(bt,Ze))}else if(hn.children.length>0&&("ION-MODAL"===hn.tagName||"ION-POPOVER"===hn.tagName)&&!(mt=hn.children[0]).classList.contains("ion-delegate-host")){const Ze=null===(pt=hn.ownerDocument)||void 0===pt?void 0:pt.createElement("div");Ze.classList.add("ion-delegate-host"),ct.forEach(bn=>Ze.classList.add(bn)),Ze.append(...hn.children),hn.appendChild(Ze),mt=Ze}const Qe=document.querySelector("ion-app")||document.body;return st=document.createComment("ionic teleport"),hn.parentNode.insertBefore(st,hn),Qe.appendChild(hn),mt??hn});return function(Mt,nt){return pn.apply(this,arguments)}}(),removeViewFromDom:()=>(hn&&st&&(st.parentNode.insertBefore(hn,st),st.remove()),Promise.resolve())}}},4089:(zr,qn,Ke)=>{"use strict";Ke.d(qn,{B:()=>x,G:()=>an});class fn{constructor(st,Ae,De,pn,xt){this.id=Ae,this.name=De,this.disableScroll=xt,this.priority=1e6*pn+Ae,this.ctrl=st}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const st=this.ctrl.capture(this.name,this.id,this.priority);return st&&this.disableScroll&&this.ctrl.disableScroll(this.id),st}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class X{constructor(st,Ae,De,pn){this.id=Ae,this.disable=De,this.disableScroll=pn,this.ctrl=st}block(){if(this.ctrl){if(this.disable)for(const st of this.disable)this.ctrl.disableGesture(st,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const st of this.disable)this.ctrl.enableGesture(st,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const x="backdrop-no-scroll",an=new class We{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(st){var Ae;return new fn(this,this.newID(),st.name,null!==(Ae=st.priority)&&void 0!==Ae?Ae:0,!!st.disableScroll)}createBlocker(st={}){return new X(this,this.newID(),st.disable,!!st.disableScroll)}start(st,Ae,De){return this.canStart(st)?(this.requestedStart.set(Ae,De),!0):(this.requestedStart.delete(Ae),!1)}capture(st,Ae,De){if(!this.start(st,Ae,De))return!1;const pn=this.requestedStart;let xt=-1e4;if(pn.forEach(Mt=>{xt=Math.max(xt,Mt)}),xt===De){this.capturedId=Ae,pn.clear();const Mt=new CustomEvent("ionGestureCaptured",{detail:{gestureName:st}});return document.dispatchEvent(Mt),!0}return pn.delete(Ae),!1}release(st){this.requestedStart.delete(st),this.capturedId===st&&(this.capturedId=void 0)}disableGesture(st,Ae){let De=this.disabledGestures.get(st);void 0===De&&(De=new Set,this.disabledGestures.set(st,De)),De.add(Ae)}enableGesture(st,Ae){const De=this.disabledGestures.get(st);void 0!==De&&De.delete(Ae)}disableScroll(st){this.disabledScroll.add(st),1===this.disabledScroll.size&&document.body.classList.add(x)}enableScroll(st){this.disabledScroll.delete(st),0===this.disabledScroll.size&&document.body.classList.remove(x)}canStart(st){return!(void 0!==this.capturedId||this.isDisabled(st))}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(st){const Ae=this.disabledGestures.get(st);return!!(Ae&&Ae.size>0)}newID(){return this.gestureId++,this.gestureId}}},6466:(zr,qn,Ke)=>{"use strict";Ke.r(qn),Ke.d(qn,{MENU_BACK_BUTTON_PRIORITY:()=>De,OVERLAY_BACK_BUTTON_PRIORITY:()=>Ae,blockHardwareBackButton:()=>hn,shouldUseCloseWatcher:()=>an,startHardwareBackButton:()=>st});var We=Ke(5861),fn=Ke(1848),X=Ke(4601);Ke(7271);const an=()=>X.c.get("experimentalCloseWatcher",!1)&&void 0!==fn.w&&"CloseWatcher"in fn.w,hn=()=>{document.addEventListener("backbutton",()=>{})},st=()=>{const pn=document;let xt=!1;const Mt=()=>{if(xt)return;let nt=0,ct=[];const It=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(Qe,bt){ct.push({priority:Qe,handler:bt,id:nt++})}}});pn.dispatchEvent(It);const pt=function(){var Qe=(0,We.Z)(function*(bt){try{if(bt?.handler){const Ze=bt.handler(mt);null!=Ze&&(yield Ze)}}catch(Ze){console.error(Ze)}});return function(Ze){return Qe.apply(this,arguments)}}(),mt=()=>{if(ct.length>0){let Qe={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};ct.forEach(bt=>{bt.priority>=Qe.priority&&(Qe=bt)}),xt=!0,ct=ct.filter(bt=>bt.id!==Qe.id),pt(Qe).then(()=>xt=!1)}};mt()};if(an()){let nt;const ct=()=>{nt?.destroy(),nt=new fn.w.CloseWatcher,nt.onclose=()=>{Mt(),ct()}};ct()}else pn.addEventListener("backbutton",Mt)},Ae=100,De=99},4298:(zr,qn,Ke)=>{"use strict";Ke.d(qn,{a:()=>Ae,b:()=>De,c:()=>X,d:()=>ct,e:()=>bt,f:()=>nt,g:()=>pn,h:()=>an,i:()=>st,j:()=>It,k:()=>x,l:()=>Mt,m:()=>pt,n:()=>Qe,o:()=>Ze,p:()=>mt,r:()=>xt,s:()=>bn,t:()=>We});const We=(ze,lt=0)=>new Promise(Je=>{fn(ze,lt,Je)}),fn=(ze,lt=0,Je)=>{let Yt,en;const $t={passive:!0},on=()=>{Yt&&Yt()},ut=Gn=>{(void 0===Gn||ze===Gn.target)&&(on(),Je(Gn))};return ze&&(ze.addEventListener("webkitTransitionEnd",ut,$t),ze.addEventListener("transitionend",ut,$t),en=setTimeout(ut,lt+500),Yt=()=>{void 0!==en&&(clearTimeout(en),en=void 0),ze.removeEventListener("webkitTransitionEnd",ut,$t),ze.removeEventListener("transitionend",ut,$t)}),on},X=(ze,lt)=>{ze.componentOnReady?ze.componentOnReady().then(Je=>lt(Je)):xt(()=>lt(ze))},x=ze=>void 0!==ze.componentOnReady,an=(ze,lt=[])=>{const Je={};return lt.forEach(Yt=>{ze.hasAttribute(Yt)&&(null!==ze.getAttribute(Yt)&&(Je[Yt]=ze.getAttribute(Yt)),ze.removeAttribute(Yt))}),Je},hn=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],st=(ze,lt)=>{let Je=hn;return lt&&lt.length>0&&(Je=Je.filter(Yt=>!lt.includes(Yt))),an(ze,Je)},Ae=(ze,lt,Je,Yt)=>{var en;if(typeof window<"u"){const $t=window,at=null===(en=$t?.Ionic)||void 0===en?void 0:en.config;if(at){const on=at.get("_ael");if(on)return on(ze,lt,Je,Yt);if(at._ael)return at._ael(ze,lt,Je,Yt)}}return ze.addEventListener(lt,Je,Yt)},De=(ze,lt,Je,Yt)=>{var en;if(typeof window<"u"){const $t=window,at=null===(en=$t?.Ionic)||void 0===en?void 0:en.config;if(at){const on=at.get("_rel");if(on)return on(ze,lt,Je,Yt);if(at._rel)return at._rel(ze,lt,Je,Yt)}}return ze.removeEventListener(lt,Je,Yt)},pn=(ze,lt=ze)=>ze.shadowRoot||lt,xt=ze=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(ze):"function"==typeof requestAnimationFrame?requestAnimationFrame(ze):setTimeout(ze),Mt=ze=>!!ze.shadowRoot&&!!ze.attachShadow,nt=ze=>{if(ze.focus(),ze.classList.contains("ion-focusable")){const lt=ze.closest("ion-app");lt&&lt.setFocus([ze])}},ct=(ze,lt,Je,Yt,en)=>{if(ze||Mt(lt)){let $t=lt.querySelector("input.aux-input");$t||($t=lt.ownerDocument.createElement("input"),$t.type="hidden",$t.classList.add("aux-input"),lt.appendChild($t)),$t.disabled=en,$t.name=Je,$t.value=Yt||""}},It=(ze,lt,Je)=>Math.max(ze,Math.min(lt,Je)),pt=(ze,lt)=>{if(!ze){const Je="ASSERT: "+lt;throw console.error(Je),new Error(Je)}},mt=ze=>{if(ze){const lt=ze.changedTouches;if(lt&&lt.length>0){const Je=lt[0];return{x:Je.clientX,y:Je.clientY}}if(void 0!==ze.pageX)return{x:ze.pageX,y:ze.pageY}}return{x:0,y:0}},Qe=ze=>{const lt="rtl"===document.dir;switch(ze){case"start":return lt;case"end":return!lt;default:throw new Error(`"${ze}" is not a valid value for [side]. Use "start" or "end" instead.`)}},bt=(ze,lt)=>{const Je=ze._original||ze;return{_original:ze,emit:Ze(Je.emit.bind(Je),lt)}},Ze=(ze,lt=0)=>{let Je;return(...Yt)=>{clearTimeout(Je),Je=setTimeout(ze,lt,...Yt)}},bn=(ze,lt)=>{if(ze??(ze={}),lt??(lt={}),ze===lt)return!0;const Je=Object.keys(ze);if(Je.length!==Object.keys(lt).length)return!1;for(const Yt of Je)if(!(Yt in lt)||ze[Yt]!==lt[Yt])return!1;return!0}},7271:(zr,qn,Ke)=>{"use strict";Ke.d(qn,{B:()=>hn,a:()=>Gn,b:()=>Hs,c:()=>Nn,d:()=>io,e:()=>jt,f:()=>vi,g:()=>mo,h:()=>ki,i:()=>Zr,j:()=>wa,k:()=>di,r:()=>De,w:()=>mn});var We=Ke(5861);var x=Object.defineProperty,hn={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1},st=new WeakMap,Ae=N=>st.get(N),De=(N,K)=>st.set(K.$lazyInstance$=N,K),xt=(N,K)=>K in N,Mt=(N,K)=>(0,console.error)(N,K),nt=new Map,It=new Map,pt=[],bn="s-id",Yt="slot-fb{display:contents}slot-fb[hidden]{display:none}",en="http://www.w3.org/1999/xlink",$t=typeof window<"u"?window:{},at=$t.document||{head:{}},ut={$flags$:0,$resourcesUrl$:"",jmp:N=>N(),raf:N=>requestAnimationFrame(N),ael:(N,K,ae,pe)=>N.addEventListener(K,ae,pe),rel:(N,K,ae,pe)=>N.removeEventListener(K,ae,pe),ce:(N,K)=>new CustomEvent(N,K)},Gn=N=>{Object.assign(ut,N)},gt=(()=>{let N=!1;try{at.addEventListener("e",null,Object.defineProperty({},"passive",{get(){N=!0}}))}catch{}return N})(),ge=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch{}return!1})(),be=!1,fe=[],Z=[],Ye=(N,K)=>ae=>{N.push(ae),be||(be=!0,K&&4&ut.$flags$?Lt(kt):ut.raf(kt))},qt=N=>{for(let K=0;K<N.length;K++)try{N[K](performance.now())}catch(ae){Mt(ae)}N.length=0},kt=()=>{qt(fe),qt(Z),(be=fe.length>0)&&ut.raf(kt)},Lt=N=>Promise.resolve(void 0).then(N),jt=Ye(fe,!1),mn=Ye(Z,!0),di=N=>{const K=new URL(N,ut.$resourcesUrl$);return K.origin!==$t.location.origin?K.href:K.pathname},Ui={},Oi=N=>"object"==(N=typeof N)||"function"===N;function dr(N){var K,ae,pe;return null!=(pe=null==(ae=null==(K=N.head)?void 0:K.querySelector('meta[name="csp-nonce"]'))?void 0:ae.getAttribute("content"))?pe:void 0}((N,K)=>{for(var ae in K)x(N,ae,{get:K[ae],enumerable:!0})})({},{err:()=>ht,map:()=>Ne,ok:()=>Vn,unwrap:()=>et,unwrapErr:()=>wn});var Vn=N=>({isOk:!0,isErr:!1,value:N}),ht=N=>({isOk:!1,isErr:!0,value:N});function Ne(N,K){if(N.isOk){const ae=K(N.value);return ae instanceof Promise?ae.then(pe=>Vn(pe)):Vn(ae)}if(N.isErr)return ht(N.value);throw"should never get here"}var et=N=>{if(N.isOk)return N.value;throw N.value},wn=N=>{if(N.isErr)return N.value;throw N.value},ki=(N,K,...ae)=>{let pe=null,_e=null,xe=null,ot=!1,_t=!1;const Pe=[],yt=nn=>{for(let An=0;An<nn.length;An++)pe=nn[An],Array.isArray(pe)?yt(pe):null!=pe&&"boolean"!=typeof pe&&((ot="function"!=typeof N&&!Oi(pe))&&(pe=String(pe)),ot&&_t?Pe[Pe.length-1].$text$+=pe:Pe.push(ot?it(null,pe):pe),_t=ot)};if(yt(ae),K){K.key&&(_e=K.key),K.name&&(xe=K.name);{const nn=K.className||K.class;nn&&(K.class="object"!=typeof nn?nn:Object.keys(nn).filter(An=>nn[An]).join(" "))}}if("function"==typeof N)return N(null===K?{}:K,Pe,hr);const Rt=it(N,null);return Rt.$attrs$=K,Pe.length>0&&(Rt.$children$=Pe),Rt.$key$=_e,Rt.$name$=xe,Rt},it=(N,K)=>({$flags$:0,$tag$:N,$text$:K,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null}),vi={},hr={forEach:(N,K)=>N.map(Hi).forEach(K),map:(N,K)=>N.map(Hi).map(K).map(Bt)},Hi=N=>({vattrs:N.$attrs$,vchildren:N.$children$,vkey:N.$key$,vname:N.$name$,vtag:N.$tag$,vtext:N.$text$}),Bt=N=>{if("function"==typeof N.vtag){const ae={...N.vattrs};return N.vkey&&(ae.key=N.vkey),N.vname&&(ae.name=N.vname),ki(N.vtag,ae,...N.vchildren||[])}const K=it(N.vtag,N.vtext);return K.$attrs$=N.vattrs,K.$children$=N.vchildren,K.$key$=N.vkey,K.$name$=N.vname,K},In=(N,K,ae,pe,_e,xe,ot)=>{let _t,Pe,yt,Rt;if(1===xe.nodeType){if(_t=xe.getAttribute("c-id"),_t&&(Pe=_t.split("."),(Pe[0]===ot||"0"===Pe[0])&&(yt={$flags$:0,$hostId$:Pe[0],$nodeId$:Pe[1],$depth$:Pe[2],$index$:Pe[3],$tag$:xe.tagName.toLowerCase(),$elm$:xe,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},K.push(yt),xe.removeAttribute("c-id"),N.$children$||(N.$children$=[]),N.$children$[yt.$index$]=yt,N=yt,pe&&"0"===yt.$depth$&&(pe[yt.$index$]=yt.$elm$))),xe.shadowRoot)for(Rt=xe.shadowRoot.childNodes.length-1;Rt>=0;Rt--)In(N,K,ae,pe,_e,xe.shadowRoot.childNodes[Rt],ot);for(Rt=xe.childNodes.length-1;Rt>=0;Rt--)In(N,K,ae,pe,_e,xe.childNodes[Rt],ot)}else if(8===xe.nodeType)Pe=xe.nodeValue.split("."),(Pe[1]===ot||"0"===Pe[1])&&(_t=Pe[0],yt={$flags$:0,$hostId$:Pe[1],$nodeId$:Pe[2],$depth$:Pe[3],$index$:Pe[4],$elm$:xe,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===_t?(yt.$elm$=xe.nextSibling,yt.$elm$&&3===yt.$elm$.nodeType&&(yt.$text$=yt.$elm$.textContent,K.push(yt),xe.remove(),N.$children$||(N.$children$=[]),N.$children$[yt.$index$]=yt,pe&&"0"===yt.$depth$&&(pe[yt.$index$]=yt.$elm$))):yt.$hostId$===ot&&("s"===_t?(yt.$tag$="slot",xe["s-sn"]=Pe[5]?yt.$name$=Pe[5]:"",xe["s-sr"]=!0,pe&&(yt.$elm$=at.createElement(yt.$tag$),yt.$name$&&yt.$elm$.setAttribute("name",yt.$name$),xe.parentNode.insertBefore(yt.$elm$,xe),xe.remove(),"0"===yt.$depth$&&(pe[yt.$index$]=yt.$elm$)),ae.push(yt),N.$children$||(N.$children$=[]),N.$children$[yt.$index$]=yt):"r"===_t&&(pe?xe.remove():(_e["s-cr"]=xe,xe["s-cn"]=!0))));else if(N&&"style"===N.$tag$){const nn=it(null,xe.textContent);nn.$elm$=xe,nn.$index$="0",N.$children$=[nn]}},Ur=(N,K)=>{if(1===N.nodeType){let ae=0;if(N.shadowRoot)for(;ae<N.shadowRoot.childNodes.length;ae++)Ur(N.shadowRoot.childNodes[ae],K);for(ae=0;ae<N.childNodes.length;ae++)Ur(N.childNodes[ae],K)}else if(8===N.nodeType){const ae=N.nodeValue.split(".");"o"===ae[0]&&(K.set(ae[1]+"."+ae[2],N),N.nodeValue="",N["s-en"]=ae[3])}},Nn=N=>pt.push(N),mo=N=>Ae(N).$modeName$,Zr=N=>Ae(N).$hostElement$,io=(N,K,ae)=>{const pe=Zr(N);return{emit:_e=>ue(pe,K,{bubbles:!!(4&ae),composed:!!(2&ae),cancelable:!!(1&ae),detail:_e})}},ue=(N,K,ae)=>{const pe=ut.ce(K,ae);return N.dispatchEvent(pe),pe},U=new WeakMap,J=(N,K,ae)=>{var pe;const _e=Ce(K,ae),xe=It.get(_e);if(N=11===N.nodeType?N:at,xe)if("string"==typeof xe){let _t,ot=U.get(N=N.head||N);if(ot||U.set(N,ot=new Set),!ot.has(_e)){if(N.host&&(_t=N.querySelector(`[sty-id="${_e}"]`)))_t.innerHTML=xe;else{_t=at.createElement("style"),_t.innerHTML=xe;const Pe=null!=(pe=ut.$nonce$)?pe:dr(at);null!=Pe&&_t.setAttribute("nonce",Pe),(!(1&K.$flags$)||1&K.$flags$&&"HEAD"!==N.nodeName)&&N.insertBefore(_t,N.querySelector("link"))}4&K.$flags$&&(_t.innerHTML+=Yt),ot&&ot.add(_e)}}else N.adoptedStyleSheets.includes(xe)||(N.adoptedStyleSheets=[...N.adoptedStyleSheets,xe]);return _e},Ce=(N,K)=>"sc-"+(K&&32&N.$flags$?N.$tagName$+"-"+K:N.$tagName$),Te=(N,K,ae,pe,_e,xe)=>{if(ae!==pe){let ot=xt(N,K),_t=K.toLowerCase();if("class"===K){const Pe=N.classList,yt=ce(ae),Rt=ce(pe);Pe.remove(...yt.filter(nn=>nn&&!Rt.includes(nn))),Pe.add(...Rt.filter(nn=>nn&&!yt.includes(nn)))}else if("style"===K){for(const Pe in ae)(!pe||null==pe[Pe])&&(Pe.includes("-")?N.style.removeProperty(Pe):N.style[Pe]="");for(const Pe in pe)(!ae||pe[Pe]!==ae[Pe])&&(Pe.includes("-")?N.style.setProperty(Pe,pe[Pe]):N.style[Pe]=pe[Pe])}else if("key"!==K)if("ref"===K)pe&&pe(N);else if(ot||"o"!==K[0]||"n"!==K[1]){const Pe=Oi(pe);if((ot||Pe&&null!==pe)&&!_e)try{if(N.tagName.includes("-"))N[K]=pe;else{const Rt=pe??"";"list"===K?ot=!1:(null==ae||N[K]!=Rt)&&(N[K]=Rt)}}catch{}let yt=!1;_t!==(_t=_t.replace(/^xlink\:?/,""))&&(K=_t,yt=!0),null==pe||!1===pe?(!1!==pe||""===N.getAttribute(K))&&(yt?N.removeAttributeNS(en,K):N.removeAttribute(K)):(!ot||4&xe||_e)&&!Pe&&(pe=!0===pe?"":pe,yt?N.setAttributeNS(en,K,pe):N.setAttribute(K,pe))}else if(K="-"===K[2]?K.slice(3):xt($t,_t)?_t.slice(2):_t[2]+K.slice(3),ae||pe){const Pe=K.endsWith($e);K=K.replace(rt,""),ae&&ut.rel(N,K,ae,Pe),pe&&ut.ael(N,K,pe,Pe)}}},ke=/\s/,ce=N=>N?N.split(ke):[],$e="Capture",rt=new RegExp($e+"$"),Le=(N,K,ae)=>{const pe=11===K.$elm$.nodeType&&K.$elm$.host?K.$elm$.host:K.$elm$,_e=N&&N.$attrs$||Ui,xe=K.$attrs$||Ui;for(const ot of wt(Object.keys(_e)))ot in xe||Te(pe,ot,_e[ot],void 0,ae,K.$flags$);for(const ot of wt(Object.keys(xe)))Te(pe,ot,_e[ot],xe[ot],ae,K.$flags$)};function wt(N){return N.includes("ref")?[...N.filter(K=>"ref"!==K),"ref"]:N}var Ut,tn,kn,oi=!1,Dn=!1,xi=!1,pi=!1,bi=(N,K,ae,pe)=>{var _e;const xe=K.$children$[ae];let _t,Pe,yt,ot=0;if(oi||(xi=!0,"slot"===xe.$tag$&&(Ut&&pe.classList.add(Ut+"-s"),xe.$flags$|=xe.$children$?2:1)),null!==xe.$text$)_t=xe.$elm$=at.createTextNode(xe.$text$);else if(1&xe.$flags$)_t=xe.$elm$=at.createTextNode("");else{if(pi||(pi="svg"===xe.$tag$),_t=xe.$elm$=at.createElementNS(pi?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",!oi&&2&xe.$flags$?"slot-fb":xe.$tag$),pi&&"foreignObject"===xe.$tag$&&(pi=!1),Le(null,xe,pi),!!_t.getRootNode().querySelector("body")&&(N=>null!=N)(Ut)&&_t["s-si"]!==Ut&&_t.classList.add(_t["s-si"]=Ut),Gi(_t,pe),xe.$children$)for(ot=0;ot<xe.$children$.length;++ot)Pe=bi(N,xe,ot,_t),Pe&&_t.appendChild(Pe);"svg"===xe.$tag$?pi=!1:"foreignObject"===_t.tagName&&(pi=!0)}return _t["s-hn"]=kn,3&xe.$flags$&&(_t["s-sr"]=!0,_t["s-cr"]=tn,_t["s-sn"]=xe.$name$||"",_t["s-rf"]=null==(_e=xe.$attrs$)?void 0:_e.ref,yt=N&&N.$children$&&N.$children$[ae],yt&&yt.$tag$===xe.$tag$&&N.$elm$&&ei(N.$elm$)),_t},ei=N=>{ut.$flags$|=1;const K=N.closest(kn.toLowerCase());if(null!=K){const ae=Array.from(K.childNodes).find(_e=>_e["s-cr"]),pe=Array.from(N.childNodes);for(const _e of ae?pe.reverse():pe)null!=_e["s-sh"]&&(St(K,_e,ae??null),_e["s-sh"]=void 0,xi=!0)}ut.$flags$&=-2},si=(N,K)=>{ut.$flags$|=1;const ae=Array.from(N.childNodes);if(N["s-sr"]){let pe=N;for(;pe=pe.nextSibling;)pe&&pe["s-sn"]===N["s-sn"]&&pe["s-sh"]===kn&&ae.push(pe)}for(let pe=ae.length-1;pe>=0;pe--){const _e=ae[pe];_e["s-hn"]!==kn&&_e["s-ol"]&&(St(Ri(_e),_e,Us(_e)),_e["s-ol"].remove(),_e["s-ol"]=void 0,_e["s-sh"]=void 0,xi=!0),K&&si(_e,K)}ut.$flags$&=-2},qi=(N,K,ae,pe,_e,xe)=>{let _t,ot=N["s-cr"]&&N["s-cr"].parentNode||N;for(ot.shadowRoot&&ot.tagName===kn&&(ot=ot.shadowRoot);_e<=xe;++_e)pe[_e]&&(_t=bi(null,ae,_e,N),_t&&(pe[_e].$elm$=_t,St(ot,_t,Us(K))))},mi=(N,K,ae)=>{for(let pe=K;pe<=ae;++pe){const _e=N[pe];if(_e){const xe=_e.$elm$;He(_e),xe&&(Dn=!0,xe["s-ol"]?xe["s-ol"].remove():si(xe,!0),xe.remove())}}},Ci=(N,K,ae=!1)=>!(N.$tag$!==K.$tag$||("slot"===N.$tag$?"$nodeId$"in N&&ae&&8!==N.$elm$.nodeType||N.$name$!==K.$name$:!ae&&N.$key$!==K.$key$)),Us=N=>N&&N["s-ol"]||N,Ri=N=>(N["s-ol"]?N["s-ol"]:N).parentNode,Xo=(N,K,ae=!1)=>{const pe=K.$elm$=N.$elm$,_e=N.$children$,xe=K.$children$,ot=K.$tag$,_t=K.$text$;let Pe;null===_t?(pi="svg"===ot||"foreignObject"!==ot&&pi,"slot"!==ot||oi?Le(N,K,pi):N.$name$!==K.$name$&&(K.$elm$["s-sn"]=K.$name$||"",ei(K.$elm$.parentElement)),null!==_e&&null!==xe?((N,K,ae,pe,_e=!1)=>{let Ji,Sr,xe=0,ot=0,_t=0,Pe=0,yt=K.length-1,Rt=K[0],nn=K[yt],An=pe.length-1,Bn=pe[0],Li=pe[An];for(;xe<=yt&&ot<=An;)if(null==Rt)Rt=K[++xe];else if(null==nn)nn=K[--yt];else if(null==Bn)Bn=pe[++ot];else if(null==Li)Li=pe[--An];else if(Ci(Rt,Bn,_e))Xo(Rt,Bn,_e),Rt=K[++xe],Bn=pe[++ot];else if(Ci(nn,Li,_e))Xo(nn,Li,_e),nn=K[--yt],Li=pe[--An];else if(Ci(Rt,Li,_e))("slot"===Rt.$tag$||"slot"===Li.$tag$)&&si(Rt.$elm$.parentNode,!1),Xo(Rt,Li,_e),St(N,Rt.$elm$,nn.$elm$.nextSibling),Rt=K[++xe],Li=pe[--An];else if(Ci(nn,Bn,_e))("slot"===Rt.$tag$||"slot"===Li.$tag$)&&si(nn.$elm$.parentNode,!1),Xo(nn,Bn,_e),St(N,nn.$elm$,Rt.$elm$),nn=K[--yt],Bn=pe[++ot];else{for(_t=-1,Pe=xe;Pe<=yt;++Pe)if(K[Pe]&&null!==K[Pe].$key$&&K[Pe].$key$===Bn.$key$){_t=Pe;break}_t>=0?(Sr=K[_t],Sr.$tag$!==Bn.$tag$?Ji=bi(K&&K[ot],ae,_t,N):(Xo(Sr,Bn,_e),K[_t]=void 0,Ji=Sr.$elm$),Bn=pe[++ot]):(Ji=bi(K&&K[ot],ae,ot,N),Bn=pe[++ot]),Ji&&St(Ri(Rt.$elm$),Ji,Us(Rt.$elm$))}xe>yt?qi(N,null==pe[An+1]?null:pe[An+1].$elm$,ae,pe,ot,An):ot>An&&mi(K,xe,yt)})(pe,_e,K,xe,ae):null!==xe?(null!==N.$text$&&(pe.textContent=""),qi(pe,null,K,xe,0,xe.length-1)):!ae&&null!==_e&&mi(_e,0,_e.length-1),pi&&"svg"===ot&&(pi=!1)):(Pe=pe["s-cr"])?Pe.parentNode.textContent=_t:N.$text$!==_t&&(pe.data=_t)},us=N=>{const K=N.childNodes;for(const ae of K)if(1===ae.nodeType){if(ae["s-sr"]){const pe=ae["s-sn"];ae.hidden=!1;for(const _e of K)if(_e!==ae)if(_e["s-hn"]!==ae["s-hn"]||""!==pe){if(1===_e.nodeType&&(pe===_e.getAttribute("slot")||pe===_e["s-sn"])||3===_e.nodeType&&pe===_e["s-sn"]){ae.hidden=!0;break}}else if(1===_e.nodeType||3===_e.nodeType&&""!==_e.textContent.trim()){ae.hidden=!0;break}}us(ae)}},ir=[],kr=N=>{let K,ae,pe;for(const _e of N.childNodes){if(_e["s-sr"]&&(K=_e["s-cr"])&&K.parentNode){ae=K.parentNode.childNodes;const xe=_e["s-sn"];for(pe=ae.length-1;pe>=0;pe--)if(K=ae[pe],!(K["s-cn"]||K["s-nr"]||K["s-hn"]===_e["s-hn"]||K["s-sh"]&&K["s-sh"]===_e["s-hn"]))if(Nl(K,xe)){let ot=ir.find(_t=>_t.$nodeToRelocate$===K);Dn=!0,K["s-sn"]=K["s-sn"]||xe,ot?(ot.$nodeToRelocate$["s-sh"]=_e["s-hn"],ot.$slotRefNode$=_e):(K["s-sh"]=_e["s-hn"],ir.push({$slotRefNode$:_e,$nodeToRelocate$:K})),K["s-sr"]&&ir.map(_t=>{Nl(_t.$nodeToRelocate$,K["s-sn"])&&(ot=ir.find(Pe=>Pe.$nodeToRelocate$===K),ot&&!_t.$slotRefNode$&&(_t.$slotRefNode$=ot.$slotRefNode$))})}else ir.some(ot=>ot.$nodeToRelocate$===K)||ir.push({$nodeToRelocate$:K})}1===_e.nodeType&&kr(_e)}},Nl=(N,K)=>1===N.nodeType?null===N.getAttribute("slot")&&""===K||N.getAttribute("slot")===K:N["s-sn"]===K||""===K,He=N=>{N.$attrs$&&N.$attrs$.ref&&N.$attrs$.ref(null),N.$children$&&N.$children$.map(He)},St=(N,K,ae)=>{const pe=N?.insertBefore(K,ae);return Gi(K,N),pe},ii=N=>{const K=[];return N&&K.push(...N["s-scs"]||[],N["s-si"],N["s-sc"],...ii(N.parentElement)),K},Gi=(N,K,ae=!1)=>{var pe;if(N&&K&&1===N.nodeType){const _e=new Set(ii(K).filter(Boolean));if(_e.size&&(null==(pe=N.classList)||pe.add(...N["s-scs"]=[..._e]),N["s-ol"]||ae))for(const xe of Array.from(N.childNodes))Gi(xe,N,!0)}},br=(N,K)=>{K&&!N.$onRenderResolve$&&K["s-p"]&&K["s-p"].push(new Promise(ae=>N.$onRenderResolve$=ae))},Hr=(N,K)=>{if(N.$flags$|=16,!(4&N.$flags$))return br(N,N.$ancestorComponent$),mn(()=>Rr(N,K));N.$flags$|=512},Rr=(N,K)=>{const _e=N.$lazyInstance$;if(!_e)throw new Error(`Can't render component <${N.$hostElement$.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let xe;return K&&(N.$flags$|=256,N.$queuedListeners$&&(N.$queuedListeners$.map(([ot,_t])=>jn(_e,ot,_t)),N.$queuedListeners$=void 0),xe=jn(_e,"componentWillLoad")),xe=La(xe,()=>jn(_e,"componentWillRender")),La(xe,()=>Na(N,_e,K))},La=(N,K)=>Vi(N)?N.then(K).catch(ae=>{console.error(ae),K()}):K(),Vi=N=>N instanceof Promise||N&&N.then&&"function"==typeof N.then,Na=function(){var N=(0,We.Z)(function*(K,ae,pe){var _e;const xe=K.$hostElement$,_t=xe["s-rc"];pe&&(N=>{const K=N.$cmpMeta$,ae=N.$hostElement$,pe=K.$flags$,xe=J(ae.shadowRoot?ae.shadowRoot:ae.getRootNode(),K,N.$modeName$);10&pe&&2&pe&&(ae["s-sc"]=xe,ae.classList.add(xe+"-h"),2&pe&&ae.classList.add(xe+"-s"))})(K);ti(K,ae,xe,pe),_t&&(_t.map(yt=>yt()),xe["s-rc"]=void 0);{const yt=null!=(_e=xe["s-p"])?_e:[],Rt=()=>Zn(K);0===yt.length?Rt():(Promise.all(yt).then(Rt),K.$flags$|=4,yt.length=0)}});return function(ae,pe,_e){return N.apply(this,arguments)}}(),ti=(N,K,ae,pe)=>{try{K=K.render&&K.render(),N.$flags$&=-17,N.$flags$|=2,((N,K,ae=!1)=>{var pe,_e,xe,ot,_t;const Pe=N.$hostElement$,yt=N.$cmpMeta$,Rt=N.$vnode$||it(null,null),nn=(N=>N&&N.$tag$===vi)(K)?K:ki(null,null,K);if(kn=Pe.tagName,yt.$attrsToReflect$&&(nn.$attrs$=nn.$attrs$||{},yt.$attrsToReflect$.map(([An,Bn])=>nn.$attrs$[Bn]=Pe[An])),ae&&nn.$attrs$)for(const An of Object.keys(nn.$attrs$))Pe.hasAttribute(An)&&!["key","ref","style","class"].includes(An)&&(nn.$attrs$[An]=Pe[An]);if(nn.$tag$=null,nn.$flags$|=4,N.$vnode$=nn,nn.$elm$=Rt.$elm$=Pe.shadowRoot||Pe,Ut=Pe["s-sc"],oi=0!=(1&yt.$flags$),tn=Pe["s-cr"],Dn=!1,Xo(Rt,nn,ae),ut.$flags$|=1,xi){kr(nn.$elm$);for(const An of ir){const Bn=An.$nodeToRelocate$;if(!Bn["s-ol"]){const Li=at.createTextNode("");Li["s-nr"]=Bn,St(Bn.parentNode,Bn["s-ol"]=Li,Bn)}}for(const An of ir){const Bn=An.$nodeToRelocate$,Li=An.$slotRefNode$;if(Li){const Ji=Li.parentNode;let Sr=Li.nextSibling;if(Sr&&1===Sr.nodeType){let Qi=null==(pe=Bn["s-ol"])?void 0:pe.previousSibling;for(;Qi;){let Fr=null!=(_e=Qi["s-nr"])?_e:null;if(Fr&&Fr["s-sn"]===Bn["s-sn"]&&Ji===Fr.parentNode){for(Fr=Fr.nextSibling;Fr===Bn||Fr?.["s-sr"];)Fr=Fr?.nextSibling;if(!Fr||!Fr["s-nr"]){Sr=Fr;break}}Qi=Qi.previousSibling}}(!Sr&&Ji!==Bn.parentNode||Bn.nextSibling!==Sr)&&Bn!==Sr&&(St(Ji,Bn,Sr),1===Bn.nodeType&&(Bn.hidden=null!=(xe=Bn["s-ih"])&&xe)),Bn&&"function"==typeof Li["s-rf"]&&Li["s-rf"](Bn)}else 1===Bn.nodeType&&(ae&&(Bn["s-ih"]=null!=(ot=Bn.hidden)&&ot),Bn.hidden=!0)}}if(Dn&&us(nn.$elm$),ut.$flags$&=-2,ir.length=0,2&yt.$flags$)for(const An of nn.$elm$.childNodes)An["s-hn"]!==kn&&!An["s-sh"]&&(ae&&null==An["s-ih"]&&(An["s-ih"]=null!=(_t=An.hidden)&&_t),An.hidden=!0);tn=void 0})(N,K,pe)}catch(_e){Mt(_e,N.$hostElement$)}return null},Zn=N=>{const ae=N.$hostElement$,_e=N.$lazyInstance$,xe=N.$ancestorComponent$;jn(_e,"componentDidRender"),64&N.$flags$?jn(_e,"componentDidUpdate"):(N.$flags$|=64,xa(ae),jn(_e,"componentDidLoad"),N.$onReadyResolve$(ae),xe||Ko()),N.$onInstanceResolve$(ae),N.$onRenderResolve$&&(N.$onRenderResolve$(),N.$onRenderResolve$=void 0),512&N.$flags$&&Lt(()=>Hr(N,!1)),N.$flags$&=-517},wa=N=>{{const K=Ae(N),ae=K.$hostElement$.isConnected;return ae&&2==(18&K.$flags$)&&Hr(K,!1),ae}},Ko=N=>{xa(at.documentElement),Lt(()=>ue($t,"appload",{detail:{namespace:"ionic"}}))},jn=(N,K,ae)=>{if(N&&N[K])try{return N[K](ae)}catch(pe){Mt(pe)}},xa=N=>N.classList.add(("hydrated","hydrated")),Bo=(N,K,ae)=>{var pe,_e;const xe=N.prototype;if(K.$members$||K.$watchers$||N.watchers){N.watchers&&!K.$watchers$&&(K.$watchers$=N.watchers);const ot=Object.entries(null!=(pe=K.$members$)?pe:{});if(ot.map(([_t,[Pe]])=>{31&Pe||2&ae&&32&Pe?Object.defineProperty(xe,_t,{get(){return((N,K)=>Ae(this).$instanceValues$.get(K))(0,_t)},set(yt){((N,K,ae,pe)=>{const _e=Ae(N);if(!_e)throw new Error(`Couldn't find host element for "${pe.$tagName$}" as it is unknown to this Stencil runtime. This usually happens when integrating a 3rd party Stencil component with another Stencil component or application. Please reach out to the maintainers of the 3rd party Stencil component or report this on the Stencil Discord server (https://chat.stenciljs.com) or comment on this similar [GitHub issue](https://github.com/ionic-team/stencil/issues/5457).`);const xe=_e.$hostElement$,ot=_e.$instanceValues$.get(K),_t=_e.$flags$,Pe=_e.$lazyInstance$;ae=((N,K)=>null==N||Oi(N)?N:4&K?"false"!==N&&(""===N||!!N):2&K?parseFloat(N):1&K?String(N):N)(ae,pe.$members$[K][0]);const yt=Number.isNaN(ot)&&Number.isNaN(ae);if((!(8&_t)||void 0===ot)&&ae!==ot&&!yt&&(_e.$instanceValues$.set(K,ae),Pe)){if(pe.$watchers$&&128&_t){const nn=pe.$watchers$[K];nn&&nn.map(An=>{try{Pe[An](ae,ot,K)}catch(Bn){Mt(Bn,xe)}})}2==(18&_t)&&Hr(_e,!1)}})(this,_t,yt,K)},configurable:!0,enumerable:!0}):1&ae&&64&Pe&&Object.defineProperty(xe,_t,{value(...yt){var Rt;const nn=Ae(this);return null==(Rt=nn?.$onInstancePromise$)?void 0:Rt.then(()=>{var An;return null==(An=nn.$lazyInstance$)?void 0:An[_t](...yt)})}})}),1&ae){const _t=new Map;xe.attributeChangedCallback=function(Pe,yt,Rt){ut.jmp(()=>{var nn;const An=_t.get(Pe);if(this.hasOwnProperty(An))Rt=this[An],delete this[An];else{if(xe.hasOwnProperty(An)&&"number"==typeof this[An]&&this[An]==Rt)return;if(null==An){const Bn=Ae(this),Li=Bn?.$flags$;if(Li&&!(8&Li)&&128&Li&&Rt!==yt){const Ji=Bn.$lazyInstance$,Sr=null==(nn=K.$watchers$)?void 0:nn[Pe];Sr?.forEach(Qi=>{null!=Ji[Qi]&&Ji[Qi].call(Ji,Rt,yt,Pe)})}return}}this[An]=(null!==Rt||"boolean"!=typeof this[An])&&Rt})},N.observedAttributes=Array.from(new Set([...Object.keys(null!=(_e=K.$watchers$)?_e:{}),...ot.filter(([Pe,yt])=>15&yt[0]).map(([Pe,yt])=>{var Rt;const nn=yt[1]||Pe;return _t.set(nn,Pe),512&yt[0]&&(null==(Rt=K.$attrsToReflect$)||Rt.push([Pe,nn])),nn})]))}}return N},wr=function(){var N=(0,We.Z)(function*(K,ae,pe,_e){let xe;if(!(32&ae.$flags$)){if(ae.$flags$|=32,pe.$lazyBundleId$){const yt=((N,K,ae)=>{const pe=N.$tagName$.replace(/-/g,"_"),_e=N.$lazyBundleId$;if(!_e)return;const xe=nt.get(_e);return xe?xe[pe]:Ke(863)(`./${_e}.entry.js`).then(ot=>(nt.set(_e,ot),ot[pe]),Mt)})(pe);if(yt&&"then"in yt){const nn=()=>{};xe=yield yt,nn()}else xe=yt;if(!xe)throw new Error(`Constructor for "${pe.$tagName$}#${ae.$modeName$}" was not found`);xe.isProxied||(pe.$watchers$=xe.watchers,Bo(xe,pe,2),xe.isProxied=!0);const Rt=()=>{};ae.$flags$|=8;try{new xe(ae)}catch(nn){Mt(nn)}ae.$flags$&=-9,ae.$flags$|=128,Rt(),Yo(ae.$lazyInstance$)}else xe=K.constructor,customElements.whenDefined(K.localName).then(()=>ae.$flags$|=128);if(xe&&xe.style){let yt;"string"==typeof xe.style?yt=xe.style:"string"!=typeof xe.style&&(ae.$modeName$=(N=>pt.map(K=>K(N)).find(K=>!!K))(K),ae.$modeName$&&(yt=xe.style[ae.$modeName$]));const Rt=Ce(pe,ae.$modeName$);if(!It.has(Rt)){const nn=()=>{};((N,K,ae)=>{let pe=It.get(N);ge&&ae?(pe=pe||new CSSStyleSheet,"string"==typeof pe?pe=K:pe.replaceSync(K)):pe=K,It.set(N,pe)})(Rt,yt,!!(1&pe.$flags$)),nn()}}}const ot=ae.$ancestorComponent$,_t=()=>Hr(ae,!0);ot&&ot["s-rc"]?ot["s-rc"].push(_t):_t()});return function(ae,pe,_e,xe){return N.apply(this,arguments)}}(),Yo=N=>{jn(N,"connectedCallback")},Fi=N=>{const K=N["s-cr"]=at.createComment("");K["s-cn"]=!0,St(N,K,N.firstChild)},Un=N=>{jn(N,"disconnectedCallback")},zl=function(){var N=(0,We.Z)(function*(K){if(!(1&ut.$flags$)){const ae=Ae(K);ae.$rmListeners$&&(ae.$rmListeners$.map(pe=>pe()),ae.$rmListeners$=void 0),ae?.$lazyInstance$?Un(ae.$lazyInstance$):ae?.$onReadyPromise$&&ae.$onReadyPromise$.then(()=>Un(ae.$lazyInstance$))}});return function(ae){return N.apply(this,arguments)}}(),du=N=>{const K=N.cloneNode;N.cloneNode=function(ae){const pe=this,_e=pe.shadowRoot&&true,xe=K.call(pe,!!_e&&ae);if(!_e&&ae){let _t,Pe,ot=0;const yt=["s-id","s-cr","s-lr","s-rc","s-sc","s-p","s-cn","s-sr","s-sn","s-hn","s-ol","s-nr","s-si","s-rf","s-scs"];for(;ot<pe.childNodes.length;ot++)_t=pe.childNodes[ot]["s-nr"],Pe=yt.every(Rt=>!pe.childNodes[ot][Rt]),_t&&(xe.__appendChild?xe.__appendChild(_t.cloneNode(!0)):xe.appendChild(_t.cloneNode(!0))),Pe&&xe.appendChild(pe.childNodes[ot].cloneNode(!0))}return xe}},xc=N=>{N.__appendChild=N.appendChild,N.appendChild=function(K){const ae=K["s-sn"]=Dc(K),pe=cl(this.childNodes,ae,this.tagName);if(pe){const _e=Vl(pe,ae),xe=_e[_e.length-1],ot=St(xe.parentNode,K,xe.nextSibling);return us(this),ot}return this.__appendChild(K)}},qe=N=>{N.__removeChild=N.removeChild,N.removeChild=function(K){if(K&&typeof K["s-sn"]<"u"){const ae=cl(this.childNodes,K["s-sn"],this.tagName);if(ae){const _e=Vl(ae,K["s-sn"]).find(xe=>xe===K);if(_e)return _e.remove(),void us(this)}}return this.__removeChild(K)}},Ps=N=>{const K=N.prepend;N.prepend=function(...ae){ae.forEach(pe=>{"string"==typeof pe&&(pe=this.ownerDocument.createTextNode(pe));const _e=pe["s-sn"]=Dc(pe),xe=cl(this.childNodes,_e,this.tagName);if(xe){const ot=document.createTextNode("");ot["s-nr"]=pe,xe["s-cr"].parentNode.__appendChild(ot),pe["s-ol"]=ot;const Pe=Vl(xe,_e)[0];return St(Pe.parentNode,pe,Pe.nextSibling)}return 1===pe.nodeType&&pe.getAttribute("slot")&&(pe.hidden=!0),K.call(this,pe)})}},On=N=>{N.append=function(...K){K.forEach(ae=>{"string"==typeof ae&&(ae=this.ownerDocument.createTextNode(ae)),this.appendChild(ae)})}},ai=N=>{const K=N.insertAdjacentHTML;N.insertAdjacentHTML=function(ae,pe){if("afterbegin"!==ae&&"beforeend"!==ae)return K.call(this,ae,pe);const _e=this.ownerDocument.createElement("_");let xe;if(_e.innerHTML=pe,"afterbegin"===ae)for(;xe=_e.firstChild;)this.prepend(xe);else if("beforeend"===ae)for(;xe=_e.firstChild;)this.append(xe)}},Ba=N=>{N.insertAdjacentText=function(K,ae){this.insertAdjacentHTML(K,ae)}},$l=N=>{const K=N.insertAdjacentElement;N.insertAdjacentElement=function(ae,pe){return"afterbegin"!==ae&&"beforeend"!==ae?K.call(this,ae,pe):"afterbegin"===ae?(this.prepend(pe),pe):("beforeend"===ae&&this.append(pe),pe)}},Cc=N=>{const K=Object.getOwnPropertyDescriptor(Node.prototype,"textContent");Object.defineProperty(N,"__textContent",K),Object.defineProperty(N,"textContent",{get(){return" "+Or(this.childNodes).map(_e=>{var xe,ot;const _t=[];let Pe=_e.nextSibling;for(;Pe&&Pe["s-sn"]===_e["s-sn"];)(3===Pe.nodeType||1===Pe.nodeType)&&_t.push(null!=(ot=null==(xe=Pe.textContent)?void 0:xe.trim())?ot:""),Pe=Pe.nextSibling;return _t.filter(yt=>""!==yt).join(" ")}).filter(_e=>""!==_e).join(" ")+" "},set(ae){Or(this.childNodes).forEach(_e=>{let xe=_e.nextSibling;for(;xe&&xe["s-sn"]===_e["s-sn"];){const ot=xe;xe=xe.nextSibling,ot.remove()}if(""===_e["s-sn"]){const ot=this.ownerDocument.createTextNode(ae);ot["s-sn"]="",St(_e.parentElement,ot,_e.nextSibling)}else _e.remove()})}})},ll=(N,K)=>{class ae extends Array{item(_e){return this[_e]}}if(8&K.$flags$){const pe=N.__lookupGetter__("childNodes");Object.defineProperty(N,"children",{get(){return this.childNodes.map(_e=>1===_e.nodeType)}}),Object.defineProperty(N,"childElementCount",{get:()=>N.children.length}),Object.defineProperty(N,"childNodes",{get(){const _e=pe.call(this);if(!(1&ut.$flags$)&&2&Ae(this).$flags$){const xe=new ae;for(let ot=0;ot<_e.length;ot++){const _t=_e[ot]["s-nr"];_t&&xe.push(_t)}return xe}return ae.from(_e)}})}},Or=N=>{const K=[];for(const ae of Array.from(N))ae["s-sr"]&&K.push(ae),K.push(...Or(ae.childNodes));return K},Dc=N=>N["s-sn"]||1===N.nodeType&&N.getAttribute("slot")||"",cl=(N,K,ae)=>{let _e,pe=0;for(;pe<N.length;pe++)if(_e=N[pe],_e["s-sr"]&&_e["s-sn"]===K&&_e["s-hn"]===ae||(_e=cl(_e.childNodes,K,ae),_e))return _e;return null},Vl=(N,K)=>{const ae=[N];for(;(N=N.nextSibling)&&N["s-sn"]===K;)ae.push(N);return ae},Hs=(N,K={})=>{var ae;const _e=[],xe=K.exclude||[],ot=$t.customElements,_t=at.head,Pe=_t.querySelector("meta[charset]"),yt=at.createElement("style"),Rt=[];let nn,An=!0;Object.assign(ut,K),ut.$resourcesUrl$=new URL(K.resourcesUrl||"./",at.baseURI).href,ut.$flags$|=2;let Bn=!1;if(N.map(Li=>{Li[1].map(Ji=>{var Sr;const Qi={$flags$:Ji[0],$tagName$:Ji[1],$members$:Ji[2],$listeners$:Ji[3]};4&Qi.$flags$&&(Bn=!0),Qi.$members$=Ji[2],Qi.$listeners$=Ji[3],Qi.$attrsToReflect$=[],Qi.$watchers$=null!=(Sr=Ji[4])?Sr:{};const Fr=Qi.$tagName$,Hl=class extends HTMLElement{constructor(Ln){if(super(Ln),this.hasRegisteredEventListeners=!1,((N,K)=>{const ae={$flags$:0,$hostElement$:N,$cmpMeta$:K,$instanceValues$:new Map};ae.$onInstancePromise$=new Promise(pe=>ae.$onInstanceResolve$=pe),ae.$onReadyPromise$=new Promise(pe=>ae.$onReadyResolve$=pe),N["s-p"]=[],N["s-rc"]=[],st.set(N,ae)})(Ln=this,Qi),1&Qi.$flags$)if(Ln.shadowRoot){if("open"!==Ln.shadowRoot.mode)throw new Error(`Unable to re-use existing shadow root for ${Qi.$tagName$}! Mode is set to ${Ln.shadowRoot.mode} but Stencil only supports open shadow roots.`)}else Ln.attachShadow({mode:"open",delegatesFocus:!!(16&Qi.$flags$)})}connectedCallback(){const Ln=Ae(this);this.hasRegisteredEventListeners||(this.hasRegisteredEventListeners=!0,jl(this,Ln,Qi.$listeners$)),nn&&(clearTimeout(nn),nn=null),An?Rt.push(this):ut.jmp(()=>(N=>{if(!(1&ut.$flags$)){const K=Ae(N),ae=K.$cmpMeta$,pe=()=>{};if(1&K.$flags$)jl(N,K,ae.$listeners$),K?.$lazyInstance$?Yo(K.$lazyInstance$):K?.$onReadyPromise$&&K.$onReadyPromise$.then(()=>Yo(K.$lazyInstance$));else{let _e;if(K.$flags$|=1,_e=N.getAttribute(bn),_e){if(1&ae.$flags$){const xe=J(N.shadowRoot,ae,N.getAttribute("s-mode"));N.classList.remove(xe+"-h",xe+"-s")}((N,K,ae,pe)=>{const xe=N.shadowRoot,ot=[],Pe=xe?[]:null,yt=pe.$vnode$=it(K,null);ut.$orgLocNodes$||Ur(at.body,ut.$orgLocNodes$=new Map),N[bn]=ae,N.removeAttribute(bn),In(yt,ot,[],Pe,N,N,ae),ot.map(Rt=>{const nn=Rt.$hostId$+"."+Rt.$nodeId$,An=ut.$orgLocNodes$.get(nn),Bn=Rt.$elm$;An&&""===An["s-en"]&&An.parentNode.insertBefore(Bn,An.nextSibling),xe||(Bn["s-hn"]=K,An&&(Bn["s-ol"]=An,Bn["s-ol"]["s-nr"]=Bn)),ut.$orgLocNodes$.delete(nn)}),xe&&Pe.map(Rt=>{Rt&&xe.appendChild(Rt)})})(N,ae.$tagName$,_e,K)}_e||12&ae.$flags$&&Fi(N);{let xe=N;for(;xe=xe.parentNode||xe.host;)if(1===xe.nodeType&&xe.hasAttribute("s-id")&&xe["s-p"]||xe["s-p"]){br(K,K.$ancestorComponent$=xe);break}}ae.$members$&&Object.entries(ae.$members$).map(([xe,[ot]])=>{if(31&ot&&N.hasOwnProperty(xe)){const _t=N[xe];delete N[xe],N[xe]=_t}}),wr(N,K,ae)}pe()}})(this))}disconnectedCallback(){ut.jmp(()=>zl(this))}componentOnReady(){return Ae(this).$onReadyPromise$}};2&Qi.$flags$&&((N,K)=>{du(N),xc(N),On(N),Ps(N),$l(N),ai(N),Ba(N),Cc(N),ll(N,K),qe(N)})(Hl.prototype,Qi),Qi.$lazyBundleId$=Li[0],!xe.includes(Fr)&&!ot.get(Fr)&&(_e.push(Fr),ot.define(Fr,Bo(Hl,Qi,1)))})}),_e.length>0&&(Bn&&(yt.textContent+=Yt),yt.textContent+=_e.sort()+"{visibility:hidden}.hydrated{visibility:inherit}",yt.innerHTML.length)){yt.setAttribute("data-styles","");const Li=null!=(ae=ut.$nonce$)?ae:dr(at);null!=Li&&yt.setAttribute("nonce",Li),_t.insertBefore(yt,Pe?Pe.nextSibling:_t.firstChild)}An=!1,Rt.length?Rt.map(Li=>Li.connectedCallback()):ut.jmp(()=>nn=setTimeout(Ko,30))},jl=(N,K,ae,pe)=>{ae&&ae.map(([_e,xe,ot])=>{const _t=Ul(N,_e),Pe=Ku(K,ot),yt=oa(_e);ut.ael(_t,xe,Pe,yt),(K.$rmListeners$=K.$rmListeners$||[]).push(()=>ut.rel(_t,xe,Pe,yt))})},Ku=(N,K)=>ae=>{var pe;try{256&N.$flags$?null==(pe=N.$lazyInstance$)||pe[K](ae):(N.$queuedListeners$=N.$queuedListeners$||[]).push([K,ae])}catch(_e){Mt(_e)}},Ul=(N,K)=>4&K?at:8&K?$t:16&K?at.body:N,oa=N=>gt?{passive:0!=(1&N),capture:0!=(2&N)}:0!=(2&N)},1981:(zr,qn,Ke)=>{"use strict";Ke.r(qn),Ke.d(qn,{GESTURE_CONTROLLER:()=>We.G,createGesture:()=>De});var We=Ke(4089);const fn=(nt,ct,It,pt)=>{const mt=X(nt)?{capture:!!pt.capture,passive:!!pt.passive}:!!pt.capture;let Qe,bt;return nt.__zone_symbol__addEventListener?(Qe="__zone_symbol__addEventListener",bt="__zone_symbol__removeEventListener"):(Qe="addEventListener",bt="removeEventListener"),nt[Qe](ct,It,mt),()=>{nt[bt](ct,It,mt)}},X=nt=>{if(void 0===x)try{const ct=Object.defineProperty({},"passive",{get:()=>{x=!0}});nt.addEventListener("optsTest",()=>{},ct)}catch{x=!1}return!!x};let x;const st=nt=>nt instanceof Document?nt:nt.ownerDocument,De=nt=>{let ct=!1,It=!1,pt=!0,mt=!1;const Qe=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},nt),bt=Qe.canStart,Ze=Qe.onWillStart,bn=Qe.onStart,ze=Qe.onEnd,lt=Qe.notCaptured,Je=Qe.onMove,Yt=Qe.threshold,en=Qe.passive,$t=Qe.blurOnStart,at={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},on=((nt,ct,It)=>{const pt=It*(Math.PI/180),mt="x"===nt,Qe=Math.cos(pt),bt=ct*ct;let Ze=0,bn=0,ze=!1,lt=0;return{start(Je,Yt){Ze=Je,bn=Yt,lt=0,ze=!0},detect(Je,Yt){if(!ze)return!1;const en=Je-Ze,$t=Yt-bn,at=en*en+$t*$t;if(at<bt)return!1;const on=Math.sqrt(at),ut=(mt?en:$t)/on;return lt=ut>Qe?1:ut<-Qe?-1:0,ze=!1,!0},isGesture:()=>0!==lt,getDirection:()=>lt}})(Qe.direction,Qe.threshold,Qe.maxAngle),ut=We.G.createGesture({name:nt.gestureName,priority:nt.gesturePriority,disableScroll:nt.disableScroll}),gt=()=>{ct&&(mt=!1,Je&&Je(at))},Xe=()=>!!ut.capture()&&(ct=!0,pt=!1,at.startX=at.currentX,at.startY=at.currentY,at.startTime=at.currentTime,Ze?Ze(at).then(be):be(),!0),be=()=>{$t&&(()=>{if(typeof document<"u"){const kt=document.activeElement;kt?.blur&&kt.blur()}})(),bn&&bn(at),pt=!0},fe=()=>{ct=!1,It=!1,mt=!1,pt=!0,ut.release()},Z=kt=>{const Lt=ct,jt=pt;if(fe(),jt){if(pn(at,kt),Lt)return void(ze&&ze(at));lt&&lt(at)}},Ye=((nt,ct,It,pt,mt)=>{let Qe,bt,Ze,bn,ze,lt,Je,Yt=0;const en=ge=>{Yt=Date.now()+2e3,ct(ge)&&(!bt&&It&&(bt=fn(nt,"touchmove",It,mt)),Ze||(Ze=fn(ge.target,"touchend",at,mt)),bn||(bn=fn(ge.target,"touchcancel",at,mt)))},$t=ge=>{Yt>Date.now()||ct(ge)&&(!lt&&It&&(lt=fn(st(nt),"mousemove",It,mt)),Je||(Je=fn(st(nt),"mouseup",on,mt)))},at=ge=>{ut(),pt&&pt(ge)},on=ge=>{Gn(),pt&&pt(ge)},ut=()=>{bt&&bt(),Ze&&Ze(),bn&&bn(),bt=Ze=bn=void 0},Gn=()=>{lt&&lt(),Je&&Je(),lt=Je=void 0},Nt=()=>{ut(),Gn()},gt=(ge=!0)=>{ge?(Qe||(Qe=fn(nt,"touchstart",en,mt)),ze||(ze=fn(nt,"mousedown",$t,mt))):(Qe&&Qe(),ze&&ze(),Qe=ze=void 0,Nt())};return{enable:gt,stop:Nt,destroy:()=>{gt(!1),pt=It=ct=void 0}}})(Qe.el,kt=>{const Lt=Mt(kt);return!(It||!pt||(xt(kt,at),at.startX=at.currentX,at.startY=at.currentY,at.startTime=at.currentTime=Lt,at.velocityX=at.velocityY=at.deltaX=at.deltaY=0,at.event=kt,bt&&!1===bt(at))||(ut.release(),!ut.start()))&&(It=!0,0===Yt?Xe():(on.start(at.startX,at.startY),!0))},kt=>{ct?!mt&&pt&&(mt=!0,pn(at,kt),requestAnimationFrame(gt)):(pn(at,kt),on.detect(at.currentX,at.currentY)&&(!on.isGesture()||!Xe())&&qt())},Z,{capture:!1,passive:en}),qt=()=>{fe(),Ye.stop(),lt&&lt(at)};return{enable(kt=!0){kt||(ct&&Z(void 0),fe()),Ye.enable(kt)},destroy(){ut.destroy(),Ye.destroy()}}},pn=(nt,ct)=>{if(!ct)return;const It=nt.currentX,pt=nt.currentY,mt=nt.currentTime;xt(ct,nt);const Qe=nt.currentX,bt=nt.currentY,bn=(nt.currentTime=Mt(ct))-mt;if(bn>0&&bn<100){const lt=(bt-pt)/bn;nt.velocityX=(Qe-It)/bn*.7+.3*nt.velocityX,nt.velocityY=.7*lt+.3*nt.velocityY}nt.deltaX=Qe-nt.startX,nt.deltaY=bt-nt.startY,nt.event=ct},xt=(nt,ct)=>{let It=0,pt=0;if(nt){const mt=nt.changedTouches;if(mt&&mt.length>0){const Qe=mt[0];It=Qe.clientX,pt=Qe.clientY}else void 0!==nt.pageX&&(It=nt.pageX,pt=nt.pageY)}ct.currentX=It,ct.currentY=pt},Mt=nt=>nt.timeStamp||Date.now()},8200:(zr,qn,Ke)=>{"use strict";Ke.d(qn,{b:()=>Ae,c:()=>De,d:()=>pn,e:()=>Nt,g:()=>ge,l:()=>ut,s:()=>gt,t:()=>Qe,w:()=>Gn});var We=Ke(5861),fn=Ke(4601),X=Ke(7271),x=Ke(2400),an=Ke(4298);const Ae="ionViewWillLeave",De="ionViewDidLeave",pn="ionViewWillUnload",xt=be=>{be.tabIndex=-1,be.focus()},Mt=be=>null!==be.offsetParent,ct="ion-last-focus",mt_saveViewFocus=Z=>{if(fn.c.get("focusManagerPriority",!1)){const qt=document.activeElement;null!==qt&&Z?.contains(qt)&&qt.setAttribute(ct,"true")}},mt_setViewFocus=Z=>{const Ye=fn.c.get("focusManagerPriority",!1);if(Array.isArray(Ye)&&!Z.contains(document.activeElement)){const qt=Z.querySelector(`[${ct}]`);if(qt&&Mt(qt))return void xt(qt);for(const kt of Ye)switch(kt){case"content":const Lt=Z.querySelector('main, [role="main"]');if(Lt&&Mt(Lt))return void xt(Lt);break;case"heading":const jt=Z.querySelector('h1, [role="heading"][aria-level="1"]');if(jt&&Mt(jt))return void xt(jt);break;case"banner":const mn=Z.querySelector('header, [role="banner"]');if(mn&&Mt(mn))return void xt(mn);break;default:(0,x.p)(`Unrecognized focus manager priority value ${kt}`)}xt(Z)}},Qe=be=>new Promise((fe,Z)=>{(0,X.w)(()=>{bt(be),Ze(be).then(Ye=>{Ye.animation&&Ye.animation.destroy(),bn(be),fe(Ye)},Ye=>{bn(be),Z(Ye)})})}),bt=be=>{const fe=be.enteringEl,Z=be.leavingEl;mt_saveViewFocus(Z),Xe(fe,Z,be.direction),be.showGoBack?fe.classList.add("can-go-back"):fe.classList.remove("can-go-back"),gt(fe,!1),fe.style.setProperty("pointer-events","none"),Z&&(gt(Z,!1),Z.style.setProperty("pointer-events","none"))},Ze=function(){var be=(0,We.Z)(function*(fe){const Z=yield ze(fe);return Z&&X.B.isBrowser?lt(Z,fe):Je(fe)});return function(Z){return be.apply(this,arguments)}}(),bn=be=>{const fe=be.enteringEl,Z=be.leavingEl;fe.classList.remove("ion-page-invisible"),fe.style.removeProperty("pointer-events"),void 0!==Z&&(Z.classList.remove("ion-page-invisible"),Z.style.removeProperty("pointer-events")),mt_setViewFocus(fe)},ze=function(){var be=(0,We.Z)(function*(fe){return fe.leavingEl&&fe.animated&&0!==fe.duration?fe.animationBuilder?fe.animationBuilder:"ios"===fe.mode?(yield Promise.resolve().then(Ke.bind(Ke,6232))).iosTransitionAnimation:(yield Promise.resolve().then(Ke.bind(Ke,519))).mdTransitionAnimation:void 0});return function(Z){return be.apply(this,arguments)}}(),lt=function(){var be=(0,We.Z)(function*(fe,Z){yield Yt(Z,!0);const Ye=fe(Z.baseEl,Z);at(Z.enteringEl,Z.leavingEl);const qt=yield $t(Ye,Z);return Z.progressCallback&&Z.progressCallback(void 0),qt&&on(Z.enteringEl,Z.leavingEl),{hasCompleted:qt,animation:Ye}});return function(Z,Ye){return be.apply(this,arguments)}}(),Je=function(){var be=(0,We.Z)(function*(fe){const Z=fe.enteringEl,Ye=fe.leavingEl,qt=fn.c.get("focusManagerPriority",!1);return yield Yt(fe,qt),at(Z,Ye),on(Z,Ye),{hasCompleted:!0}});return function(Z){return be.apply(this,arguments)}}(),Yt=function(){var be=(0,We.Z)(function*(fe,Z){(void 0!==fe.deepWait?fe.deepWait:Z)&&(yield Promise.all([Nt(fe.enteringEl),Nt(fe.leavingEl)])),yield en(fe.viewIsReady,fe.enteringEl)});return function(Z,Ye){return be.apply(this,arguments)}}(),en=function(){var be=(0,We.Z)(function*(fe,Z){fe&&(yield fe(Z))});return function(Z,Ye){return be.apply(this,arguments)}}(),$t=(be,fe)=>{const Z=fe.progressCallback,Ye=new Promise(qt=>{be.onFinish(kt=>qt(1===kt))});return Z?(be.progressStart(!0),Z(be)):be.play(),Ye},at=(be,fe)=>{ut(fe,Ae),ut(be,"ionViewWillEnter")},on=(be,fe)=>{ut(be,"ionViewDidEnter"),ut(fe,De)},ut=(be,fe)=>{if(be){const Z=new CustomEvent(fe,{bubbles:!1,cancelable:!1});be.dispatchEvent(Z)}},Gn=()=>new Promise(be=>(0,an.r)(()=>(0,an.r)(()=>be()))),Nt=function(){var be=(0,We.Z)(function*(fe){const Z=fe;if(Z){if(null!=Z.componentOnReady){if(null!=(yield Z.componentOnReady()))return}else if(null!=Z.__registerHost)return void(yield new Promise(qt=>(0,an.r)(qt)));yield Promise.all(Array.from(Z.children).map(Nt))}});return function(Z){return be.apply(this,arguments)}}(),gt=(be,fe)=>{fe?(be.setAttribute("aria-hidden","true"),be.classList.add("ion-page-hidden")):(be.hidden=!1,be.removeAttribute("aria-hidden"),be.classList.remove("ion-page-hidden"))},Xe=(be,fe,Z)=>{void 0!==be&&(be.style.zIndex="back"===Z?"99":"101"),void 0!==fe&&(fe.style.zIndex="100")},ge=be=>be.classList.contains("ion-page")?be:be.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||be},2400:(zr,qn,Ke)=>{"use strict";Ke.d(qn,{a:()=>fn,b:()=>X,p:()=>We});const We=(x,...an)=>console.warn(`[Ionic Warning]: ${x}`,...an),fn=(x,...an)=>console.error(`[Ionic Error]: ${x}`,...an),X=(x,...an)=>console.error(`<${x.tagName.toLowerCase()}> must be used inside ${an.join(" or ")}.`)},1848:(zr,qn,Ke)=>{"use strict";Ke.d(qn,{d:()=>fn,w:()=>We});const We=typeof window<"u"?window:void 0,fn=typeof document<"u"?document:void 0},7101:(zr,qn,Ke)=>{"use strict";Ke.d(qn,{m:()=>nt});var We=Ke(5861),fn=Ke(1848),X=Ke(6466),x=Ke(2400),an=Ke(4298),hn=Ke(4601),st=Ke(2282);const Ae=ct=>(0,st.c)().duration(ct?400:300),De=ct=>{let It,pt;const mt=ct.width+8,Qe=(0,st.c)(),bt=(0,st.c)();ct.isEndSide?(It=mt+"px",pt="0px"):(It=-mt+"px",pt="0px"),Qe.addElement(ct.menuInnerEl).fromTo("transform",`translateX(${It})`,`translateX(${pt})`);const bn="ios"===(0,hn.b)(ct),ze=bn?.2:.25;return bt.addElement(ct.backdropEl).fromTo("opacity",.01,ze),Ae(bn).addAnimation([Qe,bt])},pn=ct=>{let It,pt;const mt=(0,hn.b)(ct),Qe=ct.width;ct.isEndSide?(It=-Qe+"px",pt=Qe+"px"):(It=Qe+"px",pt=-Qe+"px");const bt=(0,st.c)().addElement(ct.menuInnerEl).fromTo("transform",`translateX(${pt})`,"translateX(0px)"),Ze=(0,st.c)().addElement(ct.contentEl).fromTo("transform","translateX(0px)",`translateX(${It})`),bn=(0,st.c)().addElement(ct.backdropEl).fromTo("opacity",.01,.32);return Ae("ios"===mt).addAnimation([bt,Ze,bn])},xt=ct=>{const It=(0,hn.b)(ct),pt=ct.width*(ct.isEndSide?-1:1)+"px",mt=(0,st.c)().addElement(ct.contentEl).fromTo("transform","translateX(0px)",`translateX(${pt})`);return Ae("ios"===It).addAnimation(mt)},nt=(()=>{const ct=new Map,It=[],pt=function(){var fe=(0,We.Z)(function*(Z){const Ye=yield lt(Z,!0);return!!Ye&&Ye.open()});return function(Ye){return fe.apply(this,arguments)}}(),mt=function(){var fe=(0,We.Z)(function*(Z){const Ye=yield void 0!==Z?lt(Z,!0):Je();return void 0!==Ye&&Ye.close()});return function(Ye){return fe.apply(this,arguments)}}(),Qe=function(){var fe=(0,We.Z)(function*(Z){const Ye=yield lt(Z,!0);return!!Ye&&Ye.toggle()});return function(Ye){return fe.apply(this,arguments)}}(),bt=function(){var fe=(0,We.Z)(function*(Z,Ye){const qt=yield lt(Ye);return qt&&(qt.disabled=!Z),qt});return function(Ye,qt){return fe.apply(this,arguments)}}(),Ze=function(){var fe=(0,We.Z)(function*(Z,Ye){const qt=yield lt(Ye);return qt&&(qt.swipeGesture=Z),qt});return function(Ye,qt){return fe.apply(this,arguments)}}(),bn=function(){var fe=(0,We.Z)(function*(Z){if(null!=Z){const Ye=yield lt(Z);return void 0!==Ye&&Ye.isOpen()}return void 0!==(yield Je())});return function(Ye){return fe.apply(this,arguments)}}(),ze=function(){var fe=(0,We.Z)(function*(Z){const Ye=yield lt(Z);return!!Ye&&!Ye.disabled});return function(Ye){return fe.apply(this,arguments)}}(),lt=function(){var fe=(0,We.Z)(function*(Z,Ye=!1){if(yield be(),"start"===Z||"end"===Z){const kt=It.filter(jt=>jt.side===Z&&!jt.disabled);if(kt.length>=1)return kt.length>1&&Ye&&(0,x.p)(`menuController queried for a menu on the "${Z}" side, but ${kt.length} menus were found. The first menu reference will be used. If this is not the behavior you want then pass the ID of the menu instead of its side.`,kt.map(jt=>jt.el)),kt[0].el;const Lt=It.filter(jt=>jt.side===Z);if(Lt.length>=1)return Lt.length>1&&Ye&&(0,x.p)(`menuController queried for a menu on the "${Z}" side, but ${Lt.length} menus were found. The first menu reference will be used. If this is not the behavior you want then pass the ID of the menu instead of its side.`,Lt.map(jt=>jt.el)),Lt[0].el}else if(null!=Z)return ge(kt=>kt.menuId===Z);return ge(kt=>!kt.disabled)||(It.length>0?It[0].el:void 0)});return function(Ye){return fe.apply(this,arguments)}}(),Je=function(){var fe=(0,We.Z)(function*(){return yield be(),Nt()});return function(){return fe.apply(this,arguments)}}(),Yt=function(){var fe=(0,We.Z)(function*(){return yield be(),gt()});return function(){return fe.apply(this,arguments)}}(),en=function(){var fe=(0,We.Z)(function*(){return yield be(),Xe()});return function(){return fe.apply(this,arguments)}}(),$t=(fe,Z)=>{ct.set(fe,Z)},ut=function(){var fe=(0,We.Z)(function*(Z,Ye,qt){if(Xe())return!1;if(Ye){const kt=yield Je();kt&&Z.el!==kt&&(yield kt.setOpen(!1,!1))}return Z._setOpen(Ye,qt)});return function(Ye,qt,kt){return fe.apply(this,arguments)}}(),Nt=()=>ge(fe=>fe._isOpen),gt=()=>It.map(fe=>fe.el),Xe=()=>It.some(fe=>fe.isAnimating),ge=fe=>{const Z=It.find(fe);if(void 0!==Z)return Z.el},be=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(fe=>new Promise(Z=>(0,an.c)(fe,Z))));return $t("reveal",xt),$t("push",pn),$t("overlay",De),null==fn.d||fn.d.addEventListener("ionBackButton",fe=>{const Z=Nt();Z&&fe.detail.register(X.MENU_BACK_BUTTON_PRIORITY,()=>Z.close())}),{registerAnimation:$t,get:lt,getMenus:Yt,getOpen:Je,isEnabled:ze,swipeGesture:Ze,isAnimating:en,isOpen:bn,enable:bt,toggle:Qe,close:mt,open:pt,_getOpenSync:Nt,_createAnimation:(fe,Z)=>{const Ye=ct.get(fe);if(!Ye)throw new Error("animation not registered");return Ye(Z)},_register:fe=>{It.indexOf(fe)<0&&It.push(fe)},_unregister:fe=>{const Z=It.indexOf(fe);Z>-1&&It.splice(Z,1)},_setOpen:ut}})()},4601:(zr,qn,Ke)=>{"use strict";Ke.d(qn,{a:()=>xt,b:()=>gt,c:()=>X,i:()=>Xe});var We=Ke(7271);class fn{constructor(){this.m=new Map}reset(be){this.m=new Map(Object.entries(be))}get(be,fe){const Z=this.m.get(be);return void 0!==Z?Z:fe}getBoolean(be,fe=!1){const Z=this.m.get(be);return void 0===Z?fe:"string"==typeof Z?"true"===Z:!!Z}getNumber(be,fe){const Z=parseFloat(this.m.get(be));return isNaN(Z)?void 0!==fe?fe:NaN:Z}set(be,fe){this.m.set(be,fe)}}const X=new fn,De="ionic-persist-config",xt=(ge,be)=>("string"==typeof ge&&(be=ge,ge=void 0),(ge=>Mt(ge))(ge).includes(be)),Mt=(ge=window)=>{if(typeof ge>"u")return[];ge.Ionic=ge.Ionic||{};let be=ge.Ionic.platforms;return null==be&&(be=ge.Ionic.platforms=nt(ge),be.forEach(fe=>ge.document.documentElement.classList.add(`plt-${fe}`))),be},nt=ge=>{const be=X.get("platform");return Object.keys(Gn).filter(fe=>{const Z=be?.[fe];return"function"==typeof Z?Z(ge):Gn[fe](ge)})},It=ge=>!!(on(ge,/iPad/i)||on(ge,/Macintosh/i)&&ze(ge)),Qe=ge=>on(ge,/android|sink/i),ze=ge=>ut(ge,"(any-pointer:coarse)"),Je=ge=>Yt(ge)||en(ge),Yt=ge=>!!(ge.cordova||ge.phonegap||ge.PhoneGap),en=ge=>{const be=ge.Capacitor;return!!be?.isNative},on=(ge,be)=>be.test(ge.navigator.userAgent),ut=(ge,be)=>{var fe;return null===(fe=ge.matchMedia)||void 0===fe?void 0:fe.call(ge,be).matches},Gn={ipad:It,iphone:ge=>on(ge,/iPhone/i),ios:ge=>on(ge,/iPhone|iPod/i)||It(ge),android:Qe,phablet:ge=>{const be=ge.innerWidth,fe=ge.innerHeight,Z=Math.min(be,fe),Ye=Math.max(be,fe);return Z>390&&Z<520&&Ye>620&&Ye<800},tablet:ge=>{const be=ge.innerWidth,fe=ge.innerHeight,Z=Math.min(be,fe),Ye=Math.max(be,fe);return It(ge)||(ge=>Qe(ge)&&!on(ge,/mobile/i))(ge)||Z>460&&Z<820&&Ye>780&&Ye<1400},cordova:Yt,capacitor:en,electron:ge=>on(ge,/electron/i),pwa:ge=>{var be;return!!(null!==(be=ge.matchMedia)&&void 0!==be&&be.call(ge,"(display-mode: standalone)").matches||ge.navigator.standalone)},mobile:ze,mobileweb:ge=>ze(ge)&&!Je(ge),desktop:ge=>!ze(ge),hybrid:Je};let Nt;const gt=ge=>ge&&(0,We.g)(ge)||Nt,Xe=(ge={})=>{if(typeof window>"u")return;const be=window.document,fe=window,Z=fe.Ionic=fe.Ionic||{},Ye={};ge._ael&&(Ye.ael=ge._ael),ge._rel&&(Ye.rel=ge._rel),ge._ce&&(Ye.ce=ge._ce),(0,We.a)(Ye);const qt=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(ge=>{try{const be=ge.sessionStorage.getItem(De);return null!==be?JSON.parse(be):{}}catch{return{}}})(fe)),{persistConfig:!1}),Z.config),(ge=>{const be={};return ge.location.search.slice(1).split("&").map(fe=>fe.split("=")).map(([fe,Z])=>{try{return[decodeURIComponent(fe),decodeURIComponent(Z)]}catch{return["",""]}}).filter(([fe])=>((ge,be)=>ge.substr(0,be.length)===be)(fe,"ionic:")).map(([fe,Z])=>[fe.slice(6),Z]).forEach(([fe,Z])=>{be[fe]=Z}),be})(fe)),ge);X.reset(qt),X.getBoolean("persistConfig")&&((ge,be)=>{try{ge.sessionStorage.setItem(De,JSON.stringify(be))}catch{return}})(fe,qt),Mt(fe),Z.config=X,Z.mode=Nt=X.get("mode",be.documentElement.getAttribute("mode")||(xt(fe,"ios")?"ios":"md")),X.set("mode",Nt),be.documentElement.setAttribute("mode",Nt),be.documentElement.classList.add(Nt),X.getBoolean("_testing")&&X.set("animated",!1);const kt=jt=>{var mn;return null===(mn=jt.tagName)||void 0===mn?void 0:mn.startsWith("ION-")},Lt=jt=>["ios","md"].includes(jt);(0,We.c)(jt=>{for(;jt;){const mn=jt.mode||jt.getAttribute("mode");if(mn){if(Lt(mn))return mn;kt(jt)&&console.warn('Invalid ionic mode: "'+mn+'", expected: "ios" or "md"')}jt=jt.parentElement}return Nt})}},6232:(zr,qn,Ke)=>{"use strict";Ke.r(qn),Ke.d(qn,{iosTransitionAnimation:()=>ct,shadow:()=>Ae});var We=Ke(2282),fn=Ke(8200);Ke(1848),Ke(4601),Ke(7271);const st=pt=>document.querySelector(`${pt}.ion-cloned-element`),Ae=pt=>pt.shadowRoot||pt,De=pt=>{const mt="ION-TABS"===pt.tagName?pt:pt.querySelector("ion-tabs"),Qe="ion-content ion-header:not(.header-collapse-condense-inactive) ion-title.title-large";if(null!=mt){const bt=mt.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");return null!=bt?bt.querySelector(Qe):null}return pt.querySelector(Qe)},pn=(pt,mt)=>{const Qe="ION-TABS"===pt.tagName?pt:pt.querySelector("ion-tabs");let bt=[];if(null!=Qe){const Ze=Qe.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");null!=Ze&&(bt=Ze.querySelectorAll("ion-buttons"))}else bt=pt.querySelectorAll("ion-buttons");for(const Ze of bt){const bn=Ze.closest("ion-header"),ze=bn&&!bn.classList.contains("header-collapse-condense-inactive"),lt=Ze.querySelector("ion-back-button"),Je=Ze.classList.contains("buttons-collapse");if(null!==lt&&("start"===Ze.slot||""===Ze.slot)&&(Je&&ze&&mt||!Je))return lt}return null},Mt=(pt,mt,Qe,bt,Ze,bn,ze,lt,Je)=>{var Yt,en;const $t=mt?`calc(100% - ${Ze.right+4}px)`:Ze.left-4+"px",at=mt?"right":"left",on=mt?"left":"right",ut=mt?"right":"left";let Gn=1,Nt=1,gt=`scale(${Nt})`;const Xe="scale(1)";if(bn&&ze){const et=(null===(Yt=bn.textContent)||void 0===Yt?void 0:Yt.trim())===(null===(en=lt.textContent)||void 0===en?void 0:en.trim());Gn=Je.width/ze.width,Nt=(Je.height-It)/ze.height,gt=et?`scale(${Gn}, ${Nt})`:`scale(${Nt})`}const be=Ae(bt).querySelector("ion-icon").getBoundingClientRect(),fe=mt?be.width/2-(be.right-Ze.right)+"px":Ze.left-be.width/2+"px",Z=mt?`-${window.innerWidth-Ze.right}px`:`${Ze.left}px`,Ye=`${Je.top}px`,qt=`${Ze.top}px`,jt=Qe?[{offset:0,transform:`translate3d(${Z}, ${qt}, 0)`},{offset:1,transform:`translate3d(${fe}, ${Ye}, 0)`}]:[{offset:0,transform:`translate3d(${fe}, ${Ye}, 0)`},{offset:1,transform:`translate3d(${Z}, ${qt}, 0)`}],Ui=Qe?[{offset:0,opacity:1,transform:Xe},{offset:1,opacity:0,transform:gt}]:[{offset:0,opacity:0,transform:gt},{offset:1,opacity:1,transform:Xe}],ve=Qe?[{offset:0,opacity:1,transform:"scale(1)"},{offset:.2,opacity:0,transform:"scale(0.6)"},{offset:1,opacity:0,transform:"scale(0.6)"}]:[{offset:0,opacity:0,transform:"scale(0.6)"},{offset:.6,opacity:0,transform:"scale(0.6)"},{offset:1,opacity:1,transform:"scale(1)"}],Oi=(0,We.c)(),dr=(0,We.c)(),Pn=(0,We.c)(),Vn=st("ion-back-button"),ht=Ae(Vn).querySelector(".button-text"),Ne=Ae(Vn).querySelector("ion-icon");Vn.text=bt.text,Vn.mode=bt.mode,Vn.icon=bt.icon,Vn.color=bt.color,Vn.disabled=bt.disabled,Vn.style.setProperty("display","block"),Vn.style.setProperty("position","fixed"),dr.addElement(Ne),Oi.addElement(ht),Pn.addElement(Vn),Pn.beforeStyles({position:"absolute",top:"0px",[ut]:"0px"}).beforeAddWrite(()=>{bt.style.setProperty("display","none"),Vn.style.setProperty(at,$t)}).afterAddWrite(()=>{bt.style.setProperty("display",""),Vn.style.setProperty("display","none"),Vn.style.removeProperty(at)}).keyframes(jt),Oi.beforeStyles({"transform-origin":`${at} top`}).keyframes(Ui),dr.beforeStyles({"transform-origin":`${on} center`}).keyframes(ve),pt.addAnimation([Oi,dr,Pn])},nt=(pt,mt,Qe,bt,Ze,bn,ze,lt,Je)=>{var Yt,en;const $t=mt?"right":"left",at=mt?`calc(100% - ${Ze.right}px)`:`${Ze.left}px`,ut=`${Ze.top}px`;let Nt=mt?`-${window.innerWidth-ze.right-8}px`:`${ze.x+8}px`,gt=.5;const Xe="scale(1)";let ge=`scale(${gt})`;if(lt&&Je){Nt=mt?`-${window.innerWidth-Je.right-8}px`:Je.x-8+"px";const mn=(null===(Yt=lt.textContent)||void 0===Yt?void 0:Yt.trim())===(null===(en=bt.textContent)||void 0===en?void 0:en.trim());gt=Je.height/(bn.height-It),ge=mn?`scale(${Je.width/bn.width}, ${gt})`:`scale(${gt})`}const Z=ze.top+ze.height/2-Ze.height*gt/2+"px",kt=Qe?[{offset:0,opacity:0,transform:`translate3d(${Nt}, ${Z}, 0) ${ge}`},{offset:.1,opacity:0},{offset:1,opacity:1,transform:`translate3d(0px, ${ut}, 0) ${Xe}`}]:[{offset:0,opacity:.99,transform:`translate3d(0px, ${ut}, 0) ${Xe}`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Nt}, ${Z}, 0) ${ge}`}],Lt=st("ion-title"),jt=(0,We.c)();Lt.innerText=bt.innerText,Lt.size=bt.size,Lt.color=bt.color,jt.addElement(Lt),jt.beforeStyles({"transform-origin":`${$t} top`,height:`${Ze.height}px`,display:"",position:"relative",[$t]:at}).beforeAddWrite(()=>{bt.style.setProperty("opacity","0")}).afterAddWrite(()=>{bt.style.setProperty("opacity",""),Lt.style.setProperty("display","none")}).keyframes(kt),pt.addAnimation(jt)},ct=(pt,mt)=>{var Qe;try{const bt="cubic-bezier(0.32,0.72,0,1)",Ze="opacity",bn="transform",ze="0%",Je="rtl"===pt.ownerDocument.dir,Yt=Je?"-99.5%":"99.5%",en=Je?"33%":"-33%",$t=mt.enteringEl,at=mt.leavingEl,on="back"===mt.direction,ut=$t.querySelector(":scope > ion-content"),Gn=$t.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *"),Nt=$t.querySelectorAll(":scope > ion-header > ion-toolbar"),gt=(0,We.c)(),Xe=(0,We.c)();if(gt.addElement($t).duration((null!==(Qe=mt.duration)&&void 0!==Qe?Qe:0)||540).easing(mt.easing||bt).fill("both").beforeRemoveClass("ion-page-invisible"),at&&null!=pt){const Z=(0,We.c)();Z.addElement(pt),gt.addAnimation(Z)}if(ut||0!==Nt.length||0!==Gn.length?(Xe.addElement(ut),Xe.addElement(Gn)):Xe.addElement($t.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),gt.addAnimation(Xe),on?Xe.beforeClearStyles([Ze]).fromTo("transform",`translateX(${en})`,`translateX(${ze})`).fromTo(Ze,.8,1):Xe.beforeClearStyles([Ze]).fromTo("transform",`translateX(${Yt})`,`translateX(${ze})`),ut){const Z=Ae(ut).querySelector(".transition-effect");if(Z){const Ye=Z.querySelector(".transition-cover"),qt=Z.querySelector(".transition-shadow"),kt=(0,We.c)(),Lt=(0,We.c)(),jt=(0,We.c)();kt.addElement(Z).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Lt.addElement(Ye).beforeClearStyles([Ze]).fromTo(Ze,0,.1),jt.addElement(qt).beforeClearStyles([Ze]).fromTo(Ze,.03,.7),kt.addAnimation([Lt,jt]),Xe.addAnimation([kt])}}const ge=$t.querySelector("ion-header.header-collapse-condense"),{forward:be,backward:fe}=((pt,mt,Qe,bt,Ze)=>{const bn=pn(bt,Qe),ze=De(Ze),lt=De(bt),Je=pn(Ze,Qe),Yt=null!==bn&&null!==ze&&!Qe,en=null!==lt&&null!==Je&&Qe;if(Yt){const $t=ze.getBoundingClientRect(),at=bn.getBoundingClientRect(),on=Ae(bn).querySelector(".button-text"),ut=on?.getBoundingClientRect(),Nt=Ae(ze).querySelector(".toolbar-title").getBoundingClientRect();nt(pt,mt,Qe,ze,$t,Nt,at,on,ut),Mt(pt,mt,Qe,bn,at,on,ut,ze,Nt)}else if(en){const $t=lt.getBoundingClientRect(),at=Je.getBoundingClientRect(),on=Ae(Je).querySelector(".button-text"),ut=on?.getBoundingClientRect(),Nt=Ae(lt).querySelector(".toolbar-title").getBoundingClientRect();nt(pt,mt,Qe,lt,$t,Nt,at,on,ut),Mt(pt,mt,Qe,Je,at,on,ut,lt,Nt)}return{forward:Yt,backward:en}})(gt,Je,on,$t,at);if(Nt.forEach(Z=>{const Ye=(0,We.c)();Ye.addElement(Z),gt.addAnimation(Ye);const qt=(0,We.c)();qt.addElement(Z.querySelector("ion-title"));const kt=(0,We.c)(),Lt=Array.from(Z.querySelectorAll("ion-buttons,[menuToggle]")),jt=Z.closest("ion-header"),mn=jt?.classList.contains("header-collapse-condense-inactive");let di;di=Lt.filter(on?Oi=>{const dr=Oi.classList.contains("buttons-collapse");return dr&&!mn||!dr}:Oi=>!Oi.classList.contains("buttons-collapse")),kt.addElement(di);const Ui=(0,We.c)();Ui.addElement(Z.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])"));const ri=(0,We.c)();ri.addElement(Ae(Z).querySelector(".toolbar-background"));const ur=(0,We.c)(),ve=Z.querySelector("ion-back-button");if(ve&&ur.addElement(ve),Ye.addAnimation([qt,kt,Ui,ri,ur]),kt.fromTo(Ze,.01,1),Ui.fromTo(Ze,.01,1),on)mn||qt.fromTo("transform",`translateX(${en})`,`translateX(${ze})`).fromTo(Ze,.01,1),Ui.fromTo("transform",`translateX(${en})`,`translateX(${ze})`),ur.fromTo(Ze,.01,1);else if(ge||qt.fromTo("transform",`translateX(${Yt})`,`translateX(${ze})`).fromTo(Ze,.01,1),Ui.fromTo("transform",`translateX(${Yt})`,`translateX(${ze})`),ri.beforeClearStyles([Ze,"transform"]),jt?.translucent?ri.fromTo("transform",Je?"translateX(-100%)":"translateX(100%)","translateX(0px)"):ri.fromTo(Ze,.01,"var(--opacity)"),be||ur.fromTo(Ze,.01,1),ve&&!be){const dr=(0,We.c)();dr.addElement(Ae(ve).querySelector(".button-text")).fromTo("transform",Je?"translateX(-100px)":"translateX(100px)","translateX(0px)"),Ye.addAnimation(dr)}}),at){const Z=(0,We.c)(),Ye=at.querySelector(":scope > ion-content"),qt=at.querySelectorAll(":scope > ion-header > ion-toolbar"),kt=at.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *");if(Ye||0!==qt.length||0!==kt.length?(Z.addElement(Ye),Z.addElement(kt)):Z.addElement(at.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),gt.addAnimation(Z),on){Z.beforeClearStyles([Ze]).fromTo("transform",`translateX(${ze})`,Je?"translateX(-100%)":"translateX(100%)");const Lt=(0,fn.g)(at);gt.afterAddWrite(()=>{"normal"===gt.getDirection()&&Lt.style.setProperty("display","none")})}else Z.fromTo("transform",`translateX(${ze})`,`translateX(${en})`).fromTo(Ze,1,.8);if(Ye){const Lt=Ae(Ye).querySelector(".transition-effect");if(Lt){const jt=Lt.querySelector(".transition-cover"),mn=Lt.querySelector(".transition-shadow"),di=(0,We.c)(),Ui=(0,We.c)(),ri=(0,We.c)();di.addElement(Lt).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Ui.addElement(jt).beforeClearStyles([Ze]).fromTo(Ze,.1,0),ri.addElement(mn).beforeClearStyles([Ze]).fromTo(Ze,.7,.03),di.addAnimation([Ui,ri]),Z.addAnimation([di])}}qt.forEach(Lt=>{const jt=(0,We.c)();jt.addElement(Lt);const mn=(0,We.c)();mn.addElement(Lt.querySelector("ion-title"));const di=(0,We.c)(),Ui=Lt.querySelectorAll("ion-buttons,[menuToggle]"),ri=Lt.closest("ion-header"),ur=ri?.classList.contains("header-collapse-condense-inactive"),ve=Array.from(Ui).filter(Ne=>{const et=Ne.classList.contains("buttons-collapse");return et&&!ur||!et});di.addElement(ve);const Oi=(0,We.c)(),dr=Lt.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])");dr.length>0&&Oi.addElement(dr);const Pn=(0,We.c)();Pn.addElement(Ae(Lt).querySelector(".toolbar-background"));const Vn=(0,We.c)(),ht=Lt.querySelector("ion-back-button");if(ht&&Vn.addElement(ht),jt.addAnimation([mn,di,Oi,Vn,Pn]),gt.addAnimation(jt),Vn.fromTo(Ze,.99,0),di.fromTo(Ze,.99,0),Oi.fromTo(Ze,.99,0),on){if(ur||mn.fromTo("transform",`translateX(${ze})`,Je?"translateX(-100%)":"translateX(100%)").fromTo(Ze,.99,0),Oi.fromTo("transform",`translateX(${ze})`,Je?"translateX(-100%)":"translateX(100%)"),Pn.beforeClearStyles([Ze,"transform"]),ri?.translucent?Pn.fromTo("transform","translateX(0px)",Je?"translateX(-100%)":"translateX(100%)"):Pn.fromTo(Ze,"var(--opacity)",0),ht&&!fe){const et=(0,We.c)();et.addElement(Ae(ht).querySelector(".button-text")).fromTo("transform",`translateX(${ze})`,`translateX(${(Je?-124:124)+"px"})`),jt.addAnimation(et)}}else ur||mn.fromTo("transform",`translateX(${ze})`,`translateX(${en})`).fromTo(Ze,.99,0).afterClearStyles([bn,Ze]),Oi.fromTo("transform",`translateX(${ze})`,`translateX(${en})`).afterClearStyles([bn,Ze]),Vn.afterClearStyles([Ze]),mn.afterClearStyles([Ze]),di.afterClearStyles([Ze])})}return gt}catch(bt){throw bt}},It=10},519:(zr,qn,Ke)=>{"use strict";Ke.r(qn),Ke.d(qn,{mdTransitionAnimation:()=>hn});var We=Ke(2282),fn=Ke(8200);Ke(1848),Ke(4601),Ke(7271);const hn=(st,Ae)=>{var De,pn,xt;const ct="back"===Ae.direction,pt=Ae.leavingEl,mt=(0,fn.g)(Ae.enteringEl),Qe=mt.querySelector("ion-toolbar"),bt=(0,We.c)();if(bt.addElement(mt).fill("both").beforeRemoveClass("ion-page-invisible"),ct?bt.duration((null!==(De=Ae.duration)&&void 0!==De?De:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):bt.duration((null!==(pn=Ae.duration)&&void 0!==pn?pn:0)||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("transform","translateY(40px)","translateY(0px)").fromTo("opacity",.01,1),Qe){const Ze=(0,We.c)();Ze.addElement(Qe),bt.addAnimation(Ze)}if(pt&&ct){bt.duration((null!==(xt=Ae.duration)&&void 0!==xt?xt:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)");const Ze=(0,We.c)();Ze.addElement((0,fn.g)(pt)).onFinish(bn=>{1===bn&&Ze.elements.length>0&&Ze.elements[0].style.setProperty("display","none")}).fromTo("transform","translateY(0px)","translateY(40px)").fromTo("opacity",1,0),bt.addAnimation(Ze)}return bt}},7368:(zr,qn,Ke)=>{"use strict";Ke.d(qn,{B:()=>Ui,F:()=>Vn,G:()=>ri,O:()=>ur,a:()=>mt,b:()=>Qe,c:()=>ze,d:()=>ve,e:()=>Oi,f:()=>be,g:()=>Z,h:()=>kt,i:()=>jt,j:()=>Je,k:()=>Yt,m:()=>Ze,n:()=>pn,o:()=>Xe,q:()=>xt,s:()=>di});var We=Ke(5861),fn=Ke(1848),X=Ke(4298),x=Ke(6466),an=Ke(4601),hn=Ke(4813),st=Ke(4089),Ae=Ke(2400);const De='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',pn=(ht,Ne)=>{const et=ht.querySelector(De);Mt(et,Ne??ht)},xt=(ht,Ne)=>{const et=Array.from(ht.querySelectorAll(De));Mt(et.length>0?et[et.length-1]:null,Ne??ht)},Mt=(ht,Ne)=>{let et=ht;const wn=ht?.shadowRoot;wn&&(et=wn.querySelector(De)||ht),et?(0,X.f)(et):Ne.focus()};let nt=0,ct=0;const It=new WeakMap,pt=ht=>({create:Ne=>en(ht,Ne),dismiss:(Ne,et,wn)=>Gn(document,Ne,et,ht,wn),getTop:()=>(0,We.Z)(function*(){return Xe(document,ht)})()}),mt=pt("ion-alert"),Qe=pt("ion-action-sheet"),Ze=pt("ion-modal"),ze=pt("ion-popover"),Je=ht=>{typeof document<"u"&&ut(document);const Ne=nt++;ht.overlayIndex=Ne},Yt=ht=>(ht.hasAttribute("id")||(ht.id="ion-overlay-"+ ++ct),ht.id),en=(ht,Ne)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(ht).then(()=>{const et=document.createElement(ht);return et.classList.add("overlay-hidden"),Object.assign(et,Object.assign(Object.assign({},Ne),{hasController:!0})),Ye(document).appendChild(et),new Promise(wn=>(0,X.c)(et,wn))}):Promise.resolve(),at=(ht,Ne)=>{let et=ht;const wn=ht?.shadowRoot;wn&&(et=wn.querySelector(De)||ht),et?(0,X.f)(et):Ne.focus()},ut=ht=>{0===nt&&(nt=1,ht.addEventListener("focus",Ne=>{((ht,Ne)=>{const et=Xe(Ne,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker-legacy,ion-popover"),wn=ht.target;et&&wn&&!et.classList.contains(Vn)&&(et.shadowRoot?(()=>{if(et.contains(wn))et.lastFocus=wn;else if("ION-TOAST"===wn.tagName)at(et.lastFocus,et);else{const ki=et.lastFocus;pn(et),ki===Ne.activeElement&&xt(et),et.lastFocus=Ne.activeElement}})():(()=>{if(et===wn)et.lastFocus=void 0;else if("ION-TOAST"===wn.tagName)at(et.lastFocus,et);else{const ki=(0,X.g)(et);if(!ki.contains(wn))return;const it=ki.querySelector(".ion-overlay-wrapper");if(!it)return;if(it.contains(wn)||wn===ki.querySelector("ion-backdrop"))et.lastFocus=wn;else{const vi=et.lastFocus;pn(it,et),vi===Ne.activeElement&&xt(it,et),et.lastFocus=Ne.activeElement}}})())})(Ne,ht)},!0),ht.addEventListener("ionBackButton",Ne=>{const et=Xe(ht);et?.backdropDismiss&&Ne.detail.register(x.OVERLAY_BACK_BUTTON_PRIORITY,()=>{et.dismiss(void 0,Ui)})}),(0,x.shouldUseCloseWatcher)()||ht.addEventListener("keydown",Ne=>{if("Escape"===Ne.key){const et=Xe(ht);et?.backdropDismiss&&et.dismiss(void 0,Ui)}}))},Gn=(ht,Ne,et,wn,Fn)=>{const $i=Xe(ht,wn,Fn);return $i?$i.dismiss(Ne,et):Promise.reject("overlay does not exist")},gt=(ht,Ne)=>((ht,Ne)=>(void 0===Ne&&(Ne="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker-legacy,ion-popover,ion-toast"),Array.from(ht.querySelectorAll(Ne)).filter(et=>et.overlayIndex>0)))(ht,Ne).filter(et=>!(ht=>ht.classList.contains("overlay-hidden"))(et)),Xe=(ht,Ne,et)=>{const wn=gt(ht,Ne);return void 0===et?wn[wn.length-1]:wn.find(Fn=>Fn.id===et)},ge=(ht=!1)=>{const et=Ye(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");et&&(ht?et.setAttribute("aria-hidden","true"):et.removeAttribute("aria-hidden"))},be=function(){var ht=(0,We.Z)(function*(Ne,et,wn,Fn,$i){var ki,it;if(Ne.presented)return;ge(!0),document.body.classList.add(st.B),dr(Ne.el),Ne.presented=!0,Ne.willPresent.emit(),null===(ki=Ne.willPresentShorthand)||void 0===ki||ki.emit();const vi=(0,an.b)(Ne),hi=Ne.enterAnimation?Ne.enterAnimation:an.c.get(et,"ios"===vi?wn:Fn);(yield qt(Ne,hi,Ne.el,$i))&&(Ne.didPresent.emit(),null===(it=Ne.didPresentShorthand)||void 0===it||it.emit()),"ION-TOAST"!==Ne.el.tagName&&fe(Ne.el),Ne.keyboardClose&&(null===document.activeElement||!Ne.el.contains(document.activeElement))&&Ne.el.focus(),Ne.el.removeAttribute("aria-hidden")});return function(et,wn,Fn,$i,ki){return ht.apply(this,arguments)}}(),fe=function(){var ht=(0,We.Z)(function*(Ne){let et=document.activeElement;if(!et)return;const wn=et?.shadowRoot;wn&&(et=wn.querySelector(De)||et),yield Ne.onDidDismiss(),(null===document.activeElement||document.activeElement===document.body)&&et.focus()});return function(et){return ht.apply(this,arguments)}}(),Z=function(){var ht=(0,We.Z)(function*(Ne,et,wn,Fn,$i,ki,it){var vi,hi;if(!Ne.presented)return!1;void 0!==fn.d&&1===gt(fn.d).length&&(ge(!1),document.body.classList.remove(st.B)),Ne.presented=!1;try{Ne.el.style.setProperty("pointer-events","none"),Ne.willDismiss.emit({data:et,role:wn}),null===(vi=Ne.willDismissShorthand)||void 0===vi||vi.emit({data:et,role:wn});const Hi=(0,an.b)(Ne),Bt=Ne.leaveAnimation?Ne.leaveAnimation:an.c.get(Fn,"ios"===Hi?$i:ki);wn!==ri&&(yield qt(Ne,Bt,Ne.el,it)),Ne.didDismiss.emit({data:et,role:wn}),null===(hi=Ne.didDismissShorthand)||void 0===hi||hi.emit({data:et,role:wn}),(It.get(Ne)||[]).forEach(In=>In.destroy()),It.delete(Ne),Ne.el.classList.add("overlay-hidden"),Ne.el.style.removeProperty("pointer-events"),void 0!==Ne.el.lastFocus&&(Ne.el.lastFocus=void 0)}catch(Hi){console.error(Hi)}return Ne.el.remove(),Pn(),!0});return function(et,wn,Fn,$i,ki,it,vi){return ht.apply(this,arguments)}}(),Ye=ht=>ht.querySelector("ion-app")||ht.body,qt=function(){var ht=(0,We.Z)(function*(Ne,et,wn,Fn){wn.classList.remove("overlay-hidden");const ki=et(Ne.el,Fn);(!Ne.animated||!an.c.getBoolean("animated",!0))&&ki.duration(0),Ne.keyboardClose&&ki.beforeAddWrite(()=>{const vi=wn.ownerDocument.activeElement;vi?.matches("input,ion-input, ion-textarea")&&vi.blur()});const it=It.get(Ne)||[];return It.set(Ne,[...it,ki]),yield ki.play(),!0});return function(et,wn,Fn,$i){return ht.apply(this,arguments)}}(),kt=(ht,Ne)=>{let et;const wn=new Promise(Fn=>et=Fn);return Lt(ht,Ne,Fn=>{et(Fn.detail)}),wn},Lt=(ht,Ne,et)=>{const wn=Fn=>{(0,X.b)(ht,Ne,wn),et(Fn)};(0,X.a)(ht,Ne,wn)},jt=ht=>"cancel"===ht||ht===Ui,mn=ht=>ht(),di=(ht,Ne)=>{if("function"==typeof ht)return an.c.get("_zoneGate",mn)(()=>{try{return ht(Ne)}catch(wn){throw wn}})},Ui="backdrop",ri="gesture",ur=39,ve=ht=>{let et,Ne=!1;const wn=(0,hn.C)(),Fn=(it=!1)=>{if(et&&!it)return{delegate:et,inline:Ne};const{el:vi,hasController:hi,delegate:hr}=ht;return Ne=null!==vi.parentNode&&!hi,et=Ne?hr||wn:hr,{inline:Ne,delegate:et}};return{attachViewToDom:function(){var it=(0,We.Z)(function*(vi){const{delegate:hi}=Fn(!0);if(hi)return yield hi.attachViewToDom(ht.el,vi);const{hasController:hr}=ht;if(hr&&void 0!==vi)throw new Error("framework delegate is missing");return null});return function(hi){return it.apply(this,arguments)}}(),removeViewFromDom:()=>{const{delegate:it}=Fn();it&&void 0!==ht.el&&it.removeViewFromDom(ht.el.parentElement,ht.el)}}},Oi=()=>{let ht;const Ne=()=>{ht&&(ht(),ht=void 0)};return{addClickListener:(wn,Fn)=>{Ne();const $i=void 0!==Fn?document.getElementById(Fn):null;$i?ht=((it,vi)=>{const hi=()=>{vi.present()};return it.addEventListener("click",hi),()=>{it.removeEventListener("click",hi)}})($i,wn):(0,Ae.p)(`A trigger element with the ID "${Fn}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,wn)},removeClickListener:Ne}},dr=ht=>{var Ne;if(void 0===fn.d)return;const et=gt(fn.d);for(let wn=et.length-1;wn>=0;wn--){const Fn=et[wn],$i=null!==(Ne=et[wn+1])&&void 0!==Ne?Ne:ht;($i.hasAttribute("aria-hidden")||"ION-TOAST"!==$i.tagName)&&Fn.setAttribute("aria-hidden","true")}},Pn=()=>{if(void 0===fn.d)return;const ht=gt(fn.d);for(let Ne=ht.length-1;Ne>=0;Ne--){const et=ht[Ne];if(et.removeAttribute("aria-hidden"),"ION-TOAST"!==et.tagName)break}},Vn="ion-disable-focus-trap"},8819:(zr,qn,Ke)=>{"use strict";function We(e){return"function"==typeof e}function fn(e){const t=e(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const X=fn(e=>function(t){e(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function x(e,n){if(e){const t=e.indexOf(n);0<=t&&e.splice(t,1)}}class an{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const l of t)l.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(We(i))try{i()}catch(l){n=l instanceof X?l.errors:[l]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const l of r)try{Ae(l)}catch(h){n=n??[],h instanceof X?n=[...n,...h.errors]:n.push(h)}}if(n)throw new X(n)}}add(n){var t;if(n&&n!==this)if(this.closed)Ae(n);else{if(n instanceof an){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(n)}}_hasParent(n){const{_parentage:t}=this;return t===n||Array.isArray(t)&&t.includes(n)}_addParent(n){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(n),t):t?[t,n]:n}_removeParent(n){const{_parentage:t}=this;t===n?this._parentage=null:Array.isArray(t)&&x(t,n)}remove(n){const{_finalizers:t}=this;t&&x(t,n),n instanceof an&&n._removeParent(this)}}an.EMPTY=(()=>{const e=new an;return e.closed=!0,e})();const hn=an.EMPTY;function st(e){return e instanceof an||e&&"closed"in e&&We(e.remove)&&We(e.add)&&We(e.unsubscribe)}function Ae(e){We(e)?e():e.unsubscribe()}const De={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},pn={setTimeout(e,n,...t){const{delegate:i}=pn;return i?.setTimeout?i.setTimeout(e,n,...t):setTimeout(e,n,...t)},clearTimeout(e){const{delegate:n}=pn;return(n?.clearTimeout||clearTimeout)(e)},delegate:void 0};function xt(e){pn.setTimeout(()=>{const{onUnhandledError:n}=De;if(!n)throw e;n(e)})}function Mt(){}const nt=pt("C",void 0,void 0);function pt(e,n,t){return{kind:e,value:n,error:t}}let mt=null;function Qe(e){if(De.useDeprecatedSynchronousErrorHandling){const n=!mt;if(n&&(mt={errorThrown:!1,error:null}),e(),n){const{errorThrown:t,error:i}=mt;if(mt=null,t)throw i}}else e()}class Ze extends an{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,st(n)&&n.add(this)):this.destination=at}static create(n,t,i){return new Je(n,t,i)}next(n){this.isStopped?$t(function It(e){return pt("N",e,void 0)}(n),this):this._next(n)}error(n){this.isStopped?$t(function ct(e){return pt("E",void 0,e)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?$t(nt,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const bn=Function.prototype.bind;function ze(e,n){return bn.call(e,n)}class lt{constructor(n){this.partialObserver=n}next(n){const{partialObserver:t}=this;if(t.next)try{t.next(n)}catch(i){Yt(i)}}error(n){const{partialObserver:t}=this;if(t.error)try{t.error(n)}catch(i){Yt(i)}else Yt(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(t){Yt(t)}}}class Je extends Ze{constructor(n,t,i){let r;if(super(),We(n)||!n)r={next:n??void 0,error:t??void 0,complete:i??void 0};else{let l;this&&De.useDeprecatedNextContext?(l=Object.create(n),l.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&ze(n.next,l),error:n.error&&ze(n.error,l),complete:n.complete&&ze(n.complete,l)}):r=n}this.destination=new lt(r)}}function Yt(e){De.useDeprecatedSynchronousErrorHandling?function bt(e){De.useDeprecatedSynchronousErrorHandling&&mt&&(mt.errorThrown=!0,mt.error=e)}(e):xt(e)}function $t(e,n){const{onStoppedNotification:t}=De;t&&pn.setTimeout(()=>t(e,n))}const at={closed:!0,next:Mt,error:function en(e){throw e},complete:Mt},on="function"==typeof Symbol&&Symbol.observable||"@@observable";function ut(e){return e}function Nt(e){return 0===e.length?ut:1===e.length?e[0]:function(t){return e.reduce((i,r)=>r(i),t)}}let gt=(()=>{class e{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new e;return i.source=this,i.operator=t,i}subscribe(t,i,r){const l=function be(e){return e&&e instanceof Ze||function ge(e){return e&&We(e.next)&&We(e.error)&&We(e.complete)}(e)&&st(e)}(t)?t:new Je(t,i,r);return Qe(()=>{const{operator:h,source:g}=this;l.add(h?h.call(l,g):g?this._subscribe(l):this._trySubscribe(l))}),l}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=Xe(i))((r,l)=>{const h=new Je({next:g=>{try{t(g)}catch(w){l(w),h.unsubscribe()}},error:l,complete:r});this.subscribe(h)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[on](){return this}pipe(...t){return Nt(t)(this)}toPromise(t){return new(t=Xe(t))((i,r)=>{let l;this.subscribe(h=>l=h,h=>r(h),()=>i(l))})}}return e.create=n=>new e(n),e})();function Xe(e){var n;return null!==(n=e??De.Promise)&&void 0!==n?n:Promise}const fe=fn(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Z=(()=>{class e extends gt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Ye(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new fe}next(t){Qe(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Qe(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Qe(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:l}=this;return i||r?hn:(this.currentObservers=null,l.push(t),new an(()=>{this.currentObservers=null,x(l,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:l}=this;i?t.error(r):l&&t.complete()}asObservable(){const t=new gt;return t.source=this,t}}return e.create=(n,t)=>new Ye(n,t),e})();class Ye extends Z{constructor(n,t){super(),this.destination=n,this.source=t}next(n){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,n)}error(n){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,n)}complete(){var n,t;null===(t=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===t||t.call(n)}_subscribe(n){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(n))&&void 0!==i?i:hn}}function qt(e){return We(e?.lift)}function kt(e){return n=>{if(qt(n))return n.lift(function(t){try{return e(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Lt(e,n,t,i,r){return new jt(e,n,t,i,r)}class jt extends Ze{constructor(n,t,i,r,l,h){super(n),this.onFinalize=l,this.shouldUnsubscribe=h,this._next=t?function(g){try{t(g)}catch(w){n.error(w)}}:super._next,this._error=r?function(g){try{r(g)}catch(w){n.error(w)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(g){n.error(g)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function mn(e,n){return kt((t,i)=>{let r=0;t.subscribe(Lt(i,l=>{i.next(e.call(n,l,r++))}))})}function Hi(e){return this instanceof Hi?(this.v=e,this):new Hi(e)}function In(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function ki(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(l){t[l]=e[l]&&function(h){return new Promise(function(g,w){!function r(l,h,g,w){Promise.resolve(w).then(function(E){l({value:E,done:g})},h)}(g,w,(h=e[l](h)).done,h.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const re=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function Ce(e){return We(e?.then)}function Te(e){return We(e[on])}function ke(e){return Symbol.asyncIterator&&We(e?.[Symbol.asyncIterator])}function ce(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const rt=function $e(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Le(e){return We(e?.[rt])}function wt(e){return function Bt(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(e,n||[]),l=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",function h(ie){return function(we){return Promise.resolve(we).then(ie,$)}}),r[Symbol.asyncIterator]=function(){return this},r;function g(ie,we){i[ie]&&(r[ie]=function(Se){return new Promise(function(je,dt){l.push([ie,Se,je,dt])>1||w(ie,Se)})},we&&(r[ie]=we(r[ie])))}function w(ie,we){try{!function E(ie){ie.value instanceof Hi?Promise.resolve(ie.value.v).then(k,$):te(l[0][2],ie)}(i[ie](we))}catch(Se){te(l[0][3],Se)}}function k(ie){w("next",ie)}function $(ie){w("throw",ie)}function te(ie,we){ie(we),l.shift(),l.length&&w(l[0][0],l[0][1])}}(this,arguments,function*(){const t=e.getReader();try{for(;;){const{value:i,done:r}=yield Hi(t.read());if(r)return yield Hi(void 0);yield yield Hi(i)}}finally{t.releaseLock()}})}function Ut(e){return We(e?.getReader)}function tn(e){if(e instanceof gt)return e;if(null!=e){if(Te(e))return function kn(e){return new gt(n=>{const t=e[on]();if(We(t.subscribe))return t.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(re(e))return function oi(e){return new gt(n=>{for(let t=0;t<e.length&&!n.closed;t++)n.next(e[t]);n.complete()})}(e);if(Ce(e))return function Dn(e){return new gt(n=>{e.then(t=>{n.closed||(n.next(t),n.complete())},t=>n.error(t)).then(null,xt)})}(e);if(ke(e))return pi(e);if(Le(e))return function xi(e){return new gt(n=>{for(const t of e)if(n.next(t),n.closed)return;n.complete()})}(e);if(Ut(e))return function bi(e){return pi(wt(e))}(e)}throw ce(e)}function pi(e){return new gt(n=>{(function ei(e,n){var t,i,r,l;return function et(e,n,t,i){return new(t||(t=Promise))(function(l,h){function g(k){try{E(i.next(k))}catch($){h($)}}function w(k){try{E(i.throw(k))}catch($){h($)}}function E(k){k.done?l(k.value):function r(l){return l instanceof t?l:new t(function(h){h(l)})}(k.value).then(g,w)}E((i=i.apply(e,n||[])).next())})}(this,void 0,void 0,function*(){try{for(t=In(e);!(i=yield t.next()).done;)if(n.next(i.value),n.closed)return}catch(h){r={error:h}}finally{try{i&&!i.done&&(l=t.return)&&(yield l.call(t))}finally{if(r)throw r.error}}n.complete()})})(e,n).catch(t=>n.error(t))})}function si(e,n,t,i=0,r=!1){const l=n.schedule(function(){t(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(l),!r)return l}function mi(e,n,t=1/0){return We(n)?mi((i,r)=>mn((l,h)=>n(i,l,r,h))(tn(e(i,r))),t):("number"==typeof n&&(t=n),kt((i,r)=>function qi(e,n,t,i,r,l,h,g){const w=[];let E=0,k=0,$=!1;const te=()=>{$&&!w.length&&!E&&n.complete()},ie=Se=>E<i?we(Se):w.push(Se),we=Se=>{l&&n.next(Se),E++;let je=!1;tn(t(Se,k++)).subscribe(Lt(n,dt=>{r?.(dt),l?ie(dt):n.next(dt)},()=>{je=!0},void 0,()=>{if(je)try{for(E--;w.length&&E<i;){const dt=w.shift();h?si(n,h,()=>we(dt)):we(dt)}te()}catch(dt){n.error(dt)}}))};return e.subscribe(Lt(n,ie,()=>{$=!0,te()})),()=>{g?.()}}(i,r,e,t)))}function _r(e=1/0){return mi(ut,e)}const Ci=new gt(e=>e.complete());function us(e){return e[e.length-1]}function ir(e){return We(us(e))?e.pop():void 0}function kr(e){return function Xo(e){return e&&We(e.schedule)}(us(e))?e.pop():void 0}function He(e,n=0){return kt((t,i)=>{t.subscribe(Lt(i,r=>si(i,e,()=>i.next(r),n),()=>si(i,e,()=>i.complete(),n),r=>si(i,e,()=>i.error(r),n)))})}function St(e,n=0){return kt((t,i)=>{i.add(e.schedule(()=>t.subscribe(i),n))})}function Hr(e,n){if(!e)throw new Error("Iterable cannot be null");return new gt(t=>{si(t,n,()=>{const i=e[Symbol.asyncIterator]();si(t,n,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Vi(e,n){return n?function La(e,n){if(null!=e){if(Te(e))return function ii(e,n){return tn(e).pipe(St(n),He(n))}(e,n);if(re(e))return function Di(e,n){return new gt(t=>{let i=0;return n.schedule(function(){i===e.length?t.complete():(t.next(e[i++]),t.closed||this.schedule())})})}(e,n);if(Ce(e))return function Gi(e,n){return tn(e).pipe(St(n),He(n))}(e,n);if(ke(e))return Hr(e,n);if(Le(e))return function br(e,n){return new gt(t=>{let i;return si(t,n,()=>{i=e[rt](),si(t,n,()=>{let r,l;try{({value:r,done:l}=i.next())}catch(h){return void t.error(h)}l?t.complete():t.next(r)},0,!0)}),()=>We(i?.return)&&i.return()})}(e,n);if(Ut(e))return function Rr(e,n){return Hr(wt(e),n)}(e,n)}throw ce(e)}(e,n):tn(e)}class ti extends Z{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const t=super._subscribe(n);return!t.closed&&n.next(this._value),t}getValue(){const{hasError:n,thrownError:t,_value:i}=this;if(n)throw t;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}function Zn(...e){return Vi(e,kr(e))}function wa(e={}){const{connector:n=(()=>new Z),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=e;return l=>{let h,g,w,E=0,k=!1,$=!1;const te=()=>{g?.unsubscribe(),g=void 0},ie=()=>{te(),h=w=void 0,k=$=!1},we=()=>{const Se=h;ie(),Se?.unsubscribe()};return kt((Se,je)=>{E++,!$&&!k&&te();const dt=w=w??n();je.add(()=>{E--,0===E&&!$&&!k&&(g=Ko(we,r))}),dt.subscribe(je),!h&&E>0&&(h=new Je({next:Ue=>dt.next(Ue),error:Ue=>{$=!0,te(),g=Ko(ie,t,Ue),dt.error(Ue)},complete:()=>{k=!0,te(),g=Ko(ie,i),dt.complete()}}),tn(Se).subscribe(h))})(l)}}function Ko(e,n,...t){if(!0===n)return void e();if(!1===n)return;const i=new Je({next:()=>{i.unsubscribe(),e()}});return tn(n(...t)).subscribe(i)}function jn(e,n){return kt((t,i)=>{let r=null,l=0,h=!1;const g=()=>h&&!r&&i.complete();t.subscribe(Lt(i,w=>{r?.unsubscribe();let E=0;const k=l++;tn(e(w,k)).subscribe(r=Lt(i,$=>i.next(n?n(w,$,k,E++):$),()=>{r=null,g()}))},()=>{h=!0,g()}))})}function Bl(e,n){return e===n}function Ti(e){for(let n in e)if(e[n]===Ti)return n;throw Error("Could not find renamed property on target object.")}function Bo(e,n){for(const t in n)n.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function wr(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(wr).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const n=e.toString();if(null==n)return""+n;const t=n.indexOf("\n");return-1===t?n:n.substring(0,t)}function Yo(e,n){return null==e||""===e?null===n?"":n:null==n||""===n?e:e+" "+n}const fr=Ti({__forward_ref__:Ti});function Fi(e){return e.__forward_ref__=Fi,e.toString=function(){return wr(this())},e}function Un(e){return zl(e)?e():e}function zl(e){return"function"==typeof e&&e.hasOwnProperty(fr)&&e.__forward_ref__===Fi}function al(e){return e&&!!e.\u0275providers}const xc="https://g.co/ng/security#xss";class qe extends Error{constructor(n,t){super(function Ps(e,n){return`NG0${Math.abs(e)}${n?": "+n:""}`}(n,t)),this.code=n}}function On(e){return"string"==typeof e?e:null==e?"":String(e)}function ll(e,n){throw new qe(-201,!1)}function pe(e,n){null==e&&function _e(e,n,t,i){throw new Error(`ASSERTION ERROR: ${e}`+(null==i?"":` [Expected=> ${t} ${i} ${n} <=Actual]`))}(n,e,null,"!=")}function Pe(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Rt(e){return{providers:e.providers||[],imports:e.imports||[]}}function nn(e){return Bn(e,Sr)||Bn(e,Fr)}function Bn(e,n){return e.hasOwnProperty(n)?e[n]:null}function Ji(e){return e&&(e.hasOwnProperty(Qi)||e.hasOwnProperty(Hl))?e[Qi]:null}const Sr=Ti({\u0275prov:Ti}),Qi=Ti({\u0275inj:Ti}),Fr=Ti({ngInjectableDef:Ti}),Hl=Ti({ngInjectorDef:Ti});var Ln=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(Ln||{});let Ec;function Io(e){const n=Ec;return Ec=e,n}function dl(e,n,t){const i=nn(e);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Ln.Optional?null:void 0!==n?n:void ll(wr(e))}const Xi=globalThis;class ln{constructor(n,t){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Pe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Rs={},xr="__NG_DI_FLAG__",Pc="ngTempTokenPath",kc=/\n/gm,tr="__source";let aa;function Jo(e){const n=aa;return aa=e,n}function Rc(e,n=Ln.Default){if(void 0===aa)throw new qe(-203,!1);return null===aa?dl(e,void 0,n):aa.get(e,n&Ln.Optional?null:void 0,n)}function Ht(e,n=Ln.Default){return(function Yu(){return Ec}()||Rc)(Un(e),n)}function Ft(e,n=Ln.Default){return Ht(e,ds(n))}function ds(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function ho(e){const n=[];for(let t=0;t<e.length;t++){const i=Un(e[t]);if(Array.isArray(i)){if(0===i.length)throw new qe(900,!1);let r,l=Ln.Default;for(let h=0;h<i.length;h++){const g=i[h],w=Oc(g);"number"==typeof w?-1===w?r=g.token:l|=w:r=g}n.push(Ht(r,l))}else n.push(Ht(i))}return n}function $a(e,n){return e[xr]=n,e.prototype[xr]=n,e}function Oc(e){return e[xr]}function Qo(e){return{toString:e}.toString()}var Da=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(Da||{}),yo=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(yo||{});const zo={},Ni=[],qs=Ti({\u0275cmp:Ti}),es=Ti({\u0275dir:Ti}),Wl=Ti({\u0275pipe:Ti}),Zl=Ti({\u0275mod:Ti}),li=Ti({\u0275fac:Ti}),la=Ti({__NG_ELEMENT_ID__:Ti}),Fc=Ti({__NG_ENV_ID__:Ti});function Xl(e,n,t){let i=e.length;for(;;){const r=e.indexOf(n,t);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const l=n.length;if(r+l===i||e.charCodeAt(r+l)<=32)return r}t=r+1}}function Va(e,n,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const l=t[i++],h=t[i++],g=t[i++];e.setAttribute(n,h,g,l)}else{const l=r,h=t[++i];Kl(l)?e.setProperty(n,l,h):e.setAttribute(n,l,h),i++}}return i}function Lc(e){return 3===e||4===e||6===e}function Kl(e){return 64===e.charCodeAt(0)}function ca(e,n){if(null!==n&&0!==n.length)if(null===e||0===e.length)e=n.slice();else{let t=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?t=r:0===t||Nc(e,t,r,null,-1===t||2===t?n[++i]:null)}}return e}function Nc(e,n,t,i,r){let l=0,h=e.length;if(-1===n)h=-1;else for(;l<e.length;){const g=e[l++];if("number"==typeof g){if(g===n){h=-1;break}if(g>n){h=l-1;break}}}for(;l<e.length;){const g=e[l];if("number"==typeof g)break;if(g===t){if(null===i)return void(null!==r&&(e[l+1]=r));if(i===e[l+1])return void(e[l+2]=r)}l++,null!==i&&l++,null!==r&&l++}-1!==h&&(e.splice(h,0,n),l=h+1),e.splice(l++,0,t),null!==i&&e.splice(l++,0,i),null!==r&&e.splice(l++,0,r)}const fl="ng-template";function pl(e,n,t){let i=0,r=!0;for(;i<e.length;){let l=e[i++];if("string"==typeof l&&r){const h=e[i++];if(t&&"class"===l&&-1!==Xl(h.toLowerCase(),n,0))return!0}else{if(1===l){for(;i<e.length&&"string"==typeof(l=e[i++]);)if(l.toLowerCase()===n)return!0;return!1}"number"==typeof l&&(r=!1)}}return!1}function ml(e){return 4===e.type&&e.value!==fl}function ja(e,n,t){return n===(4!==e.type||t?e.value:fl)}function Yl(e,n,t){let i=4;const r=e.attrs||[],l=function Ua(e){for(let n=0;n<e.length;n++)if(Lc(e[n]))return n;return e.length}(r);let h=!1;for(let g=0;g<n.length;g++){const w=n[g];if("number"!=typeof w){if(!h)if(4&i){if(i=2|1&i,""!==w&&!ja(e,w,t)||""===w&&1===n.length){if(hs(i))return!1;h=!0}}else{const E=8&i?w:n[++g];if(8&i&&null!==e.attrs){if(!pl(e.attrs,E,t)){if(hs(i))return!1;h=!0}continue}const $=Bc(8&i?"class":w,r,ml(e),t);if(-1===$){if(hs(i))return!1;h=!0;continue}if(""!==E){let te;te=$>l?"":r[$+1].toLowerCase();const ie=8&i?te:null;if(ie&&-1!==Xl(ie,E,0)||2&i&&E!==te){if(hs(i))return!1;h=!0}}}}else{if(!h&&!hs(i)&&!hs(w))return!1;if(h&&hs(w))continue;h=!1,i=w|1&i}}return hs(i)||h}function hs(e){return 0==(1&e)}function Bc(e,n,t,i){if(null===n)return-1;let r=0;if(i||!t){let l=!1;for(;r<n.length;){const h=n[r];if(h===e)return r;if(3===h||6===h)l=!0;else{if(1===h||2===h){let g=n[++r];for(;"string"==typeof g;)g=n[++r];continue}if(4===h)break;if(0===h){r+=4;continue}}r+=l?1:2}return-1}return function gl(e,n){let t=e.indexOf(4);if(t>-1)for(t++;t<e.length;){const i=e[t];if("number"==typeof i)return-1;if(i===n)return t;t++}return-1}(n,e)}function Jl(e,n,t=!1){for(let i=0;i<n.length;i++)if(Yl(e,n[i],t))return!0;return!1}function Ha(e,n){return e?":not("+n.trim()+")":n}function Ql(e){let n=e[0],t=1,i=2,r="",l=!1;for(;t<e.length;){let h=e[t];if("string"==typeof h)if(2&i){const g=e[++t];r+="["+h+(g.length>0?'="'+g+'"':"")+"]"}else 8&i?r+="."+h:4&i&&(r+=" "+h);else""!==r&&!hs(h)&&(n+=Ha(l,r),r=""),i=h,l=l||!hs(i);t++}return""!==r&&(n+=Ha(l,r)),n}function Pt(e){return Qo(()=>{const n=yl(e),t={...n,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===Da.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||yo.Emulated,styles:e.styles||Ni,_:null,schemas:e.schemas||null,tView:null,id:""};vl(t);const i=e.dependencies;return t.directiveDefs=_l(i,!1),t.pipeDefs=_l(i,!0),t.id=function mu(e){let n=0;const t=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const r of t)n=Math.imul(31,n)+r.charCodeAt(0)<<0;return n+=2147483648,"c"+n}(t),t})}function tc(e){return wi(e)||Xr(e)}function nd(e){return null!==e}function ro(e){return Qo(()=>({type:e.type,bootstrap:e.bootstrap||Ni,declarations:e.declarations||Ni,imports:e.imports||Ni,exports:e.exports||Ni,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function fs(e,n){if(null==e)return zo;const t={};for(const i in e)if(e.hasOwnProperty(i)){let r=e[i],l=r;Array.isArray(r)&&(l=r[1],r=r[0]),t[r]=i,n&&(n[r]=l)}return t}function yn(e){return Qo(()=>{const n=yl(e);return vl(n),n})}function wi(e){return e[qs]||null}function Xr(e){return e[es]||null}function qr(e){return e[Wl]||null}function ko(e,n){const t=e[Zl]||null;if(!t&&!0===n)throw new Error(`Type ${wr(e)} does not have '\u0275mod' property.`);return t}function yl(e){const n={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:e.inputs||zo,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||Ni,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:fs(e.inputs,n),outputs:fs(e.outputs)}}function vl(e){e.features?.forEach(n=>n(e))}function _l(e,n){if(!e)return null;const t=n?qr:tc;return()=>("function"==typeof e?e():e).map(i=>t(i)).filter(nd)}const Ki=0,gn=1,ci=2,Cr=3,ns=4,ps=5,so=6,Ea=7,rr=8,ua=9,So=10,Hn=11,Ia=12,ms=13,gs=14,Tr=15,$o=16,Fs=17,Zi=18,bl=19,qa=20,vo=21,Zt=22,wl=23,Ga=24,Ei=25,Sa=1,da=2,Yn=7,T=9,z=11;function Ve(e){return Array.isArray(e)&&"object"==typeof e[Sa]}function Ot(e){return Array.isArray(e)&&!0===e[Sa]}function ui(e){return 0!=(4&e.flags)}function Xn(e){return e.componentOffset>-1}function or(e){return 1==(1&e.flags)}function _o(e){return!!e.template}function Xd(e){return 0!=(512&e[ci])}function Q(e,n){return e.hasOwnProperty(li)?e[li]:null}const ne=Symbol("SIGNAL");function se(e,n){return(null===e||"object"!=typeof e)&&Object.is(e,n)}let he=null,Ee=!1;function oe(e){const n=he;return he=e,n}const Me={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function Oe(e){if(Ee)throw new Error("");if(null===he)return;const n=he.nextProducerIndex++;zn(he),n<he.producerNode.length&&he.producerNode[n]!==e&&Xt(he)&&Vt(he.producerNode[n],he.producerIndexOfThis[n]),he.producerNode[n]!==e&&(he.producerNode[n]=e,he.producerIndexOfThis[n]=Xt(he)?Jn(e,he,n):0),he.producerLastReadVersion[n]=e.version}function Be(e){if(!Xt(e)||e.dirty){if(!e.producerMustRecompute(e)&&!zt(e))return void(e.dirty=!1);e.producerRecomputeValue(e),e.dirty=!1}}function ft(e){if(void 0===e.liveConsumerNode)return;const n=Ee;Ee=!0;try{for(const t of e.liveConsumerNode)t.dirty||cn(t)}finally{Ee=n}}function Tt(){return!1!==he?.consumerAllowSignalWrites}function cn(e){e.dirty=!0,ft(e),e.consumerMarkedDirty?.(e)}function sn(e){return e&&(e.nextProducerIndex=0),oe(e)}function At(e,n){if(oe(n),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(Xt(e))for(let t=e.nextProducerIndex;t<e.producerNode.length;t++)Vt(e.producerNode[t],e.producerIndexOfThis[t]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function zt(e){zn(e);for(let n=0;n<e.producerNode.length;n++){const t=e.producerNode[n],i=e.producerLastReadVersion[n];if(i!==t.version||(Be(t),i!==t.version))return!0}return!1}function Cn(e){if(zn(e),Xt(e))for(let n=0;n<e.producerNode.length;n++)Vt(e.producerNode[n],e.producerIndexOfThis[n]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function Jn(e,n,t){if(pr(e),zn(e),0===e.liveConsumerNode.length)for(let i=0;i<e.producerNode.length;i++)e.producerIndexOfThis[i]=Jn(e.producerNode[i],e,i);return e.liveConsumerIndexOfThis.push(t),e.liveConsumerNode.push(n)-1}function Vt(e,n){if(pr(e),zn(e),1===e.liveConsumerNode.length)for(let i=0;i<e.producerNode.length;i++)Vt(e.producerNode[i],e.producerIndexOfThis[i]);const t=e.liveConsumerNode.length-1;if(e.liveConsumerNode[n]=e.liveConsumerNode[t],e.liveConsumerIndexOfThis[n]=e.liveConsumerIndexOfThis[t],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,n<e.liveConsumerNode.length){const i=e.liveConsumerIndexOfThis[n],r=e.liveConsumerNode[n];zn(r),r.producerIndexOfThis[i]=n}}function Xt(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function zn(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}function pr(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}let is=function Ar(){throw new Error};function Ro(){is()}let To=null;function ys(e,n){const t=Object.create(gu);function i(){return Oe(t),t.value}return t.value=e,n?.equal&&(t.equal=n.equal),i.set=Za,i.update=rd,i.mutate=Yd,i.asReadonly=Gs,i[ne]=t,i}const gu=(()=>({...Me,equal:se,readonlyFn:void 0}))();function xl(e){e.version++,ft(e),To?.()}function Za(e){const n=this[ne];Tt()||Ro(),n.equal(n.value,e)||(n.value=e,xl(n))}function rd(e){Tt()||Ro(),Za.call(this,e(this[ne].value))}function Yd(e){const n=this[ne];Tt()||Ro(),e(n.value),xl(n)}function Gs(){const e=this[ne];if(void 0===e.readonlyFn){const n=()=>this();n[ne]=e,e.readonlyFn=n}return e.readonlyFn}const Zs=()=>{},rs=(()=>({...Me,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:e=>{e.schedule(e.ref)},hasRun:!1,cleanupFn:Zs}))();class Ls{constructor(n,t,i){this.previousValue=n,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Bi(){return nc}function nc(e){return e.type.prototype.ngOnChanges&&(e.setInput=yu),Dl}function Dl(){const e=Zh(this),n=e?.current;if(n){const t=e.previous;if(t===zo)e.previous=n;else for(let i in n)t[i]=n[i];e.current=null,this.ngOnChanges(n)}}function yu(e,n,t,i){const r=this.declaredInputs[t],l=Zh(e)||function Oo(e,n){return e[Wh]=n}(e,{previous:zo,current:null}),h=l.current||(l.current={}),g=l.previous,w=g[r];h[r]=new Ls(w&&w.currentValue,n,g===zo),e[i]=n}Bi.ngInherit=!0;const Wh="__ngSimpleChanges__";function Zh(e){return e[Wh]||null}const vs=function(e,n,t){};function mr(e){for(;Array.isArray(e);)e=e[Ki];return e}function Xh(e,n){return mr(n[e])}function _s(e,n){return mr(n[e.index])}function Np(e,n){return e.data[n]}function bs(e,n){const t=n[e];return Ve(t)?t:t[Ki]}function ic(e,n){return null==n?null:e[n]}function Fg(e){e[Fs]=0}function Bp(e){1024&e[ci]||(e[ci]|=1024,bu(e,1))}function ad(e){1024&e[ci]&&(e[ci]&=-1025,bu(e,-1))}function bu(e,n){let t=e[Cr];if(null===t)return;t[ps]+=n;let i=t;for(t=t[Cr];null!==t&&(1===n&&1===i[ps]||-1===n&&0===i[ps]);)t[ps]+=n,i=t,t=t[Cr]}const Kn={lFrame:rf(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Jh(){return Kn.bindingsEnabled}function Dt(){return Kn.lFrame.lView}function Wi(){return Kn.lFrame.tView}function ef(e){return Kn.lFrame.contextLView=e,e[rr]}function cd(e){return Kn.lFrame.contextLView=null,e}function ss(){let e=tf();for(;null!==e&&64===e.type;)e=e.parent;return e}function tf(){return Kn.lFrame.currentTNode}function Ka(e,n){const t=Kn.lFrame;t.currentTNode=e,t.isParent=n}function qc(){return Kn.lFrame.isParent}function Vp(){Kn.lFrame.isParent=!1}function bo(){return Kn.lFrame.bindingIndex++}function Xs(e){const n=Kn.lFrame,t=n.bindingIndex;return n.bindingIndex=n.bindingIndex+e,t}function eh(e,n){const t=Kn.lFrame;t.bindingIndex=t.bindingRootIndex=e,dd(n)}function dd(e){Kn.lFrame.currentDirectiveIndex=e}function qp(e){const n=Kn.lFrame.currentDirectiveIndex;return-1===n?null:e[n]}function nf(e){Kn.lFrame.currentQueryIndex=e}function zg(e){const n=e[gn];return 2===n.type?n.declTNode:1===n.type?e[so]:null}function $g(e,n,t){if(t&Ln.SkipSelf){let r=n,l=e;for(;!(r=r.parent,null!==r||t&Ln.Host||(r=zg(l),null===r||(l=l[gs],10&r.type))););if(null===r)return!1;n=r,e=l}const i=Kn.lFrame=Wp();return i.currentTNode=n,i.lView=e,!0}function th(e){const n=Wp(),t=e[gn];Kn.lFrame=n,n.currentTNode=t.firstChild,n.lView=e,n.tView=t,n.contextLView=e,n.bindingIndex=t.bindingStartIndex,n.inI18n=!1}function Wp(){const e=Kn.lFrame,n=null===e?null:e.child;return null===n?rf(e):n}function rf(e){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=n),n}function hd(){const e=Kn.lFrame;return Kn.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const Ks=hd;function sf(){const e=hd();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function Ns(){return Kn.lFrame.selectedIndex}function Du(e){Kn.lFrame.selectedIndex=e}function ao(){const e=Kn.lFrame;return Np(e.tView,e.selectedIndex)}let Hg=!0;function af(){return Hg}function Gc(e){Hg=e}function lf(e,n){for(let t=n.directiveStart,i=n.directiveEnd;t<i;t++){const l=e.data[t].type.prototype,{ngAfterContentInit:h,ngAfterContentChecked:g,ngAfterViewInit:w,ngAfterViewChecked:E,ngOnDestroy:k}=l;h&&(e.contentHooks??=[]).push(-t,h),g&&((e.contentHooks??=[]).push(t,g),(e.contentCheckHooks??=[]).push(t,g)),w&&(e.viewHooks??=[]).push(-t,w),E&&((e.viewHooks??=[]).push(t,E),(e.viewCheckHooks??=[]).push(t,E)),null!=k&&(e.destroyHooks??=[]).push(t,k)}}function cf(e,n,t){qg(e,n,3,t)}function uf(e,n,t,i){(3&e[ci])===t&&qg(e,n,t,i)}function nh(e,n){let t=e[ci];(3&t)===n&&(t&=8191,t+=1,e[ci]=t)}function qg(e,n,t,i){const l=i??-1,h=n.length-1;let g=0;for(let w=void 0!==i?65535&e[Fs]:0;w<h;w++)if("number"==typeof n[w+1]){if(g=n[w],null!=i&&g>=i)break}else n[w]<0&&(e[Fs]+=65536),(g<l||-1==l)&&(Y_(e,t,n,w),e[Fs]=(4294901760&e[Fs])+w+2),w++}function Iu(e,n){vs(4,e,n);const t=oe(null);try{n.call(e)}finally{oe(t),vs(5,e,n)}}function Y_(e,n,t,i){const r=t[i]<0,l=t[i+1],g=e[r?-t[i]:t[i]];r?e[ci]>>13<e[Fs]>>16&&(3&e[ci])===n&&(e[ci]+=8192,Iu(g,l)):Iu(g,l)}const Mr=-1;class Wc{constructor(n,t,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function ih(e){return e!==Mr}function Su(e){return 32767&e}function md(e,n){let t=function Xp(e){return e>>16}(e),i=n;for(;t>0;)i=i[gs],t--;return i}let ff=!0;function pf(e){const n=ff;return ff=e,n}const Kg=255,Yg=5;let J_=0;const as={};function rh(e,n){const t=Jg(e,n);if(-1!==t)return t;const i=n[gn];i.firstCreatePass&&(e.injectorIndex=n.length,Zc(i.data,e),Zc(n,null),Zc(i.blueprint,null));const r=mf(e,n),l=e.injectorIndex;if(ih(r)){const h=Su(r),g=md(r,n),w=g[gn].data;for(let E=0;E<8;E++)n[l+E]=g[h+E]|w[h+E]}return n[l+8]=r,l}function Zc(e,n){e.push(0,0,0,0,0,0,0,0,n)}function Jg(e,n){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===n[e.injectorIndex+8]?-1:e.injectorIndex}function mf(e,n){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let t=0,i=null,r=n;for(;null!==r;){if(i=oy(r),null===i)return Mr;if(t++,r=r[gs],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return Mr}function Kp(e,n,t){!function Q_(e,n,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(la)&&(i=t[la]),null==i&&(i=t[la]=J_++);const r=i&Kg;n.data[e+(r>>Yg)]|=1<<r}(e,n,t)}function Yp(e,n,t){if(t&Ln.Optional||void 0!==e)return e;ll()}function ey(e,n,t,i){if(t&Ln.Optional&&void 0===i&&(i=null),!(t&(Ln.Self|Ln.Host))){const r=e[ua],l=Io(void 0);try{return r?r.get(n,i,t&Ln.Optional):dl(n,i,t&Ln.Optional)}finally{Io(l)}}return Yp(i,0,t)}function ty(e,n,t,i=Ln.Default,r){if(null!==e){if(2048&n[ci]&&!(i&Ln.Self)){const h=function nb(e,n,t,i,r){let l=e,h=n;for(;null!==l&&null!==h&&2048&h[ci]&&!(512&h[ci]);){const g=ny(l,h,t,i|Ln.Self,as);if(g!==as)return g;let w=l.parent;if(!w){const E=h[qa];if(E){const k=E.get(t,as,i);if(k!==as)return k}w=oy(h),h=h[gs]}l=w}return r}(e,n,t,i,as);if(h!==as)return h}const l=ny(e,n,t,i,as);if(l!==as)return l}return ey(n,t,i,r)}function ny(e,n,t,i,r){const l=function Jp(e){if("string"==typeof e)return e.charCodeAt(0)||0;const n=e.hasOwnProperty(la)?e[la]:void 0;return"number"==typeof n?n>=0?n&Kg:oh:n}(t);if("function"==typeof l){if(!$g(n,e,i))return i&Ln.Host?Yp(r,0,i):ey(n,t,i,r);try{let h;if(h=l(i),null!=h||i&Ln.Optional)return h;ll()}finally{Ks()}}else if("number"==typeof l){let h=null,g=Jg(e,n),w=Mr,E=i&Ln.Host?n[Tr][so]:null;for((-1===g||i&Ln.SkipSelf)&&(w=-1===g?mf(e,n):n[g+8],w!==Mr&&ry(i,!1)?(h=n[gn],g=Su(w),n=md(w,n)):g=-1);-1!==g;){const k=n[gn];if(iy(l,g,k.data)){const $=eb(g,n,t,h,i,E);if($!==as)return $}w=n[g+8],w!==Mr&&ry(i,n[gn].data[g+8]===E)&&iy(l,g,n)?(h=k,g=Su(w),n=md(w,n)):g=-1}}return r}function eb(e,n,t,i,r,l){const h=n[gn],g=h.data[e+8],k=function gd(e,n,t,i,r){const l=e.providerIndexes,h=n.data,g=1048575&l,w=e.directiveStart,k=l>>20,te=r?g+k:e.directiveEnd;for(let ie=i?g:g+k;ie<te;ie++){const we=h[ie];if(ie<w&&t===we||ie>=w&&we.type===t)return ie}if(r){const ie=h[w];if(ie&&_o(ie)&&ie.type===t)return w}return null}(g,h,t,null==i?Xn(g)&&ff:i!=h&&0!=(3&g.type),r&Ln.Host&&l===g);return null!==k?Ya(n,h,k,g):as}function Ya(e,n,t,i){let r=e[t];const l=n.data;if(function Gg(e){return e instanceof Wc}(r)){const h=r;h.resolving&&function Ba(e,n){const t=n?`. Dependency path: ${n.join(" > ")} > ${e}`:"";throw new qe(-200,`Circular dependency in DI detected for ${e}${t}`)}(function ai(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():On(e)}(l[t]));const g=pf(h.canSeeViewProviders);h.resolving=!0;const E=h.injectImpl?Io(h.injectImpl):null;$g(e,i,Ln.Default);try{r=e[t]=h.factory(void 0,l,e,i),n.firstCreatePass&&t>=i.directiveStart&&function K_(e,n,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:l}=n.type.prototype;if(i){const h=nc(n);(t.preOrderHooks??=[]).push(e,h),(t.preOrderCheckHooks??=[]).push(e,h)}r&&(t.preOrderHooks??=[]).push(0-e,r),l&&((t.preOrderHooks??=[]).push(e,l),(t.preOrderCheckHooks??=[]).push(e,l))}(t,l[t],n)}finally{null!==E&&Io(E),pf(g),h.resolving=!1,Ks()}}return r}function iy(e,n,t){return!!(t[n+(e>>Yg)]&1<<e)}function ry(e,n){return!(e&Ln.Self||e&Ln.Host&&n)}class Bs{constructor(n,t){this._tNode=n,this._lView=t}get(n,t,i){return ty(this._tNode,this._lView,n,ds(i),t)}}function oh(){return new Bs(ss(),Dt())}function Gr(e){return Qo(()=>{const n=e.prototype.constructor,t=n[li]||Qp(n),i=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==i;){const l=r[li]||Qp(r);if(l&&l!==t)return l;r=Object.getPrototypeOf(r)}return l=>new l})}function Qp(e){return zl(e)?()=>{const n=Qp(Un(e));return n&&n()}:Q(e)}function oy(e){const n=e[gn],t=n.type;return 2===t?n.declTNode:1===t?e[so]:null}const _d="__parameters__";function Au(e,n,t){return Qo(()=>{const i=function yf(e){return function(...t){if(e){const i=e(...t);for(const r in i)this[r]=i[r]}}}(n);function r(...l){if(this instanceof r)return i.apply(this,l),this;const h=new r(...l);return g.annotation=h,g;function g(w,E,k){const $=w.hasOwnProperty(_d)?w[_d]:Object.defineProperty(w,_d,{value:[]})[_d];for(;$.length<=k;)$.push(null);return($[k]=$[k]||[]).push(h),w}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}function ji(e,n){e.forEach(t=>Array.isArray(t)?ji(t,n):n(t))}function vf(e,n,t){n>=e.length?e.push(t):e.splice(n,0,t)}function sh(e,n){return n>=e.length-1?e.pop():e.splice(n,1)[0]}function pa(e,n,t){let i=xd(e,n);return i>=0?e[1|i]=t:(i=~i,function ay(e,n,t,i){let r=e.length;if(r==n)e.push(t,i);else if(1===r)e.push(i,e[0]),e[0]=t;else{for(r--,e.push(e[r-1],e[r]);r>n;)e[r]=e[r-2],r--;e[n]=t,e[n+1]=i}}(e,i,n,t)),i}function tm(e,n){const t=xd(e,n);if(t>=0)return e[1|t]}function xd(e,n){return function ly(e,n,t){let i=0,r=e.length>>t;for(;r!==i;){const l=i+(r-i>>1),h=e[l<<t];if(n===h)return l<<t;h>n?r=l:i=l+1}return~(r<<t)}(e,n,1)}const bf=$a(Au("Optional"),8),ch=$a(Au("SkipSelf"),4);function yh(e){return 128==(128&e.flags)}var Jc=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(Jc||{});const yb=/^>|^->|<!--|-->|--!>|<!-$/g,vb=/(<|>)/g,sm="\u200b$1\u200b";const Sf=new Map;let xy=0;const $s="__ngContext__";function Ao(e,n){Ve(n)?(e[$s]=n[bl],function Dy(e){Sf.set(e[bl],e)}(n)):e[$s]=n}let Tf;function Af(e,n){return Tf(e,n)}function bh(e){const n=e[Cr];return Ot(n)?n[Cr]:n}function fm(e){return pm(e[Ia])}function wh(e){return pm(e[ns])}function pm(e){for(;null!==e&&!Ot(e);)e=e[ns];return e}function lc(e,n,t,i,r){if(null!=i){let l,h=!1;Ot(i)?l=i:Ve(i)&&(h=!0,i=i[Ki]);const g=mr(i);0===e&&null!==t?null==r?_m(n,t,g):cc(n,t,g,r||null,!0):1===e&&null!==t?cc(n,t,g,r||null,!0):2===e?function m(e,n,t){const i=kd(e,n);i&&function bm(e,n,t,i){e.removeChild(n,t,i)}(e,i,n,t)}(n,g,h):3===e&&n.destroyNode(g),null!=l&&function O(e,n,t,i,r){const l=t[Yn];l!==mr(t)&&lc(n,e,i,l,r);for(let g=z;g<t.length;g++){const w=t[g];C(w[gn],w,e,n,i,l)}}(n,e,l,t,r)}}function mm(e,n){return e.createComment(function sc(e){return e.replace(yb,n=>n.replace(vb,sm))}(n))}function Mf(e,n,t){return e.createElement(n,t)}function ym(e,n){const t=e[T],i=t.indexOf(n);ad(n),t.splice(i,1)}function Md(e,n){if(e.length<=z)return;const t=z+n,i=e[t];if(i){const r=i[$o];null!==r&&r!==e&&ym(r,i),n>0&&(e[t-1][ns]=i[ns]);const l=sh(e,z+n);!function bb(e,n){C(e,n,n[Hn],2,null,null),n[Ki]=null,n[so]=null}(i[gn],i);const h=l[Zi];null!==h&&h.detachView(l[gn]),i[Cr]=null,i[ns]=null,i[ci]&=-129}return i}function vm(e,n){if(!(256&n[ci])){const t=n[Hn];n[wl]&&Cn(n[wl]),n[Ga]&&Cn(n[Ga]),t.destroyNode&&C(e,n,t,3,null,null),function Qc(e){let n=e[Ia];if(!n)return Pf(e[gn],e);for(;n;){let t=null;if(Ve(n))t=n[Ia];else{const i=n[z];i&&(t=i)}if(!t){for(;n&&!n[ns]&&n!==e;)Ve(n)&&Pf(n[gn],n),n=n[Cr];null===n&&(n=e),Ve(n)&&Pf(n[gn],n),t=n&&n[ns]}n=t}}(n)}}function Pf(e,n){if(!(256&n[ci])){n[ci]&=-129,n[ci]|=256,function wb(e,n){let t;if(null!=e&&null!=(t=e.destroyHooks))for(let i=0;i<t.length;i+=2){const r=n[t[i]];if(!(r instanceof Wc)){const l=t[i+1];if(Array.isArray(l))for(let h=0;h<l.length;h+=2){const g=r[l[h]],w=l[h+1];vs(4,g,w);try{w.call(g)}finally{vs(5,g,w)}}else{vs(4,r,l);try{l.call(r)}finally{vs(5,r,l)}}}}}(e,n),function Ry(e,n){const t=e.cleanup,i=n[Ea];if(null!==t)for(let l=0;l<t.length-1;l+=2)if("string"==typeof t[l]){const h=t[l+3];h>=0?i[h]():i[-h].unsubscribe(),l+=2}else t[l].call(i[t[l+1]]);null!==i&&(n[Ea]=null);const r=n[vo];if(null!==r){n[vo]=null;for(let l=0;l<r.length;l++)(0,r[l])()}}(e,n),1===n[gn].type&&n[Hn].destroy();const t=n[$o];if(null!==t&&Ot(n[Cr])){t!==n[Cr]&&ym(t,n);const i=n[Zi];null!==i&&i.detachView(e)}!function lm(e){Sf.delete(e[bl])}(n)}}function kf(e,n,t){return function Rf(e,n,t){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return t[Ki];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:l}=e.data[i.directiveStart+r];if(l===yo.None||l===yo.Emulated)return null}return _s(i,t)}}(e,n.parent,t)}function cc(e,n,t,i,r){e.insertBefore(n,t,i,r)}function _m(e,n,t){e.appendChild(n,t)}function Pd(e,n,t,i,r){null!==i?cc(e,n,t,i,r):_m(e,n,t)}function kd(e,n){return e.parentNode(n)}let Ch,ee,Ct,Jt,Lf=function Ff(e,n,t){return 40&e.type?_s(e,t):null};function a(e,n,t,i){const r=kf(e,i,n),l=n[Hn],g=function Rd(e,n,t){return Lf(e,n,t)}(i.parent||n[so],i,n);if(null!=r)if(Array.isArray(t))for(let w=0;w<t.length;w++)Pd(l,r,t[w],g,!1);else Pd(l,r,t,g,!1);void 0!==Ch&&Ch(l,i,n,t,r)}function s(e,n){if(null!==n){const t=n.type;if(3&t)return _s(n,e);if(4&t)return d(-1,e[n.index]);if(8&t){const i=n.child;if(null!==i)return s(e,i);{const r=e[n.index];return Ot(r)?d(-1,r):mr(r)}}if(32&t)return Af(n,e)()||mr(e[n.index]);{const i=c(e,n);return null!==i?Array.isArray(i)?i[0]:s(bh(e[Tr]),i):s(e,n.next)}}return null}function c(e,n){return null!==n?e[Tr][so].projection[n.projection]:null}function d(e,n){const t=z+e+1;if(t<n.length){const i=n[t],r=i[gn].firstChild;if(null!==r)return s(i,r)}return n[Yn]}function b(e,n,t,i,r,l,h){for(;null!=t;){const g=i[t.index],w=t.type;if(h&&0===n&&(g&&Ao(mr(g),i),t.flags|=2),32!=(32&t.flags))if(8&w)b(e,n,t.child,i,r,l,!1),lc(n,e,r,g,l);else if(32&w){const E=Af(t,i);let k;for(;k=E();)lc(n,e,r,k,l);lc(n,e,r,g,l)}else 16&w?M(e,n,i,t,r,l):lc(n,e,r,g,l);t=h?t.projectionNext:t.next}}function C(e,n,t,i,r,l){b(t,i,e.firstChild,n,r,l,!1)}function M(e,n,t,i,r,l){const h=t[Tr],w=h[so].projection[i.projection];if(Array.isArray(w))for(let E=0;E<w.length;E++)lc(n,e,r,w[E],l);else{let E=w;const k=h[Cr];yh(i)&&(E.flags|=128),b(e,n,E,k,r,l,!0)}}function q(e,n,t){""===t?e.removeAttribute(n,"class"):e.setAttribute(n,"class",t)}function Y(e,n,t){const{mergedAttrs:i,classes:r,styles:l}=t;null!==i&&Va(e,n,i),null!==r&&q(e,n,r),null!==l&&function j(e,n,t){e.setAttribute(n,"style",t)}(e,n,l)}function ye(e){return function le(){if(void 0===ee&&(ee=null,Xi.trustedTypes))try{ee=Xi.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return ee}()?.createHTML(e)||e}function Rn(){if(void 0!==Ct)return Ct;if(typeof document<"u")return document;throw new qe(210,!1)}function Sn(e){return function Gt(){if(void 0===Jt&&(Jt=null,Xi.trustedTypes))try{Jt=Xi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Jt}()?.createHTML(e)||e}class tt{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${xc})`}}class Mn extends tt{getTypeName(){return"HTML"}}class Tn extends tt{getTypeName(){return"Style"}}class Qn extends tt{getTypeName(){return"Script"}}class gr extends tt{getTypeName(){return"URL"}}class ar extends tt{getTypeName(){return"ResourceURL"}}function nr(e){return e instanceof tt?e.changingThisBreaksApplicationSecurity:e}function xo(e,n){const t=function Ho(e){return e instanceof tt&&e.getTypeName()||null}(e);if(null!=t&&t!==n){if("ResourceURL"===t&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${t} (see ${xc})`)}return t===n}class ls{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const t=(new window.DOMParser).parseFromString(ye(n),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(n):(t.removeChild(t.firstChild),t)}catch{return null}}}class qo{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const t=this.inertDocument.createElement("template");return t.innerHTML=ye(n),t}}const Go=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Ss(e){return(e=String(e)).match(Go)?e:"unsafe:"+e}function co(e){const n={};for(const t of e.split(","))n[t]=!0;return n}function Pi(...e){const n={};for(const t of e)for(const i in t)t.hasOwnProperty(i)&&(n[i]=!0);return n}const yr=co("area,br,col,hr,img,wbr"),Dr=co("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Vs=co("rp,rt"),Ma=Pi(yr,Pi(Dr,co("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Pi(Vs,co("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Pi(Vs,Dr)),Ys=co("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Tl=Pi(Ys,co("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),co("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Eh=co("script,style,template");class Fy{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let t=n.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(n){const t=n.nodeName.toLowerCase();if(!Ma.hasOwnProperty(t))return this.sanitizedSomething=!0,!Eh.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=n.attributes;for(let r=0;r<i.length;r++){const l=i.item(r),h=l.name,g=h.toLowerCase();if(!Tl.hasOwnProperty(g)){this.sanitizedSomething=!0;continue}let w=l.value;Ys[g]&&(w=Ss(w)),this.buf.push(" ",h,'="',Nf(w),'"')}return this.buf.push(">"),!0}endElement(n){const t=n.nodeName.toLowerCase();Ma.hasOwnProperty(t)&&!yr.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(n){this.buf.push(Nf(n))}checkClobberedElement(n,t){if(t&&(n.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return t}}const Ly=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,wm=/([^\#-~ |!])/g;function Nf(e){return e.replace(/&/g,"&amp;").replace(Ly,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(wm,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let ka;function xm(e,n){let t=null;try{ka=ka||function Co(e){const n=new qo(e);return function Is(){try{return!!(new window.DOMParser).parseFromString(ye(""),"text/html")}catch{return!1}}()?new ls(n):n}(e);let i=n?String(n):"";t=ka.getInertBodyElement(i);let r=5,l=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=l,l=t.innerHTML,t=ka.getInertBodyElement(i)}while(i!==l);return ye((new Fy).sanitizeChildren(Bf(t)||t))}finally{if(t){const i=Bf(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function Bf(e){return"content"in e&&function Cb(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var ma=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(ma||{});function Cm(e){const n=function Ih(){const e=Dt();return e&&e[So].sanitizer}();return n?Sn(n.sanitize(ma.HTML,e)||""):xo(e,"HTML")?Sn(nr(e)):xm(Rn(),On(e))}const Do=new ln("ENVIRONMENT_INITIALIZER"),Js=new ln("INJECTOR",-1),eu=new ln("INJECTOR_DEF_TYPES");class ga{get(n,t=Rs){if(t===Rs){const i=new Error(`NullInjectorError: No provider for ${wr(n)}!`);throw i.name="NullInjectorError",i}return t}}function Al(e){return{\u0275providers:e}}function Ml(...e){return{\u0275providers:nD(0,e),\u0275fromNgModule:!0}}function nD(e,...n){const t=[],i=new Set;let r;const l=h=>{t.push(h)};return ji(n,h=>{const g=h;zy(g,l,[],i)&&(r||=[],r.push(g))}),void 0!==r&&iD(r,l),t}function iD(e,n){for(let t=0;t<e.length;t++){const{ngModule:i,providers:r}=e[t];Sb(r,l=>{n(l,i)})}}function zy(e,n,t,i){if(!(e=Un(e)))return!1;let r=null,l=Ji(e);const h=!l&&wi(e);if(l||h){if(h&&!h.standalone)return!1;r=e}else{const w=e.ngModule;if(l=Ji(w),!l)return!1;r=w}const g=i.has(r);if(h){if(g)return!1;if(i.add(r),h.dependencies){const w="function"==typeof h.dependencies?h.dependencies():h.dependencies;for(const E of w)zy(E,n,t,i)}}else{if(!l)return!1;{if(null!=l.imports&&!g){let E;i.add(r);try{ji(l.imports,k=>{zy(k,n,t,i)&&(E||=[],E.push(k))})}finally{}void 0!==E&&iD(E,n)}if(!g){const E=Q(r)||(()=>new r);n({provide:r,useFactory:E,deps:Ni},r),n({provide:eu,useValue:r,multi:!0},r),n({provide:Do,useValue:()=>Ht(r),multi:!0},r)}const w=l.providers;if(null!=w&&!g){const E=e;Sb(w,k=>{n(k,E)})}}}return r!==e&&void 0!==e.providers}function Sb(e,n){for(let t of e)al(t)&&(t=t.\u0275providers),Array.isArray(t)?Sb(t,n):n(t)}const rk=Ti({provide:String,useValue:Ti});function Tb(e){return null!==e&&"object"==typeof e&&rk in e}function Sh(e){return"function"==typeof e}const Ab=new ln("Set Injector scope."),$y={},sk={};let Mb;function Vy(){return void 0===Mb&&(Mb=new ga),Mb}class Ts{}class $f extends Ts{get destroyed(){return this._destroyed}constructor(n,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,kb(n,h=>this.processProvider(h)),this.records.set(Js,Vf(void 0,this)),r.has("environment")&&this.records.set(Ts,Vf(void 0,this));const l=this.records.get(Ab);null!=l&&"string"==typeof l.value&&this.scopes.add(l.value),this.injectorDefTypes=new Set(this.get(eu.multi,Ni,Ln.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const n=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of n)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();const t=Jo(this),i=Io(void 0);try{return n()}finally{Jo(t),Io(i)}}get(n,t=Rs,i=Ln.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(Fc))return n[Fc](this);i=ds(i);const l=Jo(this),h=Io(void 0);try{if(!(i&Ln.SkipSelf)){let w=this.records.get(n);if(void 0===w){const E=function dk(e){return"function"==typeof e||"object"==typeof e&&e instanceof ln}(n)&&nn(n);w=E&&this.injectableDefInScope(E)?Vf(Pb(n),$y):null,this.records.set(n,w)}if(null!=w)return this.hydrate(n,w)}return(i&Ln.Self?Vy():this.parent).get(n,t=i&Ln.Optional&&t===Rs?null:t)}catch(g){if("NullInjectorError"===g.name){if((g[Pc]=g[Pc]||[]).unshift(wr(n)),l)throw g;return function hl(e,n,t,i){const r=e[Pc];throw n[tr]&&r.unshift(n[tr]),e.message=function Ca(e,n,t,i=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let r=wr(n);if(Array.isArray(n))r=n.map(wr).join(" -> ");else if("object"==typeof n){let l=[];for(let h in n)if(n.hasOwnProperty(h)){let g=n[h];l.push(h+":"+("string"==typeof g?JSON.stringify(g):wr(g)))}r=`{${l.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${e.replace(kc,"\n  ")}`}("\n"+e.message,r,t,i),e.ngTokenPath=r,e[Pc]=null,e}(g,n,"R3InjectorError",this.source)}throw g}finally{Io(h),Jo(l)}}resolveInjectorInitializers(){const n=Jo(this),t=Io(void 0);try{const r=this.get(Do.multi,Ni,Ln.Self);for(const l of r)l()}finally{Jo(n),Io(t)}}toString(){const n=[],t=this.records;for(const i of t.keys())n.push(wr(i));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new qe(205,!1)}processProvider(n){let t=Sh(n=Un(n))?n:Un(n&&n.provide);const i=function lk(e){return Tb(e)?Vf(void 0,e.useValue):Vf(sD(e),$y)}(n);if(Sh(n)||!0!==n.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Vf(void 0,$y,!0),r.factory=()=>ho(r.multi),this.records.set(t,r)),t=n,r.multi.push(n)}this.records.set(t,i)}hydrate(n,t){return t.value===$y&&(t.value=sk,t.value=t.factory()),"object"==typeof t.value&&t.value&&function uk(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(n){if(!n.providedIn)return!1;const t=Un(n.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(n){const t=this._onDestroyHooks.indexOf(n);-1!==t&&this._onDestroyHooks.splice(t,1)}}function Pb(e){const n=nn(e),t=null!==n?n.factory:Q(e);if(null!==t)return t;if(e instanceof ln)throw new qe(204,!1);if(e instanceof Function)return function ak(e){const n=e.length;if(n>0)throw function wd(e,n){const t=[];for(let i=0;i<e;i++)t.push(n);return t}(n,"?"),new qe(204,!1);const t=function Li(e){return e&&(e[Sr]||e[Fr])||null}(e);return null!==t?()=>t.factory(e):()=>new e}(e);throw new qe(204,!1)}function sD(e,n,t){let i;if(Sh(e)){const r=Un(e);return Q(r)||Pb(r)}if(Tb(e))i=()=>Un(e.useValue);else if(function oD(e){return!(!e||!e.useFactory)}(e))i=()=>e.useFactory(...ho(e.deps||[]));else if(function rD(e){return!(!e||!e.useExisting)}(e))i=()=>Ht(Un(e.useExisting));else{const r=Un(e&&(e.useClass||e.provide));if(!function ck(e){return!!e.deps}(e))return Q(r)||Pb(r);i=()=>new r(...ho(e.deps))}return i}function Vf(e,n,t=!1){return{factory:e,value:n,multi:t?[]:void 0}}function kb(e,n){for(const t of e)Array.isArray(t)?kb(t,n):t&&al(t)?kb(t.\u0275providers,n):n(t)}const jy=new ln("AppId",{providedIn:"root",factory:()=>hk}),hk="ng",aD=new ln("Platform Initializer"),Th=new ln("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),lD=new ln("AnimationModuleType"),cD=new ln("CSP nonce",{providedIn:"root",factory:()=>Rn().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let uD=(e,n,t)=>null;function $b(e,n,t=!1){return uD(e,n,t)}class xk{}class fD{}class Dk{resolveComponentFactory(n){throw function Ck(e){const n=Error(`No component factory found for ${wr(e)}.`);return n.ngComponent=e,n}(n)}}let Sm=(()=>{class e{static#e=this.NULL=new Dk}return e})();function Ek(){return Hf(ss(),Dt())}function Hf(e,n){return new Et(_s(e,n))}let Et=(()=>{class e{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=Ek}return e})();class Tm{}let Ru=(()=>{class e{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function Sk(){const e=Dt(),t=bs(ss().index,e);return(Ve(t)?t:e)[Hn]}()}return e})(),Tk=(()=>{class e{static#e=this.\u0275prov=Pe({token:e,providedIn:"root",factory:()=>null})}return e})();class Am{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const Ak=new Am("16.2.12"),Ub={};function vD(e,n=null,t=null,i){const r=_D(e,n,t,i);return r.resolveInjectorInitializers(),r}function _D(e,n=null,t=null,i,r=new Set){const l=[t||Ni,Ml(e)];return i=i||("object"==typeof e?void 0:wr(e)),new $f(l,n||Vy(),i||null,r)}let Jr=(()=>{class e{static#e=this.THROW_IF_NOT_FOUND=Rs;static#t=this.NULL=new ga;static create(t,i){if(Array.isArray(t))return vD({name:""},i,t,"");{const r=t.name??"";return vD({name:r},t.parent,t.providers,r)}}static#n=this.\u0275prov=Pe({token:e,providedIn:"any",factory:()=>Ht(Js)});static#i=this.__NG_ELEMENT_ID__=-1}return e})();function qb(e){return e.ngOriginalError}class Ou{constructor(){this._console=console}handleError(n){const t=this._findOriginalError(n);this._console.error("ERROR",n),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(n){let t=n&&qb(n);for(;t&&qb(t);)t=qb(t);return t||null}}function Wb(e){return n=>{setTimeout(e,void 0,n)}}const Vr=class Lk extends Z{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,t,i){let r=n,l=t||(()=>null),h=i;if(n&&"object"==typeof n){const w=n;r=w.next?.bind(w),l=w.error?.bind(w),h=w.complete?.bind(w)}this.__isAsync&&(l=Wb(l),r&&(r=Wb(r)),h&&(h=Wb(h)));const g=super.subscribe({next:r,error:l,complete:h});return n instanceof an&&n.add(g),g}};function wD(...e){}class vt{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Vr(!1),this.onMicrotaskEmpty=new Vr(!1),this.onStable=new Vr(!1),this.onError=new Vr(!1),typeof Zone>"u")throw new qe(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function Nk(){const e="function"==typeof Xi.requestAnimationFrame;let n=Xi[e?"requestAnimationFrame":"setTimeout"],t=Xi[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&n&&t){const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function $k(e){const n=()=>{!function zk(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Xi,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Xb(e),e.isCheckStableRunning=!0,Zb(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Xb(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,l,h,g)=>{if(function jk(e){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0].data?.__ignore_ng_zone__}(g))return t.invokeTask(r,l,h,g);try{return xD(e),t.invokeTask(r,l,h,g)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===l.type||e.shouldCoalesceRunChangeDetection)&&n(),CD(e)}},onInvoke:(t,i,r,l,h,g,w)=>{try{return xD(e),t.invoke(r,l,h,g,w)}finally{e.shouldCoalesceRunChangeDetection&&n(),CD(e)}},onHasTask:(t,i,r,l)=>{t.hasTask(r,l),i===r&&("microTask"==l.change?(e._hasPendingMicrotasks=l.microTask,Xb(e),Zb(e)):"macroTask"==l.change&&(e.hasPendingMacrotasks=l.macroTask))},onHandleError:(t,i,r,l)=>(t.handleError(r,l),e.runOutsideAngular(()=>e.onError.emit(l)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!vt.isInAngularZone())throw new qe(909,!1)}static assertNotInAngularZone(){if(vt.isInAngularZone())throw new qe(909,!1)}run(n,t,i){return this._inner.run(n,t,i)}runTask(n,t,i,r){const l=this._inner,h=l.scheduleEventTask("NgZoneEvent: "+r,n,Bk,wD,wD);try{return l.runTask(h,t,i)}finally{l.cancelTask(h)}}runGuarded(n,t,i){return this._inner.runGuarded(n,t,i)}runOutsideAngular(n){return this._outer.run(n)}}const Bk={};function Zb(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Xb(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function xD(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function CD(e){e._nesting--,Zb(e)}class Vk{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Vr,this.onMicrotaskEmpty=new Vr,this.onStable=new Vr,this.onError=new Vr}run(n,t,i){return n.apply(t,i)}runGuarded(n,t,i){return n.apply(t,i)}runOutsideAngular(n){return n()}runTask(n,t,i,r){return n.apply(t,i)}}const DD=new ln("",{providedIn:"root",factory:ED});function ED(){const e=Ft(vt);let n=!0;return function Na(...e){const n=kr(e),t=function Nl(e,n){return"number"==typeof us(e)?e.pop():n}(e,1/0),i=e;return i.length?1===i.length?tn(i[0]):_r(t)(Vi(i,n)):Ci}(new gt(r=>{n=e.isStable&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks,e.runOutsideAngular(()=>{r.next(n),r.complete()})}),new gt(r=>{let l;e.runOutsideAngular(()=>{l=e.onStable.subscribe(()=>{vt.assertNotInAngularZone(),queueMicrotask(()=>{!n&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks&&(n=!0,r.next(!0))})})});const h=e.onUnstable.subscribe(()=>{vt.assertInAngularZone(),n&&(n=!1,e.runOutsideAngular(()=>{r.next(!1)}))});return()=>{l.unsubscribe(),h.unsubscribe()}}).pipe(wa()))}function Fu(e){return e instanceof Function?e():e}let Kb=(()=>{class e{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=Pe({token:e,providedIn:"root",factory:()=>new e})}return e})();function Mm(e){for(;e;){e[ci]|=64;const n=bh(e);if(Xd(e)&&!n)return e;e=n}return null}const MD=new ln("",{providedIn:"root",factory:()=>!1});let Xy=null;function OD(e,n){return e[n]??ND()}function FD(e,n){const t=ND();t.producerNode?.length&&(e[n]=Xy,t.lView=e,Xy=LD())}const Jk={...Me,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{Mm(e.lView)},lView:null};function LD(){return Object.create(Jk)}function ND(){return Xy??=LD(),Xy}const Ii={};function jr(e){BD(Wi(),Dt(),Ns()+e,!1)}function BD(e,n,t,i){if(!i)if(3==(3&n[ci])){const l=e.preOrderCheckHooks;null!==l&&cf(n,l,t)}else{const l=e.preOrderHooks;null!==l&&uf(n,l,0,t)}Du(t)}function G(e,n=Ln.Default){const t=Dt();return null===t?Ht(e,n):ty(ss(),t,Un(e),n)}function Ky(e,n,t,i,r,l,h,g,w,E,k){const $=n.blueprint.slice();return $[Ki]=r,$[ci]=140|i,(null!==E||e&&2048&e[ci])&&($[ci]|=2048),Fg($),$[Cr]=$[gs]=e,$[rr]=t,$[So]=h||e&&e[So],$[Hn]=g||e&&e[Hn],$[ua]=w||e&&e[ua]||null,$[so]=l,$[bl]=function Cy(){return xy++}(),$[Zt]=k,$[qa]=E,$[Tr]=2==n.type?e[Tr]:$,$}function Wf(e,n,t,i,r){let l=e.data[n];if(null===l)l=function Yb(e,n,t,i,r){const l=tf(),h=qc(),w=e.data[n]=function sR(e,n,t,i,r,l){let h=n?n.injectorIndex:-1,g=0;return function wu(){return null!==Kn.skipHydrationRootTNode}()&&(g|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:h,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:g,providerIndexes:0,value:r,attrs:l,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,h?l:l&&l.parent,t,n,i,r);return null===e.firstChild&&(e.firstChild=w),null!==l&&(h?null==l.child&&null!==w.parent&&(l.child=w):null===l.next&&(l.next=w,w.prev=l)),w}(e,n,t,i,r),function Up(){return Kn.lFrame.inI18n}()&&(l.flags|=32);else if(64&l.type){l.type=t,l.value=i,l.attrs=r;const h=function ud(){const e=Kn.lFrame,n=e.currentTNode;return e.isParent?n:n.parent}();l.injectorIndex=null===h?-1:h.injectorIndex}return Ka(l,!0),l}function Pm(e,n,t,i){if(0===t)return-1;const r=n.length;for(let l=0;l<t;l++)n.push(i),e.blueprint.push(i),e.data.push(null);return r}function $D(e,n,t,i,r){const l=OD(n,wl),h=Ns(),g=2&i;try{Du(-1),g&&n.length>Ei&&BD(e,n,Ei,!1),vs(g?2:0,r);const E=g?l:null,k=sn(E);try{null!==E&&(E.dirty=!1),t(i,r)}finally{At(E,k)}}finally{g&&null===n[wl]&&FD(n,wl),Du(h),vs(g?3:1,r)}}function Jb(e,n,t){if(ui(n)){const i=oe(null);try{const l=n.directiveEnd;for(let h=n.directiveStart;h<l;h++){const g=e.data[h];g.contentQueries&&g.contentQueries(1,t[h],h)}}finally{oe(i)}}}function Qb(e,n,t){Jh()&&(function fR(e,n,t,i){const r=t.directiveStart,l=t.directiveEnd;Xn(t)&&function bR(e,n,t){const i=_s(n,e),r=VD(t);let h=16;t.signals?h=4096:t.onPush&&(h=64);const g=Yy(e,Ky(e,r,null,h,i,n,null,e[So].rendererFactory.createRenderer(i,t),null,null,null));e[n.index]=g}(n,t,e.data[r+t.componentOffset]),e.firstCreatePass||rh(t,n),Ao(i,n);const h=t.initialInputs;for(let g=r;g<l;g++){const w=e.data[g],E=Ya(n,e,g,t);Ao(E,n),null!==h&&wR(0,g-r,E,w,0,h),_o(w)&&(bs(t.index,n)[rr]=Ya(n,e,g,t))}}(e,n,t,_s(t,n)),64==(64&t.flags)&&GD(e,n,t))}function e0(e,n,t=_s){const i=n.localNames;if(null!==i){let r=n.index+1;for(let l=0;l<i.length;l+=2){const h=i[l+1],g=-1===h?t(n,e):e[h];e[r++]=g}}}function VD(e){const n=e.tView;return null===n||n.incompleteFirstPass?e.tView=t0(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):n}function t0(e,n,t,i,r,l,h,g,w,E,k){const $=Ei+i,te=$+r,ie=function eR(e,n){const t=[];for(let i=0;i<n;i++)t.push(i<e?null:Ii);return t}($,te),we="function"==typeof E?E():E;return ie[gn]={type:e,blueprint:ie,template:t,queries:null,viewQuery:g,declTNode:n,data:ie.slice().fill(null,$),bindingStartIndex:$,expandoStartIndex:te,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof l?l():l,pipeRegistry:"function"==typeof h?h():h,firstChild:null,schemas:w,consts:we,incompleteFirstPass:!1,ssrId:k}}let jD=e=>null;function UD(e,n,t,i){for(let r in e)if(e.hasOwnProperty(r)){t=null===t?{}:t;const l=e[r];null===i?HD(t,n,r,l):i.hasOwnProperty(r)&&HD(t,n,i[r],l)}return t}function HD(e,n,t,i){e.hasOwnProperty(t)?e[t].push(n,i):e[t]=[n,i]}function el(e,n,t,i,r,l,h,g){const w=_s(n,t);let k,E=n.inputs;!g&&null!=E&&(k=E[i])?(a0(e,t,k,i,r),Xn(n)&&function cR(e,n){const t=bs(n,e);16&t[ci]||(t[ci]|=64)}(t,n.index)):3&n.type&&(i=function lR(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(i),r=null!=h?h(r,n.value||"",i):r,l.setProperty(w,i,r))}function n0(e,n,t,i){if(Jh()){const r=null===i?null:{"":-1},l=function mR(e,n){const t=e.directiveRegistry;let i=null,r=null;if(t)for(let l=0;l<t.length;l++){const h=t[l];if(Jl(n,h.selectors,!1))if(i||(i=[]),_o(h))if(null!==h.findHostDirectiveDefs){const g=[];r=r||new Map,h.findHostDirectiveDefs(h,g,r),i.unshift(...g,h),r0(e,n,g.length)}else i.unshift(h),r0(e,n,0);else r=r||new Map,h.findHostDirectiveDefs?.(h,i,r),i.push(h)}return null===i?null:[i,r]}(e,t);let h,g;null===l?h=g=null:[h,g]=l,null!==h&&qD(e,n,t,h,r,g),r&&function gR(e,n,t){if(n){const i=e.localNames=[];for(let r=0;r<n.length;r+=2){const l=t[n[r+1]];if(null==l)throw new qe(-301,!1);i.push(n[r],l)}}}(t,i,r)}t.mergedAttrs=ca(t.mergedAttrs,t.attrs)}function qD(e,n,t,i,r,l){for(let E=0;E<i.length;E++)Kp(rh(t,n),e,i[E].type);!function vR(e,n,t){e.flags|=1,e.directiveStart=n,e.directiveEnd=n+t,e.providerIndexes=n}(t,e.data.length,i.length);for(let E=0;E<i.length;E++){const k=i[E];k.providersResolver&&k.providersResolver(k)}let h=!1,g=!1,w=Pm(e,n,i.length,null);for(let E=0;E<i.length;E++){const k=i[E];t.mergedAttrs=ca(t.mergedAttrs,k.hostAttrs),_R(e,t,n,w,k),yR(w,k,r),null!==k.contentQueries&&(t.flags|=4),(null!==k.hostBindings||null!==k.hostAttrs||0!==k.hostVars)&&(t.flags|=64);const $=k.type.prototype;!h&&($.ngOnChanges||$.ngOnInit||$.ngDoCheck)&&((e.preOrderHooks??=[]).push(t.index),h=!0),!g&&($.ngOnChanges||$.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(t.index),g=!0),w++}!function aR(e,n,t){const r=n.directiveEnd,l=e.data,h=n.attrs,g=[];let w=null,E=null;for(let k=n.directiveStart;k<r;k++){const $=l[k],te=t?t.get($):null,we=te?te.outputs:null;w=UD($.inputs,k,w,te?te.inputs:null),E=UD($.outputs,k,E,we);const Se=null===w||null===h||ml(n)?null:xR(w,k,h);g.push(Se)}null!==w&&(w.hasOwnProperty("class")&&(n.flags|=8),w.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=g,n.inputs=w,n.outputs=E}(e,t,l)}function GD(e,n,t){const i=t.directiveStart,r=t.directiveEnd,l=t.index,h=function W_(){return Kn.lFrame.currentDirectiveIndex}();try{Du(l);for(let g=i;g<r;g++){const w=e.data[g],E=n[g];dd(g),(null!==w.hostBindings||0!==w.hostVars||null!==w.hostAttrs)&&pR(w,E)}}finally{Du(-1),dd(h)}}function pR(e,n){null!==e.hostBindings&&e.hostBindings(1,n)}function r0(e,n,t){n.componentOffset=t,(e.components??=[]).push(n.index)}function yR(e,n,t){if(t){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)t[n.exportAs[i]]=e;_o(n)&&(t[""]=e)}}function _R(e,n,t,i,r){e.data[i]=r;const l=r.factory||(r.factory=Q(r.type)),h=new Wc(l,_o(r),G);e.blueprint[i]=h,t[i]=h,function dR(e,n,t,i,r){const l=r.hostBindings;if(l){let h=e.hostBindingOpCodes;null===h&&(h=e.hostBindingOpCodes=[]);const g=~n.index;(function hR(e){let n=e.length;for(;n>0;){const t=e[--n];if("number"==typeof t&&t<0)return t}return 0})(h)!=g&&h.push(g),h.push(t,i,l)}}(e,n,i,Pm(e,t,r.hostVars,Ii),r)}function tu(e,n,t,i,r,l){const h=_s(e,n);!function o0(e,n,t,i,r,l,h){if(null==l)e.removeAttribute(n,r,t);else{const g=null==h?On(l):h(l,i||"",r);e.setAttribute(n,r,g,t)}}(n[Hn],h,l,e.value,t,i,r)}function wR(e,n,t,i,r,l){const h=l[n];if(null!==h)for(let g=0;g<h.length;)WD(i,t,h[g++],h[g++],h[g++])}function WD(e,n,t,i,r){const l=oe(null);try{const h=e.inputTransforms;null!==h&&h.hasOwnProperty(i)&&(r=h[i].call(n,r)),null!==e.setInput?e.setInput(n,r,t,i):n[i]=r}finally{oe(l)}}function xR(e,n,t){let i=null,r=0;for(;r<t.length;){const l=t[r];if(0!==l)if(5!==l){if("number"==typeof l)break;if(e.hasOwnProperty(l)){null===i&&(i=[]);const h=e[l];for(let g=0;g<h.length;g+=2)if(h[g]===n){i.push(l,h[g+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function ZD(e,n,t,i){return[e,!0,!1,n,null,0,i,t,null,null,null]}function XD(e,n){const t=e.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const l=t[i+1];if(-1!==l){const h=e.data[l];nf(t[i]),h.contentQueries(2,n[l],l)}}}function Yy(e,n){return e[Ia]?e[ms][ns]=n:e[Ia]=n,e[ms]=n,n}function s0(e,n,t){nf(0);const i=oe(null);try{n(e,t)}finally{oe(i)}}function JD(e,n,t){return(null===e||_o(e))&&(t=function Uc(e){for(;Array.isArray(e);){if("object"==typeof e[Sa])return e;e=e[Ki]}return null}(t[n.index])),t[Hn]}function QD(e,n){const t=e[ua],i=t?t.get(Ou,null):null;i&&i.handleError(n)}function a0(e,n,t,i,r){for(let l=0;l<t.length;){const h=t[l++],g=t[l++];WD(e.data[h],n[h],i,g,r)}}function CR(e,n){const t=bs(n,e),i=t[gn];!function DR(e,n){for(let t=n.length;t<e.blueprint.length;t++)n.push(e.blueprint[t])}(i,t);const r=t[Ki];null!==r&&null===t[Zt]&&(t[Zt]=$b(r,t[ua])),l0(i,t,t[rr])}function l0(e,n,t){th(n);try{const i=e.viewQuery;null!==i&&s0(1,i,t);const r=e.template;null!==r&&$D(e,n,r,1,t),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&XD(e,n),e.staticViewQueries&&s0(2,e.viewQuery,t);const l=e.components;null!==l&&function ER(e,n){for(let t=0;t<n.length;t++)CR(e,n[t])}(n,l)}catch(i){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),i}finally{n[ci]&=-5,sf()}}let eE=(()=>{class e{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const l=typeof Zone>"u"?null:Zone.current,h=function Cl(e,n,t){const i=Object.create(rs);t&&(i.consumerAllowSignalWrites=!0),i.fn=e,i.schedule=n;const r=h=>{i.cleanupFn=h};return i.ref={notify:()=>cn(i),run:()=>{if(i.dirty=!1,i.hasRun&&!zt(i))return;i.hasRun=!0;const h=sn(i);try{i.cleanupFn(),i.cleanupFn=Zs,i.fn(r)}finally{At(i,h)}},cleanup:()=>i.cleanupFn()},i.ref}(t,E=>{this.all.has(E)&&this.queue.set(E,l)},r);let g;this.all.add(h),h.notify();const w=()=>{h.cleanup(),g?.(),this.all.delete(h),this.queue.delete(h)};return g=i?.onDestroy(w),{destroy:w}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=Pe({token:e,providedIn:"root",factory:()=>new e})}return e})();function Jy(e,n,t){let i=t?e.styles:null,r=t?e.classes:null,l=0;if(null!==n)for(let h=0;h<n.length;h++){const g=n[h];"number"==typeof g?l=g:1==l?r=Yo(r,g):2==l&&(i=Yo(i,g+": "+n[++h]+";"))}t?e.styles=i:e.stylesWithoutHost=i,t?e.classes=r:e.classesWithoutHost=r}function km(e,n,t,i,r=!1){for(;null!==t;){const l=n[t.index];null!==l&&i.push(mr(l)),Ot(l)&&tE(l,i);const h=t.type;if(8&h)km(e,n,t.child,i);else if(32&h){const g=Af(t,n);let w;for(;w=g();)i.push(w)}else if(16&h){const g=c(n,t);if(Array.isArray(g))i.push(...g);else{const w=bh(n[Tr]);km(w[gn],w,g,i,!0)}}t=r?t.projectionNext:t.next}return i}function tE(e,n){for(let t=z;t<e.length;t++){const i=e[t],r=i[gn].firstChild;null!==r&&km(i[gn],i,r,n)}e[Yn]!==e[Ki]&&n.push(e[Yn])}function Qy(e,n,t,i=!0){const r=n[So],l=r.rendererFactory,h=r.afterRenderEventManager;l.begin?.(),h?.begin();try{nE(e,n,e.template,t)}catch(w){throw i&&QD(n,w),w}finally{l.end?.(),r.effectManager?.flush(),h?.end()}}function nE(e,n,t,i){const r=n[ci];if(256!=(256&r)){n[So].effectManager?.flush(),th(n);try{Fg(n),function Bg(e){return Kn.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==t&&$D(e,n,t,2,i);const h=3==(3&r);if(h){const E=e.preOrderCheckHooks;null!==E&&cf(n,E,null)}else{const E=e.preOrderHooks;null!==E&&uf(n,E,0,null),nh(n,0)}if(function TR(e){for(let n=fm(e);null!==n;n=wh(n)){if(!n[da])continue;const t=n[T];for(let i=0;i<t.length;i++){Bp(t[i])}}}(n),iE(n,2),null!==e.contentQueries&&XD(e,n),h){const E=e.contentCheckHooks;null!==E&&cf(n,E)}else{const E=e.contentHooks;null!==E&&uf(n,E,1),nh(n,1)}!function Qk(e,n){const t=e.hostBindingOpCodes;if(null===t)return;const i=OD(n,Ga);try{for(let r=0;r<t.length;r++){const l=t[r];if(l<0)Du(~l);else{const h=l,g=t[++r],w=t[++r];eh(g,h),i.dirty=!1;const E=sn(i);try{w(2,n[h])}finally{At(i,E)}}}}finally{null===n[Ga]&&FD(n,Ga),Du(-1)}}(e,n);const g=e.components;null!==g&&oE(n,g,0);const w=e.viewQuery;if(null!==w&&s0(2,w,i),h){const E=e.viewCheckHooks;null!==E&&cf(n,E)}else{const E=e.viewHooks;null!==E&&uf(n,E,2),nh(n,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),n[ci]&=-73,ad(n)}finally{sf()}}}function iE(e,n){for(let t=fm(e);null!==t;t=wh(t))for(let i=z;i<t.length;i++)rE(t[i],n)}function AR(e,n,t){rE(bs(n,e),t)}function rE(e,n){if(!function Yh(e){return 128==(128&e[ci])}(e))return;const t=e[gn],i=e[ci];if(80&i&&0===n||1024&i||2===n)nE(t,e,t.template,e[rr]);else if(e[ps]>0){iE(e,1);const r=t.components;null!==r&&oE(e,r,1)}}function oE(e,n,t){for(let i=0;i<n.length;i++)AR(e,n[i],t)}class Rm{get rootNodes(){const n=this._lView,t=n[gn];return km(t,n,t.firstChild,[])}constructor(n,t){this._lView=n,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[rr]}set context(n){this._lView[rr]=n}get destroyed(){return 256==(256&this._lView[ci])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[Cr];if(Ot(n)){const t=n[8],i=t?t.indexOf(this):-1;i>-1&&(Md(n,i),sh(t,i))}this._attachedToViewContainer=!1}vm(this._lView[gn],this._lView)}onDestroy(n){!function El(e,n){if(256==(256&e[ci]))throw new qe(911,!1);null===e[vo]&&(e[vo]=[]),e[vo].push(n)}(this._lView,n)}markForCheck(){Mm(this._cdRefInjectingView||this._lView)}detach(){this._lView[ci]&=-129}reattach(){this._lView[ci]|=128}detectChanges(){Qy(this._lView[gn],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new qe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Uo(e,n){C(e,n,n[Hn],2,null,null)}(this._lView[gn],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new qe(902,!1);this._appRef=n}}class MR extends Rm{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;Qy(n[gn],n,n[rr],!1)}checkNoChanges(){}get context(){return null}}class sE extends Sm{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const t=wi(n);return new Om(t,this.ngModule)}}function aE(e){const n=[];for(let t in e)e.hasOwnProperty(t)&&n.push({propName:e[t],templateName:t});return n}class kR{constructor(n,t){this.injector=n,this.parentInjector=t}get(n,t,i){i=ds(i);const r=this.injector.get(n,Ub,i);return r!==Ub||t===Ub?r:this.parentInjector.get(n,t,i)}}class Om extends fD{get inputs(){const n=this.componentDef,t=n.inputTransforms,i=aE(n.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return aE(this.componentDef.outputs)}constructor(n,t){super(),this.componentDef=n,this.ngModule=t,this.componentType=n.type,this.selector=function zc(e){return e.map(Ql).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!t}create(n,t,i,r){let l=(r=r||this.ngModule)instanceof Ts?r:r?.injector;l&&null!==this.componentDef.getStandaloneInjector&&(l=this.componentDef.getStandaloneInjector(l)||l);const h=l?new kR(n,l):n,g=h.get(Tm,null);if(null===g)throw new qe(407,!1);const $={rendererFactory:g,sanitizer:h.get(Tk,null),effectManager:h.get(eE,null),afterRenderEventManager:h.get(Kb,null)},te=g.createRenderer(null,this.componentDef),ie=this.componentDef.selectors[0][0]||"div",we=i?function tR(e,n,t,i){const l=i.get(MD,!1)||t===yo.ShadowDom,h=e.selectRootElement(n,l);return function nR(e){jD(e)}(h),h}(te,i,this.componentDef.encapsulation,h):Mf(te,ie,function PR(e){const n=e.toLowerCase();return"svg"===n?"svg":"math"===n?"math":null}(ie)),dt=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let Ue=null;null!==we&&(Ue=$b(we,h,!0));const Kt=t0(0,null,null,1,0,null,null,null,null,null,null),En=Ky(null,Kt,null,dt,null,null,$,te,h,null,Ue);let _i,Br;th(En);try{const no=this.componentDef;let js,ol=null;no.findHostDirectiveDefs?(js=[],ol=new Map,no.findHostDirectiveDefs(no,js,ol),js.push(no)):js=[no];const wc=function OR(e,n){const t=e[gn],i=Ei;return e[i]=n,Wf(t,i,2,"#host",null)}(En,we),H_=function FR(e,n,t,i,r,l,h){const g=r[gn];!function LR(e,n,t,i){for(const r of e)n.mergedAttrs=ca(n.mergedAttrs,r.hostAttrs);null!==n.mergedAttrs&&(Jy(n,n.mergedAttrs,!0),null!==t&&Y(i,t,n))}(i,e,n,h);let w=null;null!==n&&(w=$b(n,r[ua]));const E=l.rendererFactory.createRenderer(n,t);let k=16;t.signals?k=4096:t.onPush&&(k=64);const $=Ky(r,VD(t),null,k,r[e.index],e,l,E,null,null,w);return g.firstCreatePass&&r0(g,e,i.length-1),Yy(r,$),r[e.index]=$}(wc,we,no,js,En,$,te);Br=Np(Kt,Ei),we&&function BR(e,n,t,i){if(i)Va(e,t,["ng-version",Ak.full]);else{const{attrs:r,classes:l}=function td(e){const n=[],t=[];let i=1,r=2;for(;i<e.length;){let l=e[i];if("string"==typeof l)2===r?""!==l&&n.push(l,e[++i]):8===r&&t.push(l);else{if(!hs(r))break;r=l}i++}return{attrs:n,classes:t}}(n.selectors[0]);r&&Va(e,t,r),l&&l.length>0&&q(e,t,l.join(" "))}}(te,no,we,i),void 0!==t&&function zR(e,n,t){const i=e.projection=[];for(let r=0;r<n.length;r++){const l=t[r];i.push(null!=l?Array.from(l):null)}}(Br,this.ngContentSelectors,t),_i=function NR(e,n,t,i,r,l){const h=ss(),g=r[gn],w=_s(h,r);qD(g,r,h,t,null,i);for(let k=0;k<t.length;k++)Ao(Ya(r,g,h.directiveStart+k,h),r);GD(g,r,h),w&&Ao(w,r);const E=Ya(r,g,h.directiveStart+h.componentOffset,h);if(e[rr]=r[rr]=E,null!==l)for(const k of l)k(E,n);return Jb(g,h,e),E}(H_,no,js,ol,En,[$R]),l0(Kt,En,null)}finally{sf()}return new RR(this.componentType,_i,Hf(Br,En),En,Br)}}class RR extends xk{constructor(n,t,i,r,l){super(),this.location=i,this._rootLView=r,this._tNode=l,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new MR(r),this.componentType=n}setInput(n,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),t))return;const l=this._rootLView;a0(l[gn],l,r,n,t),this.previousInputValues.set(n,t),Mm(bs(this._tNode.index,l))}}get injector(){return new Bs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function $R(){const e=ss();lf(Dt()[gn],e)}function Mi(e){let n=function lE(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),t=!0;const i=[e];for(;n;){let r;if(_o(e))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new qe(903,!1);r=n.\u0275dir}if(r){if(t){i.push(r);const h=e;h.inputs=ev(e.inputs),h.inputTransforms=ev(e.inputTransforms),h.declaredInputs=ev(e.declaredInputs),h.outputs=ev(e.outputs);const g=r.hostBindings;g&&HR(e,g);const w=r.viewQuery,E=r.contentQueries;if(w&&jR(e,w),E&&UR(e,E),Bo(e.inputs,r.inputs),Bo(e.declaredInputs,r.declaredInputs),Bo(e.outputs,r.outputs),null!==r.inputTransforms&&(null===h.inputTransforms&&(h.inputTransforms={}),Bo(h.inputTransforms,r.inputTransforms)),_o(r)&&r.data.animation){const k=e.data;k.animation=(k.animation||[]).concat(r.data.animation)}}const l=r.features;if(l)for(let h=0;h<l.length;h++){const g=l[h];g&&g.ngInherit&&g(e),g===Mi&&(t=!1)}}n=Object.getPrototypeOf(n)}!function VR(e){let n=0,t=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.hostVars=n+=r.hostVars,r.hostAttrs=ca(r.hostAttrs,t=ca(t,r.hostAttrs))}}(i)}function ev(e){return e===zo?{}:e===Ni?[]:e}function jR(e,n){const t=e.viewQuery;e.viewQuery=t?(i,r)=>{n(i,r),t(i,r)}:n}function UR(e,n){const t=e.contentQueries;e.contentQueries=t?(i,r,l)=>{n(i,r,l),t(i,r,l)}:n}function HR(e,n){const t=e.hostBindings;e.hostBindings=t?(i,r)=>{n(i,r),t(i,r)}:n}function tv(e){return!!function c0(e){return null!==e&&("function"==typeof e||"object"==typeof e)}(e)&&(Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e)}function Qs(e,n,t){return!Object.is(e[n],t)&&(e[n]=t,!0)}function ea(e,n,t,i){const r=Dt();return Qs(r,bo(),n)&&(Wi(),tu(ao(),r,e,n,t,i)),ea}function ta(e,n,t,i,r,l,h,g){const w=Dt(),E=Wi(),k=e+Ei,$=E.firstCreatePass?function mO(e,n,t,i,r,l,h,g,w){const E=n.consts,k=Wf(n,e,4,h||null,ic(E,g));n0(n,t,k,ic(E,w)),lf(n,k);const $=k.tView=t0(2,k,i,r,l,n.directiveRegistry,n.pipeRegistry,null,n.schemas,E,null);return null!==n.queries&&(n.queries.template(n,k),$.queries=n.queries.embeddedTView(k)),k}(k,E,w,n,t,i,r,l,h):E.data[k];Ka($,!1);const te=EE(E,w,$,e);af()&&a(E,w,te,$),Ao(te,w),Yy(w,w[k]=ZD(te,w,te,$)),or($)&&Qb(E,w,$),null!=h&&e0(w,$,g)}let EE=function IE(e,n,t,i){return Gc(!0),n[Hn].createComment("")};function po(e,n,t){const i=Dt();return Qs(i,bo(),n)&&el(Wi(),ao(),i,e,n,i[Hn],t,!1),po}function m0(e,n,t,i,r){const h=r?"class":"style";a0(e,t,n.inputs[h],h,i)}function zi(e,n,t,i){const r=Dt(),l=Wi(),h=Ei+e,g=r[Hn],w=l.firstCreatePass?function _O(e,n,t,i,r,l){const h=n.consts,w=Wf(n,e,2,i,ic(h,r));return n0(n,t,w,ic(h,l)),null!==w.attrs&&Jy(w,w.attrs,!1),null!==w.mergedAttrs&&Jy(w,w.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,w),w}(h,l,r,n,t,i):l.data[h],E=TE(l,r,w,g,n,e);r[h]=E;const k=or(w);return Ka(w,!0),Y(g,E,w),32!=(32&w.flags)&&af()&&a(l,r,E,w),0===function G_(){return Kn.lFrame.elementDepthCount}()&&Ao(E,r),function Lg(){Kn.lFrame.elementDepthCount++}(),k&&(Qb(l,r,w),Jb(l,w,r)),null!==i&&e0(r,w),zi}function Yi(){let e=ss();qc()?Vp():(e=e.parent,Ka(e,!1));const n=e;(function xu(e){return Kn.skipHydrationRootTNode===e})(n)&&function Ng(){Kn.skipHydrationRootTNode=null}(),function fo(){Kn.lFrame.elementDepthCount--}();const t=Wi();return t.firstCreatePass&&(lf(t,e),ui(e)&&t.queries.elementEnd(e)),null!=n.classesWithoutHost&&function Wg(e){return 0!=(8&e.flags)}(n)&&m0(t,n,Dt(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function Zg(e){return 0!=(16&e.flags)}(n)&&m0(t,n,Dt(),n.stylesWithoutHost,!1),Yi}function kl(e,n,t,i){return zi(e,n,t,i),Yi(),kl}let TE=(e,n,t,i,r,l)=>(Gc(!0),Mf(i,r,function fd(){return Kn.lFrame.currentNamespace}()));function ip(e,n,t){const i=Dt(),r=Wi(),l=e+Ei,h=r.firstCreatePass?function xO(e,n,t,i,r){const l=n.consts,h=ic(l,i),g=Wf(n,e,8,"ng-container",h);return null!==h&&Jy(g,h,!0),n0(n,t,g,ic(l,r)),null!==n.queries&&n.queries.elementStart(n,g),g}(l,r,i,n,t):r.data[l];Ka(h,!0);const g=AE(r,i,h,e);return i[l]=g,af()&&a(r,i,g,h),Ao(g,i),or(h)&&(Qb(r,i,h),Jb(r,h,i)),null!=t&&e0(i,h),ip}function rp(){let e=ss();const n=Wi();return qc()?Vp():(e=e.parent,Ka(e,!1)),n.firstCreatePass&&(lf(n,e),ui(e)&&n.queries.elementEnd(e)),rp}let AE=(e,n,t,i)=>(Gc(!0),mm(n[Hn],""));function av(){return Dt()}function zm(e){return!!e&&"function"==typeof e.then}function ME(e){return!!e&&"function"==typeof e.subscribe}function lr(e,n,t,i){const r=Dt(),l=Wi(),h=ss();return function kE(e,n,t,i,r,l,h){const g=or(i),E=e.firstCreatePass&&function YD(e){return e.cleanup||(e.cleanup=[])}(e),k=n[rr],$=function KD(e){return e[Ea]||(e[Ea]=[])}(n);let te=!0;if(3&i.type||h){const Se=_s(i,n),je=h?h(Se):Se,dt=$.length,Ue=h?En=>h(mr(En[i.index])):i.index;let Kt=null;if(!h&&g&&(Kt=function EO(e,n,t,i){const r=e.cleanup;if(null!=r)for(let l=0;l<r.length-1;l+=2){const h=r[l];if(h===t&&r[l+1]===i){const g=n[Ea],w=r[l+2];return g.length>w?g[w]:null}"string"==typeof h&&(l+=2)}return null}(e,n,r,i.index)),null!==Kt)(Kt.__ngLastListenerFn__||Kt).__ngNextListenerFn__=l,Kt.__ngLastListenerFn__=l,te=!1;else{l=OE(i,n,k,l,!1);const En=t.listen(je,r,l);$.push(l,En),E&&E.push(r,Ue,dt,dt+1)}}else l=OE(i,n,k,l,!1);const ie=i.outputs;let we;if(te&&null!==ie&&(we=ie[r])){const Se=we.length;if(Se)for(let je=0;je<Se;je+=2){const _i=n[we[je]][we[je+1]].subscribe(l),Br=$.length;$.push(l,_i),E&&E.push(r,i.index,Br,-(Br+1))}}}(l,r,r[Hn],h,e,n,i),lr}function RE(e,n,t,i){try{return vs(6,n,t),!1!==t(i)}catch(r){return QD(e,r),!1}finally{vs(7,n,t)}}function OE(e,n,t,i,r){return function l(h){if(h===Function)return i;Mm(e.componentOffset>-1?bs(e.index,n):n);let w=RE(n,t,i,h),E=l.__ngNextListenerFn__;for(;E;)w=RE(n,t,E,h)&&w,E=E.__ngNextListenerFn__;return r&&!1===w&&h.preventDefault(),w}}function na(e=1){return function Z_(e){return(Kn.lFrame.contextLView=function Vg(e,n){for(;e>0;)n=n[gs],e--;return n}(e,Kn.lFrame.contextLView))[rr]}(e)}function lv(e,n){return e<<17|n<<2}function Od(e){return e>>17&32767}function y0(e){return 2|e}function Mh(e){return(131068&e)>>2}function v0(e,n){return-131069&e|n<<2}function _0(e){return 1|e}function HE(e,n,t,i,r){const l=e[t+1],h=null===n;let g=i?Od(l):Mh(l),w=!1;for(;0!==g&&(!1===w||h);){const k=e[g+1];kO(e[g],n)&&(w=!0,e[g+1]=i?_0(k):y0(k)),g=i?Od(k):Mh(k)}w&&(e[t+1]=i?y0(l):_0(l))}function kO(e,n){return null===e||null==n||(Array.isArray(e)?e[1]:e)===n||!(!Array.isArray(e)||"string"!=typeof n)&&xd(e,n)>=0}const cs={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function qE(e){return e.substring(cs.key,cs.keyEnd)}function GE(e,n){const t=cs.textEnd;return t===n?-1:(n=cs.keyEnd=function LO(e,n,t){for(;n<t&&e.charCodeAt(n)>32;)n++;return n}(e,cs.key=n,t),op(e,n,t))}function op(e,n,t){for(;n<t&&e.charCodeAt(n)<=32;)n++;return n}function sp(e,n,t){return dc(e,n,t,!1),sp}function cv(e,n){return dc(e,n,null,!0),cv}function Nu(e){!function hc(e,n,t,i){const r=Wi(),l=Xs(2);r.firstUpdatePass&&JE(r,null,l,i);const h=Dt();if(t!==Ii&&Qs(h,l,t)){const g=r.data[Ns()];if(nI(g,i)&&!YE(r,l)){let w=i?g.classesWithoutHost:g.stylesWithoutHost;null!==w&&(t=Yo(w,t||"")),m0(r,g,h,t,i)}else!function GO(e,n,t,i,r,l,h,g){r===Ii&&(r=Ni);let w=0,E=0,k=0<r.length?r[0]:null,$=0<l.length?l[0]:null;for(;null!==k||null!==$;){const te=w<r.length?r[w+1]:void 0,ie=E<l.length?l[E+1]:void 0;let Se,we=null;k===$?(w+=2,E+=2,te!==ie&&(we=$,Se=ie)):null===$||null!==k&&k<$?(w+=2,we=k):(E+=2,we=$,Se=ie),null!==we&&eI(e,n,t,i,we,Se,h,g),k=w<r.length?r[w]:null,$=E<l.length?l[E]:null}}(r,g,h,h[Hn],h[l+1],h[l+1]=function HO(e,n,t){if(null==t||""===t)return Ni;const i=[],r=nr(t);if(Array.isArray(r))for(let l=0;l<r.length;l++)e(i,r[l],!0);else if("object"==typeof r)for(const l in r)r.hasOwnProperty(l)&&e(i,l,r[l]);else"string"==typeof r&&n(i,r);return i}(e,n,t),i,l)}}(qO,ru,e,!0)}function ru(e,n){for(let t=function OO(e){return function ZE(e){cs.key=0,cs.keyEnd=0,cs.value=0,cs.valueEnd=0,cs.textEnd=e.length}(e),GE(e,op(e,0,cs.textEnd))}(n);t>=0;t=GE(n,t))pa(e,qE(n),!0)}function dc(e,n,t,i){const r=Dt(),l=Wi(),h=Xs(2);l.firstUpdatePass&&JE(l,e,h,i),n!==Ii&&Qs(r,h,n)&&eI(l,l.data[Ns()],r,r[Hn],e,r[h+1]=function WO(e,n){return null==e||""===e||("string"==typeof n?e+=n:"object"==typeof e&&(e=wr(nr(e)))),e}(n,t),i,h)}function YE(e,n){return n>=e.expandoStartIndex}function JE(e,n,t,i){const r=e.data;if(null===r[t+1]){const l=r[Ns()],h=YE(e,t);nI(l,i)&&null===n&&!h&&(n=!1),n=function $O(e,n,t,i){const r=qp(e);let l=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(t=$m(t=b0(null,e,n,t,i),n.attrs,i),l=null);else{const h=n.directiveStylingLast;if(-1===h||e[h]!==r)if(t=b0(r,e,n,t,i),null===l){let w=function VO(e,n,t){const i=t?n.classBindings:n.styleBindings;if(0!==Mh(i))return e[Od(i)]}(e,n,i);void 0!==w&&Array.isArray(w)&&(w=b0(null,e,n,w[1],i),w=$m(w,n.attrs,i),function jO(e,n,t,i){e[Od(t?n.classBindings:n.styleBindings)]=i}(e,n,i,w))}else l=function UO(e,n,t){let i;const r=n.directiveEnd;for(let l=1+n.directiveStylingLast;l<r;l++)i=$m(i,e[l].hostAttrs,t);return $m(i,n.attrs,t)}(e,n,i)}return void 0!==l&&(i?n.residualClasses=l:n.residualStyles=l),t}(r,l,n,i),function MO(e,n,t,i,r,l){let h=l?n.classBindings:n.styleBindings,g=Od(h),w=Mh(h);e[i]=t;let k,E=!1;if(Array.isArray(t)?(k=t[1],(null===k||xd(t,k)>0)&&(E=!0)):k=t,r)if(0!==w){const te=Od(e[g+1]);e[i+1]=lv(te,g),0!==te&&(e[te+1]=v0(e[te+1],i)),e[g+1]=function TO(e,n){return 131071&e|n<<17}(e[g+1],i)}else e[i+1]=lv(g,0),0!==g&&(e[g+1]=v0(e[g+1],i)),g=i;else e[i+1]=lv(w,0),0===g?g=i:e[w+1]=v0(e[w+1],i),w=i;E&&(e[i+1]=y0(e[i+1])),HE(e,k,i,!0),HE(e,k,i,!1),function PO(e,n,t,i,r){const l=r?e.residualClasses:e.residualStyles;null!=l&&"string"==typeof n&&xd(l,n)>=0&&(t[i+1]=_0(t[i+1]))}(n,k,e,i,l),h=lv(g,w),l?n.classBindings=h:n.styleBindings=h}(r,l,n,t,h,i)}}function b0(e,n,t,i,r){let l=null;const h=t.directiveEnd;let g=t.directiveStylingLast;for(-1===g?g=t.directiveStart:g++;g<h&&(l=n[g],i=$m(i,l.hostAttrs,r),l!==e);)g++;return null!==e&&(t.directiveStylingLast=g),i}function $m(e,n,t){const i=t?1:2;let r=-1;if(null!==n)for(let l=0;l<n.length;l++){const h=n[l];"number"==typeof h?r=h:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),pa(e,h,!!t||n[++l]))}return void 0===e?null:e}function qO(e,n,t){const i=String(n);""!==i&&!i.includes(" ")&&pa(e,i,t)}function eI(e,n,t,i,r,l,h,g){if(!(3&n.type))return;const w=e.data,E=w[g+1],k=function AO(e){return 1==(1&e)}(E)?tI(w,n,t,r,Mh(E),h):void 0;uv(k)||(uv(l)||function SO(e){return 2==(2&e)}(E)&&(l=tI(w,null,t,r,g,h)),function F(e,n,t,i,r){if(n)r?e.addClass(t,i):e.removeClass(t,i);else{let l=-1===i.indexOf("-")?void 0:Jc.DashCase;null==r?e.removeStyle(t,i,l):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),l|=Jc.Important),e.setStyle(t,i,r,l))}}(i,h,Xh(Ns(),t),r,l))}function tI(e,n,t,i,r,l){const h=null===n;let g;for(;r>0;){const w=e[r],E=Array.isArray(w),k=E?w[1]:w,$=null===k;let te=t[r+1];te===Ii&&(te=$?Ni:void 0);let ie=$?tm(te,i):k===i?te:void 0;if(E&&!uv(ie)&&(ie=tm(w,i)),uv(ie)&&(g=ie,h))return g;const we=e[r+1];r=h?Od(we):Mh(we)}if(null!==n){let w=l?n.residualClasses:n.residualStyles;null!=w&&(g=tm(w,i))}return g}function uv(e){return void 0!==e}function nI(e,n){return 0!=(e.flags&(n?8:16))}function Qr(e,n=""){const t=Dt(),i=Wi(),r=e+Ei,l=i.firstCreatePass?Wf(i,r,1,n,null):i.data[r],h=iI(i,t,l,n,e);t[r]=h,af()&&a(i,t,h,l),Ka(l,!1)}let iI=(e,n,t,i,r)=>(Gc(!0),function ku(e,n){return e.createText(n)}(n[Hn],i));function dv(e){return fc("",e,""),dv}function fc(e,n,t){const i=Dt(),r=function Xf(e,n,t,i){return Qs(e,bo(),t)?n+On(t)+i:Ii}(i,e,n,t);return r!==Ii&&function Lu(e,n,t){const i=Xh(n,e);!function xh(e,n,t){e.setValue(n,t)}(e[Hn],i,t)}(i,Ns(),r),fc}function w0(e,n,t){const i=Dt();if(Qs(i,bo(),n)){const l=Wi(),h=ao();el(l,h,i,e,n,JD(qp(l.data),h,i),t,!0)}return w0}const lp="en-US";let DI=lp;function D0(e,n,t,i,r){if(e=Un(e),Array.isArray(e))for(let l=0;l<e.length;l++)D0(e[l],n,t,i,r);else{const l=Wi(),h=Dt(),g=ss();let w=Sh(e)?e:Un(e.provide);const E=sD(e),k=1048575&g.providerIndexes,$=g.directiveStart,te=g.providerIndexes>>20;if(Sh(e)||!e.multi){const ie=new Wc(E,r,G),we=I0(w,n,r?k:k+te,$);-1===we?(Kp(rh(g,h),l,w),E0(l,e,n.length),n.push(w),g.directiveStart++,g.directiveEnd++,r&&(g.providerIndexes+=1048576),t.push(ie),h.push(ie)):(t[we]=ie,h[we]=ie)}else{const ie=I0(w,n,k+te,$),we=I0(w,n,k,k+te),je=we>=0&&t[we];if(r&&!je||!r&&!(ie>=0&&t[ie])){Kp(rh(g,h),l,w);const dt=function pL(e,n,t,i,r){const l=new Wc(e,t,G);return l.multi=[],l.index=n,l.componentProviders=0,XI(l,r,i&&!t),l}(r?fL:hL,t.length,r,i,E);!r&&je&&(t[we].providerFactory=dt),E0(l,e,n.length,0),n.push(w),g.directiveStart++,g.directiveEnd++,r&&(g.providerIndexes+=1048576),t.push(dt),h.push(dt)}else E0(l,e,ie>-1?ie:we,XI(t[r?we:ie],E,!r&&i));!r&&i&&je&&t[we].componentProviders++}}}function E0(e,n,t,i){const r=Sh(n),l=function ok(e){return!!e.useClass}(n);if(r||l){const w=(l?Un(n.useClass):n).prototype.ngOnDestroy;if(w){const E=e.destroyHooks||(e.destroyHooks=[]);if(!r&&n.multi){const k=E.indexOf(t);-1===k?E.push(t,[i,w]):E[k+1].push(i,w)}else E.push(t,w)}}}function XI(e,n,t){return t&&e.componentProviders++,e.multi.push(n)-1}function I0(e,n,t,i){for(let r=t;r<i;r++)if(n[r]===e)return r;return-1}function hL(e,n,t,i){return S0(this.multi,[])}function fL(e,n,t,i){const r=this.multi;let l;if(this.providerFactory){const h=this.providerFactory.componentProviders,g=Ya(t,t[gn],this.providerFactory.index,i);l=g.slice(0,h),S0(r,l);for(let w=h;w<g.length;w++)l.push(g[w])}else l=[],S0(r,l);return l}function S0(e,n){for(let t=0;t<e.length;t++)n.push((0,e[t])());return n}function Pr(e,n=[]){return t=>{t.providersResolver=(i,r)=>function dL(e,n,t){const i=Wi();if(i.firstCreatePass){const r=_o(e);D0(t,i.data,i.blueprint,r,!0),D0(n,i.data,i.blueprint,r,!1)}}(i,r?r(e):e,n)}}class kh{}class KI{}class T0 extends kh{constructor(n,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new sE(this);const r=ko(n);this._bootstrapComponents=Fu(r.bootstrap),this._r3Injector=_D(n,t,[{provide:kh,useValue:this},{provide:Sm,useValue:this.componentFactoryResolver},...i],wr(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class A0 extends KI{constructor(n){super(),this.moduleType=n}create(n){return new T0(this.moduleType,n,[])}}class YI extends kh{constructor(n){super(),this.componentFactoryResolver=new sE(this),this.instance=null;const t=new $f([...n.providers,{provide:kh,useValue:this},{provide:Sm,useValue:this.componentFactoryResolver}],n.parent||Vy(),n.debugName,new Set(["environment"]));this.injector=t,n.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function M0(e,n,t=null){return new YI({providers:e,parent:n,debugName:t,runEnvironmentInitializers:!0}).injector}let yL=(()=>{class e{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=nD(0,t.type),r=i.length>0?M0([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=Pe({token:e,providedIn:"environment",factory:()=>new e(Ht(Ts))})}return e})();function gv(e){e.getStandaloneInjector=n=>n.get(yL).getOrCreateStandaloneInjector(e)}function qL(e,n,t,i=!0){const r=n[gn];if(function gm(e,n,t,i){const r=z+i,l=t.length;i>0&&(t[r-1][ns]=n),i<l-z?(n[ns]=t[r],vf(t,z+i,n)):(t.push(n),n[ns]=null),n[Cr]=t;const h=n[$o];null!==h&&t!==h&&function ky(e,n){const t=e[T];n[Tr]!==n[Cr][Cr][Tr]&&(e[da]=!0),null===t?e[T]=[n]:t.push(n)}(h,n);const g=n[Zi];null!==g&&g.insertView(e),n[ci]|=128}(r,n,e,t),i){const l=d(t,e),h=n[Hn],g=kd(h,e[Yn]);null!==g&&function Ad(e,n,t,i,r,l){i[Ki]=r,i[so]=n,C(e,i,t,1,r,l)}(r,e[so],h,n,g,l)}}Symbol;let pc=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=ZL}return e})();const GL=pc,WL=class extends GL{constructor(n,t,i){super(),this._declarationLView=n,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,t){return this.createEmbeddedViewImpl(n,t)}createEmbeddedViewImpl(n,t,i){const r=function HL(e,n,t,i){const r=n.tView,g=Ky(e,r,t,4096&e[ci]?4096:16,null,n,null,null,null,i?.injector??null,i?.hydrationInfo??null);g[$o]=e[n.index];const E=e[Zi];return null!==E&&(g[Zi]=E.createEmbeddedView(r)),l0(r,g,t),g}(this._declarationLView,this._declarationTContainer,n,{injector:t,hydrationInfo:i});return new Rm(r)}};function ZL(){return function yv(e,n){return 4&e.type?new WL(n,e,Hf(e,n)):null}(ss(),Dt())}let tl=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=eN}return e})();function eN(){return function mS(e,n){let t;const i=n[e.index];return Ot(i)?t=i:(t=ZD(i,n,null,e),n[e.index]=t,Yy(n,t)),gS(t,n,e,i),new fS(t,e,n)}(ss(),Dt())}const tN=tl,fS=class extends tN{constructor(n,t,i){super(),this._lContainer=n,this._hostTNode=t,this._hostLView=i}get element(){return Hf(this._hostTNode,this._hostLView)}get injector(){return new Bs(this._hostTNode,this._hostLView)}get parentInjector(){const n=mf(this._hostTNode,this._hostLView);if(ih(n)){const t=md(n,this._hostLView),i=Su(n);return new Bs(t[gn].data[i+8],t)}return new Bs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const t=pS(this._lContainer);return null!==t&&t[n]||null}get length(){return this._lContainer.length-z}createEmbeddedView(n,t,i){let r,l;"number"==typeof i?r=i:null!=i&&(r=i.index,l=i.injector);const g=n.createEmbeddedViewImpl(t||{},l,null);return this.insertImpl(g,r,false),g}createComponent(n,t,i,r,l){const h=n&&!function bd(e){return"function"==typeof e}(n);let g;if(h)g=t;else{const Se=t||{};g=Se.index,i=Se.injector,r=Se.projectableNodes,l=Se.environmentInjector||Se.ngModuleRef}const w=h?n:new Om(wi(n)),E=i||this.parentInjector;if(!l&&null==w.ngModule){const je=(h?E:this.parentInjector).get(Ts,null);je&&(l=je)}wi(w.componentType??{});const ie=w.create(E,r,null,l);return this.insertImpl(ie.hostView,g,false),ie}insert(n,t){return this.insertImpl(n,t,!1)}insertImpl(n,t,i){const r=n._lView;if(function Og(e){return Ot(e[Cr])}(r)){const w=this.indexOf(n);if(-1!==w)this.detach(w);else{const E=r[Cr],k=new fS(E,E[so],E[Cr]);k.detach(k.indexOf(n))}}const h=this._adjustIndex(t),g=this._lContainer;return qL(g,r,h,!i),n.attachToViewContainerRef(),vf(R0(g),h,n),n}move(n,t){return this.insert(n,t)}indexOf(n){const t=pS(this._lContainer);return null!==t?t.indexOf(n):-1}remove(n){const t=this._adjustIndex(n,-1),i=Md(this._lContainer,t);i&&(sh(R0(this._lContainer),t),vm(i[gn],i))}detach(n){const t=this._adjustIndex(n,-1),i=Md(this._lContainer,t);return i&&null!=sh(R0(this._lContainer),t)?new Rm(i):null}_adjustIndex(n,t=0){return n??this.length+t}};function pS(e){return e[8]}function R0(e){return e[8]||(e[8]=[])}let gS=function yS(e,n,t,i){if(e[Yn])return;let r;r=8&t.type?mr(i):function nN(e,n){const t=e[Hn],i=t.createComment(""),r=_s(n,e);return cc(t,kd(t,r),i,function Of(e,n){return e.nextSibling(n)}(t,r),!1),i}(n,t),e[Yn]=r};const wv=new ln("Application Initializer");let H0=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=Ft(wv,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const l=r();if(zm(l))t.push(l);else if(ME(l)){const h=new Promise((g,w)=>{l.subscribe({complete:g,error:w})});t.push(h)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),zS=(()=>{class e{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();const $u=new ln("LocaleId",{providedIn:"root",factory:()=>Ft($u,Ln.Optional|Ln.SkipSelf)||function kN(){return typeof $localize<"u"&&$localize.locale||lp}()});let xv=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new ti(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class FN{constructor(n,t){this.ngModuleFactory=n,this.componentFactories=t}}let $S=(()=>{class e{compileModuleSync(t){return new A0(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),l=Fu(ko(t).declarations).reduce((h,g)=>{const w=wi(g);return w&&h.push(new Om(w)),h},[]);return new FN(i,l)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const HS=new ln(""),Dv=new ln("");let X0,W0=(()=>{class e{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,X0||(function iB(e){X0=e}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{vt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let l=-1;i&&i>0&&(l=setTimeout(()=>{this._callbacks=this._callbacks.filter(h=>h.timeoutId!==l),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:l,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(vt),Ht(Z0),Ht(Dv))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})(),Z0=(()=>{class e{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return X0?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})(),Fd=null;const qS=new ln("AllowMultipleToken"),K0=new ln("PlatformDestroyListeners"),Y0=new ln("appBootstrapListener");class WS{constructor(n,t){this.name=n,this.token=t}}function XS(e,n,t=[]){const i=`Platform: ${n}`,r=new ln(i);return(l=[])=>{let h=J0();if(!h||h.injector.get(qS,!1)){const g=[...t,...l,{provide:r,useValue:!0}];e?e(g):function sB(e){if(Fd&&!Fd.get(qS,!1))throw new qe(400,!1);(function GS(){!function jo(e){is=e}(()=>{throw new qe(600,!1)})})(),Fd=e;const n=e.get(YS);(function ZS(e){e.get(aD,null)?.forEach(t=>t())})(e)}(function KS(e=[],n){return Jr.create({name:n,providers:[{provide:Ab,useValue:"platform"},{provide:K0,useValue:new Set([()=>Fd=null])},...e]})}(g,i))}return function lB(e){const n=J0();if(!n)throw new qe(401,!1);return n}()}}function J0(){return Fd?.get(YS)??null}let YS=(()=>{class e{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function cB(e="zone.js",n){return"noop"===e?new Vk:"zone.js"===e?new vt(n):e}(i?.ngZone,function JS(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const l=function gL(e,n,t){return new T0(e,n,t)}(t.moduleType,this.injector,function iT(e){return[{provide:vt,useFactory:e},{provide:Do,multi:!0,useFactory:()=>{const n=Ft(dB,{optional:!0});return()=>n.initialize()}},{provide:nT,useFactory:uB},{provide:DD,useFactory:ED}]}(()=>r)),h=l.injector.get(Ou,null);return r.runOutsideAngular(()=>{const g=r.onError.subscribe({next:w=>{h.handleError(w)}});l.onDestroy(()=>{Ev(this._modules,l),g.unsubscribe()})}),function QS(e,n,t){try{const i=t();return zm(i)?i.catch(r=>{throw n.runOutsideAngular(()=>e.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>e.handleError(i)),i}}(h,r,()=>{const g=l.injector.get(H0);return g.runInitializers(),g.donePromise.then(()=>(function EI(e){pe(e,"Expected localeId to be defined"),"string"==typeof e&&(DI=e.toLowerCase().replace(/_/g,"-"))}(l.injector.get($u,lp)||lp),this._moduleDoBootstrap(l),l))})})}bootstrapModule(t,i=[]){const r=eT({},i);return function rB(e,n,t){const i=new A0(t);return Promise.resolve(i)}(0,0,t).then(l=>this.bootstrapModuleFactory(l,r))}_moduleDoBootstrap(t){const i=t.injector.get(ou);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new qe(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new qe(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(K0,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(Jr))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function eT(e,n){return Array.isArray(n)?n.reduce(eT,e):{...e,...n}}let ou=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Ft(nT),this.zoneIsStable=Ft(DD),this.componentTypes=[],this.components=[],this.isStable=Ft(xv).hasPendingTasks.pipe(jn(t=>t?Zn(!1):this.zoneIsStable),function xa(e,n=ut){return e=e??Bl,kt((t,i)=>{let r,l=!0;t.subscribe(Lt(i,h=>{const g=n(h);(l||!e(r,g))&&(l=!1,r=g,i.next(h))}))})}(),wa()),this._injector=Ft(Ts)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof fD;if(!this._injector.get(H0).done)throw!r&&function Os(e){const n=wi(e)||Xr(e)||qr(e);return null!==n&&n.standalone}(t),new qe(405,!1);let h;h=r?t:this._injector.get(Sm).resolveComponentFactory(t),this.componentTypes.push(h.componentType);const g=function oB(e){return e.isBoundToModule}(h)?void 0:this._injector.get(kh),E=h.create(Jr.NULL,[],i||h.selector,g),k=E.location.nativeElement,$=E.injector.get(HS,null);return $?.registerApplication(k),E.onDestroy(()=>{this.detachView(E.hostView),Ev(this.components,E),$?.unregisterApplication(k)}),this._loadComponent(E),E}tick(){if(this._runningTick)throw new qe(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;Ev(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(Y0,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Ev(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new qe(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Ev(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}const nT=new ln("",{providedIn:"root",factory:()=>Ft(Ou).handleError.bind(void 0)});function uB(){const e=Ft(vt),n=Ft(Ou);return t=>e.runOutsideAngular(()=>n.handleError(t))}let dB=(()=>{class e{constructor(){this.zone=Ft(vt),this.applicationRef=Ft(ou)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();let Wt=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=fB}return e})();function fB(e){return function pB(e,n,t){if(Xn(e)&&!t){const i=bs(e.index,n);return new Rm(i,i)}return 47&e.type?new Rm(n[Tr],n):null}(ss(),Dt(),16==(16&e))}class aT{constructor(){}supports(n){return tv(n)}create(n){return new bB(n)}}const _B=(e,n)=>n;class bB{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||_B}forEachItem(n){let t;for(t=this._itHead;null!==t;t=t._next)n(t)}forEachOperation(n){let t=this._itHead,i=this._removalsHead,r=0,l=null;for(;t||i;){const h=!i||t&&t.currentIndex<cT(i,r,l)?t:i,g=cT(h,r,l),w=h.currentIndex;if(h===i)r--,i=i._nextRemoved;else if(t=t._next,null==h.previousIndex)r++;else{l||(l=[]);const E=g-r,k=w-r;if(E!=k){for(let te=0;te<E;te++){const ie=te<l.length?l[te]:l[te]=0,we=ie+te;k<=we&&we<E&&(l[te]=ie+1)}l[h.previousIndex]=k-E}}g!==w&&n(h,g,w)}}forEachPreviousItem(n){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachMovedItem(n){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}forEachIdentityChange(n){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)n(t)}diff(n){if(null==n&&(n=[]),!tv(n))throw new qe(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,l,h,t=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let g=0;g<this.length;g++)l=n[g],h=this._trackByFn(g,l),null!==t&&Object.is(t.trackById,h)?(i&&(t=this._verifyReinsertion(t,l,h,g)),Object.is(t.item,l)||this._addIdentityChange(t,l)):(t=this._mismatch(t,l,h,g),i=!0),t=t._next}else r=0,function YR(e,n){if(Array.isArray(e))for(let t=0;t<e.length;t++)n(e[t]);else{const t=e[Symbol.iterator]();let i;for(;!(i=t.next()).done;)n(i.value)}}(n,g=>{h=this._trackByFn(r,g),null!==t&&Object.is(t.trackById,h)?(i&&(t=this._verifyReinsertion(t,g,h,r)),Object.is(t.item,g)||this._addIdentityChange(t,g)):(t=this._mismatch(t,g,h,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,t,i,r){let l;return null===n?l=this._itTail:(l=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._reinsertAfter(n,l,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._moveAfter(n,l,r)):n=this._addAfter(new wB(t,i),l,r),n}_verifyReinsertion(n,t,i,r){let l=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==l?n=this._reinsertAfter(l,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const t=n._next;this._addToRemovals(this._unlink(n)),n=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,l=n._nextRemoved;return null===r?this._removalsHead=l:r._nextRemoved=l,null===l?this._removalsTail=r:l._prevRemoved=r,this._insertAfter(n,t,i),this._addToMoves(n,i),n}_moveAfter(n,t,i){return this._unlink(n),this._insertAfter(n,t,i),this._addToMoves(n,i),n}_addAfter(n,t,i){return this._insertAfter(n,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,t,i){const r=null===t?this._itHead:t._next;return n._next=r,n._prev=t,null===r?this._itTail=n:r._prev=n,null===t?this._itHead=n:t._next=n,null===this._linkedRecords&&(this._linkedRecords=new lT),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const t=n._prev,i=n._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,n}_addToMoves(n,t){return n.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new lT),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,t){return n.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class wB{constructor(n,t){this.item=n,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class xB{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const t=n._prevDup,i=n._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class lT{constructor(){this.map=new Map}put(n){const t=n.trackById;let i=this.map.get(t);i||(i=new xB,this.map.set(t,i)),i.add(n)}get(n,t){const r=this.map.get(n);return r?r.get(n,t):null}remove(n){const t=n.trackById;return this.map.get(t).remove(n)&&this.map.delete(t),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function cT(e,n,t){const i=e.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+n+r}function dT(){return new Tv([new aT])}let Tv=(()=>{class e{static#e=this.\u0275prov=Pe({token:e,providedIn:"root",factory:dT});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||dT()),deps:[[e,new ch,new bf]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new qe(901,!1)}}return e})();const SB=XS(null,"core",[]);let TB=(()=>{class e{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(ou))};static#t=this.\u0275mod=ro({type:e});static#n=this.\u0275inj=Rt({})}return e})();function hp(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}function wT(e){const n=wi(e);if(!n)return null;const t=new Om(n);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}let rw=null;function Ld(){return rw}class jB{}const Fo=new ln("DocumentToken");let ow=(()=>{class e{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:function(){return Ft(HB)},providedIn:"platform"})}return e})();const UB=new ln("Location Initialized");let HB=(()=>{class e extends ow{constructor(){super(),this._doc=Ft(Fo),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ld().getBaseHref(this._doc)}onPopState(t){const i=Ld().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Ld().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:function(){return new e},providedIn:"platform"})}return e})();function sw(e,n){if(0==e.length)return n;if(0==n.length)return e;let t=0;return e.endsWith("/")&&t++,n.startsWith("/")&&t++,2==t?e+n.substring(1):1==t?e+n:e+"/"+n}function xT(e){const n=e.match(/#|\?|$/),t=n&&n.index||e.length;return e.slice(0,t-("/"===e[t-1]?1:0))+e.slice(t)}function Vu(e){return e&&"?"!==e[0]?"?"+e:e}let ju=(()=>{class e{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:function(){return Ft(DT)},providedIn:"root"})}return e})();const CT=new ln("appBaseHref");let DT=(()=>{class e extends ju{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??Ft(Fo).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return sw(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Vu(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,l){const h=this.prepareExternalUrl(r+Vu(l));this._platformLocation.pushState(t,i,h)}replaceState(t,i,r,l){const h=this.prepareExternalUrl(r+Vu(l));this._platformLocation.replaceState(t,i,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(ow),Ht(CT,8))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),qB=(()=>{class e extends ju{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=sw(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,l){let h=this.prepareExternalUrl(r+Vu(l));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.pushState(t,i,h)}replaceState(t,i,r,l){let h=this.prepareExternalUrl(r+Vu(l));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(ow),Ht(CT,8))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})(),fp=(()=>{class e{constructor(t){this._subject=new Vr,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function ZB(e){if(new RegExp("^(https?:)?//").test(e)){const[,t]=e.split(/\/\/[^\/]+/);return t}return e}(xT(ET(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Vu(i))}normalize(t){return e.stripTrailingSlash(function WB(e,n){if(!e||!n.startsWith(e))return n;const t=n.substring(e.length);return""===t||["/",";","?","#"].includes(t[0])?t:n}(this._basePath,ET(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Vu(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Vu(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=Vu;static#t=this.joinWithSlash=sw;static#n=this.stripTrailingSlash=xT;static#i=this.\u0275fac=function(i){return new(i||e)(Ht(ju))};static#r=this.\u0275prov=Pe({token:e,factory:function(){return function GB(){return new fp(Ht(ju))}()},providedIn:"root"})}return e})();function ET(e){return e.replace(/\/index.html$/,"")}function OT(e,n){n=encodeURIComponent(n);for(const t of e.split(";")){const i=t.indexOf("="),[r,l]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===n)return decodeURIComponent(l)}return null}class Oz{constructor(n,t,i,r){this.$implicit=n,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let NT=(()=>{class e{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,l,h)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new Oz(r.item,this._ngForOf,-1,-1),null===h?void 0:h);else if(null==h)i.remove(null===l?void 0:l);else if(null!==l){const g=i.get(l);i.move(g,h),BT(g,r)}});for(let r=0,l=i.length;r<l;r++){const g=i.get(r).context;g.index=r,g.count=l,g.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{BT(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||e)(G(tl),G(pc),G(Tv))};static#t=this.\u0275dir=yn({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return e})();function BT(e,n){e.context.$implicit=n.item}let Qm=(()=>{class e{constructor(t,i){this._viewContainer=t,this._context=new Fz,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){zT("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){zT("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||e)(G(tl),G(pc))};static#t=this.\u0275dir=yn({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return e})();class Fz{constructor(){this.$implicit=null,this.ngIf=null}}function zT(e,n){if(n&&!n.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${wr(n)}'.`)}let xw=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ro({type:e});static#n=this.\u0275inj=Rt({})}return e})();function UT(e){return"server"===e}let d$=(()=>{class e{static#e=this.\u0275prov=Pe({token:e,providedIn:"root",factory:()=>new h$(Ht(Fo),window)})}return e})();class h${constructor(n,t){this.document=n,this.window=t,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const t=function f$(e,n){const t=e.getElementById(n)||e.getElementsByName(n)[0];if(t)return t;if("function"==typeof e.createTreeWalker&&e.body&&"function"==typeof e.body.attachShadow){const i=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const l=r.shadowRoot;if(l){const h=l.getElementById(n)||l.querySelector(`[name="${n}"]`);if(h)return h}r=i.nextNode()}}return null}(this.document,n);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(n){this.supportsScrolling()&&(this.window.history.scrollRestoration=n)}scrollToElement(n){const t=n.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,l=this.offset();this.window.scrollTo(i-l[0],r-l[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class HT{}class L$ extends jB{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Ew extends L${static makeCurrent(){!function VB(e){rw||(rw=e)}(new Ew)}onAndCancel(n,t,i){return n.addEventListener(t,i),()=>{n.removeEventListener(t,i)}}dispatchEvent(n,t){n.dispatchEvent(t)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,t){return(t=t||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,t){return"window"===t?window:"document"===t?n:"body"===t?n.body:null}getBaseHref(n){const t=function N$(){return tg=tg||document.querySelector("base"),tg?tg.getAttribute("href"):null}();return null==t?null:function B$(e){jv=jv||document.createElement("a"),jv.setAttribute("href",e);const n=jv.pathname;return"/"===n.charAt(0)?n:`/${n}`}(t)}resetBaseElement(){tg=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return OT(document.cookie,n)}}let jv,tg=null,$$=(()=>{class e{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();const Iw=new ln("EventManagerPlugins");let XT=(()=>{class e{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(l=>l.supports(t)),!i)throw new qe(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(Iw),Ht(vt))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();class KT{constructor(n){this._doc=n}}const Sw="ng-app-id";let YT=(()=>{class e{constructor(t,i,r,l={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=l,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=UT(l),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${Sw}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const l=r.get(t);return l.usage+=i,l.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,l=r?.get(i);if(l?.parentNode===t)return r.delete(i),l.removeAttribute(Sw),l;{const h=this.doc.createElement("style");return this.nonce&&h.setAttribute("nonce",this.nonce),h.textContent=i,this.platformIsServer&&h.setAttribute(Sw,this.appId),h}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const l=this.styleRef,h=l.get(i)?.elements;h?h.push(r):l.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(Fo),Ht(jy),Ht(cD,8),Ht(Th))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();const Tw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Aw=/%COMP%/g,H$=new ln("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function QT(e,n){return n.map(t=>t.replace(Aw,e))}let Mw=(()=>{class e{constructor(t,i,r,l,h,g,w,E=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=l,this.doc=h,this.platformId=g,this.ngZone=w,this.nonce=E,this.rendererByCompId=new Map,this.platformIsServer=UT(g),this.defaultRenderer=new Pw(t,h,w,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===yo.ShadowDom&&(i={...i,encapsulation:yo.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof tA?r.applyToHost(t):r instanceof kw&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let l=r.get(i.id);if(!l){const h=this.doc,g=this.ngZone,w=this.eventManager,E=this.sharedStylesHost,k=this.removeStylesOnCompDestroy,$=this.platformIsServer;switch(i.encapsulation){case yo.Emulated:l=new tA(w,E,i,this.appId,k,h,g,$);break;case yo.ShadowDom:return new Z$(w,E,t,i,h,g,this.nonce,$);default:l=new kw(w,E,i,k,h,g,$)}r.set(i.id,l)}return l}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(XT),Ht(YT),Ht(jy),Ht(H$),Ht(Fo),Ht(Th),Ht(vt),Ht(cD))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();class Pw{constructor(n,t,i,r){this.eventManager=n,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,t){return t?this.doc.createElementNS(Tw[t]||t,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,t){(eA(n)?n.content:n).appendChild(t)}insertBefore(n,t,i){n&&(eA(n)?n.content:n).insertBefore(t,i)}removeChild(n,t){n&&n.removeChild(t)}selectRootElement(n,t){let i="string"==typeof n?this.doc.querySelector(n):n;if(!i)throw new qe(-5104,!1);return t||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,t,i,r){if(r){t=r+":"+t;const l=Tw[r];l?n.setAttributeNS(l,t,i):n.setAttribute(t,i)}else n.setAttribute(t,i)}removeAttribute(n,t,i){if(i){const r=Tw[i];r?n.removeAttributeNS(r,t):n.removeAttribute(`${i}:${t}`)}else n.removeAttribute(t)}addClass(n,t){n.classList.add(t)}removeClass(n,t){n.classList.remove(t)}setStyle(n,t,i,r){r&(Jc.DashCase|Jc.Important)?n.style.setProperty(t,i,r&Jc.Important?"important":""):n.style[t]=i}removeStyle(n,t,i){i&Jc.DashCase?n.style.removeProperty(t):n.style[t]=""}setProperty(n,t,i){n[t]=i}setValue(n,t){n.nodeValue=t}listen(n,t,i){if("string"==typeof n&&!(n=Ld().getGlobalEventTarget(this.doc,n)))throw new Error(`Unsupported event target ${n} for event ${t}`);return this.eventManager.addEventListener(n,t,this.decoratePreventDefault(i))}decoratePreventDefault(n){return t=>{if("__ngUnwrap__"===t)return n;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>n(t)):n(t))&&t.preventDefault()}}}function eA(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class Z$ extends Pw{constructor(n,t,i,r,l,h,g,w){super(n,l,h,w),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const E=QT(r.id,r.styles);for(const k of E){const $=document.createElement("style");g&&$.setAttribute("nonce",g),$.textContent=k,this.shadowRoot.appendChild($)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,t){return super.appendChild(this.nodeOrShadowRoot(n),t)}insertBefore(n,t,i){return super.insertBefore(this.nodeOrShadowRoot(n),t,i)}removeChild(n,t){return super.removeChild(this.nodeOrShadowRoot(n),t)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class kw extends Pw{constructor(n,t,i,r,l,h,g,w){super(n,l,h,g),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=w?QT(w,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class tA extends kw{constructor(n,t,i,r,l,h,g,w){const E=r+"-"+i.id;super(n,t,i,l,h,g,w,E),this.contentAttr=function q$(e){return"_ngcontent-%COMP%".replace(Aw,e)}(E),this.hostAttr=function G$(e){return"_nghost-%COMP%".replace(Aw,e)}(E)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,t){const i=super.createElement(n,t);return super.setAttribute(i,this.contentAttr,""),i}}let X$=(()=>{class e extends KT{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(Fo))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();const nA=["alt","control","meta","shift"],K$={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Y$={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let J$=(()=>{class e extends KT{constructor(t){super(t)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,i,r){const l=e.parseEventName(i),h=e.eventCallback(l.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ld().onAndCancel(t,l.domEventName,h))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const l=e._normalizeKey(i.pop());let h="",g=i.indexOf("code");if(g>-1&&(i.splice(g,1),h="code."),nA.forEach(E=>{const k=i.indexOf(E);k>-1&&(i.splice(k,1),h+=E+".")}),h+=l,0!=i.length||0===l.length)return null;const w={};return w.domEventName=r,w.fullKey=h,w}static matchEventFullKeyCode(t,i){let r=K$[t.key]||t.key,l="";return i.indexOf("code.")>-1&&(r=t.code,l="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),nA.forEach(h=>{h!==r&&(0,Y$[h])(t)&&(l+=h+".")}),l+=r,l===i)}static eventCallback(t,i,r){return l=>{e.matchEventFullKeyCode(l,t)&&r.runGuarded(()=>i(l))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(Fo))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();const nV=XS(SB,"browser",[{provide:Th,useValue:"browser"},{provide:aD,useValue:function Q$(){Ew.makeCurrent()},multi:!0},{provide:Fo,useFactory:function tV(){return function un(e){Ct=e}(document),document},deps:[]}]),iV=new ln(""),oA=[{provide:Dv,useClass:class z${addToWindow(n){Xi.getAngularTestability=(i,r=!0)=>{const l=n.findTestabilityInTree(i,r);if(null==l)throw new qe(5103,!1);return l},Xi.getAllAngularTestabilities=()=>n.getAllTestabilities(),Xi.getAllAngularRootElements=()=>n.getAllRootElements(),Xi.frameworkStabilizers||(Xi.frameworkStabilizers=[]),Xi.frameworkStabilizers.push(i=>{const r=Xi.getAllAngularTestabilities();let l=r.length,h=!1;const g=function(w){h=h||w,l--,0==l&&i(h)};r.forEach(w=>{w.whenStable(g)})})}findTestabilityInTree(n,t,i){return null==t?null:n.getTestability(t)??(i?Ld().isShadowRoot(t)?this.findTestabilityInTree(n,t.host,!0):this.findTestabilityInTree(n,t.parentElement,!0):null)}},deps:[]},{provide:HS,useClass:W0,deps:[vt,Z0,Dv]},{provide:W0,useClass:W0,deps:[vt,Z0,Dv]}],sA=[{provide:Ab,useValue:"root"},{provide:Ou,useFactory:function eV(){return new Ou},deps:[]},{provide:Iw,useClass:X$,multi:!0,deps:[Fo,vt,Th]},{provide:Iw,useClass:J$,multi:!0,deps:[Fo]},Mw,YT,XT,{provide:Tm,useExisting:Mw},{provide:HT,useClass:$$,deps:[]},[]];let aA=(()=>{class e{constructor(t){}static withServerTransition(t){return{ngModule:e,providers:[{provide:jy,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(iV,12))};static#t=this.\u0275mod=ro({type:e});static#n=this.\u0275inj=Rt({providers:[...sA,...oA],imports:[xw,TB]})}return e})(),lA=(()=>{class e{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(Fo))};static#t=this.\u0275prov=Pe({token:e,factory:function(i){let r=null;return r=i?new i:function oV(){return new lA(Ht(Fo))}(),r},providedIn:"root"})}return e})();typeof window<"u"&&window;let dA=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:function(i){let r=null;return r=i?new(i||e):Ht(hA),r},providedIn:"root"})}return e})(),hA=(()=>{class e extends dA{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case ma.NONE:return i;case ma.HTML:return xo(i,"HTML")?nr(i):xm(this._doc,String(i)).toString();case ma.STYLE:return xo(i,"Style")?nr(i):i;case ma.SCRIPT:if(xo(i,"Script"))return nr(i);throw new qe(5200,!1);case ma.URL:return xo(i,"URL")?nr(i):Ss(String(i));case ma.RESOURCE_URL:if(xo(i,"ResourceURL"))return nr(i);throw new qe(5201,!1);default:throw new qe(5202,!1)}}bypassSecurityTrustHtml(t){return function Mo(e){return new Mn(e)}(t)}bypassSecurityTrustStyle(t){return function Cs(e){return new Tn(e)}(t)}bypassSecurityTrustScript(t){return function Ds(e){return new Qn(e)}(t)}bypassSecurityTrustUrl(t){return function Es(e){return new gr(e)}(t)}bypassSecurityTrustResourceUrl(t){return function Kr(e){return new ar(e)}(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(Fo))};static#t=this.\u0275prov=Pe({token:e,factory:function(i){let r=null;return r=i?new i:function cV(e){return new hA(e.get(Fo))}(Ht(Jr)),r},providedIn:"root"})}return e})();const{isArray:uV}=Array,{getPrototypeOf:dV,prototype:hV,keys:fV}=Object;function pA(e){if(1===e.length){const n=e[0];if(uV(n))return{args:n,keys:null};if(function pV(e){return e&&"object"==typeof e&&dV(e)===hV}(n)){const t=fV(n);return{args:t.map(i=>n[i]),keys:t}}}return{args:e,keys:null}}const{isArray:mV}=Array;function Ow(e){return mn(n=>function gV(e,n){return mV(n)?e(...n):e(n)}(e,n))}function mA(e,n){return e.reduce((t,i,r)=>(t[i]=n[r],t),{})}let gA=(()=>{class e{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(i){return new(i||e)(G(Ru),G(Et))};static#t=this.\u0275dir=yn({type:e})}return e})(),Oh=(()=>{class e extends gA{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=Gr(e)))(r||e)}}();static#t=this.\u0275dir=yn({type:e,features:[Mi]})}return e})();const Fa=new ln("NgValueAccessor"),_V={provide:Fa,useExisting:Fi(()=>Uv),multi:!0},wV=new ln("CompositionEventMode");let Uv=(()=>{class e extends gA{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function bV(){const e=Ld()?Ld().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(i){return new(i||e)(G(Ru),G(Et),G(wV,8))};static#t=this.\u0275dir=yn({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&lr("input",function(h){return r._handleInput(h.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(h){return r._compositionEnd(h.target.value)})},features:[Pr([_V]),Mi]})}return e})();function Bd(e){return null==e||("string"==typeof e||Array.isArray(e))&&0===e.length}const As=new ln("NgValidators"),zd=new ln("NgAsyncValidators");function wA(e){return Bd(e.value)?{required:!0}:null}function Hv(e){return null}function SA(e){return null!=e}function TA(e){return zm(e)?Vi(e):e}function AA(e){let n={};return e.forEach(t=>{n=null!=t?{...n,...t}:n}),0===Object.keys(n).length?null:n}function MA(e,n){return n.map(t=>t(e))}function PA(e){return e.map(n=>function CV(e){return!e.validate}(n)?n:t=>n.validate(t))}function Fw(e){return null!=e?function kA(e){if(!e)return null;const n=e.filter(SA);return 0==n.length?null:function(t){return AA(MA(t,n))}}(PA(e)):null}function Lw(e){return null!=e?function RA(e){if(!e)return null;const n=e.filter(SA);return 0==n.length?null:function(t){return function yV(...e){const n=ir(e),{args:t,keys:i}=pA(e),r=new gt(l=>{const{length:h}=t;if(!h)return void l.complete();const g=new Array(h);let w=h,E=h;for(let k=0;k<h;k++){let $=!1;tn(t[k]).subscribe(Lt(l,te=>{$||($=!0,E--),g[k]=te},()=>w--,void 0,()=>{(!w||!$)&&(E||l.next(i?mA(i,g):g),l.complete())}))}});return n?r.pipe(Ow(n)):r}(MA(t,n).map(TA)).pipe(mn(AA))}}(PA(e)):null}function OA(e,n){return null===e?[n]:Array.isArray(e)?[...e,n]:[e,n]}function Nw(e){return e?Array.isArray(e)?e:[e]:[]}function qv(e,n){return Array.isArray(e)?e.includes(n):e===n}function NA(e,n){const t=Nw(n);return Nw(e).forEach(r=>{qv(t,r)||t.push(r)}),t}function BA(e,n){return Nw(n).filter(t=>!qv(e,t))}class zA{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=Fw(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=Lw(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,t){return!!this.control&&this.control.hasError(n,t)}getError(n,t){return this.control?this.control.getError(n,t):null}}class ba extends zA{get formDirective(){return null}get path(){return null}}class qu extends zA{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class $A{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let VA=(()=>{class e extends $A{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||e)(G(qu,2))};static#t=this.\u0275dir=yn({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&cv("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Mi]})}return e})(),jA=(()=>{class e extends $A{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||e)(G(ba,10))};static#t=this.\u0275dir=yn({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){2&i&&cv("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[Mi]})}return e})();const ng="VALID",Wv="INVALID",mp="PENDING",ig="DISABLED";function $w(e){return(Zv(e)?e.validators:e)||null}function Vw(e,n){return(Zv(n)?n.asyncValidators:e)||null}function Zv(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class GA{constructor(n,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===ng}get invalid(){return this.status===Wv}get pending(){return this.status==mp}get disabled(){return this.status===ig}get enabled(){return this.status!==ig}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(NA(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(NA(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(BA(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(BA(n,this._rawAsyncValidators))}hasValidator(n){return qv(this._rawValidators,n)}hasAsyncValidator(n){return qv(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=mp,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=ig,this.errors=null,this._forEachChild(i=>{i.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=ng,this._forEachChild(i=>{i.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ng||this.status===mp)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ig:ng}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=mp,this._hasOwnPendingAsyncValidator=!0;const t=TA(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,t={}){this.errors=n,this._updateControlsErrors(!1!==t.emitEvent)}get(n){let t=n;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(n,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[n]:null}hasError(n,t){return!!this.getError(n,t)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new Vr,this.statusChanges=new Vr}_calculateStatus(){return this._allControlsDisabled()?ig:this.errors?Wv:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(mp)?mp:this._anyControlsHaveStatus(Wv)?Wv:ng}_anyControlsHaveStatus(n){return this._anyControls(t=>t.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){Zv(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function SV(e){return Array.isArray(e)?Fw(e):e||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function TV(e){return Array.isArray(e)?Lw(e):e||null}(this._rawAsyncValidators)}}class jw extends GA{constructor(n,t,i){super($w(t),Vw(i,t)),this.controls=n,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,t){return this.controls[n]?this.controls[n]:(this.controls[n]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(n,t,i={}){this.registerControl(n,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,t={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(n,t,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],t&&this.registerControl(n,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,t={}){(function qA(e,n,t){e._forEachChild((i,r)=>{if(void 0===t[r])throw new qe(1002,"")})})(this,0,n),Object.keys(n).forEach(i=>{(function HA(e,n,t){const i=e.controls;if(!(n?Object.keys(i):i).length)throw new qe(1e3,"");if(!i[t])throw new qe(1001,"")})(this,!0,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(n,t={}){null!=n&&(Object.keys(n).forEach(i=>{const r=this.controls[i];r&&r.patchValue(n[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(n={},t={}){this._forEachChild((i,r)=>{i.reset(n?n[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(n,t,i)=>(n[i]=t.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(t,i)=>!!i._syncPendingControls()||t);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(t=>{const i=this.controls[t];i&&n(i,t)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[t,i]of Object.entries(this.controls))if(this.contains(t)&&n(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(n,t){let i=n;return this._forEachChild((r,l)=>{i=t(i,r,l)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}const gp=new ln("CallSetDisabledState",{providedIn:"root",factory:()=>Xv}),Xv="always";function rg(e,n,t=Xv){Uw(e,n),n.valueAccessor.writeValue(e.value),(e.disabled||"always"===t)&&n.valueAccessor.setDisabledState?.(e.disabled),function PV(e,n){n.valueAccessor.registerOnChange(t=>{e._pendingValue=t,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&WA(e,n)})}(e,n),function RV(e,n){const t=(i,r)=>{n.valueAccessor.writeValue(i),r&&n.viewToModelUpdate(i)};e.registerOnChange(t),n._registerOnDestroy(()=>{e._unregisterOnChange(t)})}(e,n),function kV(e,n){n.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&WA(e,n),"submit"!==e.updateOn&&e.markAsTouched()})}(e,n),function MV(e,n){if(n.valueAccessor.setDisabledState){const t=i=>{n.valueAccessor.setDisabledState(i)};e.registerOnDisabledChange(t),n._registerOnDestroy(()=>{e._unregisterOnDisabledChange(t)})}}(e,n)}function Jv(e,n){e.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(n)})}function Uw(e,n){const t=function FA(e){return e._rawValidators}(e);null!==n.validator?e.setValidators(OA(t,n.validator)):"function"==typeof t&&e.setValidators([t]);const i=function LA(e){return e._rawAsyncValidators}(e);null!==n.asyncValidator?e.setAsyncValidators(OA(i,n.asyncValidator)):"function"==typeof i&&e.setAsyncValidators([i]);const r=()=>e.updateValueAndValidity();Jv(n._rawValidators,r),Jv(n._rawAsyncValidators,r)}function WA(e,n){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}const BV={provide:ba,useExisting:Fi(()=>e_)},og=(()=>Promise.resolve())();let e_=(()=>{class e extends ba{constructor(t,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Vr,this.form=new jw({},Fw(t),Lw(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){og.then(()=>{const i=this._findContainer(t.path);t.control=i.registerControl(t.name,t.control),rg(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){og.then(()=>{const i=this._findContainer(t.path);i&&i.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){og.then(()=>{const i=this._findContainer(t.path),r=new jw({});(function ZA(e,n){Uw(e,n)})(r,t),i.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){og.then(()=>{const i=this._findContainer(t.path);i&&i.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,i){og.then(()=>{this.form.get(t.path).setValue(i)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,function XA(e,n){e._syncPendingControls(),n.forEach(t=>{const i=t.control;"submit"===i.updateOn&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static#e=this.\u0275fac=function(i){return new(i||e)(G(As,10),G(zd,10),G(gp,8))};static#t=this.\u0275dir=yn({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){1&i&&lr("submit",function(h){return r.onSubmit(h)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Pr([BV]),Mi]})}return e})();function KA(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}function YA(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}const JA=class extends GA{constructor(n=null,t,i){super($w(t),Vw(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Zv(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=YA(n)?n.value:n)}setValue(n,t={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(n,t={}){this.setValue(n,t)}reset(n=this.defaultValue,t={}){this._applyFormState(n),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){KA(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){KA(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){YA(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},VV={provide:qu,useExisting:Fi(()=>Ww)},tM=(()=>Promise.resolve())();let Ww=(()=>{class e extends qu{constructor(t,i,r,l,h,g){super(),this._changeDetectorRef=h,this.callSetDisabledState=g,this.control=new JA,this._registered=!1,this.name="",this.update=new Vr,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function Gw(e,n){if(!n)return null;let t,i,r;return Array.isArray(n),n.forEach(l=>{l.constructor===Uv?t=l:function LV(e){return Object.getPrototypeOf(e.constructor)===Oh}(l)?i=l:r=l}),r||i||t||null}(0,l)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function qw(e,n){if(!e.hasOwnProperty("model"))return!1;const t=e.model;return!!t.isFirstChange()||!Object.is(n,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){rg(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){tM.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&hp(i);tM.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function Kv(e,n){return[...n.path,e]}(t,this._parent):[t]}static#e=this.\u0275fac=function(i){return new(i||e)(G(ba,9),G(As,10),G(zd,10),G(Fa,10),G(Wt,8),G(gp,8))};static#t=this.\u0275dir=yn({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Pr([VV]),Mi,Bi]})}return e})(),nM=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=yn({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return e})(),rM=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ro({type:e});static#n=this.\u0275inj=Rt({})}return e})();function pM(e){return"number"==typeof e?e:parseFloat(e)}let Fh=(()=>{class e{constructor(){this._validator=Hv}ngOnChanges(t){if(this.inputName in t){const i=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Hv,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return null!=t}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=yn({type:e,features:[Bi]})}return e})();const i3={provide:As,useExisting:Fi(()=>Qw),multi:!0};let Qw=(()=>{class e extends Fh{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=t=>pM(t),this.createValidator=t=>function bA(e){return n=>{if(Bd(n.value)||Bd(e))return null;const t=parseFloat(n.value);return!isNaN(t)&&t>e?{max:{max:e,actual:n.value}}:null}}(t)}static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=Gr(e)))(r||e)}}();static#t=this.\u0275dir=yn({type:e,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&ea("max",r._enabled?r.max:null)},inputs:{max:"max"},features:[Pr([i3]),Mi]})}return e})();const r3={provide:As,useExisting:Fi(()=>ex),multi:!0};let ex=(()=>{class e extends Fh{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=t=>pM(t),this.createValidator=t=>function _A(e){return n=>{if(Bd(n.value)||Bd(e))return null;const t=parseFloat(n.value);return!isNaN(t)&&t<e?{min:{min:e,actual:n.value}}:null}}(t)}static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=Gr(e)))(r||e)}}();static#t=this.\u0275dir=yn({type:e,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&ea("min",r._enabled?r.min:null)},inputs:{min:"min"},features:[Pr([r3]),Mi]})}return e})();const o3={provide:As,useExisting:Fi(()=>t_),multi:!0};let t_=(()=>{class e extends Fh{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=hp,this.createValidator=t=>wA}enabled(t){return t}static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=Gr(e)))(r||e)}}();static#t=this.\u0275dir=yn({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,r){2&i&&ea("required",r._enabled?"":null)},inputs:{required:"required"},features:[Pr([o3]),Mi]})}return e})(),d3=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ro({type:e});static#n=this.\u0275inj=Rt({imports:[rM]})}return e})(),f3=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:gp,useValue:t.callSetDisabledState??Xv}]}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ro({type:e});static#n=this.\u0275inj=Rt({imports:[d3]})}return e})();function yp(e,n){return We(n)?mi(e,n,1):mi(e,1)}function yc(e,n){return kt((t,i)=>{let r=0;t.subscribe(Lt(i,l=>e.call(n,l,r++)&&i.next(l)))})}function sg(e){return kt((n,t)=>{try{n.subscribe(t)}finally{t.add(e)}})}class n_{}class i_{}class su{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?"string"==typeof n?this.lazyInit=()=>{this.headers=new Map,n.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),l=r.toLowerCase(),h=t.slice(i+1).trim();this.maybeSetNormalizedName(r,l),this.headers.has(l)?this.headers.get(l).push(h):this.headers.set(l,[h])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const t=this.headers.get(n.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,t){return this.clone({name:n,value:t,op:"a"})}set(n,t){return this.clone({name:n,value:t,op:"s"})}delete(n,t){return this.clone({name:n,value:t,op:"d"})}maybeSetNormalizedName(n,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,n)}init(){this.lazyInit&&(this.lazyInit instanceof su?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(t=>{this.headers.set(t,n.headers.get(t)),this.normalizedNames.set(t,n.normalizedNames.get(t))})}clone(n){const t=new su;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof su?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([n]),t}applyUpdate(n){const t=n.name.toLowerCase();switch(n.op){case"a":case"s":let i=n.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(n.name,t);const r=("a"===n.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const l=n.value;if(l){let h=this.headers.get(t);if(!h)return;h=h.filter(g=>-1===l.indexOf(g)),0===h.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,h)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(n,t){const i=(Array.isArray(t)?t:[t]).map(l=>l.toString()),r=n.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(n,r)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>n(this.normalizedNames.get(t),this.headers.get(t)))}}class p3{encodeKey(n){return bM(n)}encodeValue(n){return bM(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const g3=/%(\d[a-f0-9])/gi,y3={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function bM(e){return encodeURIComponent(e).replace(g3,(n,t)=>y3[t]??n)}function r_(e){return`${e}`}class $d{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new p3,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function m3(e,n){const t=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(r=>{const l=r.indexOf("="),[h,g]=-1==l?[n.decodeKey(r),""]:[n.decodeKey(r.slice(0,l)),n.decodeValue(r.slice(l+1))],w=t.get(h)||[];w.push(g),t.set(h,w)}),t}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(t=>{const i=n.fromObject[t],r=Array.isArray(i)?i.map(r_):[r_(i)];this.map.set(t,r)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const t=this.map.get(n);return t?t[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,t){return this.clone({param:n,value:t,op:"a"})}appendAll(n){const t=[];return Object.keys(n).forEach(i=>{const r=n[i];Array.isArray(r)?r.forEach(l=>{t.push({param:i,value:l,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(n,t){return this.clone({param:n,value:t,op:"s"})}delete(n,t){return this.clone({param:n,value:t,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const t=this.encoder.encodeKey(n);return this.map.get(n).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const t=new $d({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(n),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const t=("a"===n.op?this.map.get(n.param):void 0)||[];t.push(r_(n.value)),this.map.set(n.param,t);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let i=this.map.get(n.param)||[];const r=i.indexOf(r_(n.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(n.param,i):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class v3{constructor(){this.map=new Map}set(n,t){return this.map.set(n,t),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function wM(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function xM(e){return typeof Blob<"u"&&e instanceof Blob}function CM(e){return typeof FormData<"u"&&e instanceof FormData}class ag{constructor(n,t,i,r){let l;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function _3(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,l=r):l=i,l&&(this.reportProgress=!!l.reportProgress,this.withCredentials=!!l.withCredentials,l.responseType&&(this.responseType=l.responseType),l.headers&&(this.headers=l.headers),l.context&&(this.context=l.context),l.params&&(this.params=l.params)),this.headers||(this.headers=new su),this.context||(this.context=new v3),this.params){const h=this.params.toString();if(0===h.length)this.urlWithParams=t;else{const g=t.indexOf("?");this.urlWithParams=t+(-1===g?"?":g<t.length-1?"&":"")+h}}else this.params=new $d,this.urlWithParams=t}serializeBody(){return null===this.body?null:wM(this.body)||xM(this.body)||CM(this.body)||function b3(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof $d?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||CM(this.body)?null:xM(this.body)?this.body.type||null:wM(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof $d?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const t=n.method||this.method,i=n.url||this.url,r=n.responseType||this.responseType,l=void 0!==n.body?n.body:this.body,h=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,g=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let w=n.headers||this.headers,E=n.params||this.params;const k=n.context??this.context;return void 0!==n.setHeaders&&(w=Object.keys(n.setHeaders).reduce(($,te)=>$.set(te,n.setHeaders[te]),w)),n.setParams&&(E=Object.keys(n.setParams).reduce(($,te)=>$.set(te,n.setParams[te]),E)),new ag(t,i,l,{params:E,headers:w,context:k,reportProgress:g,responseType:r,withCredentials:h})}}var vp=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(vp||{});class tx{constructor(n,t=200,i="OK"){this.headers=n.headers||new su,this.status=void 0!==n.status?n.status:t,this.statusText=n.statusText||i,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class nx extends tx{constructor(n={}){super(n),this.type=vp.ResponseHeader}clone(n={}){return new nx({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class _p extends tx{constructor(n={}){super(n),this.type=vp.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new _p({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class DM extends tx{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function ix(e,n){return{body:n,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let rx=(()=>{class e{constructor(t){this.handler=t}request(t,i,r={}){let l;if(t instanceof ag)l=t;else{let w,E;w=r.headers instanceof su?r.headers:new su(r.headers),r.params&&(E=r.params instanceof $d?r.params:new $d({fromObject:r.params})),l=new ag(t,i,void 0!==r.body?r.body:null,{headers:w,context:r.context,params:E,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const h=Zn(l).pipe(yp(w=>this.handler.handle(w)));if(t instanceof ag||"events"===r.observe)return h;const g=h.pipe(yc(w=>w instanceof _p));switch(r.observe||"body"){case"body":switch(l.responseType){case"arraybuffer":return g.pipe(mn(w=>{if(null!==w.body&&!(w.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return w.body}));case"blob":return g.pipe(mn(w=>{if(null!==w.body&&!(w.body instanceof Blob))throw new Error("Response is not a Blob.");return w.body}));case"text":return g.pipe(mn(w=>{if(null!==w.body&&"string"!=typeof w.body)throw new Error("Response is not a string.");return w.body}));default:return g.pipe(mn(w=>w.body))}case"response":return g;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new $d).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,ix(r,i))}post(t,i,r={}){return this.request("POST",t,ix(r,i))}put(t,i,r={}){return this.request("PUT",t,ix(r,i))}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(n_))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();function SM(e,n){return n(e)}function x3(e,n){return(t,i)=>n.intercept(t,{handle:r=>e(r,i)})}const D3=new ln(""),lg=new ln(""),TM=new ln("");function E3(){let e=null;return(n,t)=>{null===e&&(e=(Ft(D3,{optional:!0})??[]).reduceRight(x3,SM));const i=Ft(xv),r=i.add();return e(n,t).pipe(sg(()=>i.remove(r)))}}let AM=(()=>{class e extends n_{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=Ft(xv)}handle(t){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(lg),...this.injector.get(TM,[])]));this.chain=r.reduceRight((l,h)=>function C3(e,n,t){return(i,r)=>t.runInContext(()=>n(i,l=>e(l,r)))}(l,h,this.injector),SM)}const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(sg(()=>this.pendingTasks.remove(i)))}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(i_),Ht(Ts))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();const A3=/^\)\]\}',?\n/;let PM=(()=>{class e{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new qe(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?Vi(i.\u0275loadImpl()):Zn(null)).pipe(jn(()=>new gt(l=>{const h=i.build();if(h.open(t.method,t.urlWithParams),t.withCredentials&&(h.withCredentials=!0),t.headers.forEach((Se,je)=>h.setRequestHeader(Se,je.join(","))),t.headers.has("Accept")||h.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const Se=t.detectContentTypeHeader();null!==Se&&h.setRequestHeader("Content-Type",Se)}if(t.responseType){const Se=t.responseType.toLowerCase();h.responseType="json"!==Se?Se:"text"}const g=t.serializeBody();let w=null;const E=()=>{if(null!==w)return w;const Se=h.statusText||"OK",je=new su(h.getAllResponseHeaders()),dt=function M3(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(h)||t.url;return w=new nx({headers:je,status:h.status,statusText:Se,url:dt}),w},k=()=>{let{headers:Se,status:je,statusText:dt,url:Ue}=E(),Kt=null;204!==je&&(Kt=typeof h.response>"u"?h.responseText:h.response),0===je&&(je=Kt?200:0);let En=je>=200&&je<300;if("json"===t.responseType&&"string"==typeof Kt){const _i=Kt;Kt=Kt.replace(A3,"");try{Kt=""!==Kt?JSON.parse(Kt):null}catch(Br){Kt=_i,En&&(En=!1,Kt={error:Br,text:Kt})}}En?(l.next(new _p({body:Kt,headers:Se,status:je,statusText:dt,url:Ue||void 0})),l.complete()):l.error(new DM({error:Kt,headers:Se,status:je,statusText:dt,url:Ue||void 0}))},$=Se=>{const{url:je}=E(),dt=new DM({error:Se,status:h.status||0,statusText:h.statusText||"Unknown Error",url:je||void 0});l.error(dt)};let te=!1;const ie=Se=>{te||(l.next(E()),te=!0);let je={type:vp.DownloadProgress,loaded:Se.loaded};Se.lengthComputable&&(je.total=Se.total),"text"===t.responseType&&h.responseText&&(je.partialText=h.responseText),l.next(je)},we=Se=>{let je={type:vp.UploadProgress,loaded:Se.loaded};Se.lengthComputable&&(je.total=Se.total),l.next(je)};return h.addEventListener("load",k),h.addEventListener("error",$),h.addEventListener("timeout",$),h.addEventListener("abort",$),t.reportProgress&&(h.addEventListener("progress",ie),null!==g&&h.upload&&h.upload.addEventListener("progress",we)),h.send(g),l.next({type:vp.Sent}),()=>{h.removeEventListener("error",$),h.removeEventListener("abort",$),h.removeEventListener("load",k),h.removeEventListener("timeout",$),t.reportProgress&&(h.removeEventListener("progress",ie),null!==g&&h.upload&&h.upload.removeEventListener("progress",we)),h.readyState!==h.DONE&&h.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(HT))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();const ox=new ln("XSRF_ENABLED"),kM=new ln("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),RM=new ln("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class OM{}let R3=(()=>{class e{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=OT(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(Fo),Ht(Th),Ht(kM))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();function O3(e,n){const t=e.url.toLowerCase();if(!Ft(ox)||"GET"===e.method||"HEAD"===e.method||t.startsWith("http://")||t.startsWith("https://"))return n(e);const i=Ft(OM).getToken(),r=Ft(RM);return null!=i&&!e.headers.has(r)&&(e=e.clone({headers:e.headers.set(r,i)})),n(e)}var Vd=function(e){return e[e.Interceptors=0]="Interceptors",e[e.LegacyInterceptors=1]="LegacyInterceptors",e[e.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",e[e.NoXsrfProtection=3]="NoXsrfProtection",e[e.JsonpSupport=4]="JsonpSupport",e[e.RequestsMadeViaParent=5]="RequestsMadeViaParent",e[e.Fetch=6]="Fetch",e}(Vd||{});function F3(...e){const n=[rx,PM,AM,{provide:n_,useExisting:AM},{provide:i_,useExisting:PM},{provide:lg,useValue:O3,multi:!0},{provide:ox,useValue:!0},{provide:OM,useClass:R3}];for(const t of e)n.push(...t.\u0275providers);return Al(n)}const FM=new ln("LEGACY_INTERCEPTOR_FN");function L3(){return function Lh(e,n){return{\u0275kind:e,\u0275providers:n}}(Vd.LegacyInterceptors,[{provide:FM,useFactory:E3},{provide:lg,useExisting:FM,multi:!0}])}let N3=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ro({type:e});static#n=this.\u0275inj=Rt({providers:[F3(L3())]})}return e})();function s_(...e){const n=kr(e),t=ir(e),{args:i,keys:r}=pA(e);if(0===i.length)return Vi([],n);const l=new gt(function H3(e,n,t=ut){return i=>{LM(n,()=>{const{length:r}=e,l=new Array(r);let h=r,g=r;for(let w=0;w<r;w++)LM(n,()=>{const E=Vi(e[w],n);let k=!1;E.subscribe(Lt(i,$=>{l[w]=$,k||(k=!0,g--),g||i.next(t(l.slice()))},()=>{--h||i.complete()}))},i)},i)}}(i,n,r?h=>mA(r,h):ut));return t?l.pipe(Ow(t)):l}function LM(e,n,t){e?si(t,e,n):n()}const a_=fn(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function sx(...e){return function q3(){return _r(1)}()(Vi(e,kr(e)))}function NM(e){return new gt(n=>{tn(e()).subscribe(n)})}function cg(e,n){const t=We(e)?e:()=>e,i=r=>r.error(t());return new gt(n?r=>n.schedule(i,0,r):i)}function ax(){return kt((e,n)=>{let t=null;e._refCount++;const i=Lt(n,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(t=null);const r=e._connection,l=t;t=null,r&&(!l||r===l)&&r.unsubscribe(),n.unsubscribe()});e.subscribe(i),i.closed||(t=e.connect())})}class BM extends gt{constructor(n,t){super(),this.source=n,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,qt(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new an;const t=this.getSubject();n.add(this.source.subscribe(Lt(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=an.EMPTY)}return n}refCount(){return ax()(this)}}function bp(e){return e<=0?()=>Ci:kt((n,t)=>{let i=0;n.subscribe(Lt(t,r=>{++i<=e&&(t.next(r),e<=i&&t.complete())}))})}function l_(e){return kt((n,t)=>{let i=!1;n.subscribe(Lt(t,r=>{i=!0,t.next(r)},()=>{i||t.next(e),t.complete()}))})}function zM(e=W3){return kt((n,t)=>{let i=!1;n.subscribe(Lt(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(e())))})}function W3(){return new a_}function Nh(e,n){const t=arguments.length>=2;return i=>i.pipe(e?yc((r,l)=>e(r,l,i)):ut,bp(1),t?l_(n):zM(()=>new a_))}function ia(e,n,t){const i=We(e)||n||t?{next:e,error:n,complete:t}:e;return i?kt((r,l)=>{var h;null===(h=i.subscribe)||void 0===h||h.call(i);let g=!0;r.subscribe(Lt(l,w=>{var E;null===(E=i.next)||void 0===E||E.call(i,w),l.next(w)},()=>{var w;g=!1,null===(w=i.complete)||void 0===w||w.call(i),l.complete()},w=>{var E;g=!1,null===(E=i.error)||void 0===E||E.call(i,w),l.error(w)},()=>{var w,E;g&&(null===(w=i.unsubscribe)||void 0===w||w.call(i)),null===(E=i.finalize)||void 0===E||E.call(i)}))}):ut}function Bh(e){return kt((n,t)=>{let l,i=null,r=!1;i=n.subscribe(Lt(t,void 0,void 0,h=>{l=tn(e(h,Bh(e)(n))),i?(i.unsubscribe(),i=null,l.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,l.subscribe(t))})}function lx(e){return e<=0?()=>Ci:kt((n,t)=>{let i=[];n.subscribe(Lt(t,r=>{i.push(r),e<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}const Si="primary",ug=Symbol("RouteTitle");class Q3{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t[0]:t}return null}getAll(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function wp(e){return new Q3(e)}function ej(e,n,t){const i=t.path.split("/");if(i.length>e.length||"full"===t.pathMatch&&(n.hasChildren()||i.length<e.length))return null;const r={};for(let l=0;l<i.length;l++){const h=i[l],g=e[l];if(h.startsWith(":"))r[h.substring(1)]=g;else if(h!==g.path)return null}return{consumed:e.slice(0,i.length),posParams:r}}function au(e,n){const t=e?Object.keys(e):void 0,i=n?Object.keys(n):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let l=0;l<t.length;l++)if(r=t[l],!$M(e[r],n[r]))return!1;return!0}function $M(e,n){if(Array.isArray(e)&&Array.isArray(n)){if(e.length!==n.length)return!1;const t=[...e].sort(),i=[...n].sort();return t.every((r,l)=>i[l]===r)}return e===n}function VM(e){return e.length>0?e[e.length-1]:null}function jd(e){return function U3(e){return!!e&&(e instanceof gt||We(e.lift)&&We(e.subscribe))}(e)?e:zm(e)?Vi(Promise.resolve(e)):Zn(e)}const nj={exact:function HM(e,n,t){if(!zh(e.segments,n.segments)||!c_(e.segments,n.segments,t)||e.numberOfChildren!==n.numberOfChildren)return!1;for(const i in n.children)if(!e.children[i]||!HM(e.children[i],n.children[i],t))return!1;return!0},subset:qM},jM={exact:function ij(e,n){return au(e,n)},subset:function rj(e,n){return Object.keys(n).length<=Object.keys(e).length&&Object.keys(n).every(t=>$M(e[t],n[t]))},ignored:()=>!0};function UM(e,n,t){return nj[t.paths](e.root,n.root,t.matrixParams)&&jM[t.queryParams](e.queryParams,n.queryParams)&&!("exact"===t.fragment&&e.fragment!==n.fragment)}function qM(e,n,t){return GM(e,n,n.segments,t)}function GM(e,n,t,i){if(e.segments.length>t.length){const r=e.segments.slice(0,t.length);return!(!zh(r,t)||n.hasChildren()||!c_(r,t,i))}if(e.segments.length===t.length){if(!zh(e.segments,t)||!c_(e.segments,t,i))return!1;for(const r in n.children)if(!e.children[r]||!qM(e.children[r],n.children[r],i))return!1;return!0}{const r=t.slice(0,e.segments.length),l=t.slice(e.segments.length);return!!(zh(e.segments,r)&&c_(e.segments,r,i)&&e.children[Si])&&GM(e.children[Si],n,l,i)}}function c_(e,n,t){return n.every((i,r)=>jM[t](e[r].parameters,i.parameters))}class xp{constructor(n=new Nr([],{}),t={},i=null){this.root=n,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=wp(this.queryParams)),this._queryParamMap}toString(){return aj.serialize(this)}}class Nr{constructor(n,t){this.segments=n,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return u_(this)}}class dg{constructor(n,t){this.path=n,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=wp(this.parameters)),this._parameterMap}toString(){return XM(this)}}function zh(e,n){return e.length===n.length&&e.every((t,i)=>t.path===n[i].path)}let Cp=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:function(){return new cx},providedIn:"root"})}return e})();class cx{parse(n){const t=new vj(n);return new xp(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(n){const t=`/${hg(n.root,!0)}`,i=function uj(e){const n=Object.keys(e).map(t=>{const i=e[t];return Array.isArray(i)?i.map(r=>`${d_(t)}=${d_(r)}`).join("&"):`${d_(t)}=${d_(i)}`}).filter(t=>!!t);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${t}${i}${"string"==typeof n.fragment?`#${function lj(e){return encodeURI(e)}(n.fragment)}`:""}`}}const aj=new cx;function u_(e){return e.segments.map(n=>XM(n)).join("/")}function hg(e,n){if(!e.hasChildren())return u_(e);if(n){const t=e.children[Si]?hg(e.children[Si],!1):"",i=[];return Object.entries(e.children).forEach(([r,l])=>{r!==Si&&i.push(`${r}:${hg(l,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function sj(e,n){let t=[];return Object.entries(e.children).forEach(([i,r])=>{i===Si&&(t=t.concat(n(r,i)))}),Object.entries(e.children).forEach(([i,r])=>{i!==Si&&(t=t.concat(n(r,i)))}),t}(e,(i,r)=>r===Si?[hg(e.children[Si],!1)]:[`${r}:${hg(i,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[Si]?`${u_(e)}/${t[0]}`:`${u_(e)}/(${t.join("//")})`}}function WM(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function d_(e){return WM(e).replace(/%3B/gi,";")}function ux(e){return WM(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function h_(e){return decodeURIComponent(e)}function ZM(e){return h_(e.replace(/\+/g,"%20"))}function XM(e){return`${ux(e.path)}${function cj(e){return Object.keys(e).map(n=>`;${ux(n)}=${ux(e[n])}`).join("")}(e.parameters)}`}const dj=/^[^\/()?;#]+/;function dx(e){const n=e.match(dj);return n?n[0]:""}const hj=/^[^\/()?;=#]+/,pj=/^[^=?&#]+/,gj=/^[^&#]+/;class vj{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Nr([],{}):new Nr([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(n.length>0||Object.keys(t).length>0)&&(i[Si]=new Nr(n,t)),i}parseSegment(){const n=dx(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new qe(4009,!1);return this.capture(n),new dg(h_(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const t=function fj(e){const n=e.match(hj);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=dx(this.remaining);r&&(i=r,this.capture(i))}n[h_(t)]=h_(i)}parseQueryParam(n){const t=function mj(e){const n=e.match(pj);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const h=function yj(e){const n=e.match(gj);return n?n[0]:""}(this.remaining);h&&(i=h,this.capture(i))}const r=ZM(t),l=ZM(i);if(n.hasOwnProperty(r)){let h=n[r];Array.isArray(h)||(h=[h],n[r]=h),h.push(l)}else n[r]=l}parseParens(n){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=dx(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new qe(4010,!1);let l;i.indexOf(":")>-1?(l=i.slice(0,i.indexOf(":")),this.capture(l),this.capture(":")):n&&(l=Si);const h=this.parseChildren();t[l]=1===Object.keys(h).length?h[Si]:new Nr([],h),this.consumeOptional("//")}return t}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new qe(4011,!1)}}function KM(e){return e.segments.length>0?new Nr([],{[Si]:e}):e}function YM(e){const n={};for(const i of Object.keys(e.children)){const l=YM(e.children[i]);if(i===Si&&0===l.segments.length&&l.hasChildren())for(const[h,g]of Object.entries(l.children))n[h]=g;else(l.segments.length>0||l.hasChildren())&&(n[i]=l)}return function _j(e){if(1===e.numberOfChildren&&e.children[Si]){const n=e.children[Si];return new Nr(e.segments.concat(n.segments),n.children)}return e}(new Nr(e.segments,n))}function $h(e){return e instanceof xp}function JM(e){let n;const r=KM(function t(l){const h={};for(const w of l.children){const E=t(w);h[w.outlet]=E}const g=new Nr(l.url,h);return l===e&&(n=g),g}(e.root));return n??r}function QM(e,n,t,i){let r=e;for(;r.parent;)r=r.parent;if(0===n.length)return hx(r,r,r,t,i);const l=function wj(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new t2(!0,0,e);let n=0,t=!1;const i=e.reduce((r,l,h)=>{if("object"==typeof l&&null!=l){if(l.outlets){const g={};return Object.entries(l.outlets).forEach(([w,E])=>{g[w]="string"==typeof E?E.split("/"):E}),[...r,{outlets:g}]}if(l.segmentPath)return[...r,l.segmentPath]}return"string"!=typeof l?[...r,l]:0===h?(l.split("/").forEach((g,w)=>{0==w&&"."===g||(0==w&&""===g?t=!0:".."===g?n++:""!=g&&r.push(g))}),r):[...r,l]},[]);return new t2(t,n,i)}(n);if(l.toRoot())return hx(r,r,new Nr([],{}),t,i);const h=function xj(e,n,t){if(e.isAbsolute)return new p_(n,!0,0);if(!t)return new p_(n,!1,NaN);if(null===t.parent)return new p_(t,!0,0);const i=f_(e.commands[0])?0:1;return function Cj(e,n,t){let i=e,r=n,l=t;for(;l>r;){if(l-=r,i=i.parent,!i)throw new qe(4005,!1);r=i.segments.length}return new p_(i,!1,r-l)}(t,t.segments.length-1+i,e.numberOfDoubleDots)}(l,r,e),g=h.processChildren?pg(h.segmentGroup,h.index,l.commands):n2(h.segmentGroup,h.index,l.commands);return hx(r,h.segmentGroup,g,t,i)}function f_(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function fg(e){return"object"==typeof e&&null!=e&&e.outlets}function hx(e,n,t,i,r){let h,l={};i&&Object.entries(i).forEach(([w,E])=>{l[w]=Array.isArray(E)?E.map(k=>`${k}`):`${E}`}),h=e===n?t:e2(e,n,t);const g=KM(YM(h));return new xp(g,l,r)}function e2(e,n,t){const i={};return Object.entries(e.children).forEach(([r,l])=>{i[r]=l===n?t:e2(l,n,t)}),new Nr(e.segments,i)}class t2{constructor(n,t,i){if(this.isAbsolute=n,this.numberOfDoubleDots=t,this.commands=i,n&&i.length>0&&f_(i[0]))throw new qe(4003,!1);const r=i.find(fg);if(r&&r!==VM(i))throw new qe(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class p_{constructor(n,t,i){this.segmentGroup=n,this.processChildren=t,this.index=i}}function n2(e,n,t){if(e||(e=new Nr([],{})),0===e.segments.length&&e.hasChildren())return pg(e,n,t);const i=function Ej(e,n,t){let i=0,r=n;const l={match:!1,pathIndex:0,commandIndex:0};for(;r<e.segments.length;){if(i>=t.length)return l;const h=e.segments[r],g=t[i];if(fg(g))break;const w=`${g}`,E=i<t.length-1?t[i+1]:null;if(r>0&&void 0===w)break;if(w&&E&&"object"==typeof E&&void 0===E.outlets){if(!r2(w,E,h))return l;i+=2}else{if(!r2(w,{},h))return l;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(e,n,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<e.segments.length){const l=new Nr(e.segments.slice(0,i.pathIndex),{});return l.children[Si]=new Nr(e.segments.slice(i.pathIndex),e.children),pg(l,0,r)}return i.match&&0===r.length?new Nr(e.segments,{}):i.match&&!e.hasChildren()?fx(e,n,t):i.match?pg(e,0,r):fx(e,n,t)}function pg(e,n,t){if(0===t.length)return new Nr(e.segments,{});{const i=function Dj(e){return fg(e[0])?e[0].outlets:{[Si]:e}}(t),r={};if(Object.keys(i).some(l=>l!==Si)&&e.children[Si]&&1===e.numberOfChildren&&0===e.children[Si].segments.length){const l=pg(e.children[Si],n,t);return new Nr(e.segments,l.children)}return Object.entries(i).forEach(([l,h])=>{"string"==typeof h&&(h=[h]),null!==h&&(r[l]=n2(e.children[l],n,h))}),Object.entries(e.children).forEach(([l,h])=>{void 0===i[l]&&(r[l]=h)}),new Nr(e.segments,r)}}function fx(e,n,t){const i=e.segments.slice(0,n);let r=0;for(;r<t.length;){const l=t[r];if(fg(l)){const w=Ij(l.outlets);return new Nr(i,w)}if(0===r&&f_(t[0])){i.push(new dg(e.segments[n].path,i2(t[0]))),r++;continue}const h=fg(l)?l.outlets[Si]:`${l}`,g=r<t.length-1?t[r+1]:null;h&&g&&f_(g)?(i.push(new dg(h,i2(g))),r+=2):(i.push(new dg(h,{})),r++)}return new Nr(i,{})}function Ij(e){const n={};return Object.entries(e).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(n[t]=fx(new Nr([],{}),0,i))}),n}function i2(e){const n={};return Object.entries(e).forEach(([t,i])=>n[t]=`${i}`),n}function r2(e,n,t){return e==t.path&&au(n,t.parameters)}const mg="imperative";class lu{constructor(n,t){this.id=n,this.url=t}}class gg extends lu{constructor(n,t,i="imperative",r=null){super(n,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ud extends lu{constructor(n,t,i){super(n,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class yg extends lu{constructor(n,t,i,r){super(n,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Dp extends lu{constructor(n,t,i,r){super(n,t),this.reason=i,this.code=r,this.type=16}}class m_ extends lu{constructor(n,t,i,r){super(n,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class o2 extends lu{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Sj extends lu{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Tj extends lu{constructor(n,t,i,r,l){super(n,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=l,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Aj extends lu{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Mj extends lu{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Pj{constructor(n){this.route=n,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class kj{constructor(n){this.route=n,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Rj{constructor(n){this.snapshot=n,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Oj{constructor(n){this.snapshot=n,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Fj{constructor(n){this.snapshot=n,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Lj{constructor(n){this.snapshot=n,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class s2{constructor(n,t,i){this.routerEvent=n,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class px{}class mx{constructor(n){this.url=n}}class Nj{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Vh,this.attachRef=null}}let Vh=(()=>{class e{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Nj,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class a2{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const t=this.pathFromRoot(n);return t.length>1?t[t.length-2]:null}children(n){const t=gx(n,this._root);return t?t.children.map(i=>i.value):[]}firstChild(n){const t=gx(n,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(n){const t=yx(n,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==n)}pathFromRoot(n){return yx(n,this._root).map(t=>t.value)}}function gx(e,n){if(e===n.value)return n;for(const t of n.children){const i=gx(e,t);if(i)return i}return null}function yx(e,n){if(e===n.value)return[n];for(const t of n.children){const i=yx(e,t);if(i.length)return i.unshift(n),i}return[]}class Gu{constructor(n,t){this.value=n,this.children=t}toString(){return`TreeNode(${this.value})`}}function Ep(e){const n={};return e&&e.children.forEach(t=>n[t.value.outlet]=t),n}class l2 extends a2{constructor(n,t){super(n),this.snapshot=t,vx(this,n)}toString(){return this.snapshot.toString()}}function c2(e,n){const t=function Bj(e,n){const h=new g_([],{},{},"",{},Si,n,null,{});return new d2("",new Gu(h,[]))}(0,n),i=new ti([new dg("",{})]),r=new ti({}),l=new ti({}),h=new ti({}),g=new ti(""),w=new vc(i,r,h,g,l,Si,n,t.root);return w.snapshot=t.root,new l2(new Gu(w,[]),t)}class vc{constructor(n,t,i,r,l,h,g,w){this.urlSubject=n,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=l,this.outlet=h,this.component=g,this._futureSnapshot=w,this.title=this.dataSubject?.pipe(mn(E=>E[ug]))??Zn(void 0),this.url=n,this.params=t,this.queryParams=i,this.fragment=r,this.data=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(mn(n=>wp(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(mn(n=>wp(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function u2(e,n="emptyOnly"){const t=e.pathFromRoot;let i=0;if("always"!==n)for(i=t.length-1;i>=1;){const r=t[i],l=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(l.component)break;i--}}return function zj(e){return e.reduce((n,t)=>({params:{...n.params,...t.params},data:{...n.data,...t.data},resolve:{...t.data,...n.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class g_{get title(){return this.data?.[ug]}constructor(n,t,i,r,l,h,g,w,E){this.url=n,this.params=t,this.queryParams=i,this.fragment=r,this.data=l,this.outlet=h,this.component=g,this.routeConfig=w,this._resolve=E}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=wp(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=wp(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class d2 extends a2{constructor(n,t){super(t),this.url=n,vx(this,t)}toString(){return h2(this._root)}}function vx(e,n){n.value._routerState=e,n.children.forEach(t=>vx(e,t))}function h2(e){const n=e.children.length>0?` { ${e.children.map(h2).join(", ")} } `:"";return`${e.value}${n}`}function _x(e){if(e.snapshot){const n=e.snapshot,t=e._futureSnapshot;e.snapshot=t,au(n.queryParams,t.queryParams)||e.queryParamsSubject.next(t.queryParams),n.fragment!==t.fragment&&e.fragmentSubject.next(t.fragment),au(n.params,t.params)||e.paramsSubject.next(t.params),function tj(e,n){if(e.length!==n.length)return!1;for(let t=0;t<e.length;++t)if(!au(e[t],n[t]))return!1;return!0}(n.url,t.url)||e.urlSubject.next(t.url),au(n.data,t.data)||e.dataSubject.next(t.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function bx(e,n){const t=au(e.params,n.params)&&function oj(e,n){return zh(e,n)&&e.every((t,i)=>au(t.parameters,n[i].parameters))}(e.url,n.url);return t&&!(!e.parent!=!n.parent)&&(!e.parent||bx(e.parent,n.parent))}let wx=(()=>{class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=Si,this.activateEvents=new Vr,this.deactivateEvents=new Vr,this.attachEvents=new Vr,this.detachEvents=new Vr,this.parentContexts=Ft(Vh),this.location=Ft(tl),this.changeDetector=Ft(Wt),this.environmentInjector=Ft(Ts),this.inputBinder=Ft(y_,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new qe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new qe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new qe(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new qe(4013,!1);this._activatedRoute=t;const r=this.location,h=t.snapshot.component,g=this.parentContexts.getOrCreateContext(this.name).children,w=new $j(t,g,r.injector);this.activated=r.createComponent(h,{index:r.length,injector:w,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=yn({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Bi]})}return e})();class $j{constructor(n,t,i){this.route=n,this.childContexts=t,this.parent=i}get(n,t){return n===vc?this.route:n===Vh?this.childContexts:this.parent.get(n,t)}}const y_=new ln("");let f2=(()=>{class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=s_([i.queryParams,i.params,i.data]).pipe(jn(([l,h,g],w)=>(g={...l,...h,...g},0===w?Zn(g):Promise.resolve(g)))).subscribe(l=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const h=wT(i.component);if(h)for(const{templateName:g}of h.inputs)t.activatedComponentRef.setInput(g,l[g]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();function vg(e,n,t){if(t&&e.shouldReuseRoute(n.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=n.value;const r=function jj(e,n,t){return n.children.map(i=>{for(const r of t.children)if(e.shouldReuseRoute(i.value,r.value.snapshot))return vg(e,i,r);return vg(e,i)})}(e,n,t);return new Gu(i,r)}{if(e.shouldAttach(n.value)){const l=e.retrieve(n.value);if(null!==l){const h=l.route;return h.value._futureSnapshot=n.value,h.children=n.children.map(g=>vg(e,g)),h}}const i=function Uj(e){return new vc(new ti(e.url),new ti(e.params),new ti(e.queryParams),new ti(e.fragment),new ti(e.data),e.outlet,e.component,e)}(n.value),r=n.children.map(l=>vg(e,l));return new Gu(i,r)}}const xx="ngNavigationCancelingError";function p2(e,n){const{redirectTo:t,navigationBehaviorOptions:i}=$h(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,r=m2(!1,0,n);return r.url=t,r.navigationBehaviorOptions=i,r}function m2(e,n,t){const i=new Error("NavigationCancelingError: "+(e||""));return i[xx]=!0,i.cancellationCode=n,t&&(i.url=t),i}function g2(e){return e&&e[xx]}let y2=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Pt({type:e,selectors:[["ng-component"]],standalone:!0,features:[gv],decls:1,vars:0,template:function(i,r){1&i&&kl(0,"router-outlet")},dependencies:[wx],encapsulation:2})}return e})();function Cx(e){const n=e.children&&e.children.map(Cx),t=n?{...e,children:n}:{...e};return!t.component&&!t.loadComponent&&(n||t.loadChildren)&&t.outlet&&t.outlet!==Si&&(t.component=y2),t}function _c(e){return e.outlet||Si}function _g(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let n=e.parent;n;n=n.parent){const t=n.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class Yj{constructor(n,t,i,r,l){this.routeReuseStrategy=n,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=l}activate(n){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,n),_x(this.futureState.root),this.activateChildRoutes(t,i,n)}deactivateChildRoutes(n,t,i){const r=Ep(t);n.children.forEach(l=>{const h=l.value.outlet;this.deactivateRoutes(l,r[h],i),delete r[h]}),Object.values(r).forEach(l=>{this.deactivateRouteAndItsChildren(l,i)})}deactivateRoutes(n,t,i){const r=n.value,l=t?t.value:null;if(r===l)if(r.component){const h=i.getContext(r.outlet);h&&this.deactivateChildRoutes(n,t,h.children)}else this.deactivateChildRoutes(n,t,i);else l&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(n,t){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,t):this.deactivateRouteAndOutlet(n,t)}detachAndStoreRouteSubtree(n,t){const i=t.getContext(n.value.outlet),r=i&&n.value.component?i.children:t,l=Ep(n);for(const h of Object.keys(l))this.deactivateRouteAndItsChildren(l[h],r);if(i&&i.outlet){const h=i.outlet.detach(),g=i.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:h,route:n,contexts:g})}}deactivateRouteAndOutlet(n,t){const i=t.getContext(n.value.outlet),r=i&&n.value.component?i.children:t,l=Ep(n);for(const h of Object.keys(l))this.deactivateRouteAndItsChildren(l[h],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(n,t,i){const r=Ep(t);n.children.forEach(l=>{this.activateRoutes(l,r[l.value.outlet],i),this.forwardEvent(new Lj(l.value.snapshot))}),n.children.length&&this.forwardEvent(new Oj(n.value.snapshot))}activateRoutes(n,t,i){const r=n.value,l=t?t.value:null;if(_x(r),r===l)if(r.component){const h=i.getOrCreateContext(r.outlet);this.activateChildRoutes(n,t,h.children)}else this.activateChildRoutes(n,t,i);else if(r.component){const h=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const g=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),h.children.onOutletReAttached(g.contexts),h.attachRef=g.componentRef,h.route=g.route.value,h.outlet&&h.outlet.attach(g.componentRef,g.route.value),_x(g.route.value),this.activateChildRoutes(n,null,h.children)}else{const g=_g(r.snapshot);h.attachRef=null,h.route=r,h.injector=g,h.outlet&&h.outlet.activateWith(r,h.injector),this.activateChildRoutes(n,null,h.children)}}else this.activateChildRoutes(n,null,i)}}class v2{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class v_{constructor(n,t){this.component=n,this.route=t}}function Jj(e,n,t){const i=e._root;return bg(i,n?n._root:null,t,[i.value])}function Ip(e,n){const t=Symbol(),i=n.get(e,t);return i===t?"function"!=typeof e||function An(e){return null!==nn(e)}(e)?n.get(e):e:i}function bg(e,n,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const l=Ep(n);return e.children.forEach(h=>{(function e4(e,n,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const l=e.value,h=n?n.value:null,g=t?t.getContext(e.value.outlet):null;if(h&&l.routeConfig===h.routeConfig){const w=function t4(e,n,t){if("function"==typeof t)return t(e,n);switch(t){case"pathParamsChange":return!zh(e.url,n.url);case"pathParamsOrQueryParamsChange":return!zh(e.url,n.url)||!au(e.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!bx(e,n)||!au(e.queryParams,n.queryParams);default:return!bx(e,n)}}(h,l,l.routeConfig.runGuardsAndResolvers);w?r.canActivateChecks.push(new v2(i)):(l.data=h.data,l._resolvedData=h._resolvedData),bg(e,n,l.component?g?g.children:null:t,i,r),w&&g&&g.outlet&&g.outlet.isActivated&&r.canDeactivateChecks.push(new v_(g.outlet.component,h))}else h&&wg(n,g,r),r.canActivateChecks.push(new v2(i)),bg(e,null,l.component?g?g.children:null:t,i,r)})(h,l[h.value.outlet],t,i.concat([h.value]),r),delete l[h.value.outlet]}),Object.entries(l).forEach(([h,g])=>wg(g,t.getContext(h),r)),r}function wg(e,n,t){const i=Ep(e),r=e.value;Object.entries(i).forEach(([l,h])=>{wg(h,r.component?n?n.children.getContext(l):null:n,t)}),t.canDeactivateChecks.push(new v_(r.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,r))}function xg(e){return"function"==typeof e}function _2(e){return e instanceof a_||"EmptyError"===e?.name}const __=Symbol("INITIAL_VALUE");function Sp(){return jn(e=>s_(e.map(n=>n.pipe(bp(1),function G3(...e){const n=kr(e);return kt((t,i)=>{(n?sx(e,t,n):sx(e,t)).subscribe(i)})}(__)))).pipe(mn(n=>{for(const t of n)if(!0!==t){if(t===__)return __;if(!1===t||t instanceof xp)return t}return!0}),yc(n=>n!==__),bp(1)))}function b2(e){return function Gn(...e){return Nt(e)}(ia(n=>{if($h(n))throw p2(0,n)}),mn(n=>!0===n))}class b_{constructor(n){this.segmentGroup=n||null}}class w2{constructor(n){this.urlTree=n}}function Tp(e){return cg(new b_(e))}function x2(e){return cg(new w2(e))}class w4{constructor(n,t){this.urlSerializer=n,this.urlTree=t}noMatchError(n){return new qe(4002,!1)}lineralizeSegments(n,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Zn(i);if(r.numberOfChildren>1||!r.children[Si])return cg(new qe(4e3,!1));r=r.children[Si]}}applyRedirectCommands(n,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),n,i)}applyRedirectCreateUrlTree(n,t,i,r){const l=this.createSegmentGroup(n,t.root,i,r);return new xp(l,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(n,t){const i={};return Object.entries(n).forEach(([r,l])=>{if("string"==typeof l&&l.startsWith(":")){const g=l.substring(1);i[r]=t[g]}else i[r]=l}),i}createSegmentGroup(n,t,i,r){const l=this.createSegments(n,t.segments,i,r);let h={};return Object.entries(t.children).forEach(([g,w])=>{h[g]=this.createSegmentGroup(n,w,i,r)}),new Nr(l,h)}createSegments(n,t,i,r){return t.map(l=>l.path.startsWith(":")?this.findPosParam(n,l,r):this.findOrReturn(l,i))}findPosParam(n,t,i){const r=i[t.path.substring(1)];if(!r)throw new qe(4001,!1);return r}findOrReturn(n,t){let i=0;for(const r of t){if(r.path===n.path)return t.splice(i),r;i++}return n}}const Dx={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function x4(e,n,t,i,r){const l=Ex(e,n,t);return l.matched?(i=function qj(e,n){return e.providers&&!e._injector&&(e._injector=M0(e.providers,n,`Route: ${e.path}`)),e._injector??n}(n,i),function v4(e,n,t,i){const r=n.canMatch;return r&&0!==r.length?Zn(r.map(h=>{const g=Ip(h,e);return jd(function a4(e){return e&&xg(e.canMatch)}(g)?g.canMatch(n,t):e.runInContext(()=>g(n,t)))})).pipe(Sp(),b2()):Zn(!0)}(i,n,t).pipe(mn(h=>!0===h?l:{...Dx}))):Zn(l)}function Ex(e,n,t){if(""===n.path)return"full"===n.pathMatch&&(e.hasChildren()||t.length>0)?{...Dx}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(n.matcher||ej)(t,e,n);if(!r)return{...Dx};const l={};Object.entries(r.posParams??{}).forEach(([g,w])=>{l[g]=w.path});const h=r.consumed.length>0?{...l,...r.consumed[r.consumed.length-1].parameters}:l;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:h,positionalParamSegments:r.posParams??{}}}function C2(e,n,t,i){return t.length>0&&function E4(e,n,t){return t.some(i=>w_(e,n,i)&&_c(i)!==Si)}(e,t,i)?{segmentGroup:new Nr(n,D4(i,new Nr(t,e.children))),slicedSegments:[]}:0===t.length&&function I4(e,n,t){return t.some(i=>w_(e,n,i))}(e,t,i)?{segmentGroup:new Nr(e.segments,C4(e,0,t,i,e.children)),slicedSegments:t}:{segmentGroup:new Nr(e.segments,e.children),slicedSegments:t}}function C4(e,n,t,i,r){const l={};for(const h of i)if(w_(e,t,h)&&!r[_c(h)]){const g=new Nr([],{});l[_c(h)]=g}return{...r,...l}}function D4(e,n){const t={};t[Si]=n;for(const i of e)if(""===i.path&&_c(i)!==Si){const r=new Nr([],{});t[_c(i)]=r}return t}function w_(e,n,t){return(!(e.hasChildren()||n.length>0)||"full"!==t.pathMatch)&&""===t.path}class M4{constructor(n,t,i,r,l,h,g){this.injector=n,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=l,this.paramsInheritanceStrategy=h,this.urlSerializer=g,this.allowRedirects=!0,this.applyRedirects=new w4(this.urlSerializer,this.urlTree)}noMatchError(n){return new qe(4002,!1)}recognize(){const n=C2(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,n,Si).pipe(Bh(t=>{if(t instanceof w2)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof b_?this.noMatchError(t):t}),mn(t=>{const i=new g_([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Si,this.rootComponentType,null,{}),r=new Gu(i,t),l=new d2("",r),h=function bj(e,n,t=null,i=null){return QM(JM(e),n,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return h.queryParams=this.urlTree.queryParams,l.url=this.urlSerializer.serialize(h),this.inheritParamsAndData(l._root),{state:l,tree:h}}))}match(n){return this.processSegmentGroup(this.injector,this.config,n.root,Si).pipe(Bh(i=>{throw i instanceof b_?this.noMatchError(i):i}))}inheritParamsAndData(n){const t=n.value,i=u2(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),n.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(n,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(n,t,i):this.processSegment(n,t,i,i.segments,r,!0)}processChildren(n,t,i){const r=[];for(const l of Object.keys(i.children))"primary"===l?r.unshift(l):r.push(l);return Vi(r).pipe(yp(l=>{const h=i.children[l],g=function Xj(e,n){const t=e.filter(i=>_c(i)===n);return t.push(...e.filter(i=>_c(i)!==n)),t}(t,l);return this.processSegmentGroup(n,g,h,l)}),function X3(e,n){return kt(function Z3(e,n,t,i,r){return(l,h)=>{let g=t,w=n,E=0;l.subscribe(Lt(h,k=>{const $=E++;w=g?e(w,k,$):(g=!0,k),i&&h.next(w)},r&&(()=>{g&&h.next(w),h.complete()})))}}(e,n,arguments.length>=2,!0))}((l,h)=>(l.push(...h),l)),l_(null),function K3(e,n){const t=arguments.length>=2;return i=>i.pipe(e?yc((r,l)=>e(r,l,i)):ut,lx(1),t?l_(n):zM(()=>new a_))}(),mi(l=>{if(null===l)return Tp(i);const h=D2(l);return function P4(e){e.sort((n,t)=>n.value.outlet===Si?-1:t.value.outlet===Si?1:n.value.outlet.localeCompare(t.value.outlet))}(h),Zn(h)}))}processSegment(n,t,i,r,l,h){return Vi(t).pipe(yp(g=>this.processSegmentAgainstRoute(g._injector??n,t,g,i,r,l,h).pipe(Bh(w=>{if(w instanceof b_)return Zn(null);throw w}))),Nh(g=>!!g),Bh(g=>{if(_2(g))return function T4(e,n,t){return 0===n.length&&!e.children[t]}(i,r,l)?Zn([]):Tp(i);throw g}))}processSegmentAgainstRoute(n,t,i,r,l,h,g){return function S4(e,n,t,i){return!!(_c(e)===i||i!==Si&&w_(n,t,e))&&("**"===e.path||Ex(n,e,t).matched)}(i,r,l,h)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(n,r,i,l,h,g):g&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,r,t,i,l,h):Tp(r):Tp(r)}expandSegmentAgainstRouteUsingRedirect(n,t,i,r,l,h){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,i,r,h):this.expandRegularSegmentAgainstRouteUsingRedirect(n,t,i,r,l,h)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,t,i,r){const l=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?x2(l):this.applyRedirects.lineralizeSegments(i,l).pipe(mi(h=>{const g=new Nr(h,{});return this.processSegment(n,t,g,h,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,t,i,r,l,h){const{matched:g,consumedSegments:w,remainingSegments:E,positionalParamSegments:k}=Ex(t,r,l);if(!g)return Tp(t);const $=this.applyRedirects.applyRedirectCommands(w,r.redirectTo,k);return r.redirectTo.startsWith("/")?x2($):this.applyRedirects.lineralizeSegments(r,$).pipe(mi(te=>this.processSegment(n,i,t,te.concat(E),h,!1)))}matchSegmentAgainstRoute(n,t,i,r,l,h){let g;if("**"===i.path){const w=r.length>0?VM(r).parameters:{};g=Zn({snapshot:new g_(r,w,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,E2(i),_c(i),i.component??i._loadedComponent??null,i,I2(i)),consumedSegments:[],remainingSegments:[]}),t.children={}}else g=x4(t,i,r,n).pipe(mn(({matched:w,consumedSegments:E,remainingSegments:k,parameters:$})=>w?{snapshot:new g_(E,$,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,E2(i),_c(i),i.component??i._loadedComponent??null,i,I2(i)),consumedSegments:E,remainingSegments:k}:null));return g.pipe(jn(w=>null===w?Tp(t):this.getChildConfig(n=i._injector??n,i,r).pipe(jn(({routes:E})=>{const k=i._loadedInjector??n,{snapshot:$,consumedSegments:te,remainingSegments:ie}=w,{segmentGroup:we,slicedSegments:Se}=C2(t,te,ie,E);if(0===Se.length&&we.hasChildren())return this.processChildren(k,E,we).pipe(mn(dt=>null===dt?null:[new Gu($,dt)]));if(0===E.length&&0===Se.length)return Zn([new Gu($,[])]);const je=_c(i)===l;return this.processSegment(k,E,we,Se,je?Si:l,!0).pipe(mn(dt=>[new Gu($,dt)]))}))))}getChildConfig(n,t,i){return t.children?Zn({routes:t.children,injector:n}):t.loadChildren?void 0!==t._loadedRoutes?Zn({routes:t._loadedRoutes,injector:t._loadedInjector}):function y4(e,n,t,i){const r=n.canLoad;return void 0===r||0===r.length?Zn(!0):Zn(r.map(h=>{const g=Ip(h,e);return jd(function i4(e){return e&&xg(e.canLoad)}(g)?g.canLoad(n,t):e.runInContext(()=>g(n,t)))})).pipe(Sp(),b2())}(n,t,i).pipe(mi(r=>r?this.configLoader.loadChildren(n,t).pipe(ia(l=>{t._loadedRoutes=l.routes,t._loadedInjector=l.injector})):function b4(e){return cg(m2(!1,3))}())):Zn({routes:[],injector:n})}}function k4(e){const n=e.value.routeConfig;return n&&""===n.path}function D2(e){const n=[],t=new Set;for(const i of e){if(!k4(i)){n.push(i);continue}const r=n.find(l=>i.value.routeConfig===l.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):n.push(i)}for(const i of t){const r=D2(i.children);n.push(new Gu(i.value,r))}return n.filter(i=>!t.has(i))}function E2(e){return e.data||{}}function I2(e){return e.resolve||{}}function S2(e){return"string"==typeof e.title||null===e.title}function Ix(e){return jn(n=>{const t=e(n);return t?Vi(t).pipe(mn(()=>n)):Zn(n)})}const Ap=new ln("ROUTES");let Sx=(()=>{class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Ft($S)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Zn(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=jd(t.loadComponent()).pipe(mn(T2),ia(l=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=l}),sg(()=>{this.componentLoaders.delete(t)})),r=new BM(i,()=>new Z).pipe(ax());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Zn({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const l=function z4(e,n,t,i){return jd(e.loadChildren()).pipe(mn(T2),mi(r=>r instanceof KI||Array.isArray(r)?Zn(r):Vi(n.compileModuleAsync(r))),mn(r=>{i&&i(e);let l,h,g=!1;return Array.isArray(r)?(h=r,!0):(l=r.create(t).injector,h=l.get(Ap,[],{optional:!0,self:!0}).flat()),{routes:h.map(Cx),injector:l}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(sg(()=>{this.childrenLoaders.delete(i)})),h=new BM(l,()=>new Z).pipe(ax());return this.childrenLoaders.set(i,h),h}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function T2(e){return function $4(e){return e&&"object"==typeof e&&"default"in e}(e)?e.default:e}let x_=(()=>{class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Z,this.transitionAbortSubject=new Z,this.configLoader=Ft(Sx),this.environmentInjector=Ft(Ts),this.urlSerializer=Ft(Cp),this.rootContexts=Ft(Vh),this.inputBindingEnabled=null!==Ft(y_,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Zn(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new kj(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new Pj(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new ti({id:0,currentUrlTree:i,currentRawUrl:i,currentBrowserUrl:i,extractedUrl:t.urlHandlingStrategy.extract(i),urlAfterRedirects:t.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:mg,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(yc(l=>0!==l.id),mn(l=>({...l,extractedUrl:t.urlHandlingStrategy.extract(l.rawUrl)})),jn(l=>{this.currentTransition=l;let h=!1,g=!1;return Zn(l).pipe(ia(w=>{this.currentNavigation={id:w.id,initialUrl:w.rawUrl,extractedUrl:w.extractedUrl,trigger:w.source,extras:w.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),jn(w=>{const E=w.currentBrowserUrl.toString(),k=!t.navigated||w.extractedUrl.toString()!==E||E!==w.currentUrlTree.toString();if(!k&&"reload"!==(w.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const te="";return this.events.next(new Dp(w.id,this.urlSerializer.serialize(w.rawUrl),te,0)),w.resolve(null),Ci}if(t.urlHandlingStrategy.shouldProcessUrl(w.rawUrl))return Zn(w).pipe(jn(te=>{const ie=this.transitions?.getValue();return this.events.next(new gg(te.id,this.urlSerializer.serialize(te.extractedUrl),te.source,te.restoredState)),ie!==this.transitions?.getValue()?Ci:Promise.resolve(te)}),function R4(e,n,t,i,r,l){return mi(h=>function A4(e,n,t,i,r,l,h="emptyOnly"){return new M4(e,n,t,i,r,h,l).recognize()}(e,n,t,i,h.extractedUrl,r,l).pipe(mn(({state:g,tree:w})=>({...h,targetSnapshot:g,urlAfterRedirects:w}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),ia(te=>{l.targetSnapshot=te.targetSnapshot,l.urlAfterRedirects=te.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:te.urlAfterRedirects};const ie=new o2(te.id,this.urlSerializer.serialize(te.extractedUrl),this.urlSerializer.serialize(te.urlAfterRedirects),te.targetSnapshot);this.events.next(ie)}));if(k&&t.urlHandlingStrategy.shouldProcessUrl(w.currentRawUrl)){const{id:te,extractedUrl:ie,source:we,restoredState:Se,extras:je}=w,dt=new gg(te,this.urlSerializer.serialize(ie),we,Se);this.events.next(dt);const Ue=c2(0,this.rootComponentType).snapshot;return this.currentTransition=l={...w,targetSnapshot:Ue,urlAfterRedirects:ie,extras:{...je,skipLocationChange:!1,replaceUrl:!1}},Zn(l)}{const te="";return this.events.next(new Dp(w.id,this.urlSerializer.serialize(w.extractedUrl),te,1)),w.resolve(null),Ci}}),ia(w=>{const E=new Sj(w.id,this.urlSerializer.serialize(w.extractedUrl),this.urlSerializer.serialize(w.urlAfterRedirects),w.targetSnapshot);this.events.next(E)}),mn(w=>(this.currentTransition=l={...w,guards:Jj(w.targetSnapshot,w.currentSnapshot,this.rootContexts)},l)),function c4(e,n){return mi(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:l,canDeactivateChecks:h}}=t;return 0===h.length&&0===l.length?Zn({...t,guardsResult:!0}):function u4(e,n,t,i){return Vi(e).pipe(mi(r=>function g4(e,n,t,i,r){const l=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return l&&0!==l.length?Zn(l.map(g=>{const w=_g(n)??r,E=Ip(g,w);return jd(function s4(e){return e&&xg(e.canDeactivate)}(E)?E.canDeactivate(e,n,t,i):w.runInContext(()=>E(e,n,t,i))).pipe(Nh())})).pipe(Sp()):Zn(!0)}(r.component,r.route,t,n,i)),Nh(r=>!0!==r,!0))}(h,i,r,e).pipe(mi(g=>g&&function n4(e){return"boolean"==typeof e}(g)?function d4(e,n,t,i){return Vi(n).pipe(yp(r=>sx(function f4(e,n){return null!==e&&n&&n(new Rj(e)),Zn(!0)}(r.route.parent,i),function h4(e,n){return null!==e&&n&&n(new Fj(e)),Zn(!0)}(r.route,i),function m4(e,n,t){const i=n[n.length-1],l=n.slice(0,n.length-1).reverse().map(h=>function Qj(e){const n=e.routeConfig?e.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:e,guards:n}:null}(h)).filter(h=>null!==h).map(h=>NM(()=>Zn(h.guards.map(w=>{const E=_g(h.node)??t,k=Ip(w,E);return jd(function o4(e){return e&&xg(e.canActivateChild)}(k)?k.canActivateChild(i,e):E.runInContext(()=>k(i,e))).pipe(Nh())})).pipe(Sp())));return Zn(l).pipe(Sp())}(e,r.path,t),function p4(e,n,t){const i=n.routeConfig?n.routeConfig.canActivate:null;if(!i||0===i.length)return Zn(!0);const r=i.map(l=>NM(()=>{const h=_g(n)??t,g=Ip(l,h);return jd(function r4(e){return e&&xg(e.canActivate)}(g)?g.canActivate(n,e):h.runInContext(()=>g(n,e))).pipe(Nh())}));return Zn(r).pipe(Sp())}(e,r.route,t))),Nh(r=>!0!==r,!0))}(i,l,e,n):Zn(g)),mn(g=>({...t,guardsResult:g})))})}(this.environmentInjector,w=>this.events.next(w)),ia(w=>{if(l.guardsResult=w.guardsResult,$h(w.guardsResult))throw p2(0,w.guardsResult);const E=new Tj(w.id,this.urlSerializer.serialize(w.extractedUrl),this.urlSerializer.serialize(w.urlAfterRedirects),w.targetSnapshot,!!w.guardsResult);this.events.next(E)}),yc(w=>!!w.guardsResult||(this.cancelNavigationTransition(w,"",3),!1)),Ix(w=>{if(w.guards.canActivateChecks.length)return Zn(w).pipe(ia(E=>{const k=new Aj(E.id,this.urlSerializer.serialize(E.extractedUrl),this.urlSerializer.serialize(E.urlAfterRedirects),E.targetSnapshot);this.events.next(k)}),jn(E=>{let k=!1;return Zn(E).pipe(function O4(e,n){return mi(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return Zn(t);let l=0;return Vi(r).pipe(yp(h=>function F4(e,n,t,i){const r=e.routeConfig,l=e._resolve;return void 0!==r?.title&&!S2(r)&&(l[ug]=r.title),function L4(e,n,t,i){const r=function N4(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}(e);if(0===r.length)return Zn({});const l={};return Vi(r).pipe(mi(h=>function B4(e,n,t,i){const r=_g(n)??i,l=Ip(e,r);return jd(l.resolve?l.resolve(n,t):r.runInContext(()=>l(n,t)))}(e[h],n,t,i).pipe(Nh(),ia(g=>{l[h]=g}))),lx(1),function Y3(e){return mn(()=>e)}(l),Bh(h=>_2(h)?Ci:cg(h)))}(l,e,n,i).pipe(mn(h=>(e._resolvedData=h,e.data=u2(e,t).resolve,r&&S2(r)&&(e.data[ug]=r.title),null)))}(h.route,i,e,n)),ia(()=>l++),lx(1),mi(h=>l===r.length?Zn(t):Ci))})}(t.paramsInheritanceStrategy,this.environmentInjector),ia({next:()=>k=!0,complete:()=>{k||this.cancelNavigationTransition(E,"",2)}}))}),ia(E=>{const k=new Mj(E.id,this.urlSerializer.serialize(E.extractedUrl),this.urlSerializer.serialize(E.urlAfterRedirects),E.targetSnapshot);this.events.next(k)}))}),Ix(w=>{const E=k=>{const $=[];k.routeConfig?.loadComponent&&!k.routeConfig._loadedComponent&&$.push(this.configLoader.loadComponent(k.routeConfig).pipe(ia(te=>{k.component=te}),mn(()=>{})));for(const te of k.children)$.push(...E(te));return $};return s_(E(w.targetSnapshot.root)).pipe(l_(),bp(1))}),Ix(()=>this.afterPreactivation()),mn(w=>{const E=function Vj(e,n,t){const i=vg(e,n._root,t?t._root:void 0);return new l2(i,n)}(t.routeReuseStrategy,w.targetSnapshot,w.currentRouterState);return this.currentTransition=l={...w,targetRouterState:E},l}),ia(()=>{this.events.next(new px)}),((e,n,t,i)=>mn(r=>(new Yj(n,r.targetRouterState,r.currentRouterState,t,i).activate(e),r)))(this.rootContexts,t.routeReuseStrategy,w=>this.events.next(w),this.inputBindingEnabled),bp(1),ia({next:w=>{h=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ud(w.id,this.urlSerializer.serialize(w.extractedUrl),this.urlSerializer.serialize(w.urlAfterRedirects))),t.titleStrategy?.updateTitle(w.targetRouterState.snapshot),w.resolve(!0)},complete:()=>{h=!0}}),function J3(e){return kt((n,t)=>{tn(e).subscribe(Lt(t,()=>t.complete(),Mt)),!t.closed&&n.subscribe(t)})}(this.transitionAbortSubject.pipe(ia(w=>{throw w}))),sg(()=>{h||g||this.cancelNavigationTransition(l,"",1),this.currentNavigation?.id===l.id&&(this.currentNavigation=null)}),Bh(w=>{if(g=!0,g2(w))this.events.next(new yg(l.id,this.urlSerializer.serialize(l.extractedUrl),w.message,w.cancellationCode)),function Hj(e){return g2(e)&&$h(e.url)}(w)?this.events.next(new mx(w.url)):l.resolve(!1);else{this.events.next(new m_(l.id,this.urlSerializer.serialize(l.extractedUrl),w,l.targetSnapshot??void 0));try{l.resolve(t.errorHandler(w))}catch(E){l.reject(E)}}return Ci}))}))}cancelNavigationTransition(t,i,r){const l=new yg(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(l),t.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function A2(e){return e!==mg}let M2=(()=>{class e{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(l=>l.outlet===Si);return i}getResolvedTitleForRoute(t){return t.data[ug]}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:function(){return Ft(V4)},providedIn:"root"})}return e})(),V4=(()=>{class e extends M2{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(lA))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),j4=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:function(){return Ft(H4)},providedIn:"root"})}return e})();class U4{shouldDetach(n){return!1}store(n,t){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,t){return n.routeConfig===t.routeConfig}}let H4=(()=>{class e extends U4{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=Gr(e)))(r||e)}}();static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const C_=new ln("",{providedIn:"root",factory:()=>({})});let q4=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:function(){return Ft(G4)},providedIn:"root"})}return e})(),G4=(()=>{class e{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Cg=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(Cg||{});function P2(e,n){e.events.pipe(yc(t=>t instanceof Ud||t instanceof yg||t instanceof m_||t instanceof Dp),mn(t=>t instanceof Ud||t instanceof Dp?Cg.COMPLETE:t instanceof yg&&(0===t.code||1===t.code)?Cg.REDIRECTING:Cg.FAILED),yc(t=>t!==Cg.REDIRECTING),bp(1)).subscribe(()=>{n()})}function W4(e){throw e}function Z4(e,n,t){return n.parse("/")}const X4={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},K4={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let No=(()=>{class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Ft(zS),this.isNgZoneEnabled=!1,this._events=new Z,this.options=Ft(C_,{optional:!0})||{},this.pendingTasks=Ft(xv),this.errorHandler=this.options.errorHandler||W4,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Z4,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Ft(q4),this.routeReuseStrategy=Ft(j4),this.titleStrategy=Ft(M2),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=Ft(Ap,{optional:!0})?.flat()??[],this.navigationTransitions=Ft(x_),this.urlSerializer=Ft(Cp),this.location=Ft(fp),this.componentInputBindingEnabled=!!Ft(y_,{optional:!0}),this.eventsSubscription=new an,this.isNgZoneEnabled=Ft(vt)instanceof vt&&vt.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new xp,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=c2(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const{currentTransition:r}=this.navigationTransitions;if(null===r)return void(k2(i)&&this._events.next(i));if(i instanceof gg)A2(r.source)&&(this.browserUrlTree=r.extractedUrl);else if(i instanceof Dp)this.rawUrlTree=r.rawUrl;else if(i instanceof o2){if("eager"===this.urlUpdateStrategy){if(!r.extras.skipLocationChange){const l=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl);this.setBrowserUrl(l,r)}this.browserUrlTree=r.urlAfterRedirects}}else if(i instanceof px)this.currentUrlTree=r.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r),this.browserUrlTree=r.urlAfterRedirects);else if(i instanceof yg)0!==i.code&&1!==i.code&&(this.navigated=!0),(3===i.code||2===i.code)&&this.restoreHistory(r);else if(i instanceof mx){const l=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),h={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||A2(r.source)};this.scheduleNavigation(l,mg,null,h,{resolve:r.resolve,reject:r.reject,promise:r.promise})}i instanceof m_&&this.restoreHistory(r,!0),i instanceof Ud&&(this.navigated=!0),k2(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),mg,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const l={replaceUrl:!0},h=r?.navigationId?r:null;if(r){const w={...r};delete w.navigationId,delete w.\u0275routerPageId,0!==Object.keys(w).length&&(l.state=w)}const g=this.parseUrl(t);this.scheduleNavigation(g,i,h,l)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Cx),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:l,fragment:h,queryParamsHandling:g,preserveFragment:w}=i,E=w?this.currentUrlTree.fragment:h;let $,k=null;switch(g){case"merge":k={...this.currentUrlTree.queryParams,...l};break;case"preserve":k=this.currentUrlTree.queryParams;break;default:k=l||null}null!==k&&(k=this.removeEmptyProps(k));try{$=JM(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),$=this.currentUrlTree.root}return QM($,t,k,E??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=$h(t)?t:this.parseUrl(t),l=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(l,mg,null,i)}navigate(t,i={skipLocationChange:!1}){return function Y4(e){for(let n=0;n<e.length;n++)if(null==e[n])throw new qe(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...X4}:!1===i?{...K4}:i,$h(t))return UM(this.currentUrlTree,t,r);const l=this.parseUrl(t);return UM(this.currentUrlTree,l,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const l=t[r];return null!=l&&(i[r]=l),i},{})}scheduleNavigation(t,i,r,l,h){if(this.disposed)return Promise.resolve(!1);let g,w,E;h?(g=h.resolve,w=h.reject,E=h.promise):E=new Promise(($,te)=>{g=$,w=te});const k=this.pendingTasks.add();return P2(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(k))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:l,resolve:g,reject:w,promise:E,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),E.catch($=>Promise.reject($))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const h={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",h)}else{const l={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",l)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const l=this.currentPageId-this.browserPageId;0!==l?this.location.historyGo(l):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===l&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function k2(e){return!(e instanceof px||e instanceof mx)}class R2{}let e5=(()=>{class e{constructor(t,i,r,l,h){this.router=t,this.injector=r,this.preloadingStrategy=l,this.loader=h}setUpPreloading(){this.subscription=this.router.events.pipe(yc(t=>t instanceof Ud),yp(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const l of i){l.providers&&!l._injector&&(l._injector=M0(l.providers,t,`Route: ${l.path}`));const h=l._injector??t,g=l._loadedInjector??h;(l.loadChildren&&!l._loadedRoutes&&void 0===l.canLoad||l.loadComponent&&!l._loadedComponent)&&r.push(this.preloadConfig(h,l)),(l.children||l._loadedRoutes)&&r.push(this.processRoutes(g,l.children??l._loadedRoutes))}return Vi(r).pipe(_r())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):Zn(null);const l=r.pipe(mi(h=>null===h?Zn(void 0):(i._loadedRoutes=h.routes,i._loadedInjector=h.injector,this.processRoutes(h.injector??t,h.routes))));return i.loadComponent&&!i._loadedComponent?Vi([l,this.loader.loadComponent(i)]).pipe(_r()):l})}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(No),Ht($S),Ht(Ts),Ht(R2),Ht(Sx))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Tx=new ln("");let O2=(()=>{class e{constructor(t,i,r,l,h={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=l,this.options=h,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},h.scrollPositionRestoration=h.scrollPositionRestoration||"disabled",h.anchorScrolling=h.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof gg?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Ud?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Dp&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof s2&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new s2(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){!function zD(){throw new Error("invalid")}()};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();function Wu(e,n){return{\u0275kind:e,\u0275providers:n}}function L2(){const e=Ft(Jr);return n=>{const t=e.get(ou);if(n!==t.components[0])return;const i=e.get(No),r=e.get(N2);1===e.get(Ax)&&i.initialNavigation(),e.get(B2,null,Ln.Optional)?.setUpPreloading(),e.get(Tx,null,Ln.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const N2=new ln("",{factory:()=>new Z}),Ax=new ln("",{providedIn:"root",factory:()=>1}),B2=new ln("");function r5(e){return Wu(0,[{provide:B2,useExisting:e5},{provide:R2,useExisting:e}])}const z2=new ln("ROUTER_FORROOT_GUARD"),s5=[fp,{provide:Cp,useClass:cx},No,Vh,{provide:vc,useFactory:function F2(e){return e.routerState.root},deps:[No]},Sx,[]];function a5(){return new WS("Router",No)}let $2=(()=>{class e{constructor(t){}static forRoot(t,i){return{ngModule:e,providers:[s5,[],{provide:Ap,multi:!0,useValue:t},{provide:z2,useFactory:d5,deps:[[No,new bf,new ch]]},{provide:C_,useValue:i||{}},i?.useHash?{provide:ju,useClass:qB}:{provide:ju,useClass:DT},{provide:Tx,useFactory:()=>{const e=Ft(d$),n=Ft(vt),t=Ft(C_),i=Ft(x_),r=Ft(Cp);return t.scrollOffset&&e.setOffset(t.scrollOffset),new O2(r,i,e,n,t)}},i?.preloadingStrategy?r5(i.preloadingStrategy).\u0275providers:[],{provide:WS,multi:!0,useFactory:a5},i?.initialNavigation?h5(i):[],i?.bindToComponentInputs?Wu(8,[f2,{provide:y_,useExisting:f2}]).\u0275providers:[],[{provide:V2,useFactory:L2},{provide:Y0,multi:!0,useExisting:V2}]]}}static forChild(t){return{ngModule:e,providers:[{provide:Ap,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(z2,8))};static#t=this.\u0275mod=ro({type:e});static#n=this.\u0275inj=Rt({})}return e})();function d5(e){return"guarded"}function h5(e){return["disabled"===e.initialNavigation?Wu(3,[{provide:wv,multi:!0,useFactory:()=>{const n=Ft(No);return()=>{n.setUpLocationChangeListener()}}},{provide:Ax,useValue:2}]).\u0275providers:[],"enabledBlocking"===e.initialNavigation?Wu(2,[{provide:Ax,useValue:0},{provide:wv,multi:!0,deps:[Jr],useFactory:n=>{const t=n.get(UB,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=n.get(No),l=n.get(N2);P2(r,()=>{i(!0)}),n.get(x_).afterPreactivation=()=>(i(!0),l.closed?Zn(void 0):l),r.initialNavigation()}))}}]).\u0275providers:[]]}const V2=new ln("");var p5=Ke(3519),D_=Ke.n(p5);let j2=(()=>{class e{constructor(t){this.http=t,this.loginUrl="https://connect.paj-gps.de/api/v1/login"}login(t,i){return this.http.post(this.loginUrl,{email:t,password:i})}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(rx))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Mx=new ln("@sweetalert2/ngx-sweetalert2#swalProvider"),U2=new ln("@sweetalert2/ngx-sweetalert2#fireOnInit"),H2=new ln("@sweetalert2/ngx-sweetalert2#dismissOnDestroy");let Px=(()=>{class e{swalProvider;swalPromiseCache;constructor(t){this.swalProvider=t}get swal(){return this.swalPromiseCache||this.preloadSweetAlertLibrary(),this.swalPromiseCache}preloadSweetAlertLibrary(){if(this.swalPromiseCache)return;const t=function i(l){return"function"==typeof l&&void 0===l.version}(this.swalProvider)?this.swalProvider():Promise.resolve(this.swalProvider);this.swalPromiseCache=t.then(l=>function r(l){return"function"==typeof l}(l)?l:l.default)}static \u0275fac=function(i){return new(i||e)(Ht(Mx))};static \u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();function m5(){return Promise.resolve().then(Ke.t.bind(Ke,3519,19))}let g5=(()=>{class e{static forRoot(t={}){return{ngModule:e,providers:[Px,{provide:Mx,useValue:t.provideSwal||m5},{provide:U2,useValue:t.fireOnInit||!1},{provide:H2,useValue:t.dismissOnDestroy||!0}]}}static forChild(t={}){return{ngModule:e,providers:[...t.provideSwal?[Px,{provide:Mx,useValue:t.provideSwal}]:[],...void 0!==t.fireOnInit?[{provide:U2,useValue:t.fireOnInit}]:[],...void 0!==t.dismissOnDestroy?[{provide:H2,useValue:t.dismissOnDestroy}]:[]]}}static \u0275fac=function(i){return new(i||e)};static \u0275mod=ro({type:e});static \u0275inj=Rt({imports:[xw]})}return e})(),y5=(()=>{class e{constructor(t,i,r){this.authService=t,this.router=i,this.swalService=r,this.email="",this.password="",this.error=""}login(){this.authService.login(this.email,this.password).subscribe(t=>{localStorage.setItem("token",t.success.token),localStorage.setItem("name",this.email),D_().fire({text:"Successfully logged in!",icon:"success",toast:!0,position:"top-right",timer:3e3,timerProgressBar:!0,showConfirmButton:!1,didClose:()=>{this.router.navigate(["/menu"])}})},t=>{this.error="Login failed!",D_().fire({text:"Invalid User. Please try again.",icon:"error",toast:!0,position:"top-right",timer:3e3,timerProgressBar:!0,showConfirmButton:!1})})}static#e=this.\u0275fac=function(i){return new(i||e)(G(j2),G(No),G(Px))};static#t=this.\u0275cmp=Pt({type:e,selectors:[["app-login"]],decls:25,vars:3,consts:[[1,"login-container"],[1,"login-card"],[1,"login-content"],[1,"login-header"],[1,"info-icon-container"],[1,"info-icon"],[1,"tooltip"],[3,"ngSubmit"],["loginForm","ngForm"],[1,"form-group"],["for","email"],["id","email","name","email","type","email","required","",3,"ngModel","ngModelChange"],["for","password"],["id","password","name","password","type","password","required","",3,"ngModel","ngModelChange"],["type","submit",3,"disabled"]],template:function(i,r){if(1&i&&(zi(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),Qr(5,"Login"),Yi(),zi(6,"div",4)(7,"span",5),Qr(8,"i"),Yi(),zi(9,"div",6),Qr(10," Email: testkunde@paj-gps.de"),kl(11,"br"),Qr(12," Password: app123#. "),Yi()()(),zi(13,"form",7,8),lr("ngSubmit",function(){return r.login()}),zi(15,"div",9)(16,"label",10),Qr(17,"Email:"),Yi(),zi(18,"input",11),lr("ngModelChange",function(h){return r.email=h}),Yi()(),zi(19,"div",9)(20,"label",12),Qr(21,"Password:"),Yi(),zi(22,"input",13),lr("ngModelChange",function(h){return r.password=h}),Yi()(),zi(23,"button",14),Qr(24,"Login"),Yi()()()()()),2&i){const l=function SE(e){return function Hc(e,n){return e[n]}(function Jd(){return Kn.lFrame.contextLView}(),Ei+e)}(14);jr(18),po("ngModel",r.email),jr(4),po("ngModel",r.password),jr(1),po("disabled",!l.form.valid)}},dependencies:[nM,Uv,VA,jA,t_,Ww,e_],styles:['.login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:97vh;width:100%;background:url(login-image.e6111607b5d7cbae.jpg) no-repeat center center;background-size:cover}.login-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;box-shadow:0 4px 8px #0003;padding:2rem;width:100%;margin-right:900px;max-width:400px}.login-content[_ngcontent-%COMP%]{padding:0}.login-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid #ddd;border-radius:4px}button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:.75rem 1.5rem;border-radius:4px;cursor:pointer}button[_ngcontent-%COMP%]:disabled{background-color:#ccc}.error-message[_ngcontent-%COMP%]{color:red;margin-top:1rem}.toast-bottom-right[_ngcontent-%COMP%]{bottom:10px;right:10px}.info-icon-container[_ngcontent-%COMP%]{position:relative;display:inline-block}.info-icon[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#007bff;cursor:pointer;border:1px solid #007bff;border-radius:50%;padding:4px;text-align:center;width:50px;height:24px;line-height:16px}.tooltip[_ngcontent-%COMP%]{visibility:hidden;background-color:#555;color:#fff;text-align:center;border-radius:5px;padding:5px;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-60px;width:150px}.tooltip[_ngcontent-%COMP%]:after{content:"";position:absolute;top:100%;left:50%;margin-left:-5px;border-width:5px;border-style:solid;border-color:#555 transparent transparent transparent}.info-icon-container[_ngcontent-%COMP%]:hover   .tooltip[_ngcontent-%COMP%]{visibility:visible}.login-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}']})}return e})();var v5=Ke(5624),q2=Ke.n(v5);let G2=(()=>{class e{constructor(t){this.http=t,this.devicesUrl="https://connect.paj-gps.de/api/device",this.trackingDataUrl="https://connect.paj-gps.de/api/trackerdata/"}getDevices(t){return this.http.get(this.devicesUrl,{headers:{Authorization:`Bearer ${t}`}})}getTrackingData(t,i){return this.http.get(`${this.trackingDataUrl}${t}/last_points?lastPoints=50`,{headers:{Authorization:`Bearer ${i}`}})}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(rx))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function b5(e,n){if(1&e){const t=av();zi(0,"div",8)(1,"div",9)(2,"h3"),Qr(3),Yi(),zi(4,"p"),Qr(5),Yi()(),zi(6,"button",4),lr("click",function(){const l=ef(t).$implicit;return cd(na().selectDevice(l))}),zi(7,"span",10),Qr(8,"\u2192"),Yi()()()}if(2&e){const t=n.$implicit;jr(3),dv(t.name),jr(2),dv(t.description)}}const w5=[{path:"login",component:y5},{path:"map",component:(()=>{class e{constructor(t,i,r){this.deviceService=t,this.route=i,this.router=r,this.positions=[]}ngOnInit(){localStorage.getItem("token")||this.router.navigate(["/"]),this.deviceId=localStorage.getItem("deviceId"),this.token=localStorage.getItem("token")||"",this.initMap(),this.route.queryParams.subscribe(t=>{try{const i=t.positionData;if(i){const r=JSON.parse(i);Array.isArray(r)&&r.length?(this.positions=r.map(l=>({lat:l.lat,lng:l.lng})),this.map&&this.map.once("style.load",()=>this.drawPolyline())):console.warn("Invalid position data:",r)}else console.warn("No position data in query parameters")}catch(i){console.error("Error parsing position data:",i)}})}back(){this.router.navigate(["/menu"])}logout(){localStorage.clear(),D_().fire({text:"Logout Scuccessfully!",icon:"success",toast:!0,position:"top-right",timerProgressBar:!0,showConfirmButton:!1}),this.router.navigate(["/"])}initMap(){this.map=new(q2().Map)({container:"map",style:"https://demotiles.maplibre.org/style.json",center:[0,0],zoom:2}),this.map.once("style.load",()=>{this.map?.addSource("route",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map?.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#888","line-width":6}}),this.map?.addSource("label",{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[0,0]},properties:{title:"Area Name"}}]}}),this.map?.addLayer({id:"label",type:"symbol",source:"label",layout:{"text-field":"{title}","text-size":12},paint:{"text-color":"#000"}})})}loadDevices(){this.token&&this.map?this.deviceService.getDevices(this.token).subscribe(t=>{t&&t.success?console.log("Devices data:",t.success):console.error("Response does not contain success array:",t)},t=>{console.error("Failed to load devices:",t)}):console.warn("Token or map is not defined.")}drawPolyline(){if(this.map&&this.positions.length>0){const t=this.positions.map(l=>[l.lng,l.lat]),i=this.map.getSource("route");i&&i.setData({type:"Feature",geometry:{type:"LineString",coordinates:t},properties:{}});const r=new(q2().LngLatBounds);t.forEach(l=>r.extend(l)),this.map.fitBounds(r,{padding:20})}}static#e=this.\u0275fac=function(i){return new(i||e)(G(G2),G(vc),G(No))};static#t=this.\u0275cmp=Pt({type:e,selectors:[["app-map"]],decls:20,vars:1,consts:[[1,"container"],[1,"header-content"],[1,"logout"],[3,"click"],[1,"title"],["src","assets/logout.png","alt","Logout",1,"logout-icon",2,"height","33px"],["id","map",2,"width","100%","height","80vh"],[2,"display","flex"]],template:function(i,r){1&i&&(zi(0,"div",0)(1,"header")(2,"div",1)(3,"div",2)(4,"button",3),lr("click",function(){return r.back()}),Qr(5," Back "),Yi()(),zi(6,"div",4)(7,"h2"),Qr(8),Yi()(),zi(9,"div",2)(10,"button",3),lr("click",function(){return r.logout()}),kl(11,"img",5),Yi(),zi(12,"div"),Qr(13,"Logout"),Yi()()()(),zi(14,"main"),kl(15,"div",6),Yi(),zi(16,"footer")(17,"div",7)(18,"h3"),Qr(19,"@ 2024 copyright developed by Karthickkumar K"),Yi()()()()),2&i&&(jr(8),fc("Polyline Map - ",r.deviceId,""))},styles:["#map[_ngcontent-%COMP%]{width:100%;height:100vh}.marker[_ngcontent-%COMP%]{background-size:cover;width:32px;height:32px}",".container[_ngcontent-%COMP%] {\n        display: flex;\n        flex-direction: column;\n        min-height: 100vh;\n        \n\n    }\n\n    header[_ngcontent-%COMP%] {\n        background-color: blue;\n        \n\n        color: #fff;\n        \n\n        padding: 10px;\n    }\n\n    .header-content[_ngcontent-%COMP%] {\n        display: flex;\n        justify-content: space-between;\n        \n\n        align-items: center;\n        \n\n        max-width: 1200px;\n        \n\n        margin: 0 auto;\n        \n\n    }\n\n    .title[_ngcontent-%COMP%] {\n        \n\n        text-align: center;\n        \n\n    }\n\n    .logout[_ngcontent-%COMP%] {\n        \n\n        align-items: center;\n        \n\n    }\n\n    .logout[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\n        background: none;\n        border: none;\n        color: #fff;\n        font-size: 1.5em;\n        \n\n        cursor: pointer;\n    }\n\n    footer[_ngcontent-%COMP%] {\n        background-color: blue;\n        \n\n        color: #fff;\n        \n\n        padding: 10px;\n        text-align: center;\n        font-size: 0.9em;\n        margin-top: auto;\n        \n\n    }\n\n    main[_ngcontent-%COMP%] {\n        flex: 1;\n        \n\n        padding: 10px;\n    }\n\n    .device-card[_ngcontent-%COMP%] {\n        border: 1px solid #ddd;\n        border-radius: 5px;\n        padding: 10px;\n        margin: 10px 0;\n        background-color: #f0f0f0;\n        \n\n        display: flex;\n        justify-content: space-between;\n        \n\n        align-items: center;\n        \n\n    }\n\n    .device-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\n        margin: 0;\n        font-size: 1.2em;\n    }\n\n    .device-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\n        margin: 5px 0;\n    }\n\n    .device-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\n        background-color: #007bff;\n        \n\n        color: #fff;\n        \n\n        border: none;\n        border-radius: 5px;\n        padding: 5px 10px;\n        cursor: pointer;\n        font-size: 1em;\n        display: flex;\n        align-items: center;\n        \n\n    }\n\n    .device-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%] {\n        margin-right: 5px;\n    }"]})}return e})()},{path:"menu",component:(()=>{class e{constructor(t,i,r){this.authService=t,this.deviceService=i,this.router=r,this.devices=[],this.token=""}ngOnInit(){localStorage.getItem("token")||this.router.navigate(["/"]),this.userEmail=localStorage.getItem("name"),this.token=localStorage.getItem("token")||"",this.deviceService.getDevices(this.token).subscribe(t=>{this.devices=t.success})}logout(){localStorage.clear(),D_().fire({text:"Logout Scuccessfully!",icon:"success",toast:!0,position:"top-right",timerProgressBar:!0,showConfirmButton:!1}),this.router.navigate(["/"])}selectDevice(t){localStorage.setItem("deviceId",t.id),this.deviceService.getTrackingData(t.id,this.token).subscribe(i=>{if(i&&i.success){const l=JSON.stringify(i.success);this.router.navigate(["/map"],{queryParams:{positionData:l}})}else console.error("Response does not contain success array:",i)},i=>{console.error("Failed to load devices:",i)})}static#e=this.\u0275fac=function(i){return new(i||e)(G(j2),G(G2),G(No))};static#t=this.\u0275cmp=Pt({type:e,selectors:[["app-menu"]],decls:17,vars:2,consts:[[1,"container"],[1,"header-content"],[1,"title"],[1,"logout"],[3,"click"],["src","assets/logout.png","alt","Logout",1,"logout-icon",2,"height","33px"],["class","device-card",4,"ngFor","ngForOf"],[2,"display","flex"],[1,"device-card"],[1,"device-details"],[1,"arrow"]],template:function(i,r){1&i&&(zi(0,"div",0)(1,"header")(2,"div",1)(3,"div",2)(4,"h2"),Qr(5),Yi()(),zi(6,"div",3)(7,"button",4),lr("click",function(){return r.logout()}),kl(8,"img",5),Yi(),zi(9,"div"),Qr(10,"Logout"),Yi()()()(),zi(11,"main"),ta(12,b5,9,2,"div",6),Yi(),zi(13,"footer")(14,"div",7)(15,"h3"),Qr(16,"@ 2024 copyright developed by Karthickkumar K"),Yi()()()()),2&i&&(jr(5),fc("Devices Menu - ",r.userEmail,""),jr(7),po("ngForOf",r.devices))},dependencies:[NT],styles:[".container[_ngcontent-%COMP%] {\n    display: flex;\n    flex-direction: column;\n    min-height: 100vh;\n    \n\n  }\n\n  header[_ngcontent-%COMP%] {\n    background-color: blue;\n    \n\n    color: #fff;\n    \n\n    padding: 10px;\n  }\n\n  .header-content[_ngcontent-%COMP%] {\n    display: flex;\n    justify-content: space-between;\n    \n\n    align-items: center;\n    \n\n    max-width: 1200px;\n    \n\n    margin: 0 auto;\n    \n\n  }\n\n  .title[_ngcontent-%COMP%] {\n    margin-left: 430px;\n    \n\n    \n\n  }\n\n  .logout[_ngcontent-%COMP%] {\n    \n\n    align-items: center;\n    \n\n  }\n\n  .logout[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\n    background: none;\n    border: none;\n    color: #fff;\n    font-size: 1.5em;\n    \n\n    cursor: pointer;\n  }\n\n  footer[_ngcontent-%COMP%] {\n    background-color: blue;\n    \n\n    color: #fff;\n    \n\n    padding: 10px;\n    text-align: center;\n    font-size: 0.9em;\n    margin-top: auto;\n    \n\n  }\n\n  main[_ngcontent-%COMP%] {\n    flex: 1;\n    \n\n    padding: 10px;\n  }\n\n  .device-card[_ngcontent-%COMP%] {\n    border: 1px solid #ddd;\n    border-radius: 5px;\n    padding: 10px;\n    margin: 10px 0;\n    background-color: #f0f0f0;\n    \n\n    display: flex;\n    justify-content: space-between;\n    \n\n    align-items: center;\n    \n\n  }\n\n  .device-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\n    margin: 0;\n    font-size: 1.2em;\n  }\n\n  .device-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\n    margin: 5px 0;\n  }\n\n  .device-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\n    background-color: #007bff;\n    \n\n    color: #fff;\n    \n\n    border: none;\n    border-radius: 5px;\n    padding: 5px 10px;\n    cursor: pointer;\n    font-size: 1em;\n    display: flex;\n    align-items: center;\n    \n\n  }\n\n  .device-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%] {\n    margin-right: 5px;\n  }"]})}return e})()},{path:"",redirectTo:"/login",pathMatch:"full"}];let x5=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ro({type:e});static#n=this.\u0275inj=Rt({imports:[$2.forRoot(w5),$2]})}return e})(),C5=(()=>{class e{constructor(){this.title="gps-tracking-app"}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Pt({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(i,r){1&i&&kl(0,"router-outlet")},dependencies:[wx]})}return e})();var kx=Ke(5861),Eg=(Ke(3162),Ke(2762));const Ox=new ln("USERCONFIG");class Y2{data;constructor(n={}){this.data=n,console.warn("[Ionic Warning]: NavParams has been deprecated in favor of using Angular's input API. Developers should migrate to either the @Input decorator or the Signals-based input API.")}get(n){return this.data[n]}}let Ig=(()=>{class e{zone=Ft(vt);applicationRef=Ft(ou);config=Ft(Ox);create(t,i,r){return new V5(t,i,this.applicationRef,this.zone,r,this.config.useSetInputAPI??!1)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();class V5{environmentInjector;injector;applicationRef;zone;elementReferenceKey;enableSignalsSupport;elRefMap=new WeakMap;elEventsMap=new WeakMap;constructor(n,t,i,r,l,h){this.environmentInjector=n,this.injector=t,this.applicationRef=i,this.zone=r,this.elementReferenceKey=l,this.enableSignalsSupport=h}attachViewToDom(n,t,i,r){return this.zone.run(()=>new Promise(l=>{const h={...i};void 0!==this.elementReferenceKey&&(h[this.elementReferenceKey]=n),l(j5(this.zone,this.environmentInjector,this.injector,this.applicationRef,this.elRefMap,this.elEventsMap,n,t,h,r,this.elementReferenceKey,this.enableSignalsSupport))}))}removeViewFromDom(n,t){return this.zone.run(()=>new Promise(i=>{const r=this.elRefMap.get(t);if(r){r.destroy(),this.elRefMap.delete(t);const l=this.elEventsMap.get(t);l&&(l(),this.elEventsMap.delete(t))}i()}))}}const j5=(e,n,t,i,r,l,h,g,w,E,k,$)=>{const ie=function $B(e,n){const t=wi(e),i=n.elementInjector||Vy();return new Om(t).create(i,n.projectableNodes,n.hostElement,n.environmentInjector)}(g,{environmentInjector:n,elementInjector:Jr.create({providers:H5(w),parent:t})}),we=ie.instance,Se=ie.location.nativeElement;if(w)if(k&&void 0!==we[k]&&console.error(`[Ionic Error]: ${k} is a reserved property when using ${h.tagName.toLowerCase()}. Rename or remove the "${k}" property from ${g.name}.`),!0===$&&void 0!==ie.setInput){const{modal:dt,popover:Ue,...Kt}=w;for(const En in Kt)ie.setInput(En,Kt[En]);void 0!==dt&&Object.assign(we,{modal:dt}),void 0!==Ue&&Object.assign(we,{popover:Ue})}else Object.assign(we,w);if(E)for(const dt of E)Se.classList.add(dt);const je=J2(e,we,Se);return h.appendChild(Se),i.attachView(ie.hostView),r.set(Se,ie),l.set(Se,je),Se},U5=[Eg.L,Eg.a,Eg.b,Eg.c,Eg.d],J2=(e,n,t)=>e.run(()=>{const i=U5.filter(r=>"function"==typeof n[r]).map(r=>{const l=h=>n[r](h.detail);return t.addEventListener(r,l),()=>t.removeEventListener(r,l)});return()=>i.forEach(r=>r())}),Q2=new ln("NavParamsToken"),H5=e=>[{provide:Q2,useValue:e},{provide:Y2,useFactory:q5,deps:[Q2]}],q5=e=>new Y2(e),sP=new ln("");let a6=(()=>{class e{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=s_([i.queryParams,i.params,i.data]).pipe(jn(([l,h,g],w)=>(g={...l,...h,...g},0===w?Zn(g):Promise.resolve(g)))).subscribe(l=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const h=wT(i.component);if(h)for(const{templateName:g}of h.inputs)t.activatedComponentRef.setInput(g,l[g]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();function c6(e){return e?.componentInputBindingEnabled?new a6:null}const aP=e=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(e):"function"==typeof requestAnimationFrame?requestAnimationFrame(e):setTimeout(e);class lP{ctrl;constructor(n){this.ctrl=n}create(n){return this.ctrl.create(n||{})}dismiss(n,t,i){return this.ctrl.dismiss(n,t,i)}getTop(){return this.ctrl.getTop()}}Ke(2282),Ke(8200),Ke(6232),Ke(519),Ke(1981);var b6=Ke(4601),w6=Ke(8958),cP=(Ke(7101),Ke(7368)),x6=(Ke(1848),Ke(7271));Ke(4089),Ke(6466);const D6=b6.i,E6=function(){var e=(0,kx.Z)(function*(n,t){if(!(typeof window>"u"))return yield D6(),(0,x6.b)(JSON.parse('[["ion-menu_3",[[33,"ion-menu-button",{"color":[513],"disabled":[4],"menu":[1],"autoHide":[4,"auto-hide"],"type":[1],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]],[33,"ion-menu",{"contentId":[513,"content-id"],"menuId":[513,"menu-id"],"type":[1025],"disabled":[1028],"side":[513],"swipeGesture":[4,"swipe-gesture"],"maxEdgeStart":[2,"max-edge-start"],"isPaneVisible":[32],"isEndSide":[32],"isOpen":[64],"isActive":[64],"open":[64],"close":[64],"toggle":[64],"setOpen":[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"]],{"type":["typeChanged"],"disabled":["disabledChanged"],"side":["sideChanged"],"swipeGesture":["swipeGestureChanged"]}],[1,"ion-menu-toggle",{"menu":[1],"autoHide":[4,"auto-hide"],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]]],["ion-input-password-toggle",[[33,"ion-input-password-toggle",{"color":[513],"showIcon":[1,"show-icon"],"hideIcon":[1,"hide-icon"],"type":[1025]},null,{"type":["onTypeChange"]}]]],["ion-fab_3",[[33,"ion-fab-button",{"color":[513],"activated":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1],"show":[4],"translucent":[4],"type":[1],"size":[1],"closeIcon":[1,"close-icon"]}],[1,"ion-fab",{"horizontal":[1],"vertical":[1],"edge":[4],"activated":[1028],"close":[64],"toggle":[64]},null,{"activated":["activatedChanged"]}],[1,"ion-fab-list",{"activated":[4],"side":[1]},null,{"activated":["activatedChanged"]}]]],["ion-refresher_2",[[0,"ion-refresher-content",{"pullingIcon":[1025,"pulling-icon"],"pullingText":[1,"pulling-text"],"refreshingSpinner":[1025,"refreshing-spinner"],"refreshingText":[1,"refreshing-text"]}],[32,"ion-refresher",{"pullMin":[2,"pull-min"],"pullMax":[2,"pull-max"],"closeDuration":[1,"close-duration"],"snapbackDuration":[1,"snapback-duration"],"pullFactor":[2,"pull-factor"],"disabled":[4],"nativeRefresher":[32],"state":[32],"complete":[64],"cancel":[64],"getProgress":[64]},null,{"disabled":["disabledChanged"]}]]],["ion-back-button",[[33,"ion-back-button",{"color":[513],"defaultHref":[1025,"default-href"],"disabled":[516],"icon":[1],"text":[1],"type":[1],"routerAnimation":[16]}]]],["ion-toast",[[33,"ion-toast",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"color":[513],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"duration":[2],"header":[1],"layout":[1],"message":[1],"keyboardClose":[4,"keyboard-close"],"position":[1],"positionAnchor":[1,"position-anchor"],"buttons":[16],"translucent":[4],"animated":[4],"icon":[1],"htmlAttributes":[16],"swipeGesture":[1,"swipe-gesture"],"isOpen":[4,"is-open"],"trigger":[1],"revealContentToScreenReader":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"swipeGesture":["swipeGestureChanged"],"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-card_5",[[33,"ion-card",{"color":[513],"button":[4],"type":[1],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}],[32,"ion-card-content"],[33,"ion-card-header",{"color":[513],"translucent":[4]}],[33,"ion-card-subtitle",{"color":[513]}],[33,"ion-card-title",{"color":[513]}]]],["ion-item-option_3",[[33,"ion-item-option",{"color":[513],"disabled":[4],"download":[1],"expandable":[4],"href":[1],"rel":[1],"target":[1],"type":[1]}],[32,"ion-item-options",{"side":[1],"fireSwipeEvent":[64]}],[0,"ion-item-sliding",{"disabled":[4],"state":[32],"getOpenAmount":[64],"getSlidingRatio":[64],"open":[64],"close":[64],"closeOpened":[64]},null,{"disabled":["disabledChanged"]}]]],["ion-accordion_2",[[49,"ion-accordion",{"value":[1],"disabled":[4],"readonly":[4],"toggleIcon":[1,"toggle-icon"],"toggleIconSlot":[1,"toggle-icon-slot"],"state":[32],"isNext":[32],"isPrevious":[32]},null,{"value":["valueChanged"]}],[33,"ion-accordion-group",{"animated":[4],"multiple":[4],"value":[1025],"disabled":[4],"readonly":[4],"expand":[1],"requestAccordionToggle":[64],"getAccordions":[64]},[[0,"keydown","onKeydown"]],{"value":["valueChanged"],"disabled":["disabledChanged"],"readonly":["readonlyChanged"]}]]],["ion-infinite-scroll_2",[[32,"ion-infinite-scroll-content",{"loadingSpinner":[1025,"loading-spinner"],"loadingText":[1,"loading-text"]}],[0,"ion-infinite-scroll",{"threshold":[1],"disabled":[4],"position":[1],"isLoading":[32],"complete":[64]},null,{"threshold":["thresholdChanged"],"disabled":["disabledChanged"]}]]],["ion-reorder_2",[[33,"ion-reorder",null,[[2,"click","onClick"]]],[0,"ion-reorder-group",{"disabled":[4],"state":[32],"complete":[64]},null,{"disabled":["disabledChanged"]}]]],["ion-segment_2",[[33,"ion-segment-button",{"disabled":[1028],"layout":[1],"type":[1],"value":[8],"checked":[32],"setFocus":[64]},null,{"value":["valueChanged"]}],[33,"ion-segment",{"color":[513],"disabled":[4],"scrollable":[4],"swipeGesture":[4,"swipe-gesture"],"value":[1032],"selectOnFocus":[4,"select-on-focus"],"activated":[32]},[[0,"keydown","onKeyDown"]],{"color":["colorChanged"],"swipeGesture":["swipeGestureChanged"],"value":["valueChanged"],"disabled":["disabledChanged"]}]]],["ion-tab-bar_2",[[33,"ion-tab-button",{"disabled":[4],"download":[1],"href":[1],"rel":[1],"layout":[1025],"selected":[1028],"tab":[1],"target":[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]],[33,"ion-tab-bar",{"color":[513],"selectedTab":[1,"selected-tab"],"translucent":[4],"keyboardVisible":[32]},null,{"selectedTab":["selectedTabChanged"]}]]],["ion-chip",[[33,"ion-chip",{"color":[513],"outline":[4],"disabled":[4]}]]],["ion-datetime-button",[[33,"ion-datetime-button",{"color":[513],"disabled":[516],"datetime":[1],"datetimePresentation":[32],"dateText":[32],"timeText":[32],"datetimeActive":[32],"selectedButton":[32]}]]],["ion-input",[[38,"ion-input",{"color":[513],"autocapitalize":[1],"autocomplete":[1],"autocorrect":[1],"autofocus":[4],"clearInput":[4,"clear-input"],"clearInputIcon":[1,"clear-input-icon"],"clearOnEdit":[4,"clear-on-edit"],"counter":[4],"counterFormatter":[16],"debounce":[2],"disabled":[516],"enterkeyhint":[1],"errorText":[1,"error-text"],"fill":[1],"inputmode":[1],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"max":[8],"maxlength":[2],"min":[8],"minlength":[2],"multiple":[4],"name":[1],"pattern":[1],"placeholder":[1],"readonly":[516],"required":[4],"shape":[1],"spellcheck":[4],"step":[1],"type":[1],"value":[1032],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]},null,{"debounce":["debounceChanged"],"type":["onTypeChange"],"value":["valueChanged"]}]]],["ion-searchbar",[[34,"ion-searchbar",{"color":[513],"animated":[4],"autocapitalize":[1],"autocomplete":[1],"autocorrect":[1],"cancelButtonIcon":[1,"cancel-button-icon"],"cancelButtonText":[1,"cancel-button-text"],"clearIcon":[1,"clear-icon"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"maxlength":[2],"minlength":[2],"name":[1],"placeholder":[1],"searchIcon":[1,"search-icon"],"showCancelButton":[1,"show-cancel-button"],"showClearButton":[1,"show-clear-button"],"spellcheck":[4],"type":[1],"value":[1025],"focused":[32],"noAnimate":[32],"setFocus":[64],"getInputElement":[64]},null,{"lang":["onLangChanged"],"dir":["onDirChanged"],"debounce":["debounceChanged"],"value":["valueChanged"],"showCancelButton":["showCancelButtonChanged"]}]]],["ion-toggle",[[33,"ion-toggle",{"color":[513],"name":[1],"checked":[1028],"disabled":[4],"value":[1],"enableOnOffLabels":[4,"enable-on-off-labels"],"labelPlacement":[1,"label-placement"],"justify":[1],"alignment":[1],"activated":[32]},null,{"disabled":["disabledChanged"]}]]],["ion-nav_2",[[1,"ion-nav",{"delegate":[16],"swipeGesture":[1028,"swipe-gesture"],"animated":[4],"animation":[16],"rootParams":[16],"root":[1],"push":[64],"insert":[64],"insertPages":[64],"pop":[64],"popTo":[64],"popToRoot":[64],"removeIndex":[64],"setRoot":[64],"setPages":[64],"setRouteId":[64],"getRouteId":[64],"getActive":[64],"getByIndex":[64],"canGoBack":[64],"getPrevious":[64],"getLength":[64]},null,{"swipeGesture":["swipeGestureChanged"],"root":["rootChanged"]}],[0,"ion-nav-link",{"component":[1],"componentProps":[16],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}]]],["ion-textarea",[[38,"ion-textarea",{"color":[513],"autocapitalize":[1],"autofocus":[4],"clearOnEdit":[4,"clear-on-edit"],"debounce":[2],"disabled":[4],"fill":[1],"inputmode":[1],"enterkeyhint":[1],"maxlength":[2],"minlength":[2],"name":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"cols":[514],"rows":[2],"wrap":[1],"autoGrow":[516,"auto-grow"],"value":[1025],"counter":[4],"counterFormatter":[16],"errorText":[1,"error-text"],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"shape":[1],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]},null,{"debounce":["debounceChanged"],"value":["valueChanged"]}]]],["ion-backdrop",[[33,"ion-backdrop",{"visible":[4],"tappable":[4],"stopPropagation":[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]]],["ion-loading",[[34,"ion-loading",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"message":[1],"cssClass":[1,"css-class"],"duration":[2],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"spinner":[1025],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-breadcrumb_2",[[33,"ion-breadcrumb",{"collapsed":[4],"last":[4],"showCollapsedIndicator":[4,"show-collapsed-indicator"],"color":[1],"active":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"separator":[4],"target":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}],[33,"ion-breadcrumbs",{"color":[513],"maxItems":[2,"max-items"],"itemsBeforeCollapse":[2,"items-before-collapse"],"itemsAfterCollapse":[2,"items-after-collapse"],"collapsed":[32],"activeChanged":[32]},[[0,"collapsedClick","onCollapsedClick"]],{"maxItems":["maxItemsChanged"],"itemsBeforeCollapse":["maxItemsChanged"],"itemsAfterCollapse":["maxItemsChanged"]}]]],["ion-modal",[[33,"ion-modal",{"hasController":[4,"has-controller"],"overlayIndex":[2,"overlay-index"],"delegate":[16],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"breakpoints":[16],"initialBreakpoint":[2,"initial-breakpoint"],"backdropBreakpoint":[2,"backdrop-breakpoint"],"handle":[4],"handleBehavior":[1,"handle-behavior"],"component":[1],"componentProps":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"animated":[4],"presentingElement":[16],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"keepContentsMounted":[4,"keep-contents-mounted"],"focusTrap":[4,"focus-trap"],"canDismiss":[4,"can-dismiss"],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"setCurrentBreakpoint":[64],"getCurrentBreakpoint":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-route_4",[[0,"ion-route",{"url":[1],"component":[1],"componentProps":[16],"beforeLeave":[16],"beforeEnter":[16]},null,{"url":["onUpdate"],"component":["onUpdate"],"componentProps":["onComponentProps"]}],[0,"ion-route-redirect",{"from":[1],"to":[1]},null,{"from":["propDidChange"],"to":["propDidChange"]}],[0,"ion-router",{"root":[1],"useHash":[4,"use-hash"],"canTransition":[64],"push":[64],"back":[64],"printDebug":[64],"navChanged":[64]},[[8,"popstate","onPopState"],[4,"ionBackButton","onBackButton"]]],[1,"ion-router-link",{"color":[513],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}]]],["ion-avatar_3",[[33,"ion-avatar"],[33,"ion-badge",{"color":[513]}],[1,"ion-thumbnail"]]],["ion-col_3",[[1,"ion-col",{"offset":[1],"offsetXs":[1,"offset-xs"],"offsetSm":[1,"offset-sm"],"offsetMd":[1,"offset-md"],"offsetLg":[1,"offset-lg"],"offsetXl":[1,"offset-xl"],"pull":[1],"pullXs":[1,"pull-xs"],"pullSm":[1,"pull-sm"],"pullMd":[1,"pull-md"],"pullLg":[1,"pull-lg"],"pullXl":[1,"pull-xl"],"push":[1],"pushXs":[1,"push-xs"],"pushSm":[1,"push-sm"],"pushMd":[1,"push-md"],"pushLg":[1,"push-lg"],"pushXl":[1,"push-xl"],"size":[1],"sizeXs":[1,"size-xs"],"sizeSm":[1,"size-sm"],"sizeMd":[1,"size-md"],"sizeLg":[1,"size-lg"],"sizeXl":[1,"size-xl"]},[[9,"resize","onResize"]]],[1,"ion-grid",{"fixed":[4]}],[1,"ion-row"]]],["ion-tab_2",[[1,"ion-tab",{"active":[1028],"delegate":[16],"tab":[1],"component":[1],"setActive":[64]},null,{"active":["changeActive"]}],[1,"ion-tabs",{"useRouter":[1028,"use-router"],"selectedTab":[32],"select":[64],"getTab":[64],"getSelected":[64],"setRouteId":[64],"getRouteId":[64]}]]],["ion-img",[[1,"ion-img",{"alt":[1],"src":[1],"loadSrc":[32],"loadError":[32]},null,{"src":["srcChanged"]}]]],["ion-progress-bar",[[33,"ion-progress-bar",{"type":[1],"reversed":[4],"value":[2],"buffer":[2],"color":[513]}]]],["ion-range",[[33,"ion-range",{"color":[513],"debounce":[2],"name":[1],"label":[1],"dualKnobs":[4,"dual-knobs"],"min":[2],"max":[2],"pin":[4],"pinFormatter":[16],"snaps":[4],"step":[2],"ticks":[4],"activeBarStart":[1026,"active-bar-start"],"disabled":[4],"value":[1026],"labelPlacement":[1,"label-placement"],"ratioA":[32],"ratioB":[32],"pressedKnob":[32]},null,{"debounce":["debounceChanged"],"min":["minChanged"],"max":["maxChanged"],"activeBarStart":["activeBarStartChanged"],"disabled":["disabledChanged"],"value":["valueChanged"]}]]],["ion-split-pane",[[33,"ion-split-pane",{"contentId":[513,"content-id"],"disabled":[4],"when":[8],"visible":[32],"isVisible":[64]},null,{"visible":["visibleChanged"],"disabled":["updateState"],"when":["updateState"]}]]],["ion-text",[[1,"ion-text",{"color":[513]}]]],["ion-select_3",[[33,"ion-select",{"cancelText":[1,"cancel-text"],"color":[513],"compareWith":[1,"compare-with"],"disabled":[4],"fill":[1],"interface":[1],"interfaceOptions":[8,"interface-options"],"justify":[1],"label":[1],"labelPlacement":[1,"label-placement"],"multiple":[4],"name":[1],"okText":[1,"ok-text"],"placeholder":[1],"selectedText":[1,"selected-text"],"toggleIcon":[1,"toggle-icon"],"expandedIcon":[1,"expanded-icon"],"shape":[1],"value":[1032],"isExpanded":[32],"open":[64]},null,{"disabled":["styleChanged"],"isExpanded":["styleChanged"],"placeholder":["styleChanged"],"value":["styleChanged"]}],[1,"ion-select-option",{"disabled":[4],"value":[8]}],[34,"ion-select-popover",{"header":[1],"subHeader":[1,"sub-header"],"message":[1],"multiple":[4],"options":[16]}]]],["ion-picker",[[33,"ion-picker",{"exitInputMode":[64]},[[1,"touchstart","preventTouchStartPropagation"]]]]],["ion-picker-column",[[1,"ion-picker-column",{"disabled":[4],"value":[1032],"color":[513],"numericInput":[4,"numeric-input"],"ariaLabel":[32],"isActive":[32],"scrollActiveItemIntoView":[64],"setValue":[64],"setFocus":[64]},null,{"aria-label":["ariaLabelChanged"],"value":["valueChange"]}]]],["ion-datetime_3",[[33,"ion-datetime",{"color":[1],"name":[1],"disabled":[4],"formatOptions":[16],"readonly":[4],"isDateEnabled":[16],"min":[1025],"max":[1025],"presentation":[1],"cancelText":[1,"cancel-text"],"doneText":[1,"done-text"],"clearText":[1,"clear-text"],"yearValues":[8,"year-values"],"monthValues":[8,"month-values"],"dayValues":[8,"day-values"],"hourValues":[8,"hour-values"],"minuteValues":[8,"minute-values"],"locale":[1],"firstDayOfWeek":[2,"first-day-of-week"],"titleSelectedDatesFormatter":[16],"multiple":[4],"highlightedDates":[16],"value":[1025],"showDefaultTitle":[4,"show-default-title"],"showDefaultButtons":[4,"show-default-buttons"],"showClearButton":[4,"show-clear-button"],"showDefaultTimeLabel":[4,"show-default-time-label"],"hourCycle":[1,"hour-cycle"],"size":[1],"preferWheel":[4,"prefer-wheel"],"showMonthAndYear":[32],"activeParts":[32],"workingParts":[32],"isTimePopoverOpen":[32],"forceRenderDate":[32],"confirm":[64],"reset":[64],"cancel":[64]},null,{"formatOptions":["formatOptionsChanged"],"disabled":["disabledChanged"],"min":["minChanged"],"max":["maxChanged"],"presentation":["presentationChanged"],"yearValues":["yearValuesChanged"],"monthValues":["monthValuesChanged"],"dayValues":["dayValuesChanged"],"hourValues":["hourValuesChanged"],"minuteValues":["minuteValuesChanged"],"value":["valueChanged"]}],[34,"ion-picker-legacy",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"columns":[16],"cssClass":[1,"css-class"],"duration":[2],"showBackdrop":[4,"show-backdrop"],"backdropDismiss":[4,"backdrop-dismiss"],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"getColumn":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}],[32,"ion-picker-legacy-column",{"col":[16]},null,{"col":["colChanged"]}]]],["ion-radio_2",[[33,"ion-radio",{"color":[513],"name":[1],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"justify":[1],"alignment":[1],"checked":[32],"buttonTabindex":[32],"setFocus":[64],"setButtonTabindex":[64]},null,{"value":["valueChanged"]}],[0,"ion-radio-group",{"allowEmptySelection":[4,"allow-empty-selection"],"compareWith":[1,"compare-with"],"name":[1],"value":[1032]},[[4,"keydown","onKeydown"]],{"value":["valueChanged"]}]]],["ion-ripple-effect",[[1,"ion-ripple-effect",{"type":[1],"addRipple":[64]}]]],["ion-button_2",[[33,"ion-button",{"color":[513],"buttonType":[1025,"button-type"],"disabled":[516],"expand":[513],"fill":[1537],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"download":[1],"href":[1],"rel":[1],"shape":[513],"size":[513],"strong":[4],"target":[1],"type":[1],"form":[1],"isCircle":[32]},null,{"disabled":["disabledChanged"]}],[1,"ion-icon",{"mode":[1025],"color":[1],"ios":[1],"md":[1],"flipRtl":[4,"flip-rtl"],"name":[513],"src":[1],"icon":[8],"size":[1],"lazy":[4],"sanitize":[4],"svgContent":[32],"isVisible":[32]},null,{"name":["loadIcon"],"src":["loadIcon"],"icon":["loadIcon"],"ios":["loadIcon"],"md":["loadIcon"]}]]],["ion-action-sheet",[[34,"ion-action-sheet",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"header":[1],"subHeader":[1,"sub-header"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-alert",[[34,"ion-alert",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"header":[1],"subHeader":[1,"sub-header"],"message":[1],"buttons":[16],"inputs":[1040],"backdropDismiss":[4,"backdrop-dismiss"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},[[4,"keydown","onKeydown"]],{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"],"buttons":["buttonsChanged"],"inputs":["inputsChanged"]}]]],["ion-app_8",[[0,"ion-app",{"setFocus":[64]}],[1,"ion-content",{"color":[513],"fullscreen":[4],"fixedSlotPlacement":[1,"fixed-slot-placement"],"forceOverscroll":[1028,"force-overscroll"],"scrollX":[4,"scroll-x"],"scrollY":[4,"scroll-y"],"scrollEvents":[4,"scroll-events"],"getScrollElement":[64],"getBackgroundElement":[64],"scrollToTop":[64],"scrollToBottom":[64],"scrollByPoint":[64],"scrollToPoint":[64]},[[9,"resize","onResize"]]],[36,"ion-footer",{"collapse":[1],"translucent":[4],"keyboardVisible":[32]}],[36,"ion-header",{"collapse":[1],"translucent":[4]}],[1,"ion-router-outlet",{"mode":[1025],"delegate":[16],"animated":[4],"animation":[16],"swipeHandler":[16],"commit":[64],"setRouteId":[64],"getRouteId":[64]},null,{"swipeHandler":["swipeHandlerChanged"]}],[33,"ion-title",{"color":[513],"size":[1]},null,{"size":["sizeChanged"]}],[33,"ion-toolbar",{"color":[513]},[[0,"ionStyle","childrenStyle"]]],[38,"ion-buttons",{"collapse":[4]}]]],["ion-picker-column-option",[[33,"ion-picker-column-option",{"disabled":[4],"value":[8],"color":[513],"ariaLabel":[32]},null,{"aria-label":["onAriaLabelChange"]}]]],["ion-popover",[[33,"ion-popover",{"hasController":[4,"has-controller"],"delegate":[16],"overlayIndex":[2,"overlay-index"],"enterAnimation":[16],"leaveAnimation":[16],"component":[1],"componentProps":[16],"keyboardClose":[4,"keyboard-close"],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"event":[8],"showBackdrop":[4,"show-backdrop"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"triggerAction":[1,"trigger-action"],"trigger":[1],"size":[1],"dismissOnSelect":[4,"dismiss-on-select"],"reference":[1],"side":[1],"alignment":[1025],"arrow":[4],"isOpen":[4,"is-open"],"keyboardEvents":[4,"keyboard-events"],"focusTrap":[4,"focus-trap"],"keepContentsMounted":[4,"keep-contents-mounted"],"presented":[32],"presentFromTrigger":[64],"present":[64],"dismiss":[64],"getParentPopover":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"trigger":["onTriggerChange"],"triggerAction":["onTriggerChange"],"isOpen":["onIsOpenChange"]}]]],["ion-checkbox",[[33,"ion-checkbox",{"color":[513],"name":[1],"checked":[1028],"indeterminate":[1028],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"justify":[1],"alignment":[1]}]]],["ion-spinner",[[1,"ion-spinner",{"color":[513],"duration":[2],"name":[1],"paused":[4]}]]],["ion-item_8",[[33,"ion-item-divider",{"color":[513],"sticky":[4]}],[32,"ion-item-group"],[33,"ion-note",{"color":[513]}],[1,"ion-skeleton-text",{"animated":[4]}],[33,"ion-item",{"color":[513],"button":[4],"detail":[4],"detailIcon":[1,"detail-icon"],"disabled":[516],"download":[1],"href":[1],"rel":[1],"lines":[1],"routerAnimation":[16],"routerDirection":[1,"router-direction"],"target":[1],"type":[1],"multipleInputs":[32],"focusable":[32]},[[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]],{"button":["buttonChanged"]}],[38,"ion-label",{"color":[513],"position":[1],"noAnimate":[32]},null,{"color":["colorChanged"],"position":["positionChanged"]}],[32,"ion-list",{"lines":[1],"inset":[4],"closeSlidingItems":[64]}],[33,"ion-list-header",{"color":[513],"lines":[1]}]]]]'),t)});return function(t,i){return e.apply(this,arguments)}}(),yH={provide:As,useExisting:Fi(()=>uP),multi:!0};let uP=(()=>{class e extends Qw{static \u0275fac=function(){let t;return function(r){return(t||(t=Gr(e)))(r||e)}}();static \u0275dir=yn({type:e,selectors:[["ion-input","type","number","max","","formControlName",""],["ion-input","type","number","max","","formControl",""],["ion-input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&ea("max",r._enabled?r.max:null)},features:[Pr([yH]),Mi]})}return e})();const vH={provide:As,useExisting:Fi(()=>dP),multi:!0};let dP=(()=>{class e extends ex{static \u0275fac=function(){let t;return function(r){return(t||(t=Gr(e)))(r||e)}}();static \u0275dir=yn({type:e,selectors:[["ion-input","type","number","min","","formControlName",""],["ion-input","type","number","min","","formControl",""],["ion-input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&ea("min",r._enabled?r.min:null)},features:[Pr([vH]),Mi]})}return e})(),_H=(()=>{class e extends lP{angularDelegate=Ft(Ig);injector=Ft(Jr);environmentInjector=Ft(Ts);constructor(){super(cP.m)}create(t){return super.create({...t,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"modal")})}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();class bH extends lP{angularDelegate=Ft(Ig);injector=Ft(Jr);environmentInjector=Ft(Ts);constructor(){super(cP.c)}create(n){return super.create({...n,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"popover")})}}const wH=(e,n,t)=>()=>{const i=n.defaultView;if(i&&typeof window<"u"){(0,w6.s)({...e,_zoneGate:l=>t.run(l)});const r="__zone_symbol__addEventListener"in n.body?"__zone_symbol__addEventListener":"addEventListener";return function C6(){var e=[];if(typeof window<"u"){var n=window;(!n.customElements||n.Element&&(!n.Element.prototype.closest||!n.Element.prototype.matches||!n.Element.prototype.remove||!n.Element.prototype.getRootNode))&&e.push(Ke.e(6748).then(Ke.t.bind(Ke,3342,23))),("function"!=typeof Object.assign||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||n.NodeList&&!n.NodeList.prototype.forEach||!n.fetch||!function(){try{var i=new URL("b","http://a");return i.pathname="c%20d","http://a/c%20d"===i.href&&i.searchParams}catch{return!1}}()||typeof WeakMap>"u")&&e.push(Ke.e(2214).then(Ke.t.bind(Ke,2668,23)))}return Promise.all(e)}().then(()=>E6(i,{exclude:["ion-tabs","ion-tab"],syncQueue:!0,raf:aP,jmp:l=>t.runOutsideAngular(l),ael(l,h,g,w){l[r](h,g,w)},rel(l,h,g,w){l.removeEventListener(h,g,w)}}))}};let xH=(()=>{class e{static forRoot(t={}){return{ngModule:e,providers:[{provide:Ox,useValue:t},{provide:wv,useFactory:wH,multi:!0,deps:[Ox,Fo,vt]},Ig,{provide:sP,useFactory:c6,deps:[No]}]}}static \u0275fac=function(i){return new(i||e)};static \u0275mod=ro({type:e});static \u0275inj=Rt({providers:[_H,bH],imports:[xw]})}return e})();class hP{}class CH{}const Zu="*";function DH(e,n){return{type:7,name:e,definitions:n,options:{}}}function fP(e,n=null){return{type:4,styles:n,timings:e}}function pP(e,n=null){return{type:2,steps:e,options:n}}function Sg(e){return{type:6,styles:e,offset:null}}function $x(e,n,t){return{type:0,name:e,styles:n,options:t}}function mP(e,n,t=null){return{type:1,expr:e,animation:n,options:t}}class Tg{constructor(n=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const t="start"==n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class gP{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let t=0,i=0,r=0;const l=this.players.length;0==l?queueMicrotask(()=>this._onFinish()):this.players.forEach(h=>{h.onDone(()=>{++t==l&&this._onFinish()}),h.onDestroy(()=>{++i==l&&this._onDestroy()}),h.onStart(()=>{++r==l&&this._onStart()})}),this.totalTime=this.players.reduce((h,g)=>Math.max(h,g.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const t=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const t="start"==n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function yP(e){return new qe(3e3,!1)}function Hd(e){switch(e.length){case 0:return new Tg;case 1:return e[0];default:return new gP(e)}}function vP(e,n,t=new Map,i=new Map){const r=[],l=[];let h=-1,g=null;if(n.forEach(w=>{const E=w.get("offset"),k=E==h,$=k&&g||new Map;w.forEach((te,ie)=>{let we=ie,Se=te;if("offset"!==ie)switch(we=e.normalizePropertyName(we,r),Se){case"!":Se=t.get(ie);break;case Zu:Se=i.get(ie);break;default:Se=e.normalizeStyleValue(ie,we,Se,r)}$.set(we,Se)}),k||l.push($),g=$,h=E}),r.length)throw function WH(e){return new qe(3502,!1)}();return l}function jx(e,n,t,i){switch(n){case"start":e.onStart(()=>i(t&&Ux(t,"start",e)));break;case"done":e.onDone(()=>i(t&&Ux(t,"done",e)));break;case"destroy":e.onDestroy(()=>i(t&&Ux(t,"destroy",e)))}}function Ux(e,n,t){const l=Hx(e.element,e.triggerName,e.fromState,e.toState,n||e.phaseName,t.totalTime??e.totalTime,!!t.disabled),h=e._data;return null!=h&&(l._data=h),l}function Hx(e,n,t,i,r="",l=0,h){return{element:e,triggerName:n,fromState:t,toState:i,phaseName:r,totalTime:l,disabled:!!h}}function il(e,n,t){let i=e.get(n);return i||e.set(n,i=t),i}function _P(e){const n=e.indexOf(":");return[e.substring(1,n),e.slice(n+1)]}const o8=(()=>typeof document>"u"?null:document.documentElement)();function qx(e){const n=e.parentNode||e.host||null;return n===o8?null:n}let jh=null,bP=!1;function wP(e,n){for(;n;){if(n===e)return!0;n=qx(n)}return!1}function xP(e,n,t){if(t)return Array.from(e.querySelectorAll(n));const i=e.querySelector(n);return i?[i]:[]}let CP=(()=>{class e{validateStyleProperty(t){return function a8(e){jh||(jh=function l8(){return typeof document<"u"?document.body:null}()||{},bP=!!jh.style&&"WebkitAppearance"in jh.style);let n=!0;return jh.style&&!function s8(e){return"ebkit"==e.substring(1,6)}(e)&&(n=e in jh.style,!n&&bP&&(n="Webkit"+e.charAt(0).toUpperCase()+e.slice(1)in jh.style)),n}(t)}matchesElement(t,i){return!1}containsElement(t,i){return wP(t,i)}getParentElement(t){return qx(t)}query(t,i,r){return xP(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,l,h,g=[],w){return new Tg(r,l)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})(),Gx=(()=>{class e{static#e=this.NOOP=new CP}return e})();const c8=1e3,Wx="ng-enter",A_="ng-leave",M_="ng-trigger",P_=".ng-trigger",EP="ng-animating",Zx=".ng-animating";function Xu(e){if("number"==typeof e)return e;const n=e.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:Xx(parseFloat(n[1]),n[2])}function Xx(e,n){return"s"===n?e*c8:e}function k_(e,n,t){return e.hasOwnProperty("duration")?e:function d8(e,n,t){let r,l=0,h="";if("string"==typeof e){const g=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===g)return n.push(yP()),{duration:0,delay:0,easing:""};r=Xx(parseFloat(g[1]),g[2]);const w=g[3];null!=w&&(l=Xx(parseFloat(w),g[4]));const E=g[5];E&&(h=E)}else r=e;if(!t){let g=!1,w=n.length;r<0&&(n.push(function EH(){return new qe(3100,!1)}()),g=!0),l<0&&(n.push(function IH(){return new qe(3101,!1)}()),g=!0),g&&n.splice(w,0,yP())}return{duration:r,delay:l,easing:h}}(e,n,t)}function Ag(e,n={}){return Object.keys(e).forEach(t=>{n[t]=e[t]}),n}function IP(e){const n=new Map;return Object.keys(e).forEach(t=>{n.set(t,e[t])}),n}function qd(e,n=new Map,t){if(t)for(let[i,r]of t)n.set(i,r);for(let[i,r]of e)n.set(i,r);return n}function cu(e,n,t){n.forEach((i,r)=>{const l=Yx(r);t&&!t.has(r)&&t.set(r,e.style[l]),e.style[l]=i})}function Uh(e,n){n.forEach((t,i)=>{const r=Yx(i);e.style[r]=""})}function Mg(e){return Array.isArray(e)?1==e.length?e[0]:pP(e):e}const Kx=new RegExp("{{\\s*(.+?)\\s*}}","g");function TP(e){let n=[];if("string"==typeof e){let t;for(;t=Kx.exec(e);)n.push(t[1]);Kx.lastIndex=0}return n}function Pg(e,n,t){const i=e.toString(),r=i.replace(Kx,(l,h)=>{let g=n[h];return null==g&&(t.push(function TH(e){return new qe(3003,!1)}()),g=""),g.toString()});return r==i?e:r}function R_(e){const n=[];let t=e.next();for(;!t.done;)n.push(t.value),t=e.next();return n}const p8=/-+([a-z0-9])/g;function Yx(e){return e.replace(p8,(...n)=>n[1].toUpperCase())}function rl(e,n,t){switch(n.type){case 7:return e.visitTrigger(n,t);case 0:return e.visitState(n,t);case 1:return e.visitTransition(n,t);case 2:return e.visitSequence(n,t);case 3:return e.visitGroup(n,t);case 4:return e.visitAnimate(n,t);case 5:return e.visitKeyframes(n,t);case 6:return e.visitStyle(n,t);case 8:return e.visitReference(n,t);case 9:return e.visitAnimateChild(n,t);case 10:return e.visitAnimateRef(n,t);case 11:return e.visitQuery(n,t);case 12:return e.visitStagger(n,t);default:throw function AH(e){return new qe(3004,!1)}()}}function AP(e,n){return window.getComputedStyle(e)[n]}const O_="*";function y8(e,n){const t=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(i=>function v8(e,n,t){if(":"==e[0]){const w=function _8(e,n){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return n.push(function UH(e){return new qe(3016,!1)}()),"* => *"}}(e,t);if("function"==typeof w)return void n.push(w);e=w}const i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function jH(e){return new qe(3015,!1)}()),n;const r=i[1],l=i[2],h=i[3];n.push(MP(r,h));"<"==l[0]&&!(r==O_&&h==O_)&&n.push(MP(h,r))}(i,t,n)):t.push(e),t}const F_=new Set(["true","1"]),L_=new Set(["false","0"]);function MP(e,n){const t=F_.has(e)||L_.has(e),i=F_.has(n)||L_.has(n);return(r,l)=>{let h=e==O_||e==r,g=n==O_||n==l;return!h&&t&&"boolean"==typeof r&&(h=r?F_.has(e):L_.has(e)),!g&&i&&"boolean"==typeof l&&(g=l?F_.has(n):L_.has(n)),h&&g}}const b8=new RegExp("s*:selfs*,?","g");function Jx(e,n,t,i){return new w8(e).build(n,t,i)}class w8{constructor(n){this._driver=n}build(n,t,i){const r=new D8(t);return this._resetContextStyleTimingState(r),rl(this,Mg(n),r)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,t){let i=t.queryCount=0,r=t.depCount=0;const l=[],h=[];return"@"==n.name.charAt(0)&&t.errors.push(function PH(){return new qe(3006,!1)}()),n.definitions.forEach(g=>{if(this._resetContextStyleTimingState(t),0==g.type){const w=g,E=w.name;E.toString().split(/\s*,\s*/).forEach(k=>{w.name=k,l.push(this.visitState(w,t))}),w.name=E}else if(1==g.type){const w=this.visitTransition(g,t);i+=w.queryCount,r+=w.depCount,h.push(w)}else t.errors.push(function kH(){return new qe(3007,!1)}())}),{type:7,name:n.name,states:l,transitions:h,queryCount:i,depCount:r,options:null}}visitState(n,t){const i=this.visitStyle(n.styles,t),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const l=new Set,h=r||{};i.styles.forEach(g=>{g instanceof Map&&g.forEach(w=>{TP(w).forEach(E=>{h.hasOwnProperty(E)||l.add(E)})})}),l.size&&(R_(l.values()),t.errors.push(function RH(e,n){return new qe(3008,!1)}()))}return{type:0,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,t){t.queryCount=0,t.depCount=0;const i=rl(this,Mg(n.animation),t);return{type:1,matchers:y8(n.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Hh(n.options)}}visitSequence(n,t){return{type:2,steps:n.steps.map(i=>rl(this,i,t)),options:Hh(n.options)}}visitGroup(n,t){const i=t.currentTime;let r=0;const l=n.steps.map(h=>{t.currentTime=i;const g=rl(this,h,t);return r=Math.max(r,t.currentTime),g});return t.currentTime=r,{type:3,steps:l,options:Hh(n.options)}}visitAnimate(n,t){const i=function I8(e,n){if(e.hasOwnProperty("duration"))return e;if("number"==typeof e)return Qx(k_(e,n).duration,0,"");const t=e;if(t.split(/\s+/).some(l=>"{"==l.charAt(0)&&"{"==l.charAt(1))){const l=Qx(0,0,"");return l.dynamic=!0,l.strValue=t,l}const r=k_(t,n);return Qx(r.duration,r.delay,r.easing)}(n.timings,t.errors);t.currentAnimateTimings=i;let r,l=n.styles?n.styles:Sg({});if(5==l.type)r=this.visitKeyframes(l,t);else{let h=n.styles,g=!1;if(!h){g=!0;const E={};i.easing&&(E.easing=i.easing),h=Sg(E)}t.currentTime+=i.duration+i.delay;const w=this.visitStyle(h,t);w.isEmptyStep=g,r=w}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(n,t){const i=this._makeStyleAst(n,t);return this._validateStyleAst(i,t),i}_makeStyleAst(n,t){const i=[],r=Array.isArray(n.styles)?n.styles:[n.styles];for(let g of r)"string"==typeof g?g===Zu?i.push(g):t.errors.push(new qe(3002,!1)):i.push(IP(g));let l=!1,h=null;return i.forEach(g=>{if(g instanceof Map&&(g.has("easing")&&(h=g.get("easing"),g.delete("easing")),!l))for(let w of g.values())if(w.toString().indexOf("{{")>=0){l=!0;break}}),{type:6,styles:i,easing:h,offset:n.offset,containsDynamicStyles:l,options:null}}_validateStyleAst(n,t){const i=t.currentAnimateTimings;let r=t.currentTime,l=t.currentTime;i&&l>0&&(l-=i.duration+i.delay),n.styles.forEach(h=>{"string"!=typeof h&&h.forEach((g,w)=>{const E=t.collectedStyles.get(t.currentQuerySelector),k=E.get(w);let $=!0;k&&(l!=r&&l>=k.startTime&&r<=k.endTime&&(t.errors.push(function FH(e,n,t,i,r){return new qe(3010,!1)}()),$=!1),l=k.startTime),$&&E.set(w,{startTime:l,endTime:r}),t.options&&function f8(e,n,t){const i=n.params||{},r=TP(e);r.length&&r.forEach(l=>{i.hasOwnProperty(l)||t.push(function SH(e){return new qe(3001,!1)}())})}(g,t.options,t.errors)})})}visitKeyframes(n,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function LH(){return new qe(3011,!1)}()),i;let l=0;const h=[];let g=!1,w=!1,E=0;const k=n.steps.map(dt=>{const Ue=this._makeStyleAst(dt,t);let Kt=null!=Ue.offset?Ue.offset:function E8(e){if("string"==typeof e)return null;let n=null;if(Array.isArray(e))e.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;n=parseFloat(i.get("offset")),i.delete("offset")}});else if(e instanceof Map&&e.has("offset")){const t=e;n=parseFloat(t.get("offset")),t.delete("offset")}return n}(Ue.styles),En=0;return null!=Kt&&(l++,En=Ue.offset=Kt),w=w||En<0||En>1,g=g||En<E,E=En,h.push(En),Ue});w&&t.errors.push(function NH(){return new qe(3012,!1)}()),g&&t.errors.push(function BH(){return new qe(3200,!1)}());const $=n.steps.length;let te=0;l>0&&l<$?t.errors.push(function zH(){return new qe(3202,!1)}()):0==l&&(te=1/($-1));const ie=$-1,we=t.currentTime,Se=t.currentAnimateTimings,je=Se.duration;return k.forEach((dt,Ue)=>{const Kt=te>0?Ue==ie?1:te*Ue:h[Ue],En=Kt*je;t.currentTime=we+Se.delay+En,Se.duration=En,this._validateStyleAst(dt,t),dt.offset=Kt,i.styles.push(dt)}),i}visitReference(n,t){return{type:8,animation:rl(this,Mg(n.animation),t),options:Hh(n.options)}}visitAnimateChild(n,t){return t.depCount++,{type:9,options:Hh(n.options)}}visitAnimateRef(n,t){return{type:10,animation:this.visitReference(n.animation,t),options:Hh(n.options)}}visitQuery(n,t){const i=t.currentQuerySelector,r=n.options||{};t.queryCount++,t.currentQuery=n;const[l,h]=function x8(e){const n=!!e.split(/\s*,\s*/).find(t=>":self"==t);return n&&(e=e.replace(b8,"")),e=e.replace(/@\*/g,P_).replace(/@\w+/g,t=>P_+"-"+t.slice(1)).replace(/:animating/g,Zx),[e,n]}(n.selector);t.currentQuerySelector=i.length?i+" "+l:l,il(t.collectedStyles,t.currentQuerySelector,new Map);const g=rl(this,Mg(n.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:l,limit:r.limit||0,optional:!!r.optional,includeSelf:h,animation:g,originalSelector:n.selector,options:Hh(n.options)}}visitStagger(n,t){t.currentQuery||t.errors.push(function $H(){return new qe(3013,!1)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:k_(n.timings,t.errors,!0);return{type:12,animation:rl(this,Mg(n.animation),t),timings:i,options:null}}}class D8{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Hh(e){return e?(e=Ag(e)).params&&(e.params=function C8(e){return e?Ag(e):null}(e.params)):e={},e}function Qx(e,n,t){return{duration:e,delay:n,easing:t}}function e1(e,n,t,i,r,l,h=null,g=!1){return{type:1,element:e,keyframes:n,preStyleProps:t,postStyleProps:i,duration:r,delay:l,totalTime:r+l,easing:h,subTimeline:g}}class N_{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,t){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...t)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const A8=new RegExp(":enter","g"),P8=new RegExp(":leave","g");function t1(e,n,t,i,r,l=new Map,h=new Map,g,w,E=[]){return(new k8).buildKeyframes(e,n,t,i,r,l,h,g,w,E)}class k8{buildKeyframes(n,t,i,r,l,h,g,w,E,k=[]){E=E||new N_;const $=new n1(n,t,E,r,l,k,[]);$.options=w;const te=w.delay?Xu(w.delay):0;$.currentTimeline.delayNextStep(te),$.currentTimeline.setStyles([h],null,$.errors,w),rl(this,i,$);const ie=$.timelines.filter(we=>we.containsAnimation());if(ie.length&&g.size){let we;for(let Se=ie.length-1;Se>=0;Se--){const je=ie[Se];if(je.element===t){we=je;break}}we&&!we.allowOnlyTimelineStyles()&&we.setStyles([g],null,$.errors,w)}return ie.length?ie.map(we=>we.buildKeyframes()):[e1(t,[],[],[],0,te,"",!1)]}visitTrigger(n,t){}visitState(n,t){}visitTransition(n,t){}visitAnimateChild(n,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(n.options),l=t.currentTimeline.currentTime,h=this._visitSubInstructions(i,r,r.options);l!=h&&t.transformIntoNewTimeline(h)}t.previousNode=n}visitAnimateRef(n,t){const i=t.createSubContext(n.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],t,i),this.visitReference(n.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=n}_applyAnimationRefDelays(n,t,i){for(const r of n){const l=r?.delay;if(l){const h="number"==typeof l?l:Xu(Pg(l,r?.params??{},t.errors));i.delayNextStep(h)}}}_visitSubInstructions(n,t,i){let l=t.currentTimeline.currentTime;const h=null!=i.duration?Xu(i.duration):null,g=null!=i.delay?Xu(i.delay):null;return 0!==h&&n.forEach(w=>{const E=t.appendInstructionToTimeline(w,h,g);l=Math.max(l,E.duration+E.delay)}),l}visitReference(n,t){t.updateOptions(n.options,!0),rl(this,n.animation,t),t.previousNode=n}visitSequence(n,t){const i=t.subContextCount;let r=t;const l=n.options;if(l&&(l.params||l.delay)&&(r=t.createSubContext(l),r.transformIntoNewTimeline(),null!=l.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=B_);const h=Xu(l.delay);r.delayNextStep(h)}n.steps.length&&(n.steps.forEach(h=>rl(this,h,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=n}visitGroup(n,t){const i=[];let r=t.currentTimeline.currentTime;const l=n.options&&n.options.delay?Xu(n.options.delay):0;n.steps.forEach(h=>{const g=t.createSubContext(n.options);l&&g.delayNextStep(l),rl(this,h,g),r=Math.max(r,g.currentTimeline.currentTime),i.push(g.currentTimeline)}),i.forEach(h=>t.currentTimeline.mergeTimelineCollectedStyles(h)),t.transformIntoNewTimeline(r),t.previousNode=n}_visitTiming(n,t){if(n.dynamic){const i=n.strValue;return k_(t.params?Pg(i,t.params,t.errors):i,t.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,t){const i=t.currentAnimateTimings=this._visitTiming(n.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const l=n.style;5==l.type?this.visitKeyframes(l,t):(t.incrementTime(i.duration),this.visitStyle(l,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=n}visitStyle(n,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const l=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(l):i.setStyles(n.styles,l,t.errors,t.options),t.previousNode=n}visitKeyframes(n,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,l=i.duration,g=t.createSubContext().currentTimeline;g.easing=i.easing,n.styles.forEach(w=>{g.forwardTime((w.offset||0)*l),g.setStyles(w.styles,w.easing,t.errors,t.options),g.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(g),t.transformIntoNewTimeline(r+l),t.previousNode=n}visitQuery(n,t){const i=t.currentTimeline.currentTime,r=n.options||{},l=r.delay?Xu(r.delay):0;l&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=B_);let h=i;const g=t.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=g.length;let w=null;g.forEach((E,k)=>{t.currentQueryIndex=k;const $=t.createSubContext(n.options,E);l&&$.delayNextStep(l),E===t.element&&(w=$.currentTimeline),rl(this,n.animation,$),$.currentTimeline.applyStylesToKeyframe(),h=Math.max(h,$.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(h),w&&(t.currentTimeline.mergeTimelineCollectedStyles(w),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=n}visitStagger(n,t){const i=t.parentContext,r=t.currentTimeline,l=n.timings,h=Math.abs(l.duration),g=h*(t.currentQueryTotal-1);let w=h*t.currentQueryIndex;switch(l.duration<0?"reverse":l.easing){case"reverse":w=g-w;break;case"full":w=i.currentStaggerTime}const k=t.currentTimeline;w&&k.delayNextStep(w);const $=k.currentTime;rl(this,n.animation,t),t.previousNode=n,i.currentStaggerTime=r.currentTime-$+(r.startTime-i.currentTimeline.startTime)}}const B_={};class n1{constructor(n,t,i,r,l,h,g,w){this._driver=n,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=l,this.errors=h,this.timelines=g,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=B_,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=w||new z_(this._driver,t,0),g.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,t){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=Xu(i.duration)),null!=i.delay&&(r.delay=Xu(i.delay));const l=i.params;if(l){let h=r.params;h||(h=this.options.params={}),Object.keys(l).forEach(g=>{(!t||!h.hasOwnProperty(g))&&(h[g]=Pg(l[g],h,this.errors))})}}_copyOptions(){const n={};if(this.options){const t=this.options.params;if(t){const i=n.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return n}createSubContext(n=null,t,i){const r=t||this.element,l=new n1(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return l.previousNode=this.previousNode,l.currentAnimateTimings=this.currentAnimateTimings,l.options=this._copyOptions(),l.updateOptions(n),l.currentQueryIndex=this.currentQueryIndex,l.currentQueryTotal=this.currentQueryTotal,l.parentContext=this,this.subContextCount++,l}transformIntoNewTimeline(n){return this.previousNode=B_,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,t,i){const r={duration:t??n.duration,delay:this.currentTimeline.currentTime+(i??0)+n.delay,easing:""},l=new R8(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(l),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,t,i,r,l,h){let g=[];if(r&&g.push(this.element),n.length>0){n=(n=n.replace(A8,"."+this._enterClassName)).replace(P8,"."+this._leaveClassName);let E=this._driver.query(this.element,n,1!=i);0!==i&&(E=i<0?E.slice(E.length+i,E.length):E.slice(0,i)),g.push(...E)}return!l&&0==g.length&&h.push(function VH(e){return new qe(3014,!1)}()),g}}class z_{constructor(n,t,i,r){this._driver=n,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+n),t&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,t){return this.applyStylesToKeyframe(),new z_(this._driver,n,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,t){this._localTimelineStyles.set(n,t),this._globalTimelineStyles.set(n,t),this._styleSummary.set(n,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||Zu),this._currentKeyframe.set(t,Zu);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,t,i,r){t&&this._previousKeyframe.set("easing",t);const l=r&&r.params||{},h=function O8(e,n){const t=new Map;let i;return e.forEach(r=>{if("*"===r){i=i||n.keys();for(let l of i)t.set(l,Zu)}else qd(r,t)}),t}(n,this._globalTimelineStyles);for(let[g,w]of h){const E=Pg(w,l,i);this._pendingStyles.set(g,E),this._localTimelineStyles.has(g)||this._backFill.set(g,this._globalTimelineStyles.get(g)??Zu),this._updateStyle(g,E)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,t)=>{this._currentKeyframe.set(t,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,n)}))}snapshotCurrentStyles(){for(let[n,t]of this._localTimelineStyles)this._pendingStyles.set(n,t),this._updateStyle(n,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let t in this._currentKeyframe)n.push(t);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((g,w)=>{const E=qd(g,new Map,this._backFill);E.forEach((k,$)=>{"!"===k?n.add($):k===Zu&&t.add($)}),i||E.set("offset",w/this.duration),r.push(E)});const l=n.size?R_(n.values()):[],h=t.size?R_(t.values()):[];if(i){const g=r[0],w=new Map(g);g.set("offset",0),w.set("offset",1),r=[g,w]}return e1(this.element,r,l,h,this.duration,this.startTime,this.easing,!1)}}class R8 extends z_{constructor(n,t,i,r,l,h,g=!1){super(n,t,h.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=l,this._stretchStartingKeyframe=g,this.timings={duration:h.duration,delay:h.delay,easing:h.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const l=[],h=i+t,g=t/h,w=qd(n[0]);w.set("offset",0),l.push(w);const E=qd(n[0]);E.set("offset",RP(g)),l.push(E);const k=n.length-1;for(let $=1;$<=k;$++){let te=qd(n[$]);const ie=te.get("offset");te.set("offset",RP((t+ie*i)/h)),l.push(te)}i=h,t=0,r="",n=l}return e1(this.element,n,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function RP(e,n=3){const t=Math.pow(10,n-1);return Math.round(e*t)/t}class r1{}const F8=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class L8 extends r1{normalizePropertyName(n,t){return Yx(n)}normalizeStyleValue(n,t,i,r){let l="";const h=i.toString().trim();if(F8.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)l="px";else{const g=i.match(/^[+-]?[\d\.]+([a-z]*)$/);g&&0==g[1].length&&r.push(function MH(e,n){return new qe(3005,!1)}())}return h+l}}function OP(e,n,t,i,r,l,h,g,w,E,k,$,te){return{type:0,element:e,triggerName:n,isRemovalTransition:r,fromState:t,fromStyles:l,toState:i,toStyles:h,timelines:g,queriedElements:w,preStyleProps:E,postStyleProps:k,totalTime:$,errors:te}}const o1={};class FP{constructor(n,t,i){this._triggerName=n,this.ast=t,this._stateStyles=i}match(n,t,i,r){return function N8(e,n,t,i,r){return e.some(l=>l(n,t,i,r))}(this.ast.matchers,n,t,i,r)}buildStyles(n,t,i){let r=this._stateStyles.get("*");return void 0!==n&&(r=this._stateStyles.get(n?.toString())||r),r?r.buildStyles(t,i):new Map}build(n,t,i,r,l,h,g,w,E,k){const $=[],te=this.ast.options&&this.ast.options.params||o1,we=this.buildStyles(i,g&&g.params||o1,$),Se=w&&w.params||o1,je=this.buildStyles(r,Se,$),dt=new Set,Ue=new Map,Kt=new Map,En="void"===r,_i={params:B8(Se,te),delay:this.ast.options?.delay},Br=k?[]:t1(n,t,this.ast.animation,l,h,we,je,_i,E,$);let no=0;if(Br.forEach(ol=>{no=Math.max(ol.duration+ol.delay,no)}),$.length)return OP(t,this._triggerName,i,r,En,we,je,[],[],Ue,Kt,no,$);Br.forEach(ol=>{const wc=ol.element,H_=il(Ue,wc,new Set);ol.preStyleProps.forEach(qh=>H_.add(qh));const Rg=il(Kt,wc,new Set);ol.postStyleProps.forEach(qh=>Rg.add(qh)),wc!==t&&dt.add(wc)});const js=R_(dt.values());return OP(t,this._triggerName,i,r,En,we,je,Br,js,Ue,Kt,no)}}function B8(e,n){const t=Ag(n);for(const i in e)e.hasOwnProperty(i)&&null!=e[i]&&(t[i]=e[i]);return t}class z8{constructor(n,t,i){this.styles=n,this.defaultParams=t,this.normalizer=i}buildStyles(n,t){const i=new Map,r=Ag(this.defaultParams);return Object.keys(n).forEach(l=>{const h=n[l];null!==h&&(r[l]=h)}),this.styles.styles.forEach(l=>{"string"!=typeof l&&l.forEach((h,g)=>{h&&(h=Pg(h,r,t));const w=this.normalizer.normalizePropertyName(g,t);h=this.normalizer.normalizeStyleValue(g,w,h,t),i.set(g,h)})}),i}}class V8{constructor(n,t,i){this.name=n,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new z8(r.style,r.options&&r.options.params||{},i))}),LP(this.states,"true","1"),LP(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new FP(n,r,this.states))}),this.fallbackTransition=function j8(e,n,t){return new FP(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(h,g)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,t,i,r){return this.transitionFactories.find(h=>h.match(n,t,i,r))||null}matchStyles(n,t,i){return this.fallbackTransition.buildStyles(n,t,i)}}function LP(e,n,t){e.has(n)?e.has(t)||e.set(t,e.get(n)):e.has(t)&&e.set(n,e.get(t))}const U8=new N_;class H8{constructor(n,t,i){this.bodyNode=n,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,t){const i=[],l=Jx(this._driver,t,i,[]);if(i.length)throw function ZH(e){return new qe(3503,!1)}();this._animations.set(n,l)}_buildPlayer(n,t,i){const r=n.element,l=vP(this._normalizer,n.keyframes,t,i);return this._driver.animate(r,l,n.duration,n.delay,n.easing,[],!0)}create(n,t,i={}){const r=[],l=this._animations.get(n);let h;const g=new Map;if(l?(h=t1(this._driver,t,l,Wx,A_,new Map,new Map,i,U8,r),h.forEach(k=>{const $=il(g,k.element,new Map);k.postStyleProps.forEach(te=>$.set(te,null))})):(r.push(function XH(){return new qe(3300,!1)}()),h=[]),r.length)throw function KH(e){return new qe(3504,!1)}();g.forEach((k,$)=>{k.forEach((te,ie)=>{k.set(ie,this._driver.computeStyle($,ie,Zu))})});const E=Hd(h.map(k=>{const $=g.get(k.element);return this._buildPlayer(k,new Map,$)}));return this._playersById.set(n,E),E.onDestroy(()=>this.destroy(n)),this.players.push(E),E}destroy(n){const t=this._getPlayer(n);t.destroy(),this._playersById.delete(n);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(n){const t=this._playersById.get(n);if(!t)throw function YH(e){return new qe(3301,!1)}();return t}listen(n,t,i,r){const l=Hx(t,"","","");return jx(this._getPlayer(n),i,l,r),()=>{}}command(n,t,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,t,r[0]||{});const l=this._getPlayer(n);switch(i){case"play":l.play();break;case"pause":l.pause();break;case"reset":l.reset();break;case"restart":l.restart();break;case"finish":l.finish();break;case"init":l.init();break;case"setPosition":l.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const NP="ng-animate-queued",s1="ng-animate-disabled",X8=[],BP={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},K8={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},bc="__ng_removed";class a1{get params(){return this.options.params}constructor(n,t=""){this.namespaceId=t;const i=n&&n.hasOwnProperty("value");if(this.value=function eq(e){return e??null}(i?n.value:n),i){const l=Ag(n);delete l.value,this.options=l}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const t=n.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const kg="void",l1=new a1(kg);class Y8{constructor(n,t,i){this.id=n,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,Fl(t,this._hostClassName)}listen(n,t,i,r){if(!this._triggers.has(t))throw function JH(e,n){return new qe(3302,!1)}();if(null==i||0==i.length)throw function QH(e){return new qe(3303,!1)}();if(!function tq(e){return"start"==e||"done"==e}(i))throw function e8(e,n){return new qe(3400,!1)}();const l=il(this._elementListeners,n,[]),h={name:t,phase:i,callback:r};l.push(h);const g=il(this._engine.statesByElement,n,new Map);return g.has(t)||(Fl(n,M_),Fl(n,M_+"-"+t),g.set(t,l1)),()=>{this._engine.afterFlush(()=>{const w=l.indexOf(h);w>=0&&l.splice(w,1),this._triggers.has(t)||g.delete(t)})}}register(n,t){return!this._triggers.has(n)&&(this._triggers.set(n,t),!0)}_getTrigger(n){const t=this._triggers.get(n);if(!t)throw function t8(e){return new qe(3401,!1)}();return t}trigger(n,t,i,r=!0){const l=this._getTrigger(t),h=new c1(this.id,t,n);let g=this._engine.statesByElement.get(n);g||(Fl(n,M_),Fl(n,M_+"-"+t),this._engine.statesByElement.set(n,g=new Map));let w=g.get(t);const E=new a1(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&w&&E.absorbOptions(w.options),g.set(t,E),w||(w=l1),E.value!==kg&&w.value===E.value){if(!function rq(e,n){const t=Object.keys(e),i=Object.keys(n);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const l=t[r];if(!n.hasOwnProperty(l)||e[l]!==n[l])return!1}return!0}(w.params,E.params)){const Se=[],je=l.matchStyles(w.value,w.params,Se),dt=l.matchStyles(E.value,E.params,Se);Se.length?this._engine.reportError(Se):this._engine.afterFlush(()=>{Uh(n,je),cu(n,dt)})}return}const te=il(this._engine.playersByElement,n,[]);te.forEach(Se=>{Se.namespaceId==this.id&&Se.triggerName==t&&Se.queued&&Se.destroy()});let ie=l.matchTransition(w.value,E.value,n,E.params),we=!1;if(!ie){if(!r)return;ie=l.fallbackTransition,we=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:t,transition:ie,fromState:w,toState:E,player:h,isFallbackTransition:we}),we||(Fl(n,NP),h.onStart(()=>{Rp(n,NP)})),h.onDone(()=>{let Se=this.players.indexOf(h);Se>=0&&this.players.splice(Se,1);const je=this._engine.playersByElement.get(n);if(je){let dt=je.indexOf(h);dt>=0&&je.splice(dt,1)}}),this.players.push(h),te.push(h),h}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(t=>t.delete(n)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const t=this._engine.playersByElement.get(n);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,t){const i=this._engine.driver.query(n,P_,!0);i.forEach(r=>{if(r[bc])return;const l=this._engine.fetchNamespacesByElement(r);l.size?l.forEach(h=>h.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,t,i,r){const l=this._engine.statesByElement.get(n),h=new Map;if(l){const g=[];if(l.forEach((w,E)=>{if(h.set(E,w.value),this._triggers.has(E)){const k=this.trigger(n,E,kg,r);k&&g.push(k)}}),g.length)return this._engine.markElementAsRemoved(this.id,n,!0,t,h),i&&Hd(g).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const t=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(t&&i){const r=new Set;t.forEach(l=>{const h=l.name;if(r.has(h))return;r.add(h);const w=this._triggers.get(h).fallbackTransition,E=i.get(h)||l1,k=new a1(kg),$=new c1(this.id,h,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:h,transition:w,fromState:E,toState:k,player:$,isFallbackTransition:!0})})}}removeNode(n,t){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,t),this.triggerLeaveAnimation(n,t,!0))return;let r=!1;if(i.totalAnimations){const l=i.players.length?i.playersByQueriedElement.get(n):[];if(l&&l.length)r=!0;else{let h=n;for(;h=h.parentNode;)if(i.statesByElement.get(h)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,t);else{const l=n[bc];(!l||l===BP)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,t))}}insertNode(n,t){Fl(n,this._hostClassName)}drainQueuedTransitions(n){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const l=i.element,h=this._elementListeners.get(l);h&&h.forEach(g=>{if(g.name==i.triggerName){const w=Hx(l,i.triggerName,i.fromState.value,i.toState.value);w._data=n,jx(i.player,g.phase,w,g.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const l=i.transition.ast.depCount,h=r.transition.ast.depCount;return 0==l||0==h?l-h:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}}class J8{_onRemovalComplete(n,t){this.onRemovalComplete(n,t)}constructor(n,t,i){this.bodyNode=n,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,l)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,t){const i=new Y8(n,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let h=!1,g=this.driver.getParentElement(t);for(;g;){const w=r.get(g);if(w){const E=i.indexOf(w);i.splice(E+1,0,n),h=!0;break}g=this.driver.getParentElement(g)}h||i.unshift(n)}else i.push(n);return r.set(t,n),n}register(n,t){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,t)),i}registerTrigger(n,t,i){let r=this._namespaceLookup[n];r&&r.register(t,i)&&this.totalAnimations++}destroy(n,t){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(n);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const t=new Set,i=this.statesByElement.get(n);if(i)for(let r of i.values())if(r.namespaceId){const l=this._fetchNamespace(r.namespaceId);l&&t.add(l)}return t}trigger(n,t,i,r){if($_(t)){const l=this._fetchNamespace(n);if(l)return l.trigger(t,i,r),!0}return!1}insertNode(n,t,i,r){if(!$_(t))return;const l=t[bc];if(l&&l.setForRemoval){l.setForRemoval=!1,l.setForMove=!0;const h=this.collectedLeaveElements.indexOf(t);h>=0&&this.collectedLeaveElements.splice(h,1)}if(n){const h=this._fetchNamespace(n);h&&h.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,t){t?this.disabledNodes.has(n)||(this.disabledNodes.add(n),Fl(n,s1)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),Rp(n,s1))}removeNode(n,t,i){if($_(t)){const r=n?this._fetchNamespace(n):null;r?r.removeNode(t,i):this.markElementAsRemoved(n,t,!1,i);const l=this.namespacesByHostElement.get(t);l&&l.id!==n&&l.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(n,t,i,r,l){this.collectedLeaveElements.push(t),t[bc]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:l}}listen(n,t,i,r,l){return $_(t)?this._fetchNamespace(n).listen(t,i,r,l):()=>{}}_buildInstruction(n,t,i,r,l){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,t,l)}destroyInnerAnimations(n){let t=this.driver.query(n,P_,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(n,Zx,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const t=this.playersByElement.get(n);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const t=this.playersByQueriedElement.get(n);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return Hd(this.players).onDone(()=>n());n()})}processLeaveNode(n){const t=n[bc];if(t&&t.setForRemoval){if(n[bc]=BP,t.namespaceId){this.destroyInnerAnimations(n);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(n)}this._onRemovalComplete(n,t.setForRemoval)}n.classList?.contains(s1)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(n=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Fl(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?Hd(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function n8(e){return new qe(3402,!1)}()}_flushAnimations(n,t){const i=new N_,r=[],l=new Map,h=[],g=new Map,w=new Map,E=new Map,k=new Set;this.disabledNodes.forEach($n=>{k.add($n);const ni=this.driver.query($n,".ng-animate-queued",!0);for(let fi=0;fi<ni.length;fi++)k.add(ni[fi])});const $=this.bodyNode,te=Array.from(this.statesByElement.keys()),ie=VP(te,this.collectedEnterElements),we=new Map;let Se=0;ie.forEach(($n,ni)=>{const fi=Wx+Se++;we.set(ni,fi),$n.forEach(cr=>Fl(cr,fi))});const je=[],dt=new Set,Ue=new Set;for(let $n=0;$n<this.collectedLeaveElements.length;$n++){const ni=this.collectedLeaveElements[$n],fi=ni[bc];fi&&fi.setForRemoval&&(je.push(ni),dt.add(ni),fi.hasAnimation?this.driver.query(ni,".ng-star-inserted",!0).forEach(cr=>dt.add(cr)):Ue.add(ni))}const Kt=new Map,En=VP(te,Array.from(dt));En.forEach(($n,ni)=>{const fi=A_+Se++;Kt.set(ni,fi),$n.forEach(cr=>Fl(cr,fi))}),n.push(()=>{ie.forEach(($n,ni)=>{const fi=we.get(ni);$n.forEach(cr=>Rp(cr,fi))}),En.forEach(($n,ni)=>{const fi=Kt.get(ni);$n.forEach(cr=>Rp(cr,fi))}),je.forEach($n=>{this.processLeaveNode($n)})});const _i=[],Br=[];for(let $n=this._namespaceList.length-1;$n>=0;$n--)this._namespaceList[$n].drainQueuedTransitions(t).forEach(fi=>{const cr=fi.player,Ms=fi.element;if(_i.push(cr),this.collectedEnterElements.length){const ra=Ms[bc];if(ra&&ra.setForMove){if(ra.previousTriggersValues&&ra.previousTriggersValues.has(fi.triggerName)){const Gh=ra.previousTriggersValues.get(fi.triggerName),Ll=this.statesByElement.get(fi.element);if(Ll&&Ll.has(fi.triggerName)){const q_=Ll.get(fi.triggerName);q_.value=Gh,Ll.set(fi.triggerName,q_)}}return void cr.destroy()}}const uu=!$||!this.driver.containsElement($,Ms),sl=Kt.get(Ms),Gd=we.get(Ms),Eo=this._buildInstruction(fi,i,Gd,sl,uu);if(Eo.errors&&Eo.errors.length)return void Br.push(Eo);if(uu)return cr.onStart(()=>Uh(Ms,Eo.fromStyles)),cr.onDestroy(()=>cu(Ms,Eo.toStyles)),void r.push(cr);if(fi.isFallbackTransition)return cr.onStart(()=>Uh(Ms,Eo.fromStyles)),cr.onDestroy(()=>cu(Ms,Eo.toStyles)),void r.push(cr);const nk=[];Eo.timelines.forEach(ra=>{ra.stretchStartingKeyframe=!0,this.disabledNodes.has(ra.element)||nk.push(ra)}),Eo.timelines=nk,i.append(Ms,Eo.timelines),h.push({instruction:Eo,player:cr,element:Ms}),Eo.queriedElements.forEach(ra=>il(g,ra,[]).push(cr)),Eo.preStyleProps.forEach((ra,Gh)=>{if(ra.size){let Ll=w.get(Gh);Ll||w.set(Gh,Ll=new Set),ra.forEach((q_,h1)=>Ll.add(h1))}}),Eo.postStyleProps.forEach((ra,Gh)=>{let Ll=E.get(Gh);Ll||E.set(Gh,Ll=new Set),ra.forEach((q_,h1)=>Ll.add(h1))})});if(Br.length){const $n=[];Br.forEach(ni=>{$n.push(function i8(e,n){return new qe(3505,!1)}())}),_i.forEach(ni=>ni.destroy()),this.reportError($n)}const no=new Map,js=new Map;h.forEach($n=>{const ni=$n.element;i.has(ni)&&(js.set(ni,ni),this._beforeAnimationBuild($n.player.namespaceId,$n.instruction,no))}),r.forEach($n=>{const ni=$n.element;this._getPreviousPlayers(ni,!1,$n.namespaceId,$n.triggerName,null).forEach(cr=>{il(no,ni,[]).push(cr),cr.destroy()})});const ol=je.filter($n=>UP($n,w,E)),wc=new Map;$P(wc,this.driver,Ue,E,Zu).forEach($n=>{UP($n,w,E)&&ol.push($n)});const Rg=new Map;ie.forEach(($n,ni)=>{$P(Rg,this.driver,new Set($n),w,"!")}),ol.forEach($n=>{const ni=wc.get($n),fi=Rg.get($n);wc.set($n,new Map([...ni?.entries()??[],...fi?.entries()??[]]))});const qh=[],ek=[],tk={};h.forEach($n=>{const{element:ni,player:fi,instruction:cr}=$n;if(i.has(ni)){if(k.has(ni))return fi.onDestroy(()=>cu(ni,cr.toStyles)),fi.disabled=!0,fi.overrideTotalTime(cr.totalTime),void r.push(fi);let Ms=tk;if(js.size>1){let sl=ni;const Gd=[];for(;sl=sl.parentNode;){const Eo=js.get(sl);if(Eo){Ms=Eo;break}Gd.push(sl)}Gd.forEach(Eo=>js.set(Eo,Ms))}const uu=this._buildAnimation(fi.namespaceId,cr,no,l,Rg,wc);if(fi.setRealPlayer(uu),Ms===tk)qh.push(fi);else{const sl=this.playersByElement.get(Ms);sl&&sl.length&&(fi.parentPlayer=Hd(sl)),r.push(fi)}}else Uh(ni,cr.fromStyles),fi.onDestroy(()=>cu(ni,cr.toStyles)),ek.push(fi),k.has(ni)&&r.push(fi)}),ek.forEach($n=>{const ni=l.get($n.element);if(ni&&ni.length){const fi=Hd(ni);$n.setRealPlayer(fi)}}),r.forEach($n=>{$n.parentPlayer?$n.syncPlayerEvents($n.parentPlayer):$n.destroy()});for(let $n=0;$n<je.length;$n++){const ni=je[$n],fi=ni[bc];if(Rp(ni,A_),fi&&fi.hasAnimation)continue;let cr=[];if(g.size){let uu=g.get(ni);uu&&uu.length&&cr.push(...uu);let sl=this.driver.query(ni,Zx,!0);for(let Gd=0;Gd<sl.length;Gd++){let Eo=g.get(sl[Gd]);Eo&&Eo.length&&cr.push(...Eo)}}const Ms=cr.filter(uu=>!uu.destroyed);Ms.length?nq(this,ni,Ms):this.processLeaveNode(ni)}return je.length=0,qh.forEach($n=>{this.players.push($n),$n.onDone(()=>{$n.destroy();const ni=this.players.indexOf($n);this.players.splice(ni,1)}),$n.play()}),qh}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,t,i,r,l){let h=[];if(t){const g=this.playersByQueriedElement.get(n);g&&(h=g)}else{const g=this.playersByElement.get(n);if(g){const w=!l||l==kg;g.forEach(E=>{E.queued||!w&&E.triggerName!=r||h.push(E)})}}return(i||r)&&(h=h.filter(g=>!(i&&i!=g.namespaceId||r&&r!=g.triggerName))),h}_beforeAnimationBuild(n,t,i){const l=t.element,h=t.isRemovalTransition?void 0:n,g=t.isRemovalTransition?void 0:t.triggerName;for(const w of t.timelines){const E=w.element,k=E!==l,$=il(i,E,[]);this._getPreviousPlayers(E,k,h,g,t.toState).forEach(ie=>{const we=ie.getRealPlayer();we.beforeDestroy&&we.beforeDestroy(),ie.destroy(),$.push(ie)})}Uh(l,t.fromStyles)}_buildAnimation(n,t,i,r,l,h){const g=t.triggerName,w=t.element,E=[],k=new Set,$=new Set,te=t.timelines.map(we=>{const Se=we.element;k.add(Se);const je=Se[bc];if(je&&je.removedBeforeQueried)return new Tg(we.duration,we.delay);const dt=Se!==w,Ue=function iq(e){const n=[];return jP(e,n),n}((i.get(Se)||X8).map(no=>no.getRealPlayer())).filter(no=>!!no.element&&no.element===Se),Kt=l.get(Se),En=h.get(Se),_i=vP(this._normalizer,we.keyframes,Kt,En),Br=this._buildPlayer(we,_i,Ue);if(we.subTimeline&&r&&$.add(Se),dt){const no=new c1(n,g,Se);no.setRealPlayer(Br),E.push(no)}return Br});E.forEach(we=>{il(this.playersByQueriedElement,we.element,[]).push(we),we.onDone(()=>function Q8(e,n,t){let i=e.get(n);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&e.delete(n)}return i}(this.playersByQueriedElement,we.element,we))}),k.forEach(we=>Fl(we,EP));const ie=Hd(te);return ie.onDestroy(()=>{k.forEach(we=>Rp(we,EP)),cu(w,t.toStyles)}),$.forEach(we=>{il(r,we,[]).push(ie)}),ie}_buildPlayer(n,t,i){return t.length>0?this.driver.animate(n.element,t,n.duration,n.delay,n.easing,i):new Tg(n.duration,n.delay)}}class c1{constructor(n,t,i){this.namespaceId=n,this.triggerName=t,this.element=i,this._player=new Tg,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>jx(n,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const t=this._player;t.triggerCallback&&n.onStart(()=>t.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,t){il(this._queuedCallbacks,n,[]).push(t)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const t=this._player;t.triggerCallback&&t.triggerCallback(n)}}function $_(e){return e&&1===e.nodeType}function zP(e,n){const t=e.style.display;return e.style.display=n??"none",t}function $P(e,n,t,i,r){const l=[];t.forEach(w=>l.push(zP(w)));const h=[];i.forEach((w,E)=>{const k=new Map;w.forEach($=>{const te=n.computeStyle(E,$,r);k.set($,te),(!te||0==te.length)&&(E[bc]=K8,h.push(E))}),e.set(E,k)});let g=0;return t.forEach(w=>zP(w,l[g++])),h}function VP(e,n){const t=new Map;if(e.forEach(g=>t.set(g,[])),0==n.length)return t;const r=new Set(n),l=new Map;function h(g){if(!g)return 1;let w=l.get(g);if(w)return w;const E=g.parentNode;return w=t.has(E)?E:r.has(E)?1:h(E),l.set(g,w),w}return n.forEach(g=>{const w=h(g);1!==w&&t.get(w).push(g)}),t}function Fl(e,n){e.classList?.add(n)}function Rp(e,n){e.classList?.remove(n)}function nq(e,n,t){Hd(t).onDone(()=>e.processLeaveNode(n))}function jP(e,n){for(let t=0;t<e.length;t++){const i=e[t];i instanceof gP?jP(i.players,n):n.push(i)}}function UP(e,n,t){const i=t.get(e);if(!i)return!1;let r=n.get(e);return r?i.forEach(l=>r.add(l)):n.set(e,i),t.delete(e),!0}class V_{constructor(n,t,i){this.bodyNode=n,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,l)=>{},this._transitionEngine=new J8(n,t,i),this._timelineEngine=new H8(n,t,i),this._transitionEngine.onRemovalComplete=(r,l)=>this.onRemovalComplete(r,l)}registerTrigger(n,t,i,r,l){const h=n+"-"+r;let g=this._triggerCache[h];if(!g){const w=[],k=Jx(this._driver,l,w,[]);if(w.length)throw function GH(e,n){return new qe(3404,!1)}();g=function $8(e,n,t){return new V8(e,n,t)}(r,k,this._normalizer),this._triggerCache[h]=g}this._transitionEngine.registerTrigger(t,r,g)}register(n,t){this._transitionEngine.register(n,t)}destroy(n,t){this._transitionEngine.destroy(n,t)}onInsert(n,t,i,r){this._transitionEngine.insertNode(n,t,i,r)}onRemove(n,t,i){this._transitionEngine.removeNode(n,t,i)}disableAnimations(n,t){this._transitionEngine.markElementAsDisabled(n,t)}process(n,t,i,r){if("@"==i.charAt(0)){const[l,h]=_P(i);this._timelineEngine.command(l,t,h,r)}else this._transitionEngine.trigger(n,t,i,r)}listen(n,t,i,r,l){if("@"==i.charAt(0)){const[h,g]=_P(i);return this._timelineEngine.listen(h,t,g,l)}return this._transitionEngine.listen(n,t,i,r,l)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}}let sq=(()=>{class e{static#e=this.initialStylesByElement=new WeakMap;constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let l=e.initialStylesByElement.get(t);l||e.initialStylesByElement.set(t,l=new Map),this._initialStyles=l}start(){this._state<1&&(this._startStyles&&cu(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(cu(this._element,this._initialStyles),this._endStyles&&(cu(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(Uh(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Uh(this._element,this._endStyles),this._endStyles=null),cu(this._element,this._initialStyles),this._state=3)}}return e})();function u1(e){let n=null;return e.forEach((t,i)=>{(function aq(e){return"display"===e||"position"===e})(i)&&(n=n||new Map,n.set(i,t))}),n}class HP{constructor(n,t,i,r){this.element=n,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map;const t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const t=[];return n.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(n,t,i){return n.animate(this._convertKeyframesToObject(t),i)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&n.set(r,this._finished?i:AP(this.element,r))}),this.currentSnapshot=n}triggerCallback(n){const t="start"===n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class lq{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,t){return!1}containsElement(n,t){return wP(n,t)}getParentElement(n){return qx(n)}query(n,t,i){return xP(n,t,i)}computeStyle(n,t,i){return window.getComputedStyle(n)[t]}animate(n,t,i,r,l,h=[]){const w={duration:i,delay:r,fill:0==r?"both":"forwards"};l&&(w.easing=l);const E=new Map,k=h.filter(ie=>ie instanceof HP);(function m8(e,n){return 0===e||0===n})(i,r)&&k.forEach(ie=>{ie.currentSnapshot.forEach((we,Se)=>E.set(Se,we))});let $=function h8(e){return e.length?e[0]instanceof Map?e:e.map(n=>IP(n)):[]}(t).map(ie=>qd(ie));$=function g8(e,n,t){if(t.size&&n.length){let i=n[0],r=[];if(t.forEach((l,h)=>{i.has(h)||r.push(h),i.set(h,l)}),r.length)for(let l=1;l<n.length;l++){let h=n[l];r.forEach(g=>h.set(g,AP(e,g)))}}return n}(n,$,E);const te=function oq(e,n){let t=null,i=null;return Array.isArray(n)&&n.length?(t=u1(n[0]),n.length>1&&(i=u1(n[n.length-1]))):n instanceof Map&&(t=u1(n)),t||i?new sq(e,t,i):null}(n,$);return new HP(n,$,w,te)}}let cq=(()=>{class e extends hP{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:yo.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?pP(t):t;return qP(this._renderer,null,i,"register",[r]),new uq(i,this._renderer)}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(Tm),Ht(Fo))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();class uq extends CH{constructor(n,t){super(),this._id=n,this._renderer=t}create(n,t){return new dq(this._id,n,t||{},this._renderer)}}class dq{constructor(n,t,i,r){this.id=n,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(n,t){return this._renderer.listen(this.element,`@@${this.id}:${n}`,t)}_command(n,...t){return qP(this._renderer,this.element,this.id,n,t)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function qP(e,n,t,i,r){return e.setProperty(n,`@@${t}:${i}`,r)}const GP="@.disabled";let hq=(()=>{class e{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(l,h)=>{const g=h?.parentNode(l);g&&h.removeChild(g,l)}}createRenderer(t,i){const l=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let k=this._rendererCache.get(l);return k||(k=new WP("",l,this.engine,()=>this._rendererCache.delete(l)),this._rendererCache.set(l,k)),k}const h=i.id,g=i.id+"-"+this._currentId;this._currentId++,this.engine.register(g,t);const w=k=>{Array.isArray(k)?k.forEach(w):this.engine.registerTrigger(h,g,t,k.name,k)};return i.data.animation.forEach(w),new fq(this,g,l,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(l=>{const[h,g]=l;h(g)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(Tm),Ht(V_),Ht(vt))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})();class WP{constructor(n,t,i,r){this.namespaceId=n,this.delegate=t,this.engine=i,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,t){return this.delegate.createElement(n,t)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,t){this.delegate.appendChild(n,t),this.engine.onInsert(this.namespaceId,t,n,!1)}insertBefore(n,t,i,r=!0){this.delegate.insertBefore(n,t,i),this.engine.onInsert(this.namespaceId,t,n,r)}removeChild(n,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(n,t){return this.delegate.selectRootElement(n,t)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,t,i,r){this.delegate.setAttribute(n,t,i,r)}removeAttribute(n,t,i){this.delegate.removeAttribute(n,t,i)}addClass(n,t){this.delegate.addClass(n,t)}removeClass(n,t){this.delegate.removeClass(n,t)}setStyle(n,t,i,r){this.delegate.setStyle(n,t,i,r)}removeStyle(n,t,i){this.delegate.removeStyle(n,t,i)}setProperty(n,t,i){"@"==t.charAt(0)&&t==GP?this.disableAnimations(n,!!i):this.delegate.setProperty(n,t,i)}setValue(n,t){this.delegate.setValue(n,t)}listen(n,t,i){return this.delegate.listen(n,t,i)}disableAnimations(n,t){this.engine.disableAnimations(n,t)}}class fq extends WP{constructor(n,t,i,r,l){super(t,i,r,l),this.factory=n,this.namespaceId=t}setProperty(n,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==GP?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,t.slice(1),i):this.delegate.setProperty(n,t,i)}listen(n,t,i){if("@"==t.charAt(0)){const r=function pq(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(n);let l=t.slice(1),h="";return"@"!=l.charAt(0)&&([l,h]=function mq(e){const n=e.indexOf(".");return[e.substring(0,n),e.slice(n+1)]}(l)),this.engine.listen(this.namespaceId,r,l,h,g=>{this.factory.scheduleListenerCallback(g._data||-1,i,g)})}return this.delegate.listen(n,t,i)}}const ZP=[{provide:hP,useClass:cq},{provide:r1,useFactory:function yq(){return new L8}},{provide:V_,useClass:(()=>{class e extends V_{constructor(t,i,r,l){super(t.body,i,r)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||e)(Ht(Fo),Ht(Gx),Ht(r1),Ht(ou))};static#t=this.\u0275prov=Pe({token:e,factory:e.\u0275fac})}return e})()},{provide:Tm,useFactory:function vq(e,n,t){return new hq(e,n,t)},deps:[Mw,V_,vt]}],d1=[{provide:Gx,useFactory:()=>new lq},{provide:lD,useValue:"BrowserAnimations"},...ZP],XP=[{provide:Gx,useClass:CP},{provide:lD,useValue:"NoopAnimations"},...ZP];let _q=(()=>{class e{static withConfig(t){return{ngModule:e,providers:t.disableAnimations?XP:d1}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ro({type:e});static#n=this.\u0275inj=Rt({providers:d1,imports:[aA]})}return e})();const KP=["toast-component",""];function bq(e,n){if(1&e){const t=av();zi(0,"button",5),lr("click",function(){return ef(t),cd(na().remove())}),zi(1,"span",6),Qr(2,"\xd7"),Yi()()}}function wq(e,n){if(1&e&&(ip(0),Qr(1),rp()),2&e){const t=na(2);jr(1),fc("[",t.duplicatesCount+1,"]")}}function xq(e,n){if(1&e&&(zi(0,"div"),Qr(1),ta(2,wq,2,1,"ng-container",4),Yi()),2&e){const t=na();Nu(t.options.titleClass),ea("aria-label",t.title),jr(1),fc(" ",t.title," "),jr(1),po("ngIf",t.duplicatesCount)}}function Cq(e,n){if(1&e&&kl(0,"div",7),2&e){const t=na();Nu(t.options.messageClass),po("innerHTML",t.message,Cm)}}function Dq(e,n){if(1&e&&(zi(0,"div",8),Qr(1),Yi()),2&e){const t=na();Nu(t.options.messageClass),ea("aria-label",t.message),jr(1),fc(" ",t.message," ")}}function Eq(e,n){if(1&e&&(zi(0,"div"),kl(1,"div",9),Yi()),2&e){const t=na();jr(1),sp("width",t.width()+"%")}}class kq{_attachedHost;component;viewContainerRef;injector;constructor(n,t){this.component=n,this.injector=t}attach(n,t){return this._attachedHost=n,n.attach(this,t)}detach(){const n=this._attachedHost;if(n)return this._attachedHost=void 0,n.detach()}get isAttached(){return null!=this._attachedHost}setAttachedHost(n){this._attachedHost=n}}class Rq{_attachedPortal;_disposeFn;attach(n,t){return this._attachedPortal=n,this.attachComponentPortal(n,t)}detach(){this._attachedPortal&&this._attachedPortal.setAttachedHost(),this._attachedPortal=void 0,this._disposeFn&&(this._disposeFn(),this._disposeFn=void 0)}setDisposeFn(n){this._disposeFn=n}}class Oq{_overlayRef;componentInstance;duplicatesCount=0;_afterClosed=new Z;_activate=new Z;_manualClose=new Z;_resetTimeout=new Z;_countDuplicate=new Z;constructor(n){this._overlayRef=n}manualClose(){this._manualClose.next(),this._manualClose.complete()}manualClosed(){return this._manualClose.asObservable()}timeoutReset(){return this._resetTimeout.asObservable()}countDuplicate(){return this._countDuplicate.asObservable()}close(){this._overlayRef.detach(),this._afterClosed.next(),this._manualClose.next(),this._afterClosed.complete(),this._manualClose.complete(),this._activate.complete(),this._resetTimeout.complete(),this._countDuplicate.complete()}afterClosed(){return this._afterClosed.asObservable()}isInactive(){return this._activate.isStopped}activate(){this._activate.next(),this._activate.complete()}afterActivate(){return this._activate.asObservable()}onDuplicate(n,t){n&&this._resetTimeout.next(),t&&this._countDuplicate.next(++this.duplicatesCount)}}class U_{toastId;config;message;title;toastType;toastRef;_onTap=new Z;_onAction=new Z;constructor(n,t,i,r,l,h){this.toastId=n,this.config=t,this.message=i,this.title=r,this.toastType=l,this.toastRef=h,this.toastRef.afterClosed().subscribe(()=>{this._onAction.complete(),this._onTap.complete()})}triggerTap(){this._onTap.next(),this.config.tapToDismiss&&this._onTap.complete()}onTap(){return this._onTap.asObservable()}triggerAction(n){this._onAction.next(n)}onAction(){return this._onAction.asObservable()}}const JP=new ln("ToastConfig");class Fq extends Rq{_hostDomElement;_componentFactoryResolver;_appRef;constructor(n,t,i){super(),this._hostDomElement=n,this._componentFactoryResolver=t,this._appRef=i}attachComponentPortal(n,t){const i=this._componentFactoryResolver.resolveComponentFactory(n.component);let r;return r=i.create(n.injector),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.detachView(r.hostView),r.destroy()}),t?this._hostDomElement.insertBefore(this._getComponentRootNode(r),this._hostDomElement.firstChild):this._hostDomElement.appendChild(this._getComponentRootNode(r)),r}_getComponentRootNode(n){return n.hostView.rootNodes[0]}}let Lq=(()=>{class e{_document=Ft(Fo);_containerElement;ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t=this._document.createElement("div");t.classList.add("overlay-container"),t.setAttribute("aria-live","polite"),this._document.body.appendChild(t),this._containerElement=t}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class Nq{_portalHost;constructor(n){this._portalHost=n}attach(n,t=!0){return this._portalHost.attach(n,t)}detach(){return this._portalHost.detach()}}let Bq=(()=>{class e{_overlayContainer=Ft(Lq);_componentFactoryResolver=Ft(Sm);_appRef=Ft(ou);_document=Ft(Fo);_paneElements=new Map;create(t,i){return this._createOverlayRef(this.getPaneElement(t,i))}getPaneElement(t="",i){return this._paneElements.get(i)||this._paneElements.set(i,{}),this._paneElements.get(i)[t]||(this._paneElements.get(i)[t]=this._createPaneElement(t,i)),this._paneElements.get(i)[t]}_createPaneElement(t,i){const r=this._document.createElement("div");return r.id="toast-container",r.classList.add(t),r.classList.add("toast-container"),i?i.getContainerElement().appendChild(r):this._overlayContainer.getContainerElement().appendChild(r),r}_createPortalHost(t){return new Fq(t,this._componentFactoryResolver,this._appRef)}_createOverlayRef(t){return new Nq(this._createPortalHost(t))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),QP=(()=>{class e{overlay;_injector;sanitizer;ngZone;toastrConfig;currentlyActive=0;toasts=[];overlayContainer;previousToastMessage;index=0;constructor(t,i,r,l,h){this.overlay=i,this._injector=r,this.sanitizer=l,this.ngZone=h,this.toastrConfig={...t.default,...t.config},t.config.iconClasses&&(this.toastrConfig.iconClasses={...t.default.iconClasses,...t.config.iconClasses})}show(t,i,r={},l=""){return this._preBuildNotification(l,t,i,this.applyConfig(r))}success(t,i,r={}){return this._preBuildNotification(this.toastrConfig.iconClasses.success||"",t,i,this.applyConfig(r))}error(t,i,r={}){return this._preBuildNotification(this.toastrConfig.iconClasses.error||"",t,i,this.applyConfig(r))}info(t,i,r={}){return this._preBuildNotification(this.toastrConfig.iconClasses.info||"",t,i,this.applyConfig(r))}warning(t,i,r={}){return this._preBuildNotification(this.toastrConfig.iconClasses.warning||"",t,i,this.applyConfig(r))}clear(t){for(const i of this.toasts)if(void 0!==t){if(i.toastId===t)return void i.toastRef.manualClose()}else i.toastRef.manualClose()}remove(t){const i=this._findToast(t);if(!i||(i.activeToast.toastRef.close(),this.toasts.splice(i.index,1),this.currentlyActive=this.currentlyActive-1,!this.toastrConfig.maxOpened||!this.toasts.length))return!1;if(this.currentlyActive<this.toastrConfig.maxOpened&&this.toasts[this.currentlyActive]){const r=this.toasts[this.currentlyActive].toastRef;r.isInactive()||(this.currentlyActive=this.currentlyActive+1,r.activate())}return!0}findDuplicate(t="",i="",r,l){const{includeTitleDuplicates:h}=this.toastrConfig;for(const g of this.toasts)if((!h||h&&g.title===t)&&g.message===i)return g.toastRef.onDuplicate(r,l),g;return null}applyConfig(t={}){return{...this.toastrConfig,...t}}_findToast(t){for(let i=0;i<this.toasts.length;i++)if(this.toasts[i].toastId===t)return{index:i,activeToast:this.toasts[i]};return null}_preBuildNotification(t,i,r,l){return l.onActivateTick?this.ngZone.run(()=>this._buildNotification(t,i,r,l)):this._buildNotification(t,i,r,l)}_buildNotification(t,i,r,l){if(!l.toastComponent)throw new Error("toastComponent required");const h=this.findDuplicate(r,i,this.toastrConfig.resetTimeoutOnDuplicate&&l.timeOut>0,this.toastrConfig.countDuplicates);if((this.toastrConfig.includeTitleDuplicates&&r||i)&&this.toastrConfig.preventDuplicates&&null!==h)return h;this.previousToastMessage=i;let g=!1;this.toastrConfig.maxOpened&&this.currentlyActive>=this.toastrConfig.maxOpened&&(g=!0,this.toastrConfig.autoDismiss&&this.clear(this.toasts[0].toastId));const w=this.overlay.create(l.positionClass,this.overlayContainer);this.index=this.index+1;let E=i;i&&l.enableHtml&&(E=this.sanitizer.sanitize(ma.HTML,i));const k=new Oq(w),$=new U_(this.index,l,E,r,t,k),ie=Jr.create({providers:[{provide:U_,useValue:$}],parent:this._injector}),we=new kq(l.toastComponent,ie),Se=w.attach(we,l.newestOnTop);k.componentInstance=Se.instance;const je={toastId:this.index,title:r||"",message:i||"",toastRef:k,onShown:k.afterActivate(),onHidden:k.afterClosed(),onTap:$.onTap(),onAction:$.onAction(),portal:Se};return g||(this.currentlyActive=this.currentlyActive+1,setTimeout(()=>{je.toastRef.activate()})),this.toasts.push(je),je}static \u0275fac=function(i){return new(i||e)(Ht(JP),Ht(Bq),Ht(Jr),Ht(dA),Ht(vt))};static \u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const zq={maxOpened:0,autoDismiss:!1,newestOnTop:!0,preventDuplicates:!1,countDuplicates:!1,resetTimeoutOnDuplicate:!1,includeTitleDuplicates:!1,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},closeButton:!1,disableTimeOut:!1,timeOut:5e3,extendedTimeOut:1e3,enableHtml:!1,progressBar:!1,toastClass:"ngx-toastr",positionClass:"toast-top-right",titleClass:"toast-title",messageClass:"toast-message",easing:"ease-in",easeTime:300,tapToDismiss:!0,onActivateTick:!1,progressAnimation:"decreasing",toastComponent:(()=>{class e{toastrService;toastPackage;ngZone;message;title;options;duplicatesCount;originalTimeout;width=ys(-1);toastClasses="";state;get _state(){return this.state()}get displayStyle(){if("inactive"===this.state().value)return"none"}timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(t,i,r){this.toastrService=t,this.toastPackage=i,this.ngZone=r,this.message=i.message,this.title=i.title,this.options=i.config,this.originalTimeout=i.config.timeOut,this.toastClasses=`${i.toastType} ${i.config.toastClass}`,this.sub=i.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=i.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=i.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=i.toastRef.countDuplicate().subscribe(l=>{this.duplicatesCount=l}),this.state=ys({value:"inactive",params:{easeTime:this.toastPackage.config.easeTime,easing:"ease-in"}})}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state.update(t=>({...t,value:"active"})),!0!==this.options.disableTimeOut&&"timeOut"!==this.options.disableTimeOut&&this.options.timeOut&&(this.outsideTimeout(()=>this.remove(),this.options.timeOut),this.hideTime=(new Date).getTime()+this.options.timeOut,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}updateProgress(){if(0===this.width()||100===this.width()||!this.options.timeOut)return;const t=(new Date).getTime();this.width.set((this.hideTime-t)/this.options.timeOut*100),"increasing"===this.options.progressAnimation&&this.width.update(r=>100-r),this.width()<=0&&this.width.set(0),this.width()>=100&&this.width.set(100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state.update(t=>({...t,value:"active"})),this.outsideTimeout(()=>this.remove(),this.originalTimeout),this.options.timeOut=this.originalTimeout,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10)}remove(){"removed"!==this.state().value&&(clearTimeout(this.timeout),this.state.update(t=>({...t,value:"removed"})),this.outsideTimeout(()=>this.toastrService.remove(this.toastPackage.toastId),+this.toastPackage.config.easeTime))}tapToast(){"removed"!==this.state().value&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){"removed"!==this.state().value&&"extendedTimeOut"!==this.options.disableTimeOut&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width.set(0))}delayedHideToast(){!0===this.options.disableTimeOut||"extendedTimeOut"===this.options.disableTimeOut||0===this.options.extendedTimeOut||"removed"===this.state().value||(this.outsideTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}outsideTimeout(t,i){this.ngZone?this.ngZone.runOutsideAngular(()=>this.timeout=setTimeout(()=>this.runInsideAngular(t),i)):this.timeout=setTimeout(()=>t(),i)}outsideInterval(t,i){this.ngZone?this.ngZone.runOutsideAngular(()=>this.intervalId=setInterval(()=>this.runInsideAngular(t),i)):this.intervalId=setInterval(()=>t(),i)}runInsideAngular(t){this.ngZone?this.ngZone.run(()=>t()):t()}static \u0275fac=function(i){return new(i||e)(G(QP),G(U_),G(vt))};static \u0275cmp=Pt({type:e,selectors:[["","toast-component",""]],hostVars:5,hostBindings:function(i,r){1&i&&lr("click",function(){return r.tapToast()})("mouseenter",function(){return r.stickAround()})("mouseleave",function(){return r.delayedHideToast()}),2&i&&(w0("@flyInOut",r._state),Nu(r.toastClasses),sp("display",r.displayStyle))},standalone:!0,features:[gv],attrs:KP,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(i,r){1&i&&(ta(0,bq,3,0,"button",0),ta(1,xq,3,5,"div",1),ta(2,Cq,1,3,"div",2),ta(3,Dq,2,4,"div",3),ta(4,Eq,2,2,"div",4)),2&i&&(po("ngIf",r.options.closeButton),jr(1),po("ngIf",r.title),jr(1),po("ngIf",r.message&&r.options.enableHtml),jr(1),po("ngIf",r.message&&!r.options.enableHtml),jr(1),po("ngIf",r.options.progressBar))},dependencies:[Qm],encapsulation:2,data:{animation:[DH("flyInOut",[$x("inactive",Sg({opacity:0})),$x("active",Sg({opacity:1})),$x("removed",Sg({opacity:0})),mP("inactive => active",fP("{{ easeTime }}ms {{ easing }}")),mP("active => removed",fP("{{ easeTime }}ms {{ easing }}"))])]},changeDetection:0})}return e})()},$q=(e={})=>Al([{provide:JP,useValue:{default:zq,config:e}}]);let Vq=(()=>{class e{static forRoot(t={}){return{ngModule:e,providers:[$q(t)]}}static \u0275fac=function(i){return new(i||e)};static \u0275mod=ro({type:e});static \u0275inj=Rt({})}return e})(),jq=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ro({type:e,bootstrap:[C5]});static#n=this.\u0275inj=Rt({imports:[aA,f3,N3,x5,xH.forRoot(),_q,Vq.forRoot({positionClass:"toast-top-right",timeOut:3e3,progressBar:!0,closeButton:!0,progressAnimation:"increasing"}),g5.forRoot()]})}return e})();nV().bootstrapModule(jq).catch(e=>console.error(e))},3519:function(zr){zr.exports=function(){"use strict";function qn(V,T){(null==T||T>V.length)&&(T=V.length);for(var P=0,z=Array(T);P<T;P++)z[P]=V[P];return z}function fn(V,T,P){if("function"==typeof V?V===T:V.has(T))return arguments.length<3?T:P;throw new TypeError("Private element is not present on this object")}function x(V,T,P){return T=It(T),function ze(V,T){if(T&&("object"==typeof T||"function"==typeof T))return T;if(void 0!==T)throw new TypeError("Derived constructors may only return object or undefined");return function X(V){if(void 0===V)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return V}(V)}(V,mt()?Reflect.construct(T,P||[],It(V).constructor):T.apply(V,P))}function hn(V,T){if(!(V instanceof T))throw new TypeError("Cannot call a class as a function")}function st(V,T){return V.get(fn(V,T))}function Ae(V,T,P){(function an(V,T){if(T.has(V))throw new TypeError("Cannot initialize the same private elements twice on an object")})(V,T),T.set(V,P)}function Mt(V,T,P){return T&&function xt(V,T){for(var P=0;P<T.length;P++){var z=T[P];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(V,on(z.key),z)}}(V.prototype,T),Object.defineProperty(V,"prototype",{writable:!1}),V}function ct(){return ct=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(V,T,P){var z=function Yt(V,T){for(;!{}.hasOwnProperty.call(V,T)&&null!==(V=It(V)););return V}(V,T);if(z){var me=Object.getOwnPropertyDescriptor(z,T);return me.get?me.get.call(arguments.length<3?V:P):me.value}},ct.apply(null,arguments)}function It(V){return(It=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(T){return T.__proto__||Object.getPrototypeOf(T)})(V)}function mt(){try{var V=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mt=function(){return!!V})()}function lt(V,T){return(lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(P,z){return P.__proto__=z,P})(V,T)}function Je(V,T){return function Ke(V){if(Array.isArray(V))return V}(V)||function bt(V,T){var P=null==V?null:typeof Symbol<"u"&&V[Symbol.iterator]||V["@@iterator"];if(null!=P){var z,me,Ve,Ot,ui=[],Xn=!0,or=!1;try{if(Ve=(P=P.call(V)).next,0!==T)for(;!(Xn=(z=Ve.call(P)).done)&&(ui.push(z.value),ui.length!==T);Xn=!0);}catch(_o){or=!0,me=_o}finally{try{if(!Xn&&null!=P.return&&(Ot=P.return(),Object(Ot)!==Ot))return}finally{if(or)throw me}}return ui}}(V,T)||Gn(V,T)||function Ze(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $t(V){return function We(V){if(Array.isArray(V))return qn(V)}(V)||function Qe(V){if(typeof Symbol<"u"&&null!=V[Symbol.iterator]||null!=V["@@iterator"])return Array.from(V)}(V)||Gn(V)||function bn(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function on(V){var T=function at(V,T){if("object"!=typeof V||!V)return V;var P=V[Symbol.toPrimitive];if(void 0!==P){var z=P.call(V,T);if("object"!=typeof z)return z;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(V)}(V,"string");return"symbol"==typeof T?T:T+""}function ut(V){return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(T){return typeof T}:function(T){return T&&"function"==typeof Symbol&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T})(V)}function Gn(V,T){if(V){if("string"==typeof V)return qn(V,T);var P={}.toString.call(V).slice(8,-1);return"Object"===P&&V.constructor&&(P=V.constructor.name),"Map"===P||"Set"===P?Array.from(V):"Arguments"===P||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(P)?qn(V,T):void 0}}var gt={},ge=function(T){return new Promise(function(P){if(!T)return P();var z=window.scrollX,me=window.scrollY;gt.restoreFocusTimeout=setTimeout(function(){gt.previousActiveElement instanceof HTMLElement?(gt.previousActiveElement.focus(),gt.previousActiveElement=null):document.body&&document.body.focus(),P()},100),window.scrollTo(z,me)})},Z=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"].reduce(function(V,T){return V[T]="swal2-"+T,V},{}),qt=["success","warning","info","question","error"].reduce(function(V,T){return V[T]="swal2-"+T,V},{}),kt="SweetAlert2:",Lt=function(T){return T.charAt(0).toUpperCase()+T.slice(1)},jt=function(T){console.warn("".concat(kt," ").concat("object"===ut(T)?T.join(" "):T))},mn=function(T){console.error("".concat(kt," ").concat(T))},di=[],ri=function(T){var P=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(T){di.includes(T)||(di.push(T),jt(T))}('"'.concat(T,'" is deprecated and will be removed in the next major release.').concat(P?' Use "'.concat(P,'" instead.'):""))},ur=function(T){return"function"==typeof T?T():T},ve=function(T){return T&&"function"==typeof T.toPromise},Oi=function(T){return ve(T)?T.toPromise():Promise.resolve(T)},dr=function(T){return T&&Promise.resolve(T)===T},Pn=function(){return document.body.querySelector(".".concat(Z.container))},Vn=function(T){var P=Pn();return P?P.querySelector(T):null},ht=function(T){return Vn(".".concat(T))},Ne=function(){return ht(Z.popup)},et=function(){return ht(Z.icon)},Fn=function(){return ht(Z.title)},$i=function(){return ht(Z["html-container"])},ki=function(){return ht(Z.image)},it=function(){return ht(Z["progress-steps"])},vi=function(){return ht(Z["validation-message"])},hi=function(){return Vn(".".concat(Z.actions," .").concat(Z.confirm))},hr=function(){return Vn(".".concat(Z.actions," .").concat(Z.cancel))},Hi=function(){return Vn(".".concat(Z.actions," .").concat(Z.deny))},Wn=function(){return Vn(".".concat(Z.loader))},In=function(){return ht(Z.actions)},Ur=function(){return ht(Z.footer)},uo=function(){return ht(Z["timer-progress-bar"])},Nn=function(){return ht(Z.close)},go=function(){var T=Ne();if(!T)return[];var P=T.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),z=Array.from(P).sort(function(Ot,ui){var Xn=parseInt(Ot.getAttribute("tabindex")||"0"),or=parseInt(ui.getAttribute("tabindex")||"0");return Xn>or?1:Xn<or?-1:0}),me=T.querySelectorAll('\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n'),Ve=Array.from(me).filter(function(Ot){return"-1"!==Ot.getAttribute("tabindex")});return $t(new Set(z.concat(Ve))).filter(function(Ot){return Dn(Ot)})},Zr=function(){return H(document.body,Z.shown)&&!H(document.body,Z["toast-shown"])&&!H(document.body,Z["no-backdrop"])},io=function(){var T=Ne();return!!T&&H(T,Z.toast)},U=function(T,P){if(T.textContent="",P){var me=(new DOMParser).parseFromString(P,"text/html"),Ve=me.querySelector("head");Ve&&Array.from(Ve.childNodes).forEach(function(ui){T.appendChild(ui)});var Ot=me.querySelector("body");Ot&&Array.from(Ot.childNodes).forEach(function(ui){ui instanceof HTMLVideoElement||ui instanceof HTMLAudioElement?T.appendChild(ui.cloneNode(!0)):T.appendChild(ui)})}},H=function(T,P){if(!P)return!1;for(var z=P.split(/\s+/),me=0;me<z.length;me++)if(!T.classList.contains(z[me]))return!1;return!0},re=function(T,P,z){if(function(T,P){Array.from(T.classList).forEach(function(z){!Object.values(Z).includes(z)&&!Object.values(qt).includes(z)&&!Object.values(P.showClass||{}).includes(z)&&T.classList.remove(z)})}(T,P),P.customClass){var me=P.customClass[z];if(me){if("string"!=typeof me&&!me.forEach)return void jt("Invalid type of customClass.".concat(z,'! Expected string or iterable object, got "').concat(ut(me),'"'));ce(T,me)}}},Ce=function(T,P){if(!P)return null;switch(P){case"select":case"textarea":case"file":return T.querySelector(".".concat(Z.popup," > .").concat(Z[P]));case"checkbox":return T.querySelector(".".concat(Z.popup," > .").concat(Z.checkbox," input"));case"radio":return T.querySelector(".".concat(Z.popup," > .").concat(Z.radio," input:checked"))||T.querySelector(".".concat(Z.popup," > .").concat(Z.radio," input:first-child"));case"range":return T.querySelector(".".concat(Z.popup," > .").concat(Z.range," input"));default:return T.querySelector(".".concat(Z.popup," > .").concat(Z.input))}},Te=function(T){if(T.focus(),"file"!==T.type){var P=T.value;T.value="",T.value=P}},ke=function(T,P,z){!T||!P||("string"==typeof P&&(P=P.split(/\s+/).filter(Boolean)),P.forEach(function(me){Array.isArray(T)?T.forEach(function(Ve){z?Ve.classList.add(me):Ve.classList.remove(me)}):z?T.classList.add(me):T.classList.remove(me)}))},ce=function(T,P){ke(T,P,!0)},$e=function(T,P){ke(T,P,!1)},rt=function(T,P){for(var z=Array.from(T.children),me=0;me<z.length;me++){var Ve=z[me];if(Ve instanceof HTMLElement&&H(Ve,P))return Ve}},Le=function(T,P,z){z==="".concat(parseInt(z))&&(z=parseInt(z)),z||0===parseInt(z)?T.style.setProperty(P,"number"==typeof z?"".concat(z,"px"):z):T.style.removeProperty(P)},wt=function(T){T&&(T.style.display=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex")},Ut=function(T){T&&(T.style.display="none")},tn=function(T){var P=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block";T&&new MutationObserver(function(){oi(T,T.innerHTML,P)}).observe(T,{childList:!0,subtree:!0})},kn=function(T,P,z,me){var Ve=T.querySelector(P);Ve&&Ve.style.setProperty(z,me)},oi=function(T,P){P?wt(T,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex"):Ut(T)},Dn=function(T){return!(!T||!(T.offsetWidth||T.offsetHeight||T.getClientRects().length))},pi=function(T){return T.scrollHeight>T.clientHeight},bi=function(T){var P=window.getComputedStyle(T),z=parseFloat(P.getPropertyValue("animation-duration")||"0"),me=parseFloat(P.getPropertyValue("transition-duration")||"0");return z>0||me>0},ei=function(T){var P=arguments.length>1&&void 0!==arguments[1]&&arguments[1],z=uo();z&&Dn(z)&&(P&&(z.style.transition="none",z.style.width="100%"),setTimeout(function(){z.style.transition="width ".concat(T/1e3,"s linear"),z.style.width="0%"},10))},qi=function(){return typeof window>"u"||typeof document>"u"},mi='\n <div aria-labelledby="'.concat(Z.title,'" aria-describedby="').concat(Z["html-container"],'" class="').concat(Z.popup,'" tabindex="-1">\n   <button type="button" class="').concat(Z.close,'"></button>\n   <ul class="').concat(Z["progress-steps"],'"></ul>\n   <div class="').concat(Z.icon,'"></div>\n   <img class="').concat(Z.image,'" />\n   <h2 class="').concat(Z.title,'" id="').concat(Z.title,'"></h2>\n   <div class="').concat(Z["html-container"],'" id="').concat(Z["html-container"],'"></div>\n   <input class="').concat(Z.input,'" id="').concat(Z.input,'" />\n   <input type="file" class="').concat(Z.file,'" />\n   <div class="').concat(Z.range,'">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="').concat(Z.select,'" id="').concat(Z.select,'"></select>\n   <div class="').concat(Z.radio,'"></div>\n   <label class="').concat(Z.checkbox,'">\n     <input type="checkbox" id="').concat(Z.checkbox,'" />\n     <span class="').concat(Z.label,'"></span>\n   </label>\n   <textarea class="').concat(Z.textarea,'" id="').concat(Z.textarea,'"></textarea>\n   <div class="').concat(Z["validation-message"],'" id="').concat(Z["validation-message"],'"></div>\n   <div class="').concat(Z.actions,'">\n     <div class="').concat(Z.loader,'"></div>\n     <button type="button" class="').concat(Z.confirm,'"></button>\n     <button type="button" class="').concat(Z.deny,'"></button>\n     <button type="button" class="').concat(Z.cancel,'"></button>\n   </div>\n   <div class="').concat(Z.footer,'"></div>\n   <div class="').concat(Z["timer-progress-bar-container"],'">\n     <div class="').concat(Z["timer-progress-bar"],'"></div>\n   </div>\n </div>\n').replace(/(^|\n)\s*/g,""),Ci=function(){gt.currentInstance.resetValidationMessage()},ir=function(T){var P=function(){var T=Pn();return!!T&&(T.remove(),$e([document.documentElement,document.body],[Z["no-backdrop"],Z["toast-shown"],Z["has-column"]]),!0)}();if(qi())mn("SweetAlert2 requires document to initialize");else{var z=document.createElement("div");z.className=Z.container,P&&ce(z,Z["no-transition"]),U(z,mi);var me=function(T){return"string"==typeof T?document.querySelector(T):T}(T.target);me.appendChild(z),function(T){var P=Ne();P.setAttribute("role",T.toast?"alert":"dialog"),P.setAttribute("aria-live",T.toast?"polite":"assertive"),T.toast||P.setAttribute("aria-modal","true")}(T),function(T){"rtl"===window.getComputedStyle(T).direction&&ce(Pn(),Z.rtl)}(me),function(){var T=Ne(),P=rt(T,Z.input),z=rt(T,Z.file),me=T.querySelector(".".concat(Z.range," input")),Ve=T.querySelector(".".concat(Z.range," output")),Ot=rt(T,Z.select),ui=T.querySelector(".".concat(Z.checkbox," input")),Xn=rt(T,Z.textarea);P.oninput=Ci,z.onchange=Ci,Ot.onchange=Ci,ui.onchange=Ci,Xn.oninput=Ci,me.oninput=function(){Ci(),Ve.value=me.value},me.onchange=function(){Ci(),Ve.value=me.value}}()}},kr=function(T,P){T instanceof HTMLElement?P.appendChild(T):"object"===ut(T)?Nl(T,P):T&&U(P,T)},Nl=function(T,P){T.jquery?He(P,T):U(P,T.toString())},He=function(T,P){if(T.textContent="",0 in P)for(var z=0;z in P;z++)T.appendChild(P[z].cloneNode(!0));else T.appendChild(P.cloneNode(!0))},St=function(){if(qi())return!1;var V=document.createElement("div");return typeof V.style.webkitAnimation<"u"?"webkitAnimationEnd":typeof V.style.animation<"u"&&"animationend"}(),ii=function(T,P){var z=In(),me=Wn();!z||!me||(P.showConfirmButton||P.showDenyButton||P.showCancelButton?wt(z):Ut(z),re(z,P,"actions"),function Gi(V,T,P){var z=hi(),me=Hi(),Ve=hr();!z||!me||!Ve||(br(z,"confirm",P),br(me,"deny",P),br(Ve,"cancel",P),function Di(V,T,P,z){z.buttonsStyling?(ce([V,T,P],Z.styled),z.confirmButtonColor&&(V.style.backgroundColor=z.confirmButtonColor,ce(V,Z["default-outline"])),z.denyButtonColor&&(T.style.backgroundColor=z.denyButtonColor,ce(T,Z["default-outline"])),z.cancelButtonColor&&(P.style.backgroundColor=z.cancelButtonColor,ce(P,Z["default-outline"]))):$e([V,T,P],Z.styled)}(z,me,Ve,P),P.reverseButtons&&(P.toast?(V.insertBefore(Ve,z),V.insertBefore(me,z)):(V.insertBefore(Ve,T),V.insertBefore(me,T),V.insertBefore(z,T))))}(z,me,P),U(me,P.loaderHtml||""),re(me,P,"loader"))};function br(V,T,P){var z=Lt(T);oi(V,P["show".concat(z,"Button")],"inline-block"),U(V,P["".concat(T,"ButtonText")]||""),V.setAttribute("aria-label",P["".concat(T,"ButtonAriaLabel")]||""),V.className=Z[T],re(V,P,"".concat(T,"Button"))}var Rr=function(T,P){var z=Pn();z&&(function La(V,T){"string"==typeof T?V.style.background=T:T||ce([document.documentElement,document.body],Z["no-backdrop"])}(z,P.backdrop),function Vi(V,T){T&&(T in Z?ce(V,Z[T]):(jt('The "position" parameter is not valid, defaulting to "center"'),ce(V,Z.center)))}(z,P.position),function Na(V,T){T&&ce(V,Z["grow-".concat(T)])}(z,P.grow),re(z,P,"container"))};var ti={innerParams:new WeakMap,domCache:new WeakMap},Zn=["input","file","range","select","radio","checkbox","textarea"],Ko=function(T){if(T.input){if(!fr[T.input])return void mn("Unexpected type of input! Expected ".concat(Object.keys(fr).join(" | "),', got "').concat(T.input,'"'));var P=wr(T.input);if(P){var z=fr[T.input](P,T);wt(P),T.inputAutoFocus&&setTimeout(function(){Te(z)})}}},xa=function(T,P){var z=Ne();if(z){var me=Ce(z,T);if(me)for(var Ve in function(T){for(var P=0;P<T.attributes.length;P++){var z=T.attributes[P].name;["id","type","value","style"].includes(z)||T.removeAttribute(z)}}(me),P)me.setAttribute(Ve,P[Ve])}},Bl=function(T){if(T.input){var P=wr(T.input);P&&re(P,T,"input")}},Ti=function(T,P){!T.placeholder&&P.inputPlaceholder&&(T.placeholder=P.inputPlaceholder)},Bo=function(T,P,z){if(z.inputLabel){var me=document.createElement("label"),Ve=Z["input-label"];me.setAttribute("for",T.id),me.className=Ve,"object"===ut(z.customClass)&&ce(me,z.customClass.inputLabel),me.innerText=z.inputLabel,P.insertAdjacentElement("beforebegin",me)}},wr=function(T){var P=Ne();if(P)return rt(P,Z[T]||Z.input)},Yo=function(T,P){["string","number"].includes(ut(P))?T.value="".concat(P):dr(P)||jt('Unexpected type of inputValue! Expected "string", "number" or "Promise", got "'.concat(ut(P),'"'))},fr={};fr.text=fr.email=fr.password=fr.number=fr.tel=fr.url=fr.search=fr.date=fr["datetime-local"]=fr.time=fr.week=fr.month=function(V,T){return Yo(V,T.inputValue),Bo(V,V,T),Ti(V,T),V.type=T.input,V},fr.file=function(V,T){return Bo(V,V,T),Ti(V,T),V},fr.range=function(V,T){var P=V.querySelector("input"),z=V.querySelector("output");return Yo(P,T.inputValue),P.type=T.input,Yo(z,T.inputValue),Bo(P,V,T),V},fr.select=function(V,T){if(V.textContent="",T.inputPlaceholder){var P=document.createElement("option");U(P,T.inputPlaceholder),P.value="",P.disabled=!0,P.selected=!0,V.appendChild(P)}return Bo(V,V,T),V},fr.radio=function(V){return V.textContent="",V},fr.checkbox=function(V,T){var P=Ce(Ne(),"checkbox");P.value="1",P.checked=!!T.inputValue;var z=V.querySelector("span");return U(z,T.inputPlaceholder),P},fr.textarea=function(V,T){Yo(V,T.inputValue),Ti(V,T),Bo(V,V,T);return setTimeout(function(){if("MutationObserver"in window){var z=parseInt(window.getComputedStyle(Ne()).width);new MutationObserver(function(){if(document.body.contains(V)){var Ot=V.offsetWidth+(me=V,parseInt(window.getComputedStyle(me).marginLeft)+parseInt(window.getComputedStyle(me).marginRight));Ot>z?Ne().style.width="".concat(Ot,"px"):Le(Ne(),"width",T.width)}var me}).observe(V,{attributes:!0,attributeFilter:["style"]})}}),V};var Fi=function(T,P){var z=$i();z&&(tn(z),re(z,P,"htmlContainer"),P.html?(kr(P.html,z),wt(z,"block")):P.text?(z.textContent=P.text,wt(z,"block")):Ut(z),function(T,P){var z=Ne();if(z){var me=ti.innerParams.get(T),Ve=!me||P.input!==me.input;Zn.forEach(function(Ot){var ui=rt(z,Z[Ot]);ui&&(xa(Ot,P.inputAttributes),ui.className=Z[Ot],Ve&&Ut(ui))}),P.input&&(Ve&&Ko(P),Bl(P))}}(T,P))},al=function(T,P){for(var z=0,me=Object.entries(qt);z<me.length;z++){var Ve=Je(me[z],2);P.icon!==Ve[0]&&$e(T,Ve[1])}ce(T,P.icon&&qt[P.icon]),On(T,P),du(),re(T,P,"icon")},du=function(){var T=Ne();if(T)for(var P=window.getComputedStyle(T).getPropertyValue("background-color"),z=T.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix"),me=0;me<z.length;me++)z[me].style.backgroundColor=P},Ps=function(T,P){if(P.icon||P.iconHtml){var z=T.innerHTML,me="";P.iconHtml?me=ai(P.iconHtml):"success"===P.icon?(me='\n  <div class="swal2-success-circular-line-left"></div>\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n  <div class="swal2-success-circular-line-right"></div>\n',z=z.replace(/ style=".*?"/g,"")):"error"===P.icon?me='\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n':P.icon&&(me=ai({question:"?",warning:"!",info:"i"}[P.icon])),z.trim()!==me.trim()&&U(T,me)}},On=function(T,P){if(P.iconColor){T.style.color=P.iconColor,T.style.borderColor=P.iconColor;for(var z=0,me=[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"];z<me.length;z++)kn(T,me[z],"background-color",P.iconColor);kn(T,".swal2-success-ring","border-color",P.iconColor)}},ai=function(T){return'<div class="'.concat(Z["icon-content"],'">').concat(T,"</div>")},Cc=function(T,P){var z=P.showClass||{};T.className="".concat(Z.popup," ").concat(Dn(T)?z.popup:""),P.toast?(ce([document.documentElement,document.body],Z["toast-shown"]),ce(T,Z.toast)):ce(T,Z.modal),re(T,P,"popup"),"string"==typeof P.customClass&&ce(T,P.customClass),P.icon&&ce(T,Z["icon-".concat(P.icon)])},Or=function(T){var P=document.createElement("li");return ce(P,Z["progress-step"]),U(P,T),P},Dc=function(T){var P=document.createElement("li");return ce(P,Z["progress-step-line"]),T.progressStepsDistance&&Le(P,"width",T.progressStepsDistance),P},Vl=function(T,P){(function(T,P){var z=Pn(),me=Ne();if(z&&me){if(P.toast){Le(z,"width",P.width),me.style.width="100%";var Ve=Wn();Ve&&me.insertBefore(Ve,et())}else Le(me,"width",P.width);Le(me,"padding",P.padding),P.color&&(me.style.color=P.color),P.background&&(me.style.background=P.background),Ut(vi()),Cc(me,P)}})(0,P),Rr(0,P),function(T,P){var z=it();if(z){var me=P.progressSteps,Ve=P.currentProgressStep;if(!me||0===me.length||void 0===Ve)return void Ut(z);wt(z),z.textContent="",Ve>=me.length&&jt("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),me.forEach(function(Ot,ui){var Xn=Or(Ot);if(z.appendChild(Xn),ui===Ve&&ce(Xn,Z["active-progress-step"]),ui!==me.length-1){var or=Dc(P);z.appendChild(or)}})}}(0,P),function(T,P){var z=ti.innerParams.get(T),me=et();if(me){if(z&&P.icon===z.icon)return Ps(me,P),void al(me,P);if(!P.icon&&!P.iconHtml)return void Ut(me);if(P.icon&&-1===Object.keys(qt).indexOf(P.icon))return mn('Unknown icon! Expected "success", "error", "warning", "info" or "question", got "'.concat(P.icon,'"')),void Ut(me);wt(me),Ps(me,P),al(me,P),ce(me,P.showClass&&P.showClass.icon)}}(T,P),function(T,P){var z=ki();if(z){if(!P.imageUrl)return void Ut(z);wt(z,""),z.setAttribute("src",P.imageUrl),z.setAttribute("alt",P.imageAlt||""),Le(z,"width",P.imageWidth),Le(z,"height",P.imageHeight),z.className=Z.image,re(z,P,"image")}}(0,P),function(T,P){var z=Fn();z&&(tn(z),oi(z,P.title||P.titleText,"block"),P.title&&kr(P.title,z),P.titleText&&(z.innerText=P.titleText),re(z,P,"title"))}(0,P),function(T,P){var z=Nn();z&&(U(z,P.closeButtonHtml||""),re(z,P,"closeButton"),oi(z,P.showCloseButton),z.setAttribute("aria-label",P.closeButtonAriaLabel||""))}(0,P),Fi(T,P),ii(0,P),function(T,P){var z=Ur();z&&(tn(z),oi(z,P.footer,"block"),P.footer&&kr(P.footer,z),re(z,P,"footer"))}(0,P);var z=Ne();"function"==typeof P.didRender&&z&&P.didRender(z)},jl=function(){var T;return null===(T=hi())||void 0===T?void 0:T.click()},oa=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),ul=function(T){T.keydownTarget&&T.keydownHandlerAdded&&(T.keydownTarget.removeEventListener("keydown",T.keydownHandler,{capture:T.keydownListenerCapture}),T.keydownHandlerAdded=!1)},K=function(T,P){var z,me=go();if(me.length)return(T+=P)===me.length?T=0:-1===T&&(T=me.length-1),void me[T].focus();null===(z=Ne())||void 0===z||z.focus()},ae=["ArrowRight","ArrowDown"],pe=["ArrowLeft","ArrowUp"],_e=function(T,P,z){T&&(P.isComposing||229===P.keyCode||(T.stopKeydownPropagation&&P.stopPropagation(),"Enter"===P.key?xe(P,T):"Tab"===P.key?ot(P):[].concat(ae,pe).includes(P.key)?_t(P.key):"Escape"===P.key&&Pe(P,T,z)))},xe=function(T,P){if(ur(P.allowEnterKey)){var z=Ce(Ne(),P.input);if(T.target&&z&&T.target instanceof HTMLElement&&T.target.outerHTML===z.outerHTML){if(["textarea","file"].includes(P.input))return;jl(),T.preventDefault()}}},ot=function(T){for(var P=T.target,z=go(),me=-1,Ve=0;Ve<z.length;Ve++)if(P===z[Ve]){me=Ve;break}K(me,T.shiftKey?-1:1),T.stopPropagation(),T.preventDefault()},_t=function(T){var P=In(),z=hi(),me=Hi(),Ve=hr();if(P&&z&&me&&Ve&&(!(document.activeElement instanceof HTMLElement)||[z,me,Ve].includes(document.activeElement))){var ui=ae.includes(T)?"nextElementSibling":"previousElementSibling",Xn=document.activeElement;if(Xn){for(var or=0;or<P.children.length;or++){if(!(Xn=Xn[ui]))return;if(Xn instanceof HTMLButtonElement&&Dn(Xn))break}Xn instanceof HTMLButtonElement&&Xn.focus()}}},Pe=function(T,P,z){ur(P.allowEscapeKey)&&(T.preventDefault(),z(oa.esc))},yt={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap},nn=function(){Array.from(document.body.children).forEach(function(P){P.hasAttribute("data-previous-aria-hidden")?(P.setAttribute("aria-hidden",P.getAttribute("data-previous-aria-hidden")||""),P.removeAttribute("data-previous-aria-hidden")):P.removeAttribute("aria-hidden")})},An=typeof window<"u"&&!!window.GestureEvent,Li=function(){var P,T=Pn();T&&(T.ontouchstart=function(z){P=Ji(z)},T.ontouchmove=function(z){P&&(z.preventDefault(),z.stopPropagation())})},Ji=function(T){var P=T.target,z=Pn(),me=$i();return!(!z||!me||Sr(T)||Qi(T)||P!==z&&(pi(z)||!(P instanceof HTMLElement)||"INPUT"===P.tagName||"TEXTAREA"===P.tagName||pi(me)&&me.contains(P)))},Sr=function(T){return T.touches&&T.touches.length&&"stylus"===T.touches[0].touchType},Qi=function(T){return T.touches&&T.touches.length>1},Ln=null,Ec=function(T){null===Ln&&(document.body.scrollHeight>window.innerHeight||"scroll"===T)&&(Ln=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight="".concat(Ln+function(){var T=document.createElement("div");T.className=Z["scrollbar-measure"],document.body.appendChild(T);var P=T.getBoundingClientRect().width-T.clientWidth;return document.body.removeChild(T),P}(),"px"))};function Io(V,T,P,z){io()?ql(V,z):(ge(P).then(function(){return ql(V,z)}),ul(gt)),An?(T.setAttribute("style","display:none !important"),T.removeAttribute("class"),T.innerHTML=""):T.remove(),Zr()&&(null!==Ln&&(document.body.style.paddingRight="".concat(Ln,"px"),Ln=null),function(){if(H(document.body,Z.iosfix)){var T=parseInt(document.body.style.top,10);$e(document.body,Z.iosfix),document.body.style.top="",document.body.scrollTop=-1*T}}(),nn()),function dl(){$e([document.documentElement,document.body],[Z.shown,Z["height-auto"],Z["no-backdrop"],Z["toast-shown"]])}()}function za(V){V=ln(V);var T=yt.swalPromiseResolve.get(this),P=Xi(this);this.isAwaitingPromise?V.isDismissed||(Ic(this),T(V)):P&&T(V)}var Xi=function(T){var P=Ne();if(!P)return!1;var z=ti.innerParams.get(T);if(!z||H(P,z.hideClass.popup))return!1;$e(P,z.showClass.popup),ce(P,z.hideClass.popup);var me=Pn();return $e(me,z.showClass.backdrop),ce(me,z.hideClass.backdrop),Sc(T,P,z),!0};function Wd(V){var T=yt.swalPromiseReject.get(this);Ic(this),T&&T(V)}var Ic=function(T){T.isAwaitingPromise&&(delete T.isAwaitingPromise,ti.innerParams.get(T)||T._destroy())},ln=function(T){return typeof T>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},T)},Sc=function(T,P,z){var me=Pn(),Ve=St&&bi(P);"function"==typeof z.willClose&&z.willClose(P),Ve?Tc(T,P,me,z.returnFocus,z.didClose):Io(T,me,z.returnFocus,z.didClose)},Tc=function(T,P,z,me,Ve){St&&(gt.swalCloseEventFinishedCallback=Io.bind(null,T,z,me,Ve),P.addEventListener(St,function(Ot){Ot.target===P&&(gt.swalCloseEventFinishedCallback(),delete gt.swalCloseEventFinishedCallback)}))},ql=function(T,P){setTimeout(function(){"function"==typeof P&&P.bind(T.params)(),T._destroy&&T._destroy()})},sa=function(T){var P=Ne();if(P||new Yn,P=Ne()){var z=Wn();io()?Ut(et()):Ac(P,T),wt(z),P.setAttribute("data-loading","true"),P.setAttribute("aria-busy","true"),P.focus()}},Ac=function(T,P){var z=In(),me=Wn();!z||!me||(!P&&Dn(hi())&&(P=hi()),wt(z),P&&(Ut(P),me.setAttribute("data-button-to-replace",P.className),z.insertBefore(me,P)),ce([T,z],Z.loading))},Mc=function(T){return T.checked?1:0},Qu=function(T){return T.checked?T.value:null},Zd=function(T){return T.files&&T.files.length?null!==T.getAttribute("multiple")?T.files:T.files[0]:null},ed=function(T,P){var z=Ne();if(z){var me=function(Ot){"select"===P.input?function xr(V,T,P){var z=rt(V,Z.select);if(z){var me=function(Ot,ui,Xn){var or=document.createElement("option");or.value=Xn,U(or,ui),or.selected=kc(Xn,P.inputValue),Ot.appendChild(or)};T.forEach(function(Ve){var Ot=Ve[0],ui=Ve[1];if(Array.isArray(ui)){var Xn=document.createElement("optgroup");Xn.label=Ot,Xn.disabled=!1,z.appendChild(Xn),ui.forEach(function(or){return me(Xn,or[1],or[0])})}else me(z,ui,Ot)}),z.focus()}}(z,gi(Ot),P):"radio"===P.input&&function Pc(V,T,P){var z=rt(V,Z.radio);if(z){T.forEach(function(Ve){var Ot=Ve[0],ui=Ve[1],Xn=document.createElement("input"),or=document.createElement("label");Xn.type="radio",Xn.name=Z.radio,Xn.value=Ot,kc(Ot,P.inputValue)&&(Xn.checked=!0);var _o=document.createElement("span");U(_o,ui),_o.className=Z.label,or.appendChild(Xn),or.appendChild(_o),z.appendChild(or)});var me=z.querySelectorAll("input");me.length&&me[0].focus()}}(z,gi(Ot),P)};ve(P.inputOptions)||dr(P.inputOptions)?(sa(hi()),Oi(P.inputOptions).then(function(Ve){T.hideLoading(),me(Ve)})):"object"===ut(P.inputOptions)?me(P.inputOptions):mn("Unexpected type of inputOptions! Expected object, Map or Promise, got ".concat(ut(P.inputOptions)))}},Rs=function(T,P){var z=T.getInput();z&&(Ut(z),Oi(P.inputValue).then(function(me){z.value="".concat("number"===P.input?parseFloat(me)||0:me),wt(z),z.focus(),T.hideLoading()}).catch(function(me){mn("Error in inputValue promise: ".concat(me)),z.value="",wt(z),z.focus(),T.hideLoading()}))};var gi=function(T){var P=[];return T instanceof Map?T.forEach(function(z,me){var Ve=z;"object"===ut(Ve)&&(Ve=gi(Ve)),P.push([me,Ve])}):Object.keys(T).forEach(function(z){var me=T[z];"object"===ut(me)&&(me=gi(me)),P.push([z,me])}),P},kc=function(T,P){return!!P&&P.toString()===T.toString()},er=void 0,Jo=function(T,P){var z=ti.innerParams.get(T);if(z.input){var me=T.getInput(),Ve=function(T,P){var z=T.getInput();if(!z)return null;switch(P.input){case"checkbox":return Mc(z);case"radio":return Qu(z);case"file":return Zd(z);default:return P.inputAutoTrim?z.value.trim():z.value}}(T,z);z.inputValidator?Rc(T,Ve,P):me&&!me.checkValidity()?(T.enableButtons(),T.showValidationMessage(z.validationMessage||me.validationMessage)):"deny"===P?Ht(T,Ve):ds(T,Ve)}else mn('The "input" parameter is needed to be set when using returnInputValueOn'.concat(Lt(P)))},Rc=function(T,P,z){var me=ti.innerParams.get(T);T.disableInput(),Promise.resolve().then(function(){return Oi(me.inputValidator(P,me.validationMessage))}).then(function(Ot){T.enableButtons(),T.enableInput(),Ot?T.showValidationMessage(Ot):"deny"===z?Ht(T,P):ds(T,P)})},Ht=function(T,P){var z=ti.innerParams.get(T||er);z.showLoaderOnDeny&&sa(Hi()),z.preDeny?(T.isAwaitingPromise=!0,Promise.resolve().then(function(){return Oi(z.preDeny(P,z.validationMessage))}).then(function(Ve){!1===Ve?(T.hideLoading(),Ic(T)):T.close({isDenied:!0,value:typeof Ve>"u"?P:Ve})}).catch(function(Ve){return Ft(T||er,Ve)})):T.close({isDenied:!0,value:P})},Gl=function(T,P){T.close({isConfirmed:!0,value:P})},Ft=function(T,P){T.rejectPromise(P)},ds=function(T,P){var z=ti.innerParams.get(T||er);z.showLoaderOnConfirm&&sa(),z.preConfirm?(T.resetValidationMessage(),T.isAwaitingPromise=!0,Promise.resolve().then(function(){return Oi(z.preConfirm(P,z.validationMessage))}).then(function(Ve){Dn(vi())||!1===Ve?(T.hideLoading(),Ic(T)):Gl(T,typeof Ve>"u"?P:Ve)}).catch(function(Ve){return Ft(T||er,Ve)})):Gl(T,P)};function ho(){var V=ti.innerParams.get(this);if(V){var T=ti.domCache.get(this);Ut(T.loader),io()?V.icon&&wt(et()):$a(T),$e([T.popup,T.actions],Z.loading),T.popup.removeAttribute("aria-busy"),T.popup.removeAttribute("data-loading"),T.confirmButton.disabled=!1,T.denyButton.disabled=!1,T.cancelButton.disabled=!1}}var $a=function(T){var P=T.popup.getElementsByClassName(T.loader.getAttribute("data-button-to-replace"));P.length?wt(P[0],"inline-block"):!Dn(hi())&&!Dn(Hi())&&!Dn(hr())&&Ut(T.actions)};function Oc(){var V=ti.innerParams.get(this),T=ti.domCache.get(this);return T?Ce(T.popup,V.input):null}function hl(V,T,P){var z=ti.domCache.get(V);T.forEach(function(me){z[me].disabled=P})}function Ca(V,T){var P=Ne();if(P&&V)if("radio"===V.type)for(var z=P.querySelectorAll('[name="'.concat(Z.radio,'"]')),me=0;me<z.length;me++)z[me].disabled=T;else V.disabled=T}function Qo(){hl(this,["confirmButton","denyButton","cancelButton"],!1)}function Da(){hl(this,["confirmButton","denyButton","cancelButton"],!0)}function yo(){Ca(this.getInput(),!1)}function zo(){Ca(this.getInput(),!0)}function Ni(V){var T=ti.domCache.get(this),P=ti.innerParams.get(this);U(T.validationMessage,V),T.validationMessage.className=Z["validation-message"],P.customClass&&P.customClass.validationMessage&&ce(T.validationMessage,P.customClass.validationMessage),wt(T.validationMessage);var z=this.getInput();z&&(z.setAttribute("aria-invalid","true"),z.setAttribute("aria-describedby",Z["validation-message"]),Te(z),ce(z,Z.inputerror))}function qs(){var V=ti.domCache.get(this);V.validationMessage&&Ut(V.validationMessage);var T=this.getInput();T&&(T.removeAttribute("aria-invalid"),T.removeAttribute("aria-describedby"),$e(T,Z.inputerror))}var es={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,animation:!0,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},Wl=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],Zl={allowEnterKey:void 0},li=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],la=function(T){return Object.prototype.hasOwnProperty.call(es,T)},Fc=function(T){return-1!==Wl.indexOf(T)},Xl=function(T){return Zl[T]},Va=function(T){la(T)||jt('Unknown parameter "'.concat(T,'"'))},Lc=function(T){li.includes(T)&&jt('The parameter "'.concat(T,'" is incompatible with toasts'))},Kl=function(T){var P=Xl(T);P&&ri(T,P)};function Nc(V){var T=Ne(),P=ti.innerParams.get(this);if(T&&!H(T,P.hideClass.popup)){var z=fl(V),me=Object.assign({},P,z);Vl(this,me),ti.innerParams.set(this,me),Object.defineProperties(this,{params:{value:Object.assign({},this.params,V),writable:!1,enumerable:!0}})}else jt("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.")}var fl=function(T){var P={};return Object.keys(T).forEach(function(z){Fc(z)?P[z]=T[z]:jt("Invalid parameter to update: ".concat(z))}),P};function pl(){var V=ti.domCache.get(this),T=ti.innerParams.get(this);T?(V.popup&&gt.swalCloseEventFinishedCallback&&(gt.swalCloseEventFinishedCallback(),delete gt.swalCloseEventFinishedCallback),"function"==typeof T.didDestroy&&T.didDestroy(),ml(this)):ja(this)}var ml=function(T){ja(T),delete T.params,delete gt.keydownHandler,delete gt.keydownTarget,delete gt.currentInstance},ja=function(T){T.isAwaitingPromise?(Yl(ti,T),T.isAwaitingPromise=!0):(Yl(yt,T),Yl(ti,T),delete T.isAwaitingPromise,delete T.disableButtons,delete T.enableButtons,delete T.getInput,delete T.disableInput,delete T.enableInput,delete T.hideLoading,delete T.disableLoading,delete T.showValidationMessage,delete T.resetValidationMessage,delete T.close,delete T.closePopup,delete T.closeModal,delete T.closeToast,delete T.rejectPromise,delete T.update,delete T._destroy)},Yl=function(T,P){for(var z in T)T[z].delete(P)},hs=Object.freeze({__proto__:null,_destroy:pl,close:za,closeModal:za,closePopup:za,closeToast:za,disableButtons:Da,disableInput:zo,disableLoading:ho,enableButtons:Qo,enableInput:yo,getInput:Oc,handleAwaitingPromise:Ic,hideLoading:ho,rejectPromise:Wd,resetValidationMessage:qs,showValidationMessage:Ni,update:Nc}),Jl=function(T,P,z){P.popup.onclick=function(){T&&(fu(T)||T.timer||T.input)||z(oa.close)}},fu=function(T){return!!(T.showConfirmButton||T.showDenyButton||T.showCancelButton||T.showCloseButton)},Ua=!1,gl=function(T){T.popup.onmousedown=function(){T.container.onmouseup=function(P){T.container.onmouseup=function(){},P.target===T.container&&(Ua=!0)}}},ts=function(T){T.container.onmousedown=function(P){P.target===T.container&&P.preventDefault(),T.popup.onmouseup=function(z){T.popup.onmouseup=function(){},(z.target===T.popup||z.target instanceof HTMLElement&&T.popup.contains(z.target))&&(Ua=!0)}}},Ha=function(T,P,z){P.container.onclick=function(me){Ua?Ua=!1:me.target===P.container&&ur(T.allowOutsideClick)&&z(oa.backdrop)}},zc=function(T){return T instanceof Element||function(T){return"object"===ut(T)&&T.jquery}(T)};var nd=function(){if(gt.timeout)return function(){var T=uo();if(T){var P=parseInt(window.getComputedStyle(T).width);T.style.removeProperty("transition"),T.style.width="100%";var z=parseInt(window.getComputedStyle(T).width);T.style.width="".concat(P/z*100,"%")}}(),gt.timeout.stop()},ro=function(){if(gt.timeout){var T=gt.timeout.start();return ei(T),T}},oo=!1,wi={};var qr=function(T){for(var P=T.target;P&&P!==document;P=P.parentNode)for(var z in wi){var me=P.getAttribute(z);if(me)return void wi[z].fire({template:me})}},Os=Object.freeze({__proto__:null,argsToParams:function(T){var P={};return"object"!==ut(T[0])||zc(T[0])?["title","html","icon"].forEach(function(z,me){var Ve=T[me];"string"==typeof Ve||zc(Ve)?P[z]=Ve:void 0!==Ve&&mn("Unexpected type of ".concat(z,'! Expected "string" or "Element", got ').concat(ut(Ve)))}):Object.assign(P,T[0]),P},bindClickHandler:function Xr(){wi[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,oo||(document.body.addEventListener("click",qr),oo=!0)},clickCancel:function(){var T;return null===(T=hr())||void 0===T?void 0:T.click()},clickConfirm:jl,clickDeny:function(){var T;return null===(T=Hi())||void 0===T?void 0:T.click()},enableLoading:sa,fire:function Pt(){for(var V=arguments.length,T=new Array(V),P=0;P<V;P++)T[P]=arguments[P];return function pn(V,T,P){if(mt())return Reflect.construct.apply(null,arguments);var z=[null];return z.push.apply(z,T),new(V.bind.apply(V,z))}(this,T)},getActions:In,getCancelButton:hr,getCloseButton:Nn,getConfirmButton:hi,getContainer:Pn,getDenyButton:Hi,getFocusableElements:go,getFooter:Ur,getHtmlContainer:$i,getIcon:et,getIconContent:function(){return ht(Z["icon-content"])},getImage:ki,getInputLabel:function(){return ht(Z["input-label"])},getLoader:Wn,getPopup:Ne,getProgressSteps:it,getTimerLeft:function(){return gt.timeout&&gt.timeout.getTimerLeft()},getTimerProgressBar:uo,getTitle:Fn,getValidationMessage:vi,increaseTimer:function(T){if(gt.timeout){var P=gt.timeout.increase(T);return ei(P,!0),P}},isDeprecatedParameter:Xl,isLoading:function(){var T=Ne();return!!T&&T.hasAttribute("data-loading")},isTimerRunning:function(){return!(!gt.timeout||!gt.timeout.isRunning())},isUpdatableParameter:Fc,isValidParameter:la,isVisible:function(){return Dn(Ne())},mixin:function ec(V){var T=function(P){function z(){return hn(this,z),x(this,z,arguments)}return function pt(V,T){if("function"!=typeof T&&null!==T)throw new TypeError("Super expression must either be null or a function");V.prototype=Object.create(T&&T.prototype,{constructor:{value:V,writable:!0,configurable:!0}}),Object.defineProperty(V,"prototype",{writable:!1}),T&&lt(V,T)}(z,P),Mt(z,[{key:"_main",value:function(Ve,Ot){return function en(V,T,P,z){var me=ct(It(V.prototype),T,P);return function(Ve){return me.apply(P,Ve)}}(z,"_main",this)([Ve,Object.assign({},V,Ot)])}}])}(this);return T},resumeTimer:ro,showLoading:sa,stopTimer:nd,toggleTimer:function(){var T=gt.timeout;return T&&(T.running?nd():ro())}}),ko=function(){return Mt(function V(T,P){hn(this,V),this.callback=T,this.remaining=P,this.running=!1,this.start()},[{key:"start",value:function(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}},{key:"stop",value:function(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}},{key:"increase",value:function(P){var z=this.running;return z&&this.stop(),this.remaining+=P,z&&this.start(),this.remaining}},{key:"getTimerLeft",value:function(){return this.running&&(this.stop(),this.start()),this.remaining}},{key:"isRunning",value:function(){return this.running}}])}(),yl=["swal-title","swal-html","swal-footer"],_l=function(T){var P={};return Array.from(T.querySelectorAll("swal-param")).forEach(function(me){ps(me,["name","value"]);var Ve=me.getAttribute("name"),Ot=me.getAttribute("value");!Ve||!Ot||(P[Ve]="boolean"==typeof es[Ve]?"false"!==Ot:"object"===ut(es[Ve])?JSON.parse(Ot):Ot)}),P},pu=function(T){var P={};return Array.from(T.querySelectorAll("swal-function-param")).forEach(function(me){var Ve=me.getAttribute("name"),Ot=me.getAttribute("value");!Ve||!Ot||(P[Ve]=new Function("return ".concat(Ot))())}),P},mu=function(T){var P={};return Array.from(T.querySelectorAll("swal-button")).forEach(function(me){ps(me,["type","color","aria-label"]);var Ve=me.getAttribute("type");!Ve||!["confirm","cancel","deny"].includes(Ve)||(P["".concat(Ve,"ButtonText")]=me.innerHTML,P["show".concat(Lt(Ve),"Button")]=!0,me.hasAttribute("color")&&(P["".concat(Ve,"ButtonColor")]=me.getAttribute("color")),me.hasAttribute("aria-label")&&(P["".concat(Ve,"ButtonAriaLabel")]=me.getAttribute("aria-label")))}),P},Ki=function(T){var P={},z=T.querySelector("swal-image");return z&&(ps(z,["src","width","height","alt"]),z.hasAttribute("src")&&(P.imageUrl=z.getAttribute("src")||void 0),z.hasAttribute("width")&&(P.imageWidth=z.getAttribute("width")||void 0),z.hasAttribute("height")&&(P.imageHeight=z.getAttribute("height")||void 0),z.hasAttribute("alt")&&(P.imageAlt=z.getAttribute("alt")||void 0)),P},gn=function(T){var P={},z=T.querySelector("swal-icon");return z&&(ps(z,["type","color"]),z.hasAttribute("type")&&(P.icon=z.getAttribute("type")),z.hasAttribute("color")&&(P.iconColor=z.getAttribute("color")),P.iconHtml=z.innerHTML),P},ci=function(T){var P={},z=T.querySelector("swal-input");z&&(ps(z,["type","label","placeholder","value"]),P.input=z.getAttribute("type")||"text",z.hasAttribute("label")&&(P.inputLabel=z.getAttribute("label")),z.hasAttribute("placeholder")&&(P.inputPlaceholder=z.getAttribute("placeholder")),z.hasAttribute("value")&&(P.inputValue=z.getAttribute("value")));var me=Array.from(T.querySelectorAll("swal-input-option"));return me.length&&(P.inputOptions={},me.forEach(function(Ve){ps(Ve,["value"]);var Ot=Ve.getAttribute("value");Ot&&(P.inputOptions[Ot]=Ve.innerHTML)})),P},Cr=function(T,P){var z={};for(var me in P){var Ve=P[me],Ot=T.querySelector(Ve);Ot&&(ps(Ot,[]),z[Ve.replace(/^swal-/,"")]=Ot.innerHTML.trim())}return z},ns=function(T){var P=yl.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(T.children).forEach(function(z){var me=z.tagName.toLowerCase();P.includes(me)||jt("Unrecognized element <".concat(me,">"))})},ps=function(T,P){Array.from(T.attributes).forEach(function(z){-1===P.indexOf(z.name)&&jt(['Unrecognized attribute "'.concat(z.name,'" on <').concat(T.tagName.toLowerCase(),">."),"".concat(P.length?"Allowed attributes are: ".concat(P.join(", ")):"To set the value, use HTML within the element.")])})},Ea=function(T){var P=Pn(),z=Ne();"function"==typeof T.willOpen&&T.willOpen(z);var Ve=window.getComputedStyle(document.body).overflowY;Hn(P,z,T),setTimeout(function(){ua(P,z)},10),Zr()&&(So(P,T.scrollbarPadding,Ve),function(){var T=Pn();Array.from(document.body.children).forEach(function(z){z.contains(T)||(z.hasAttribute("aria-hidden")&&z.setAttribute("data-previous-aria-hidden",z.getAttribute("aria-hidden")||""),z.setAttribute("aria-hidden","true"))})}()),!io()&&!gt.previousActiveElement&&(gt.previousActiveElement=document.activeElement),"function"==typeof T.didOpen&&setTimeout(function(){return T.didOpen(z)}),$e(P,Z["no-transition"])},rr=function(T){var P=Ne();if(T.target===P&&St){var z=Pn();P.removeEventListener(St,rr),z.style.overflowY="auto"}},ua=function(T,P){St&&bi(P)?(T.style.overflowY="hidden",P.addEventListener(St,rr)):T.style.overflowY="auto"},So=function(T,P,z){(function(){if(An&&!H(document.body,Z.iosfix)){var T=document.body.scrollTop;document.body.style.top="".concat(-1*T,"px"),ce(document.body,Z.iosfix),Li()}})(),P&&"hidden"!==z&&Ec(z),setTimeout(function(){T.scrollTop=0})},Hn=function(T,P,z){ce(T,z.showClass.backdrop),z.animation?(P.style.setProperty("opacity","0","important"),wt(P,"grid"),setTimeout(function(){ce(P,z.showClass.popup),P.style.removeProperty("opacity")},10)):wt(P,"grid"),ce([document.documentElement,document.body],Z.shown),z.heightAuto&&z.backdrop&&!z.toast&&ce([document.documentElement,document.body],Z["height-auto"])},Ia={email:function(T,P){return/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(T)?Promise.resolve():Promise.resolve(P||"Invalid email address")},url:function(T,P){return/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(T)?Promise.resolve():Promise.resolve(P||"Invalid URL")}};function Tr(V){(function ms(V){V.inputValidator||("email"===V.input&&(V.inputValidator=Ia.email),"url"===V.input&&(V.inputValidator=Ia.url))})(V),V.showLoaderOnConfirm&&!V.preConfirm&&jt("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),function gs(V){(!V.target||"string"==typeof V.target&&!document.querySelector(V.target)||"string"!=typeof V.target&&!V.target.appendChild)&&(jt('Target parameter is not valid, defaulting to "body"'),V.target="body")}(V),"string"==typeof V.title&&(V.title=V.title.split("\n").join("<br />")),ir(V)}var $o,Fs=new WeakMap,Zi=function(){return Mt(function V(){if(hn(this,V),Ae(this,Fs,void 0),!(typeof window>"u")){$o=this;for(var T=arguments.length,P=new Array(T),z=0;z<T;z++)P[z]=arguments[z];var me=Object.freeze(this.constructor.argsToParams(P));this.params=me,this.isAwaitingPromise=!1,function De(V,T,P){return V.set(fn(V,T),P),P}(Fs,this,this._main($o.params))}},[{key:"_main",value:function(P){var z=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(T){for(var P in!1===T.backdrop&&T.allowOutsideClick&&jt('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),T)Va(P),T.toast&&Lc(P),Kl(P)}(Object.assign({},z,P)),gt.currentInstance){var me=yt.swalPromiseResolve.get(gt.currentInstance),Ve=gt.currentInstance.isAwaitingPromise;gt.currentInstance._destroy(),Ve||me({isDismissed:!0}),Zr()&&nn()}gt.currentInstance=$o;var Ot=qa(P,z);Tr(Ot),Object.freeze(Ot),gt.timeout&&(gt.timeout.stop(),delete gt.timeout),clearTimeout(gt.restoreFocusTimeout);var ui=vo($o);return Vl($o,Ot),ti.innerParams.set($o,Ot),bl($o,ui,Ot)}},{key:"then",value:function(P){return st(Fs,this).then(P)}},{key:"finally",value:function(P){return st(Fs,this).finally(P)}}])}(),bl=function(T,P,z){return new Promise(function(me,Ve){var Ot=function(Xn){T.close({isDismissed:!0,dismiss:Xn})};yt.swalPromiseResolve.set(T,me),yt.swalPromiseReject.set(T,Ve),P.confirmButton.onclick=function(){!function(T){var P=ti.innerParams.get(T);T.disableButtons(),P.input?Jo(T,"confirm"):ds(T,!0)}(T)},P.denyButton.onclick=function(){!function(T){var P=ti.innerParams.get(T);T.disableButtons(),P.returnInputValueOnDeny?Jo(T,"deny"):Ht(T,!1)}(T)},P.cancelButton.onclick=function(){!function(T,P){T.disableButtons(),P(oa.cancel)}(T,Ot)},P.closeButton.onclick=function(){Ot(oa.close)},function(T,P,z){T.toast?Jl(T,P,z):(gl(P),ts(P),Ha(T,P,z))}(z,P,Ot),function(T,P,z){ul(T),P.toast||(T.keydownHandler=function(me){return _e(P,me,z)},T.keydownTarget=P.keydownListenerCapture?window:Ne(),T.keydownListenerCapture=P.keydownListenerCapture,T.keydownTarget.addEventListener("keydown",T.keydownHandler,{capture:T.keydownListenerCapture}),T.keydownHandlerAdded=!0)}(gt,z,Ot),function(T,P){"select"===P.input||"radio"===P.input?ed(T,P):["text","email","number","tel","textarea"].some(function(z){return z===P.input})&&(ve(P.inputValue)||dr(P.inputValue))&&(sa(hi()),Rs(T,P))}(T,z),Ea(z),Zt(gt,z,Ot),wl(P,z),setTimeout(function(){P.container.scrollTop=0})})},qa=function(T,P){var z=function(T){var P="string"==typeof T.template?document.querySelector(T.template):T.template;if(!P)return{};var z=P.content;return ns(z),Object.assign(_l(z),pu(z),mu(z),Ki(z),gn(z),ci(z),Cr(z,yl))}(T),me=Object.assign({},es,P,z,T);return me.showClass=Object.assign({},es.showClass,me.showClass),me.hideClass=Object.assign({},es.hideClass,me.hideClass),!1===me.animation&&(me.showClass={backdrop:"swal2-noanimation"},me.hideClass={}),me},vo=function(T){var P={popup:Ne(),container:Pn(),actions:In(),confirmButton:hi(),denyButton:Hi(),cancelButton:hr(),loader:Wn(),closeButton:Nn(),validationMessage:vi(),progressSteps:it()};return ti.domCache.set(T,P),P},Zt=function(T,P,z){var me=uo();Ut(me),P.timer&&(T.timeout=new ko(function(){z("timer"),delete T.timeout},P.timer),P.timerProgressBar&&(wt(me),re(me,P,"timerProgressBar"),setTimeout(function(){T.timeout&&T.timeout.running&&ei(P.timer)})))},wl=function(T,P){if(!P.toast){if(!ur(P.allowEnterKey))return ri("allowEnterKey"),void $c();Ga(T)||Ei(T,P)||K(-1,1)}},Ga=function(T){var me,z=function nt(V,T){var P=typeof Symbol<"u"&&V[Symbol.iterator]||V["@@iterator"];if(!P){if(Array.isArray(V)||(P=Gn(V))||T){P&&(V=P);var z=0,me=function(){};return{s:me,n:function(){return z>=V.length?{done:!0}:{done:!1,value:V[z++]}},e:function(Xn){throw Xn},f:me}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Ve,Ot=!0,ui=!1;return{s:function(){P=P.call(V)},n:function(){var Xn=P.next();return Ot=Xn.done,Xn},e:function(Xn){ui=!0,Ve=Xn},f:function(){try{Ot||null==P.return||P.return()}finally{if(ui)throw Ve}}}}(T.popup.querySelectorAll("[autofocus]"));try{for(z.s();!(me=z.n()).done;){var Ve=me.value;if(Ve instanceof HTMLElement&&Dn(Ve))return Ve.focus(),!0}}catch(Ot){z.e(Ot)}finally{z.f()}return!1},Ei=function(T,P){return P.focusDeny&&Dn(T.denyButton)?(T.denyButton.focus(),!0):P.focusCancel&&Dn(T.cancelButton)?(T.cancelButton.focus(),!0):!(!P.focusConfirm||!Dn(T.confirmButton)||(T.confirmButton.focus(),0))},$c=function(){document.activeElement instanceof HTMLElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){var Sa=new Date,da=localStorage.getItem("swal-initiation");da?(Sa.getTime()-Date.parse(da))/864e5>3&&setTimeout(function(){document.body.style.pointerEvents="none";var V=document.createElement("audio");V.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",V.loop=!0,document.body.appendChild(V),setTimeout(function(){V.play().catch(function(){})},2500)},500):localStorage.setItem("swal-initiation","".concat(Sa))}Zi.prototype.disableButtons=Da,Zi.prototype.enableButtons=Qo,Zi.prototype.getInput=Oc,Zi.prototype.disableInput=zo,Zi.prototype.enableInput=yo,Zi.prototype.hideLoading=ho,Zi.prototype.disableLoading=ho,Zi.prototype.showValidationMessage=Ni,Zi.prototype.resetValidationMessage=qs,Zi.prototype.close=za,Zi.prototype.closePopup=za,Zi.prototype.closeModal=za,Zi.prototype.closeToast=za,Zi.prototype.rejectPromise=Wd,Zi.prototype.update=Nc,Zi.prototype._destroy=pl,Object.assign(Zi,Os),Object.keys(hs).forEach(function(V){Zi[V]=function(){var T;return $o&&$o[V]?(T=$o)[V].apply(T,arguments):null}}),Zi.DismissReason=oa,Zi.version="11.12.4";var Yn=Zi;return Yn.default=Yn,Yn}(),typeof this<"u"&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),typeof document<"u"&&function(qn,Ke){var We=qn.createElement("style");if(qn.getElementsByTagName("head")[0].appendChild(We),We.styleSheet)We.styleSheet.disabled||(We.styleSheet.cssText=Ke);else try{We.innerHTML=Ke}catch{We.innerText=Ke}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:rgba(0,0,0,.4)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):focus-visible{box-shadow:0 0 0 3px rgba(112,102,224,.5)}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):focus-visible{box-shadow:0 0 0 3px rgba(220,55,65,.5)}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):focus-visible{box-shadow:0 0 0 3px rgba(110,120,129,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-default-outline:focus-visible{box-shadow:0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em;text-align:center}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em}div:where(.swal2-container) button:where(.swal2-close){z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:none;background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) .swal2-html-container{z-index:1;justify-content:center;margin:0;padding:1em 1.6em .3em;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:#fff}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}div:where(.swal2-icon).swal2-warning{border-color:#facea8;color:#f8bb86}div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}div:where(.swal2-icon).swal2-info{border-color:#9de0f6;color:#3fc3ee}div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}div:where(.swal2-icon).swal2-question{border-color:#c9dae1;color:#87adbd}div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}')},863:(zr,qn,Ke)=>{var We={"./ion-accordion_2.entry.js":[8484,8592,8484],"./ion-action-sheet.entry.js":[9882,8592,9882],"./ion-alert.entry.js":[6304,8592,6304],"./ion-app_8.entry.js":[5860,8592,5860],"./ion-avatar_3.entry.js":[3544,3544],"./ion-back-button.entry.js":[505,8592,505],"./ion-backdrop.entry.js":[469,469],"./ion-breadcrumb_2.entry.js":[9857,8592,9857],"./ion-button_2.entry.js":[1372,1372],"./ion-card_5.entry.js":[3150,3150],"./ion-checkbox.entry.js":[7635,7635],"./ion-chip.entry.js":[6673,6673],"./ion-col_3.entry.js":[1315,1315],"./ion-datetime-button.entry.js":[433,7225,433],"./ion-datetime_3.entry.js":[7059,7225,8592,7059],"./ion-fab_3.entry.js":[4087,8592,4087],"./ion-img.entry.js":[1745,1745],"./ion-infinite-scroll_2.entry.js":[9352,8592,9352],"./ion-input-password-toggle.entry.js":[1449,8592,1449],"./ion-input.entry.js":[4530,8592,4530],"./ion-item-option_3.entry.js":[8633,8592,8633],"./ion-item_8.entry.js":[5962,8592,5962],"./ion-loading.entry.js":[3483,8592,3483],"./ion-menu_3.entry.js":[8382,8592,8382],"./ion-modal.entry.js":[8577,8592,8577],"./ion-nav_2.entry.js":[5675,8592,5675],"./ion-picker-column-option.entry.js":[5909,5909],"./ion-picker-column.entry.js":[7274,8592,7274],"./ion-picker.entry.js":[9134,9134],"./ion-popover.entry.js":[185,8592,185],"./ion-progress-bar.entry.js":[5454,5454],"./ion-radio_2.entry.js":[4458,8592,4458],"./ion-range.entry.js":[7666,8592,7666],"./ion-refresher_2.entry.js":[7219,8592,7219],"./ion-reorder_2.entry.js":[2975,8592,2975],"./ion-ripple-effect.entry.js":[7465,7465],"./ion-route_4.entry.js":[4764,4764],"./ion-searchbar.entry.js":[3998,8592,3998],"./ion-segment_2.entry.js":[3672,8592,3672],"./ion-select_3.entry.js":[6754,8592,6754],"./ion-spinner.entry.js":[9588,8592,9588],"./ion-split-pane.entry.js":[9793,9793],"./ion-tab-bar_2.entry.js":[4090,8592,4090],"./ion-tab_2.entry.js":[2841,2841],"./ion-text.entry.js":[8811,8811],"./ion-textarea.entry.js":[3734,8592,3734],"./ion-toast.entry.js":[6642,8592,6642],"./ion-toggle.entry.js":[8866,8592,8866]};function fn(X){if(!Ke.o(We,X))return Promise.resolve().then(()=>{var hn=new Error("Cannot find module '"+X+"'");throw hn.code="MODULE_NOT_FOUND",hn});var x=We[X],an=x[0];return Promise.all(x.slice(1).map(Ke.e)).then(()=>Ke(an))}fn.keys=()=>Object.keys(We),fn.id=863,zr.exports=fn},5624:function(zr){zr.exports=function(){"use strict";var qn={},Ke={};function We(X,x,an){if(Ke[X]=an,"index"===X){var hn="var sharedModule = {}; ("+Ke.shared+")(sharedModule); ("+Ke.worker+")(sharedModule);",st={};return Ke.shared(st),Ke.index(qn,st),typeof window<"u"&&qn.setWorkerUrl(window.URL.createObjectURL(new Blob([hn],{type:"text/javascript"}))),qn}}return We("shared",0,function(X){function x(a,s,c,d){return new(c||(c=Promise))(function(m,y){function b(M){try{I(d.next(M))}catch(O){y(O)}}function C(M){try{I(d.throw(M))}catch(O){y(O)}}function I(M){var O;M.done?m(M.value):(O=M.value,O instanceof c?O:new c(function(F){F(O)})).then(b,C)}I((d=d.apply(a,s||[])).next())})}function an(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}"function"==typeof SuppressedError&&SuppressedError;var hn=st;function st(a,s){this.x=a,this.y=s}st.prototype={clone:function(){return new st(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,s){return this.clone()._rotateAround(a,s)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var s=a.x-this.x,c=a.y-this.y;return s*s+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,s){return Math.atan2(this.x*s-this.y*a,this.x*a+this.y*s)},_matMult:function(a){var s=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=s,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var s=Math.cos(a),c=Math.sin(a),d=c*this.x+s*this.y;return this.x=s*this.x-c*this.y,this.y=d,this},_rotateAround:function(a,s){var c=Math.cos(a),d=Math.sin(a),m=s.y+d*(this.x-s.x)+c*(this.y-s.y);return this.x=s.x+c*(this.x-s.x)-d*(this.y-s.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},st.convert=function(a){return a instanceof st?a:Array.isArray(a)?new st(a[0],a[1]):a};var Ae=an(hn),De=pn;function pn(a,s,c,d){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(d-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=s,this.p2x=c,this.p2y=d}pn.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,s){if(void 0===s&&(s=1e-6),a<0)return 0;if(a>1)return 1;for(var c=a,d=0;d<8;d++){var m=this.sampleCurveX(c)-a;if(Math.abs(m)<s)return c;var y=this.sampleCurveDerivativeX(c);if(Math.abs(y)<1e-6)break;c-=m/y}var b=0,C=1;for(c=a,d=0;d<20&&(m=this.sampleCurveX(c),!(Math.abs(m-a)<s));d++)a>m?b=c:C=c,c=.5*(C-b)+b;return c},solve:function(a,s){return this.sampleCurveY(this.solveCurveX(a,s))}};var xt=an(De);let Mt,nt;function ct(){return null==Mt&&(Mt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),Mt}function It(){if(null==nt&&(nt=!1,ct())){const s=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(s){for(let d=0;d<25;d++){const m=4*d;s.fillStyle=`rgb(${m},${m+1},${m+2})`,s.fillRect(d%5,Math.floor(d/5),1,1)}const c=s.getImageData(0,0,5,5).data;for(let d=0;d<100;d++)if(d%4!=3&&c[d]!==d){nt=!0;break}}}return nt||!1}function pt(a,s,c,d){const m=new xt(a,s,c,d);return y=>m.solve(y)}const mt=pt(.25,.1,.25,1);function Qe(a,s,c){return Math.min(c,Math.max(s,a))}function bt(a,s,c){const d=c-s,m=((a-s)%d+d)%d+s;return m===s?c:m}function Ze(a,...s){for(const c of s)for(const d in c)a[d]=c[d];return a}let bn=1;function ze(a,s,c){const d={};for(const m in a)d[m]=s.call(this,a[m],m,a);return d}function lt(a,s,c){const d={};for(const m in a)s.call(this,a[m],m,a)&&(d[m]=a[m]);return d}function Je(a){return Array.isArray(a)?a.map(Je):"object"==typeof a&&a?ze(a,Je):a}const Yt={};function en(a){Yt[a]||(typeof console<"u"&&console.warn(a),Yt[a]=!0)}function $t(a,s,c){return(c.y-a.y)*(s.x-a.x)>(s.y-a.y)*(c.x-a.x)}function at(a){return typeof WorkerGlobalScope<"u"&&void 0!==a&&a instanceof WorkerGlobalScope}let on=null;function ut(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const Gn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Nt(a,s,c,d,m){return x(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(a,{timestamp:0});try{const b=y?.format;if(!b||!b.startsWith("BGR")&&!b.startsWith("RGB"))throw new Error(`Unrecognized format ${b}`);const C=b.startsWith("BGR"),I=new Uint8ClampedArray(d*m*4);if(yield y.copyTo(I,function(M,O,F,j,q){const Y=4*Math.max(-O,0),ee=(Math.max(0,F)-F)*j*4+Y,le=4*j,ye=Math.max(0,O),Fe=Math.max(0,F);return{rect:{x:ye,y:Fe,width:Math.min(M.width,O+j)-ye,height:Math.min(M.height,F+q)-Fe},layout:[{offset:ee,stride:le}]}}(a,s,c,d,m)),C)for(let M=0;M<I.length;M+=4){const O=I[M];I[M]=I[M+2],I[M+2]=O}return I}finally{y.close()}})}let gt,Xe;const ge="AbortError";function be(){return new Error(ge)}const fe={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Z(a){return fe.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const Ye="global-dispatcher";class qt extends Error{constructor(s,c,d,m){super(`AJAXError: ${c} (${s}): ${d}`),this.status=s,this.statusText=c,this.url=d,this.body=m}}const kt=()=>at(self)?self.worker&&self.worker.referrer:("blob:"===window.location.protocol?window.parent:window).location.href,Lt=function(a,s){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const d=Z(a.url);if(d)return d(a,s);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:Ye},s)}if(!(/^file:/.test(c=a.url)||/^file:/.test(kt())&&!/^\w+:/.test(c))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(d,m){return x(this,void 0,void 0,function*(){const y=new Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,cache:d.cache,referrer:kt(),signal:m.signal});"json"!==d.type||y.headers.has("Accept")||y.headers.set("Accept","application/json");const b=yield fetch(y);if(!b.ok){const M=yield b.blob();throw new qt(b.status,b.statusText,d.url,M)}let C;C="arrayBuffer"===d.type||"image"===d.type?b.arrayBuffer():"json"===d.type?b.json():b.text();const I=yield C;if(m.signal.aborted)throw be();return{data:I,cacheControl:b.headers.get("Cache-Control"),expires:b.headers.get("Expires")}})}(a,s);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:Ye},s)}var c,d,m;return d=a,m=s,new Promise((y,b)=>{var C;const I=new XMLHttpRequest;I.open(d.method||"GET",d.url,!0),"arrayBuffer"!==d.type&&"image"!==d.type||(I.responseType="arraybuffer");for(const M in d.headers)I.setRequestHeader(M,d.headers[M]);"json"===d.type&&(I.responseType="text",!(null===(C=d.headers)||void 0===C)&&C.Accept||I.setRequestHeader("Accept","application/json")),I.withCredentials="include"===d.credentials,I.onerror=()=>{b(new Error(I.statusText))},I.onload=()=>{if(!m.signal.aborted)if((I.status>=200&&I.status<300||0===I.status)&&null!==I.response){let M=I.response;if("json"===d.type)try{M=JSON.parse(I.response)}catch(O){return void b(O)}y({data:M,cacheControl:I.getResponseHeader("Cache-Control"),expires:I.getResponseHeader("Expires")})}else{const M=new Blob([I.response],{type:I.getResponseHeader("Content-Type")});b(new qt(I.status,I.statusText,d.url,M))}},m.signal.addEventListener("abort",()=>{I.abort(),b(be())}),I.send(d.body)})};function jt(a){if(!a||a.indexOf("://")<=0||0===a.indexOf("data:image/")||0===a.indexOf("blob:"))return!0;const s=new URL(a),c=window.location;return s.protocol===c.protocol&&s.host===c.host}function mn(a,s,c){c[a]&&-1!==c[a].indexOf(s)||(c[a]=c[a]||[],c[a].push(s))}function di(a,s,c){if(c&&c[a]){const d=c[a].indexOf(s);-1!==d&&c[a].splice(d,1)}}class Ui{constructor(s,c={}){Ze(this,c),this.type=s}}class ri extends Ui{constructor(s,c={}){super("error",Ze({error:s},c))}}class ur{on(s,c){return this._listeners=this._listeners||{},mn(s,c,this._listeners),this}off(s,c){return di(s,c,this._listeners),di(s,c,this._oneTimeListeners),this}once(s,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},mn(s,c,this._oneTimeListeners),this):new Promise(d=>this.once(s,d))}fire(s,c){"string"==typeof s&&(s=new Ui(s,c||{}));const d=s.type;if(this.listens(d)){s.target=this;const m=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const C of m)C.call(this,s);const y=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const C of y)di(d,C,this._oneTimeListeners),C.call(this,s);const b=this._eventedParent;b&&(Ze(s,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),b.fire(s))}else s instanceof ri&&console.error(s.error);return this}listens(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)}setEventedParent(s,c){return this._eventedParent=s,this._eventedParentData=c,this}}var ve={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Oi=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function dr(a,s){const c={};for(const d in a)"ref"!==d&&(c[d]=a[d]);return Oi.forEach(d=>{d in s&&(c[d]=s[d])}),c}function Pn(a,s){if(Array.isArray(a)){if(!Array.isArray(s)||a.length!==s.length)return!1;for(let c=0;c<a.length;c++)if(!Pn(a[c],s[c]))return!1;return!0}if("object"==typeof a&&null!==a&&null!==s){if("object"!=typeof s||Object.keys(a).length!==Object.keys(s).length)return!1;for(const c in a)if(!Pn(a[c],s[c]))return!1;return!0}return a===s}function Vn(a,s){a.push(s)}function ht(a,s,c){Vn(c,{command:"addSource",args:[a,s[a]]})}function Ne(a,s,c){Vn(s,{command:"removeSource",args:[a]}),c[a]=!0}function et(a,s,c,d){Ne(a,c,d),ht(a,s,c)}function wn(a,s,c){let d;for(d in a[c])if(Object.prototype.hasOwnProperty.call(a[c],d)&&"data"!==d&&!Pn(a[c][d],s[c][d]))return!1;for(d in s[c])if(Object.prototype.hasOwnProperty.call(s[c],d)&&"data"!==d&&!Pn(a[c][d],s[c][d]))return!1;return!0}function Fn(a,s,c,d,m,y){a=a||{},s=s||{};for(const b in a)Object.prototype.hasOwnProperty.call(a,b)&&(Pn(a[b],s[b])||c.push({command:y,args:[d,b,s[b],m]}));for(const b in s)Object.prototype.hasOwnProperty.call(s,b)&&!Object.prototype.hasOwnProperty.call(a,b)&&(Pn(a[b],s[b])||c.push({command:y,args:[d,b,s[b],m]}))}function $i(a){return a.id}function ki(a,s){return a[s.id]=s,a}class it{constructor(s,c,d,m){this.message=(s?`${s}: `:"")+d,m&&(this.identifier=m),null!=c&&c.__line__&&(this.line=c.__line__)}}function vi(a,...s){for(const c of s)for(const d in c)a[d]=c[d];return a}class hi extends Error{constructor(s,c){super(c),this.message=c,this.key=s}}class hr{constructor(s,c=[]){this.parent=s,this.bindings={};for(const[d,m]of c)this.bindings[d]=m}concat(s){return new hr(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const Hi={kind:"null"},Bt={kind:"number"},Wn={kind:"string"},In={kind:"boolean"},Ur={kind:"color"},uo={kind:"object"},Nn={kind:"value"},mo={kind:"collator"},go={kind:"formatted"},Zr={kind:"padding"},io={kind:"resolvedImage"},ue={kind:"variableAnchorOffsetCollection"};function U(a,s){return{kind:"array",itemType:a,N:s}}function H(a){if("array"===a.kind){const s=H(a.itemType);return"number"==typeof a.N?`array<${s}, ${a.N}>`:"value"===a.itemType.kind?"array":`array<${s}>`}return a.kind}const J=[Hi,Bt,Wn,In,Ur,go,uo,U(Nn),Zr,io,ue];function re(a,s){if("error"===s.kind)return null;if("array"===a.kind){if("array"===s.kind&&(0===s.N&&"value"===s.itemType.kind||!re(a.itemType,s.itemType))&&("number"!=typeof a.N||a.N===s.N))return null}else{if(a.kind===s.kind)return null;if("value"===a.kind)for(const c of J)if(!re(c,s))return null}return`Expected ${H(a)} but found ${H(s)} instead.`}function Ce(a,s){return s.some(c=>c.kind===a.kind)}function Te(a,s){return s.some(c=>"null"===c?null===a:"array"===c?Array.isArray(a):"object"===c?a&&!Array.isArray(a)&&"object"==typeof a:c===typeof a)}function ke(a,s){return"array"===a.kind&&"array"===s.kind?a.itemType.kind===s.itemType.kind&&"number"==typeof a.N:a.kind===s.kind}const rt=4/29,Le=6/29,wt=3*Le*Le,Ut=Le*Le*Le,tn=Math.PI/180,kn=180/Math.PI;function oi(a){return(a%=360)<0&&(a+=360),a}function Dn([a,s,c,d]){let m,y;const b=pi((.2225045*(a=xi(a))+.7168786*(s=xi(s))+.0606169*(c=xi(c)))/1);a===s&&s===c?m=y=b:(m=pi((.4360747*a+.3850649*s+.1430804*c)/.96422),y=pi((.0139322*a+.0971045*s+.7141733*c)/.82521));const C=116*b-16;return[C<0?0:C,500*(m-b),200*(b-y),d]}function xi(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function pi(a){return a>Ut?Math.pow(a,1/3):a/wt+rt}function bi([a,s,c,d]){let m=(a+16)/116,y=isNaN(s)?m:m+s/500,b=isNaN(c)?m:m-c/200;return m=1*si(m),y=.96422*si(y),b=.82521*si(b),[ei(3.1338561*y-1.6168667*m-.4906146*b),ei(-.9787684*y+1.9161415*m+.033454*b),ei(.0719453*y-.2289914*m+1.4052427*b),d]}function ei(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function si(a){return a>Le?a*a*a:wt*(a-rt)}function qi(a){return parseInt(a.padEnd(2,a),16)/255}function mi(a,s){return _r(s?a/100:a,0,1)}function _r(a,s,c){return Math.min(Math.max(s,a),c)}function Ci(a){return!a.some(Number.isNaN)}const Us={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ri{constructor(s,c,d,m=1,y=!0){this.r=s,this.g=c,this.b=d,this.a=m,y||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[s,c,d,m]))}static parse(s){if(s instanceof Ri)return s;if("string"!=typeof s)return;const c=function(d){if("transparent"===(d=d.toLowerCase().trim()))return[0,0,0,0];const m=Us[d];if(m){const[b,C,I]=m;return[b/255,C/255,I/255,1]}if(d.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(d)){const b=d.length<6?1:2;let C=1;return[qi(d.slice(C,C+=b)),qi(d.slice(C,C+=b)),qi(d.slice(C,C+=b)),qi(d.slice(C,C+b)||"ff")]}if(d.startsWith("rgb")){const b=d.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[C,I,M,O,F,j,q,Y,ee,le,ye,Fe]=b,Ie=[O||" ",q||" ",le].join("");if("  "===Ie||"  /"===Ie||",,"===Ie||",,,"===Ie){const Re=[M,j,ee].join(""),Ge="%%%"===Re?100:""===Re?255:0;if(Ge){const Ct=[_r(+I/Ge,0,1),_r(+F/Ge,0,1),_r(+Y/Ge,0,1),ye?mi(+ye,Fe):1];if(Ci(Ct))return Ct}}return}}const y=d.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[b,C,I,M,O,F,j,q,Y]=y,ee=[I||" ",O||" ",j].join("");if("  "===ee||"  /"===ee||",,"===ee||",,,"===ee){const le=[+C,_r(+M,0,100),_r(+F,0,100),q?mi(+q,Y):1];if(Ci(le))return function([ye,Fe,Ie,Re]){function Ge(Ct){const un=(Ct+ye/30)%12,Rn=Fe*Math.min(Ie,1-Ie);return Ie-Rn*Math.max(-1,Math.min(un-3,9-un,1))}return ye=oi(ye),Fe/=100,Ie/=100,[Ge(0),Ge(8),Ge(4),Re]}(le)}}}(s);return c?new Ri(...c,!1):void 0}get rgb(){const{r:s,g:c,b:d,a:m}=this,y=m||1/0;return this.overwriteGetter("rgb",[s/y,c/y,d/y,m])}get hcl(){return this.overwriteGetter("hcl",function(s){const[c,d,m,y]=Dn(s),b=Math.sqrt(d*d+m*m);return[Math.round(1e4*b)?oi(Math.atan2(m,d)*kn):NaN,b,c,y]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Dn(this.rgb))}overwriteGetter(s,c){return Object.defineProperty(this,s,{value:c}),c}toString(){const[s,c,d,m]=this.rgb;return`rgba(${[s,c,d].map(y=>Math.round(255*y)).join(",")},${m})`}}Ri.black=new Ri(0,0,0,1),Ri.white=new Ri(1,1,1,1),Ri.transparent=new Ri(0,0,0,0),Ri.red=new Ri(1,0,0,1);class Xo{constructor(s,c,d){this.sensitivity=s?c?"variant":"case":c?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,c){return this.collator.compare(s,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class us{constructor(s,c,d,m,y){this.text=s,this.image=c,this.scale=d,this.fontStack=m,this.textColor=y}}class ir{constructor(s){this.sections=s}static fromString(s){return new ir([new us(s,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(s=>0!==s.text.length||s.image&&0!==s.image.name.length)}static factory(s){return s instanceof ir?s:ir.fromString(s)}toString(){return 0===this.sections.length?"":this.sections.map(s=>s.text).join("")}}class kr{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof kr)return s;if("number"==typeof s)return new kr([s,s,s,s]);if(Array.isArray(s)&&!(s.length<1||s.length>4)){for(const c of s)if("number"!=typeof c)return;switch(s.length){case 1:s=[s[0],s[0],s[0],s[0]];break;case 2:s=[s[0],s[1],s[0],s[1]];break;case 3:s=[s[0],s[1],s[2],s[1]]}return new kr(s)}}toString(){return JSON.stringify(this.values)}}const Nl=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class He{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof He)return s;if(Array.isArray(s)&&!(s.length<1)&&s.length%2==0){for(let c=0;c<s.length;c+=2){const d=s[c],m=s[c+1];if("string"!=typeof d||!Nl.has(d)||!Array.isArray(m)||2!==m.length||"number"!=typeof m[0]||"number"!=typeof m[1])return}return new He(s)}}toString(){return JSON.stringify(this.values)}}class St{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new St({name:s,available:!1}):null}}function ii(a,s,c,d){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof s&&s>=0&&s<=255&&"number"==typeof c&&c>=0&&c<=255?void 0===d||"number"==typeof d&&d>=0&&d<=1?null:`Invalid rgba value [${[a,s,c,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof d?[a,s,c,d]:[a,s,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Gi(a){if(null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||a instanceof Ri||a instanceof Xo||a instanceof ir||a instanceof kr||a instanceof He||a instanceof St)return!0;if(Array.isArray(a)){for(const s of a)if(!Gi(s))return!1;return!0}if("object"==typeof a){for(const s in a)if(!Gi(a[s]))return!1;return!0}return!1}function Di(a){if(null===a)return Hi;if("string"==typeof a)return Wn;if("boolean"==typeof a)return In;if("number"==typeof a)return Bt;if(a instanceof Ri)return Ur;if(a instanceof Xo)return mo;if(a instanceof ir)return go;if(a instanceof kr)return Zr;if(a instanceof He)return ue;if(a instanceof St)return io;if(Array.isArray(a)){const s=a.length;let c;for(const d of a){const m=Di(d);if(c){if(c===m)continue;c=Nn;break}c=m}return U(c||Nn,s)}return uo}function br(a){const s=typeof a;return null===a?"":"string"===s||"number"===s||"boolean"===s?String(a):a instanceof Ri||a instanceof ir||a instanceof kr||a instanceof He||a instanceof St?a.toString():JSON.stringify(a)}class Hr{constructor(s,c){this.type=s,this.value=c}static parse(s,c){if(2!==s.length)return c.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!Gi(s[1]))return c.error("invalid value");const d=s[1];let m=Di(d);const y=c.expectedType;return"array"!==m.kind||0!==m.N||!y||"array"!==y.kind||"number"==typeof y.N&&0!==y.N||(m=y),new Hr(m,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Rr{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const La={string:Wn,number:Bt,boolean:In,object:uo};class Vi{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");let d,m=1;const y=s[0];if("array"===y){let C,I;if(s.length>2){const M=s[1];if("string"!=typeof M||!(M in La)||"object"===M)return c.error('The item type argument of "array" must be one of string, number, boolean',1);C=La[M],m++}else C=Nn;if(s.length>3){if(null!==s[2]&&("number"!=typeof s[2]||s[2]<0||s[2]!==Math.floor(s[2])))return c.error('The length argument to "array" must be a positive integer literal',2);I=s[2],m++}d=U(C,I)}else{if(!La[y])throw new Error(`Types doesn't contain name = ${y}`);d=La[y]}const b=[];for(;m<s.length;m++){const C=c.parse(s[m],m,Nn);if(!C)return null;b.push(C)}return new Vi(d,b)}evaluate(s){for(let c=0;c<this.args.length;c++){const d=this.args[c].evaluate(s);if(!re(this.type,Di(d)))return d;if(c===this.args.length-1)throw new Rr(`Expected value to be of type ${H(this.type)}, but found ${H(Di(d))} instead.`)}throw new Error}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const Na={"to-boolean":In,"to-color":Ur,"to-number":Bt,"to-string":Wn};class ti{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const d=s[0];if(!Na[d])throw new Error(`Can't parse ${d} as it is not part of the known types`);if(("to-boolean"===d||"to-string"===d)&&2!==s.length)return c.error("Expected one argument.");const m=Na[d],y=[];for(let b=1;b<s.length;b++){const C=c.parse(s[b],b,Nn);if(!C)return null;y.push(C)}return new ti(m,y)}evaluate(s){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(s);case"color":{let c,d;for(const m of this.args){if(c=m.evaluate(s),d=null,c instanceof Ri)return c;if("string"==typeof c){const y=s.parseColor(c);if(y)return y}else if(Array.isArray(c)&&(d=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:ii(c[0],c[1],c[2],c[3]),!d))return new Ri(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new Rr(d||`Could not parse color from value '${"string"==typeof c?c:JSON.stringify(c)}'`)}case"padding":{let c;for(const d of this.args){c=d.evaluate(s);const m=kr.parse(c);if(m)return m}throw new Rr(`Could not parse padding from value '${"string"==typeof c?c:JSON.stringify(c)}'`)}case"variableAnchorOffsetCollection":{let c;for(const d of this.args){c=d.evaluate(s);const m=He.parse(c);if(m)return m}throw new Rr(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof c?c:JSON.stringify(c)}'`)}case"number":{let c=null;for(const d of this.args){if(c=d.evaluate(s),null===c)return 0;const m=Number(c);if(!isNaN(m))return m}throw new Rr(`Could not convert ${JSON.stringify(c)} to number.`)}case"formatted":return ir.fromString(br(this.args[0].evaluate(s)));case"resolvedImage":return St.fromString(br(this.args[0].evaluate(s)));default:return br(this.args[0].evaluate(s))}}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const Zn=["Unknown","Point","LineString","Polygon"];class wa{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Zn[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(s){let c=this._parseColorCache[s];return c||(c=this._parseColorCache[s]=Ri.parse(s)),c}}class Ko{constructor(s,c,d=[],m,y=new hr,b=[]){this.registry=s,this.path=d,this.key=d.map(C=>`[${C}]`).join(""),this.scope=y,this.errors=b,this.expectedType=m,this._isConstant=c}parse(s,c,d,m,y={}){return c?this.concat(c,d,m)._parse(s,y):this._parse(s,y)}_parse(s,c){function d(m,y,b){return"assert"===b?new Vi(y,[m]):"coerce"===b?new ti(y,[m]):m}if(null!==s&&"string"!=typeof s&&"boolean"!=typeof s&&"number"!=typeof s||(s=["literal",s]),Array.isArray(s)){if(0===s.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=s[0];if("string"!=typeof m)return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[m];if(y){let b=y.parse(s,this);if(!b)return null;if(this.expectedType){const C=this.expectedType,I=b.type;if("string"!==C.kind&&"number"!==C.kind&&"boolean"!==C.kind&&"object"!==C.kind&&"array"!==C.kind||"value"!==I.kind)if("color"!==C.kind&&"formatted"!==C.kind&&"resolvedImage"!==C.kind||"value"!==I.kind&&"string"!==I.kind)if("padding"!==C.kind||"value"!==I.kind&&"number"!==I.kind&&"array"!==I.kind)if("variableAnchorOffsetCollection"!==C.kind||"value"!==I.kind&&"array"!==I.kind){if(this.checkSubtype(C,I))return null}else b=d(b,C,c.typeAnnotation||"coerce");else b=d(b,C,c.typeAnnotation||"coerce");else b=d(b,C,c.typeAnnotation||"coerce");else b=d(b,C,c.typeAnnotation||"assert")}if(!(b instanceof Hr)&&"resolvedImage"!==b.type.kind&&this._isConstant(b)){const C=new wa;try{b=new Hr(b.type,b.evaluate(C))}catch(I){return this.error(I.message),null}}return b}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===s?"'undefined' value invalid. Use null instead.":"object"==typeof s?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,c,d){const m="number"==typeof s?this.path.concat(s):this.path,y=d?this.scope.concat(d):this.scope;return new Ko(this.registry,this._isConstant,m,c||null,y,this.errors)}error(s,...c){const d=`${this.key}${c.map(m=>`[${m}]`).join("")}`;this.errors.push(new hi(d,s))}checkSubtype(s,c){const d=re(s,c);return d&&this.error(d),d}}class jn{constructor(s,c){this.type=c.type,this.bindings=[].concat(s),this.result=c}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const c of this.bindings)s(c[1]);s(this.result)}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const d=[];for(let y=1;y<s.length-1;y+=2){const b=s[y];if("string"!=typeof b)return c.error(`Expected string, but found ${typeof b} instead.`,y);if(/[^a-zA-Z0-9_]/.test(b))return c.error("Variable names must contain only alphanumeric characters or '_'.",y);const C=c.parse(s[y+1],y+1);if(!C)return null;d.push([b,C])}const m=c.parse(s[s.length-1],s.length-1,c.expectedType,d);return m?new jn(d,m):null}outputDefined(){return this.result.outputDefined()}}class xa{constructor(s,c){this.type=c.type,this.name=s,this.boundExpression=c}static parse(s,c){if(2!==s.length||"string"!=typeof s[1])return c.error("'var' expression requires exactly one string literal argument.");const d=s[1];return c.scope.has(d)?new xa(d,c.scope.get(d)):c.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}}class Bl{constructor(s,c,d){this.type=s,this.index=c,this.input=d}static parse(s,c){if(3!==s.length)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,Bt),m=c.parse(s[2],2,U(c.expectedType||Nn));return d&&m?new Bl(m.type.itemType,d,m):null}evaluate(s){const c=this.index.evaluate(s),d=this.input.evaluate(s);if(c<0)throw new Rr(`Array index out of bounds: ${c} < 0.`);if(c>=d.length)throw new Rr(`Array index out of bounds: ${c} > ${d.length-1}.`);if(c!==Math.floor(c))throw new Rr(`Array index must be an integer, but found ${c} instead.`);return d[c]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}}class Ti{constructor(s,c){this.type=In,this.needle=s,this.haystack=c}static parse(s,c){if(3!==s.length)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,Nn),m=c.parse(s[2],2,Nn);return d&&m?Ce(d.type,[In,Wn,Bt,Hi,Nn])?new Ti(d,m):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${H(d.type)} instead`):null}evaluate(s){const c=this.needle.evaluate(s),d=this.haystack.evaluate(s);if(!d)return!1;if(!Te(c,["boolean","string","number","null"]))throw new Rr(`Expected first argument to be of type boolean, string, number or null, but found ${H(Di(c))} instead.`);if(!Te(d,["string","array"]))throw new Rr(`Expected second argument to be of type array or string, but found ${H(Di(d))} instead.`);return d.indexOf(c)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}}class Bo{constructor(s,c,d){this.type=Bt,this.needle=s,this.haystack=c,this.fromIndex=d}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,Nn),m=c.parse(s[2],2,Nn);if(!d||!m)return null;if(!Ce(d.type,[In,Wn,Bt,Hi,Nn]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${H(d.type)} instead`);if(4===s.length){const y=c.parse(s[3],3,Bt);return y?new Bo(d,m,y):null}return new Bo(d,m)}evaluate(s){const c=this.needle.evaluate(s),d=this.haystack.evaluate(s);if(!Te(c,["boolean","string","number","null"]))throw new Rr(`Expected first argument to be of type boolean, string, number or null, but found ${H(Di(c))} instead.`);let m;if(this.fromIndex&&(m=this.fromIndex.evaluate(s)),Te(d,["string"])){const y=d.indexOf(c,m);return-1===y?-1:[...d.slice(0,y)].length}if(Te(d,["array"]))return d.indexOf(c,m);throw new Rr(`Expected second argument to be of type array or string, but found ${H(Di(d))} instead.`)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}}class wr{constructor(s,c,d,m,y,b){this.inputType=s,this.type=c,this.input=d,this.cases=m,this.outputs=y,this.otherwise=b}static parse(s,c){if(s.length<5)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return c.error("Expected an even number of arguments.");let d,m;c.expectedType&&"value"!==c.expectedType.kind&&(m=c.expectedType);const y={},b=[];for(let M=2;M<s.length-1;M+=2){let O=s[M];const F=s[M+1];Array.isArray(O)||(O=[O]);const j=c.concat(M);if(0===O.length)return j.error("Expected at least one branch label.");for(const Y of O){if("number"!=typeof Y&&"string"!=typeof Y)return j.error("Branch labels must be numbers or strings.");if("number"==typeof Y&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof Y&&Math.floor(Y)!==Y)return j.error("Numeric branch labels must be integer values.");if(d){if(j.checkSubtype(d,Di(Y)))return null}else d=Di(Y);if(void 0!==y[String(Y)])return j.error("Branch labels must be unique.");y[String(Y)]=b.length}const q=c.parse(F,M,m);if(!q)return null;m=m||q.type,b.push(q)}const C=c.parse(s[1],1,Nn);if(!C)return null;const I=c.parse(s[s.length-1],s.length-1,m);return I?"value"!==C.type.kind&&c.concat(1).checkSubtype(d,C.type)?null:new wr(d,m,C,y,b,I):null}evaluate(s){const c=this.input.evaluate(s);return(Di(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}}class Yo{constructor(s,c,d){this.type=s,this.branches=c,this.otherwise=d}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return c.error("Expected an odd number of arguments.");let d;c.expectedType&&"value"!==c.expectedType.kind&&(d=c.expectedType);const m=[];for(let b=1;b<s.length-1;b+=2){const C=c.parse(s[b],b,In);if(!C)return null;const I=c.parse(s[b+1],b+1,d);if(!I)return null;m.push([C,I]),d=d||I.type}const y=c.parse(s[s.length-1],s.length-1,d);if(!y)return null;if(!d)throw new Error("Can't infer output type");return new Yo(d,m,y)}evaluate(s){for(const[c,d]of this.branches)if(c.evaluate(s))return d.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[c,d]of this.branches)s(c),s(d);s(this.otherwise)}outputDefined(){return this.branches.every(([s,c])=>c.outputDefined())&&this.otherwise.outputDefined()}}class fr{constructor(s,c,d,m){this.type=s,this.input=c,this.beginIndex=d,this.endIndex=m}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,Nn),m=c.parse(s[2],2,Bt);if(!d||!m)return null;if(!Ce(d.type,[U(Nn),Wn,Nn]))return c.error(`Expected first argument to be of type array or string, but found ${H(d.type)} instead`);if(4===s.length){const y=c.parse(s[3],3,Bt);return y?new fr(d.type,d,m,y):null}return new fr(d.type,d,m)}evaluate(s){const c=this.input.evaluate(s),d=this.beginIndex.evaluate(s);let m;if(this.endIndex&&(m=this.endIndex.evaluate(s)),Te(c,["string"]))return[...c].slice(d,m).join("");if(Te(c,["array"]))return c.slice(d,m);throw new Rr(`Expected first argument to be of type array or string, but found ${H(Di(c))} instead.`)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}}function Fi(a,s){const c=a.length-1;let d,m,y=0,b=c,C=0;for(;y<=b;)if(C=Math.floor((y+b)/2),d=a[C],m=a[C+1],d<=s){if(C===c||s<m)return C;y=C+1}else{if(!(d>s))throw new Rr("Input is not a number.");b=C-1}return 0}class Un{constructor(s,c,d){this.type=s,this.input=c,this.labels=[],this.outputs=[];for(const[m,y]of d)this.labels.push(m),this.outputs.push(y)}static parse(s,c){if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");const d=c.parse(s[1],1,Bt);if(!d)return null;const m=[];let y=null;c.expectedType&&"value"!==c.expectedType.kind&&(y=c.expectedType);for(let b=1;b<s.length;b+=2){const C=1===b?-1/0:s[b],I=s[b+1],M=b,O=b+1;if("number"!=typeof C)return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(m.length&&m[m.length-1][0]>=C)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const F=c.parse(I,O,y);if(!F)return null;y=y||F.type,m.push([C,F])}return new Un(y,d,m)}evaluate(s){const c=this.labels,d=this.outputs;if(1===c.length)return d[0].evaluate(s);const m=this.input.evaluate(s);if(m<=c[0])return d[0].evaluate(s);const y=c.length;return m>=c[y-1]?d[y-1].evaluate(s):d[Fi(c,m)].evaluate(s)}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}var al=du;function du(a,s,c,d){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(d-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=s,this.p2x=c,this.p2y=d}du.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,s){if(void 0===s&&(s=1e-6),a<0)return 0;if(a>1)return 1;for(var c=a,d=0;d<8;d++){var m=this.sampleCurveX(c)-a;if(Math.abs(m)<s)return c;var y=this.sampleCurveDerivativeX(c);if(Math.abs(y)<1e-6)break;c-=m/y}var b=0,C=1;for(c=a,d=0;d<20&&(m=this.sampleCurveX(c),!(Math.abs(m-a)<s));d++)a>m?b=c:C=c,c=.5*(C-b)+b;return c},solve:function(a,s){return this.sampleCurveY(this.solveCurveX(a,s))}};var xc=function zl(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}(al);function qe(a,s,c){return a+c*(s-a)}function Ps(a,s,c){return a.map((d,m)=>qe(d,s[m],c))}const On={number:qe,color:function(a,s,c,d="rgb"){switch(d){case"rgb":{const[m,y,b,C]=Ps(a.rgb,s.rgb,c);return new Ri(m,y,b,C,!1)}case"hcl":{const[m,y,b,C]=a.hcl,[I,M,O,F]=s.hcl;let j,q;if(isNaN(m)||isNaN(I))isNaN(m)?isNaN(I)?j=NaN:(j=I,1!==b&&0!==b||(q=M)):(j=m,1!==O&&0!==O||(q=y));else{let Fe=I-m;I>m&&Fe>180?Fe-=360:I<m&&m-I>180&&(Fe+=360),j=m+c*Fe}const[Y,ee,le,ye]=function([Fe,Ie,Re,Ge]){return Fe=isNaN(Fe)?0:Fe*tn,bi([Re,Math.cos(Fe)*Ie,Math.sin(Fe)*Ie,Ge])}([j,q??qe(y,M,c),qe(b,O,c),qe(C,F,c)]);return new Ri(Y,ee,le,ye,!1)}case"lab":{const[m,y,b,C]=bi(Ps(a.lab,s.lab,c));return new Ri(m,y,b,C,!1)}}},array:Ps,padding:function(a,s,c){return new kr(Ps(a.values,s.values,c))},variableAnchorOffsetCollection:function(a,s,c){const d=a.values,m=s.values;if(d.length!==m.length)throw new Rr(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${s.toString()}`);const y=[];for(let b=0;b<d.length;b+=2){if(d[b]!==m[b])throw new Rr(`Cannot interpolate values containing mismatched anchors. from[${b}]: ${d[b]}, to[${b}]: ${m[b]}`);y.push(d[b]);const[C,I]=d[b+1],[M,O]=m[b+1];y.push([qe(C,M,c),qe(I,O,c)])}return new He(y)}};class ai{constructor(s,c,d,m,y){this.type=s,this.operator=c,this.interpolation=d,this.input=m,this.labels=[],this.outputs=[];for(const[b,C]of y)this.labels.push(b),this.outputs.push(C)}static interpolationFactor(s,c,d,m){let y=0;if("exponential"===s.name)y=Ba(c,s.base,d,m);else if("linear"===s.name)y=Ba(c,1,d,m);else if("cubic-bezier"===s.name){const b=s.controlPoints;y=new xc(b[0],b[1],b[2],b[3]).solve(Ba(c,1,d,m))}return y}static parse(s,c){let[d,m,y,...b]=s;if(!Array.isArray(m)||0===m.length)return c.error("Expected an interpolation type expression.",1);if("linear"===m[0])m={name:"linear"};else if("exponential"===m[0]){const M=m[1];if("number"!=typeof M)return c.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:M}}else{if("cubic-bezier"!==m[0])return c.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const M=m.slice(1);if(4!==M.length||M.some(O=>"number"!=typeof O||O<0||O>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:M}}}if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(y=c.parse(y,2,Bt),!y)return null;const C=[];let I=null;"interpolate-hcl"===d||"interpolate-lab"===d?I=Ur:c.expectedType&&"value"!==c.expectedType.kind&&(I=c.expectedType);for(let M=0;M<b.length;M+=2){const O=b[M],F=b[M+1],j=M+3,q=M+4;if("number"!=typeof O)return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(C.length&&C[C.length-1][0]>=O)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const Y=c.parse(F,q,I);if(!Y)return null;I=I||Y.type,C.push([O,Y])}return ke(I,Bt)||ke(I,Ur)||ke(I,Zr)||ke(I,ue)||ke(I,U(Bt))?new ai(I,d,m,y,C):c.error(`Type ${H(I)} is not interpolatable.`)}evaluate(s){const c=this.labels,d=this.outputs;if(1===c.length)return d[0].evaluate(s);const m=this.input.evaluate(s);if(m<=c[0])return d[0].evaluate(s);const y=c.length;if(m>=c[y-1])return d[y-1].evaluate(s);const b=Fi(c,m),C=ai.interpolationFactor(this.interpolation,m,c[b],c[b+1]),I=d[b].evaluate(s),M=d[b+1].evaluate(s);switch(this.operator){case"interpolate":return On[this.type.kind](I,M,C);case"interpolate-hcl":return On.color(I,M,C,"hcl");case"interpolate-lab":return On.color(I,M,C,"lab")}}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Ba(a,s,c,d){const m=d-c,y=a-c;return 0===m?0:1===s?y/m:(Math.pow(s,y)-1)/(Math.pow(s,m)-1)}class $l{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expectected at least one argument.");let d=null;const m=c.expectedType;m&&"value"!==m.kind&&(d=m);const y=[];for(const C of s.slice(1)){const I=c.parse(C,1+y.length,d,void 0,{typeAnnotation:"omit"});if(!I)return null;d=d||I.type,y.push(I)}if(!d)throw new Error("No output type");const b=m&&y.some(C=>re(m,C.type));return new $l(b?Nn:d,y)}evaluate(s){let c,d=null,m=0;for(const y of this.args)if(m++,d=y.evaluate(s),d&&d instanceof St&&!d.available&&(c||(c=d.name),d=null,m===this.args.length&&(d=c)),null!==d)break;return d}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}function Cc(a,s){return"=="===a||"!="===a?"boolean"===s.kind||"string"===s.kind||"number"===s.kind||"null"===s.kind||"value"===s.kind:"string"===s.kind||"number"===s.kind||"value"===s.kind}function ll(a,s,c,d){return 0===d.compare(s,c)}function Or(a,s,c){const d="=="!==a&&"!="!==a;return class ik{constructor(y,b,C){this.type=In,this.lhs=y,this.rhs=b,this.collator=C,this.hasUntypedArgument="value"===y.type.kind||"value"===b.type.kind}static parse(y,b){if(3!==y.length&&4!==y.length)return b.error("Expected two or three arguments.");const C=y[0];let I=b.parse(y[1],1,Nn);if(!I)return null;if(!Cc(C,I.type))return b.concat(1).error(`"${C}" comparisons are not supported for type '${H(I.type)}'.`);let M=b.parse(y[2],2,Nn);if(!M)return null;if(!Cc(C,M.type))return b.concat(2).error(`"${C}" comparisons are not supported for type '${H(M.type)}'.`);if(I.type.kind!==M.type.kind&&"value"!==I.type.kind&&"value"!==M.type.kind)return b.error(`Cannot compare types '${H(I.type)}' and '${H(M.type)}'.`);d&&("value"===I.type.kind&&"value"!==M.type.kind?I=new Vi(M.type,[I]):"value"!==I.type.kind&&"value"===M.type.kind&&(M=new Vi(I.type,[M])));let O=null;if(4===y.length){if("string"!==I.type.kind&&"string"!==M.type.kind&&"value"!==I.type.kind&&"value"!==M.type.kind)return b.error("Cannot use collator to compare non-string types.");if(O=b.parse(y[3],3,mo),!O)return null}return new ik(I,M,O)}evaluate(y){const b=this.lhs.evaluate(y),C=this.rhs.evaluate(y);if(d&&this.hasUntypedArgument){const I=Di(b),M=Di(C);if(I.kind!==M.kind||"string"!==I.kind&&"number"!==I.kind)throw new Rr(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${I.kind}, ${M.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const I=Di(b),M=Di(C);if("string"!==I.kind||"string"!==M.kind)return s(y,b,C)}return this.collator?c(y,b,C,this.collator.evaluate(y)):s(y,b,C)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const Dc=Or("==",function(a,s,c){return s===c},ll),cl=Or("!=",function(a,s,c){return s!==c},function(a,s,c,d){return!ll(0,s,c,d)}),Vl=Or("<",function(a,s,c){return s<c},function(a,s,c,d){return d.compare(s,c)<0}),Hs=Or(">",function(a,s,c){return s>c},function(a,s,c,d){return d.compare(s,c)>0}),jl=Or("<=",function(a,s,c){return s<=c},function(a,s,c,d){return d.compare(s,c)<=0}),Ku=Or(">=",function(a,s,c){return s>=c},function(a,s,c,d){return d.compare(s,c)>=0});class Ul{constructor(s,c,d){this.type=mo,this.locale=d,this.caseSensitive=s,this.diacriticSensitive=c}static parse(s,c){if(2!==s.length)return c.error("Expected one argument.");const d=s[1];if("object"!=typeof d||Array.isArray(d))return c.error("Collator options argument must be an object.");const m=c.parse(void 0!==d["case-sensitive"]&&d["case-sensitive"],1,In);if(!m)return null;const y=c.parse(void 0!==d["diacritic-sensitive"]&&d["diacritic-sensitive"],1,In);if(!y)return null;let b=null;return d.locale&&(b=c.parse(d.locale,1,Wn),!b)?null:new Ul(m,y,b)}evaluate(s){return new Xo(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}}class oa{constructor(s,c,d,m,y){this.type=Wn,this.number=s,this.locale=c,this.currency=d,this.minFractionDigits=m,this.maxFractionDigits=y}static parse(s,c){if(3!==s.length)return c.error("Expected two arguments.");const d=c.parse(s[1],1,Bt);if(!d)return null;const m=s[2];if("object"!=typeof m||Array.isArray(m))return c.error("NumberFormat options argument must be an object.");let y=null;if(m.locale&&(y=c.parse(m.locale,1,Wn),!y))return null;let b=null;if(m.currency&&(b=c.parse(m.currency,1,Wn),!b))return null;let C=null;if(m["min-fraction-digits"]&&(C=c.parse(m["min-fraction-digits"],1,Bt),!C))return null;let I=null;return m["max-fraction-digits"]&&(I=c.parse(m["max-fraction-digits"],1,Bt),!I)?null:new oa(d,y,b,C,I)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}}class ul{constructor(s){this.type=go,this.sections=s}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const d=s[1];if(!Array.isArray(d)&&"object"==typeof d)return c.error("First argument must be an image or text section.");const m=[];let y=!1;for(let b=1;b<=s.length-1;++b){const C=s[b];if(y&&"object"==typeof C&&!Array.isArray(C)){y=!1;let I=null;if(C["font-scale"]&&(I=c.parse(C["font-scale"],1,Bt),!I))return null;let M=null;if(C["text-font"]&&(M=c.parse(C["text-font"],1,U(Wn)),!M))return null;let O=null;if(C["text-color"]&&(O=c.parse(C["text-color"],1,Ur),!O))return null;const F=m[m.length-1];F.scale=I,F.font=M,F.textColor=O}else{const I=c.parse(s[b],1,Nn);if(!I)return null;const M=I.type.kind;if("string"!==M&&"value"!==M&&"null"!==M&&"resolvedImage"!==M)return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,m.push({content:I,scale:null,font:null,textColor:null})}}return new ul(m)}evaluate(s){return new ir(this.sections.map(c=>{const d=c.content.evaluate(s);return Di(d)===io?new us("",d,null,null,null):new us(br(d),null,c.scale?c.scale.evaluate(s):null,c.font?c.font.evaluate(s).join(","):null,c.textColor?c.textColor.evaluate(s):null)}))}eachChild(s){for(const c of this.sections)s(c.content),c.scale&&s(c.scale),c.font&&s(c.font),c.textColor&&s(c.textColor)}outputDefined(){return!1}}class N{constructor(s){this.type=io,this.input=s}static parse(s,c){if(2!==s.length)return c.error("Expected two arguments.");const d=c.parse(s[1],1,Wn);return d?new N(d):c.error("No image name provided.")}evaluate(s){const c=this.input.evaluate(s),d=St.fromString(c);return d&&s.availableImages&&(d.available=s.availableImages.indexOf(c)>-1),d}eachChild(s){s(this.input)}outputDefined(){return!1}}class K{constructor(s){this.type=Bt,this.input=s}static parse(s,c){if(2!==s.length)return c.error(`Expected 1 argument, but found ${s.length-1} instead.`);const d=c.parse(s[1],1);return d?"array"!==d.type.kind&&"string"!==d.type.kind&&"value"!==d.type.kind?c.error(`Expected argument of type string or array, but found ${H(d.type)} instead.`):new K(d):null}evaluate(s){const c=this.input.evaluate(s);if("string"==typeof c)return[...c].length;if(Array.isArray(c))return c.length;throw new Rr(`Expected value to be of type string or array, but found ${H(Di(c))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}}const ae=8192;function pe(a,s){const c=(180+a[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,m=Math.pow(2,s.z);return[Math.round(c*m*ae),Math.round(d*m*ae)]}function _e(a,s){const c=Math.pow(2,s.z);return[(m=(a[0]/ae+s.x)/c,360*m-180),(d=(a[1]/ae+s.y)/c,360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90)];var d,m}function xe(a,s){a[0]=Math.min(a[0],s[0]),a[1]=Math.min(a[1],s[1]),a[2]=Math.max(a[2],s[0]),a[3]=Math.max(a[3],s[1])}function ot(a,s){return!(a[0]<=s[0]||a[2]>=s[2]||a[1]<=s[1]||a[3]>=s[3])}function _t(a,s,c){const d=a[0]-s[0],m=a[1]-s[1],y=a[0]-c[0],b=a[1]-c[1];return d*b-y*m==0&&d*y<=0&&m*b<=0}function Pe(a,s,c,d){return(m=[d[0]-c[0],d[1]-c[1]])[0]*(y=[s[0]-a[0],s[1]-a[1]])[1]-m[1]*y[0]!=0&&!(!Li(a,s,c,d)||!Li(c,d,a,s));var m,y}function yt(a,s,c){for(const d of c)for(let m=0;m<d.length-1;++m)if(Pe(a,s,d[m],d[m+1]))return!0;return!1}function Rt(a,s,c=!1){let d=!1;for(const C of s)for(let I=0;I<C.length-1;I++){if(_t(a,C[I],C[I+1]))return c;(y=C[I])[1]>(m=a)[1]!=(b=C[I+1])[1]>m[1]&&m[0]<(b[0]-y[0])*(m[1]-y[1])/(b[1]-y[1])+y[0]&&(d=!d)}var m,y,b;return d}function nn(a,s){for(const c of s)if(Rt(a,c))return!0;return!1}function An(a,s){for(const c of a)if(!Rt(c,s))return!1;for(let c=0;c<a.length-1;++c)if(yt(a[c],a[c+1],s))return!1;return!0}function Bn(a,s){for(const c of s)if(An(a,c))return!0;return!1}function Li(a,s,c,d){const m=d[0]-c[0],y=d[1]-c[1],b=(a[0]-c[0])*y-m*(a[1]-c[1]),C=(s[0]-c[0])*y-m*(s[1]-c[1]);return b>0&&C<0||b<0&&C>0}function Ji(a,s,c){const d=[];for(let m=0;m<a.length;m++){const y=[];for(let b=0;b<a[m].length;b++){const C=pe(a[m][b],c);xe(s,C),y.push(C)}d.push(y)}return d}function Sr(a,s,c){const d=[];for(let m=0;m<a.length;m++){const y=Ji(a[m],s,c);d.push(y)}return d}function Qi(a,s,c,d){if(a[0]<c[0]||a[0]>c[2]){const m=.5*d;let y=a[0]-c[0]>m?-d:c[0]-a[0]>m?d:0;0===y&&(y=a[0]-c[2]>m?-d:c[2]-a[0]>m?d:0),a[0]+=y}xe(s,a)}function Fr(a,s,c,d){const m=Math.pow(2,d.z)*ae,y=[d.x*ae,d.y*ae],b=[];for(const C of a)for(const I of C){const M=[I.x+y[0],I.y+y[1]];Qi(M,s,c,m),b.push(M)}return b}function Hl(a,s,c,d){const m=Math.pow(2,d.z)*ae,y=[d.x*ae,d.y*ae],b=[];for(const I of a){const M=[];for(const O of I){const F=[O.x+y[0],O.y+y[1]];xe(s,F),M.push(F)}b.push(M)}if(s[2]-s[0]<=m/2){(C=s)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const I of b)for(const M of I)Qi(M,s,c,m)}var C;return b}class Ln{constructor(s,c){this.type=In,this.geojson=s,this.geometries=c}static parse(s,c){if(2!==s.length)return c.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(Gi(s[1])){const d=s[1];if("FeatureCollection"===d.type){const m=[];for(const y of d.features){const{type:b,coordinates:C}=y.geometry;"Polygon"===b&&m.push(C),"MultiPolygon"===b&&m.push(...C)}if(m.length)return new Ln(d,{type:"MultiPolygon",coordinates:m})}else if("Feature"===d.type){const m=d.geometry.type;if("Polygon"===m||"MultiPolygon"===m)return new Ln(d,d.geometry)}else if("Polygon"===d.type||"MultiPolygon"===d.type)return new Ln(d,d)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(null!=s.geometry()&&null!=s.canonicalID()){if("Point"===s.geometryType())return function(c,d){const m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=c.canonicalID();if("Polygon"===d.type){const C=Ji(d.coordinates,y,b),I=Fr(c.geometry(),m,y,b);if(!ot(m,y))return!1;for(const M of I)if(!Rt(M,C))return!1}if("MultiPolygon"===d.type){const C=Sr(d.coordinates,y,b),I=Fr(c.geometry(),m,y,b);if(!ot(m,y))return!1;for(const M of I)if(!nn(M,C))return!1}return!0}(s,this.geometries);if("LineString"===s.geometryType())return function(c,d){const m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=c.canonicalID();if("Polygon"===d.type){const C=Ji(d.coordinates,y,b),I=Hl(c.geometry(),m,y,b);if(!ot(m,y))return!1;for(const M of I)if(!An(M,C))return!1}if("MultiPolygon"===d.type){const C=Sr(d.coordinates,y,b),I=Hl(c.geometry(),m,y,b);if(!ot(m,y))return!1;for(const M of I)if(!Bn(M,C))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Ec=class{constructor(a=[],s=((c,d)=>c<d?-1:c>d?1:0)){if(this.data=a,this.length=this.data.length,this.compare=s,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(0===this.length)return;const a=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:s,compare:c}=this,d=s[a];for(;a>0;){const m=a-1>>1,y=s[m];if(c(d,y)>=0)break;s[a]=y,a=m}s[a]=d}_down(a){const{data:s,compare:c}=this,d=this.length>>1,m=s[a];for(;a<d;){let y=1+(a<<1);const b=y+1;if(b<this.length&&c(s[b],s[y])<0&&(y=b),c(s[y],m)>=0)break;s[a]=s[y],a=y}s[a]=m}};function Yu(a,s,c,d,m){Io(a,s,c,d||a.length-1,m||za)}function Io(a,s,c,d,m){for(;d>c;){if(d-c>600){var y=d-c+1,b=s-c+1,C=Math.log(y),I=.5*Math.exp(2*C/3),M=.5*Math.sqrt(C*I*(y-I)/y)*(b-y/2<0?-1:1);Io(a,s,Math.max(c,Math.floor(s-b*I/y+M)),Math.min(d,Math.floor(s+(y-b)*I/y+M)),m)}var O=a[s],F=c,j=d;for(dl(a,c,s),m(a[d],O)>0&&dl(a,c,d);F<j;){for(dl(a,F,j),F++,j--;m(a[F],O)<0;)F++;for(;m(a[j],O)>0;)j--}0===m(a[c],O)?dl(a,c,j):dl(a,++j,d),j<=s&&(c=j+1),s<=j&&(d=j-1)}}function dl(a,s,c){var d=a[s];a[s]=a[c],a[c]=d}function za(a,s){return a<s?-1:a>s?1:0}function Xi(a,s){if(a.length<=1)return[a];const c=[];let d,m;for(const y of a){const b=Ic(y);0!==b&&(y.area=Math.abs(b),void 0===m&&(m=b<0),m===b<0?(d&&c.push(d),d=[y]):d.push(y))}if(d&&c.push(d),s>1)for(let y=0;y<c.length;y++)c[y].length<=s||(Yu(c[y],s,1,c[y].length-1,Wd),c[y]=c[y].slice(0,s));return c}function Wd(a,s){return s.area-a.area}function Ic(a){let s=0;for(let c,d,m=0,y=a.length,b=y-1;m<y;b=m++)c=a[m],d=a[b],s+=(d.x-c.x)*(c.y+d.y);return s}const ln=1/298.257223563,Sc=ln*(2-ln),Tc=Math.PI/180;class ql{constructor(s){const c=6378.137*Tc*1e3,d=Math.cos(s*Tc),m=1/(1-Sc*(1-d*d)),y=Math.sqrt(m);this.kx=c*y*d,this.ky=c*y*m*(1-Sc)}distance(s,c){const d=this.wrap(s[0]-c[0])*this.kx,m=(s[1]-c[1])*this.ky;return Math.sqrt(d*d+m*m)}pointOnLine(s,c){let d,m,y,b,C=1/0;for(let I=0;I<s.length-1;I++){let M=s[I][0],O=s[I][1],F=this.wrap(s[I+1][0]-M)*this.kx,j=(s[I+1][1]-O)*this.ky,q=0;0===F&&0===j||(q=(this.wrap(c[0]-M)*this.kx*F+(c[1]-O)*this.ky*j)/(F*F+j*j),q>1?(M=s[I+1][0],O=s[I+1][1]):q>0&&(M+=F/this.kx*q,O+=j/this.ky*q)),F=this.wrap(c[0]-M)*this.kx,j=(c[1]-O)*this.ky;const Y=F*F+j*j;Y<C&&(C=Y,d=M,m=O,y=I,b=q)}return{point:[d,m],index:y,t:Math.max(0,Math.min(1,b))}}wrap(s){for(;s<-180;)s+=360;for(;s>180;)s-=360;return s}}function sa(a,s){return s[0]-a[0]}function Ac(a){return a[1]-a[0]+1}function ks(a,s){return a[1]>=a[0]&&a[1]<s}function Ju(a,s){if(a[0]>a[1])return[null,null];const c=Ac(a);if(s){if(2===c)return[a,null];const m=Math.floor(c/2);return[[a[0],a[0]+m],[a[0]+m,a[1]]]}if(1===c)return[a,null];const d=Math.floor(c/2)-1;return[[a[0],a[0]+d],[a[0]+d+1,a[1]]]}function Mc(a,s){if(!ks(s,a.length))return[1/0,1/0,-1/0,-1/0];const c=[1/0,1/0,-1/0,-1/0];for(let d=s[0];d<=s[1];++d)xe(c,a[d]);return c}function Qu(a){const s=[1/0,1/0,-1/0,-1/0];for(const c of a)for(const d of c)xe(s,d);return s}function Zd(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function ed(a,s,c){if(!Zd(a)||!Zd(s))return NaN;let d=0,m=0;return a[2]<s[0]&&(d=s[0]-a[2]),a[0]>s[2]&&(d=a[0]-s[2]),a[1]>s[3]&&(m=a[1]-s[3]),a[3]<s[1]&&(m=s[1]-a[3]),c.distance([0,0],[d,m])}function Rs(a,s,c){const d=c.pointOnLine(s,a);return c.distance(a,d.point)}function xr(a,s,c,d,m){const y=Math.min(Rs(a,[c,d],m),Rs(s,[c,d],m)),b=Math.min(Rs(c,[a,s],m),Rs(d,[a,s],m));return Math.min(y,b)}function Pc(a,s,c,d,m){if(!ks(s,a.length)||!ks(d,c.length))return 1/0;let y=1/0;for(let b=s[0];b<s[1];++b){const C=a[b],I=a[b+1];for(let M=d[0];M<d[1];++M){const O=c[M],F=c[M+1];if(Pe(C,I,O,F))return 0;y=Math.min(y,xr(C,I,O,F,m))}}return y}function gi(a,s,c,d,m){if(!ks(s,a.length)||!ks(d,c.length))return NaN;let y=1/0;for(let b=s[0];b<=s[1];++b)for(let C=d[0];C<=d[1];++C)if(y=Math.min(y,m.distance(a[b],c[C])),0===y)return y;return y}function kc(a,s,c){if(Rt(a,s,!0))return 0;let d=1/0;for(const m of s){const y=m[0],b=m[m.length-1];if(y!==b&&(d=Math.min(d,Rs(a,[b,y],c)),0===d))return d;const C=c.pointOnLine(m,a);if(d=Math.min(d,c.distance(a,C.point)),0===d)return d}return d}function er(a,s,c,d){if(!ks(s,a.length))return NaN;for(let y=s[0];y<=s[1];++y)if(Rt(a[y],c,!0))return 0;let m=1/0;for(let y=s[0];y<s[1];++y){const b=a[y],C=a[y+1];for(const I of c)for(let M=0,O=I.length,F=O-1;M<O;F=M++){const j=I[F],q=I[M];if(Pe(b,C,j,q))return 0;m=Math.min(m,xr(b,C,j,q,d))}}return m}function tr(a,s){for(const c of a)for(const d of c)if(Rt(d,s,!0))return!0;return!1}function aa(a,s,c,d=1/0){const m=Qu(a),y=Qu(s);if(d!==1/0&&ed(m,y,c)>=d)return d;if(ot(m,y)){if(tr(a,s))return 0}else if(tr(s,a))return 0;let b=1/0;for(const C of a)for(let I=0,M=C.length,O=M-1;I<M;O=I++){const F=C[O],j=C[I];for(const q of s)for(let Y=0,ee=q.length,le=ee-1;Y<ee;le=Y++){const ye=q[le],Fe=q[Y];if(Pe(F,j,ye,Fe))return 0;b=Math.min(b,xr(F,j,ye,Fe,c))}}return b}function hu(a,s,c,d,m,y){if(!y)return;const b=ed(Mc(d,y),m,c);b<s&&a.push([b,y,[0,0]])}function Jo(a,s,c,d,m,y,b){if(!y||!b)return;const C=ed(Mc(d,y),Mc(m,b),c);C<s&&a.push([C,y,b])}function Rc(a,s,c,d,m=1/0){let y=Math.min(d.distance(a[0],c[0][0]),m);if(0===y)return y;const b=new Ec([[0,[0,a.length-1],[0,0]]],sa),C=Qu(c);for(;b.length>0;){const I=b.pop();if(I[0]>=y)continue;const M=I[1],O=s?50:100;if(Ac(M)<=O){if(!ks(M,a.length))return NaN;if(s){const F=er(a,M,c,d);if(isNaN(F)||0===F)return F;y=Math.min(y,F)}else for(let F=M[0];F<=M[1];++F){const j=kc(a[F],c,d);if(y=Math.min(y,j),0===y)return 0}}else{const F=Ju(M,s);hu(b,y,d,a,C,F[0]),hu(b,y,d,a,C,F[1])}}return y}function Ht(a,s,c,d,m,y=1/0){let b=Math.min(y,m.distance(a[0],c[0]));if(0===b)return b;const C=new Ec([[0,[0,a.length-1],[0,c.length-1]]],sa);for(;C.length>0;){const I=C.pop();if(I[0]>=b)continue;const M=I[1],O=I[2],F=s?50:100,j=d?50:100;if(Ac(M)<=F&&Ac(O)<=j){if(!ks(M,a.length)&&ks(O,c.length))return NaN;let q;if(s&&d)q=Pc(a,M,c,O,m),b=Math.min(b,q);else if(s&&!d){const Y=a.slice(M[0],M[1]+1);for(let ee=O[0];ee<=O[1];++ee)if(q=Rs(c[ee],Y,m),b=Math.min(b,q),0===b)return b}else if(!s&&d){const Y=c.slice(O[0],O[1]+1);for(let ee=M[0];ee<=M[1];++ee)if(q=Rs(a[ee],Y,m),b=Math.min(b,q),0===b)return b}else q=gi(a,M,c,O,m),b=Math.min(b,q)}else{const q=Ju(M,s),Y=Ju(O,d);Jo(C,b,m,a,c,q[0],Y[0]),Jo(C,b,m,a,c,q[0],Y[1]),Jo(C,b,m,a,c,q[1],Y[0]),Jo(C,b,m,a,c,q[1],Y[1])}}return b}function Gl(a){return"MultiPolygon"===a.type?a.coordinates.map(s=>({type:"Polygon",coordinates:s})):"MultiLineString"===a.type?a.coordinates.map(s=>({type:"LineString",coordinates:s})):"MultiPoint"===a.type?a.coordinates.map(s=>({type:"Point",coordinates:s})):[a]}class Ft{constructor(s,c){this.type=Bt,this.geojson=s,this.geometries=c}static parse(s,c){if(2!==s.length)return c.error(`'distance' expression requires exactly one argument, but found ${s.length-1} instead.`);if(Gi(s[1])){const d=s[1];if("FeatureCollection"===d.type)return new Ft(d,d.features.map(m=>Gl(m.geometry)).flat());if("Feature"===d.type)return new Ft(d,Gl(d.geometry));if("type"in d&&"coordinates"in d)return new Ft(d,Gl(d))}return c.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(null!=s.geometry()&&null!=s.canonicalID()){if("Point"===s.geometryType())return function(c,d){const m=c.geometry(),y=m.flat().map(I=>_e([I.x,I.y],c.canonical));if(0===m.length)return NaN;const b=new ql(y[0][1]);let C=1/0;for(const I of d){switch(I.type){case"Point":C=Math.min(C,Ht(y,!1,[I.coordinates],!1,b,C));break;case"LineString":C=Math.min(C,Ht(y,!1,I.coordinates,!0,b,C));break;case"Polygon":C=Math.min(C,Rc(y,!1,I.coordinates,b,C))}if(0===C)return C}return C}(s,this.geometries);if("LineString"===s.geometryType())return function(c,d){const m=c.geometry(),y=m.flat().map(I=>_e([I.x,I.y],c.canonical));if(0===m.length)return NaN;const b=new ql(y[0][1]);let C=1/0;for(const I of d){switch(I.type){case"Point":C=Math.min(C,Ht(y,!0,[I.coordinates],!1,b,C));break;case"LineString":C=Math.min(C,Ht(y,!0,I.coordinates,!0,b,C));break;case"Polygon":C=Math.min(C,Rc(y,!0,I.coordinates,b,C))}if(0===C)return C}return C}(s,this.geometries);if("Polygon"===s.geometryType())return function(c,d){const m=c.geometry();if(0===m.length||0===m[0].length)return NaN;const y=Xi(m,0).map(I=>I.map(M=>M.map(O=>_e([O.x,O.y],c.canonical)))),b=new ql(y[0][0][0][1]);let C=1/0;for(const I of d)for(const M of y){switch(I.type){case"Point":C=Math.min(C,Rc([I.coordinates],!1,M,b,C));break;case"LineString":C=Math.min(C,Rc(I.coordinates,!0,M,b,C));break;case"Polygon":C=Math.min(C,aa(M,I.coordinates,b,C))}if(0===C)return C}return C}(s,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const ds={"==":Dc,"!=":cl,">":Hs,"<":Vl,">=":Ku,"<=":jl,array:Vi,at:Bl,boolean:Vi,case:Yo,coalesce:$l,collator:Ul,format:ul,image:N,in:Ti,"index-of":Bo,interpolate:ai,"interpolate-hcl":ai,"interpolate-lab":ai,length:K,let:jn,literal:Hr,match:wr,number:Vi,"number-format":oa,object:Vi,slice:fr,step:Un,string:Vi,"to-boolean":ti,"to-color":ti,"to-number":ti,"to-string":ti,var:xa,within:Ln,distance:Ft};class ho{constructor(s,c,d,m){this.name=s,this.type=c,this._evaluate=d,this.args=m}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}static parse(s,c){const d=s[0],m=ho.definitions[d];if(!m)return c.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(m)?m[0]:m.type,b=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,C=b.filter(([M])=>!Array.isArray(M)||M.length===s.length-1);let I=null;for(const[M,O]of C){I=new Ko(c.registry,Qo,c.path,null,c.scope);const F=[];let j=!1;for(let q=1;q<s.length;q++){const Y=s[q],ee=Array.isArray(M)?M[q-1]:M.type,le=I.parse(Y,1+F.length,ee);if(!le){j=!0;break}F.push(le)}if(!j)if(Array.isArray(M)&&M.length!==F.length)I.error(`Expected ${M.length} arguments, but found ${F.length} instead.`);else{for(let q=0;q<F.length;q++){const Y=Array.isArray(M)?M[q]:M.type,ee=F[q];I.concat(q+1).checkSubtype(Y,ee.type)}if(0===I.errors.length)return new ho(d,y,O,F)}}if(1===C.length)c.errors.push(...I.errors);else{const M=(C.length?C:b).map(([F])=>{return j=F,Array.isArray(j)?`(${j.map(H).join(", ")})`:`(${H(j.type)}...)`;var j}).join(" | "),O=[];for(let F=1;F<s.length;F++){const j=c.parse(s[F],1+O.length);if(!j)return null;O.push(H(j.type))}c.error(`Expected arguments of type ${M}, but found (${O.join(", ")}) instead.`)}return null}static register(s,c){ho.definitions=c;for(const d in c)s[d]=ho}}function $a(a,[s,c,d,m]){s=s.evaluate(a),c=c.evaluate(a),d=d.evaluate(a);const y=m?m.evaluate(a):1,b=ii(s,c,d,y);if(b)throw new Rr(b);return new Ri(s/255,c/255,d/255,y,!1)}function Oc(a,s){return a in s}function hl(a,s){const c=s[a];return void 0===c?null:c}function Ca(a){return{type:a}}function Qo(a){if(a instanceof xa)return Qo(a.boundExpression);if(a instanceof ho&&"error"===a.name||a instanceof Ul||a instanceof Ln||a instanceof Ft)return!1;const s=a instanceof ti||a instanceof Vi;let c=!0;return a.eachChild(d=>{c=s?c&&Qo(d):c&&d instanceof Hr}),!!c&&Da(a)&&zo(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Da(a){if(a instanceof ho&&("get"===a.name&&1===a.args.length||"feature-state"===a.name||"has"===a.name&&1===a.args.length||"properties"===a.name||"geometry-type"===a.name||"id"===a.name||/^filter-/.test(a.name))||a instanceof Ln||a instanceof Ft)return!1;let s=!0;return a.eachChild(c=>{s&&!Da(c)&&(s=!1)}),s}function yo(a){if(a instanceof ho&&"feature-state"===a.name)return!1;let s=!0;return a.eachChild(c=>{s&&!yo(c)&&(s=!1)}),s}function zo(a,s){if(a instanceof ho&&s.indexOf(a.name)>=0)return!1;let c=!0;return a.eachChild(d=>{c&&!zo(d,s)&&(c=!1)}),c}function Ni(a){return{result:"success",value:a}}function qs(a){return{result:"error",value:a}}function es(a){return"data-driven"===a["property-type"]||"cross-faded-data-driven"===a["property-type"]}function Wl(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Zl(a){return!!a.expression&&a.expression.interpolated}function li(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function la(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function Fc(a){return a}function Xl(a,s){const c="color"===s.type,d=a.stops&&"object"==typeof a.stops[0][0],m=d||!(d||void 0!==a.property),y=a.type||(Zl(s)?"exponential":"interval");if(c||"padding"===s.type){const O=c?Ri.parse:kr.parse;(a=vi({},a)).stops&&(a.stops=a.stops.map(F=>[F[0],O(F[1])])),a.default=O(a.default?a.default:s.default)}if(a.colorSpace&&"rgb"!==(b=a.colorSpace)&&"hcl"!==b&&"lab"!==b)throw new Error(`Unknown color space: "${a.colorSpace}"`);var b;let C,I,M;if("exponential"===y)C=ca;else if("interval"===y)C=Kl;else if("categorical"===y){C=Lc,I=Object.create(null);for(const O of a.stops)I[O[0]]=O[1];M=typeof a.stops[0][0]}else{if("identity"!==y)throw new Error(`Unknown function type "${y}"`);C=Nc}if(d){const O={},F=[];for(let Y=0;Y<a.stops.length;Y++){const ee=a.stops[Y],le=ee[0].zoom;void 0===O[le]&&(O[le]={zoom:le,type:a.type,property:a.property,default:a.default,stops:[]},F.push(le)),O[le].stops.push([ee[0].value,ee[1]])}const j=[];for(const Y of F)j.push([O[Y].zoom,Xl(O[Y],s)]);const q={name:"linear"};return{kind:"composite",interpolationType:q,interpolationFactor:ai.interpolationFactor.bind(void 0,q),zoomStops:j.map(Y=>Y[0]),evaluate:({zoom:Y},ee)=>ca({stops:j,base:a.base},s,Y).evaluate(Y,ee)}}if(m){const O="exponential"===y?{name:"exponential",base:void 0!==a.base?a.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:ai.interpolationFactor.bind(void 0,O),zoomStops:a.stops.map(F=>F[0]),evaluate:({zoom:F})=>C(a,s,F,I,M)}}return{kind:"source",evaluate(O,F){const j=F&&F.properties?F.properties[a.property]:void 0;return void 0===j?Va(a.default,s.default):C(a,s,j,I,M)}}}function Va(a,s,c){return void 0!==a?a:void 0!==s?s:void 0!==c?c:void 0}function Lc(a,s,c,d,m){return Va(typeof c===m?d[c]:void 0,a.default,s.default)}function Kl(a,s,c){if("number"!==li(c))return Va(a.default,s.default);const d=a.stops.length;if(1===d||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[d-1][0])return a.stops[d-1][1];const m=Fi(a.stops.map(y=>y[0]),c);return a.stops[m][1]}function ca(a,s,c){const d=void 0!==a.base?a.base:1;if("number"!==li(c))return Va(a.default,s.default);const m=a.stops.length;if(1===m||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[m-1][0])return a.stops[m-1][1];const y=Fi(a.stops.map(O=>O[0]),c),b=function(O,F,j,q){const Y=q-j,ee=O-j;return 0===Y?0:1===F?ee/Y:(Math.pow(F,ee)-1)/(Math.pow(F,Y)-1)}(c,d,a.stops[y][0],a.stops[y+1][0]),C=a.stops[y][1],I=a.stops[y+1][1],M=On[s.type]||Fc;return"function"==typeof C.evaluate?{evaluate(...O){const F=C.evaluate.apply(void 0,O),j=I.evaluate.apply(void 0,O);if(void 0!==F&&void 0!==j)return M(F,j,b,a.colorSpace)}}:M(C,I,b,a.colorSpace)}function Nc(a,s,c){switch(s.type){case"color":c=Ri.parse(c);break;case"formatted":c=ir.fromString(c.toString());break;case"resolvedImage":c=St.fromString(c.toString());break;case"padding":c=kr.parse(c);break;default:li(c)===s.type||"enum"===s.type&&s.values[c]||(c=void 0)}return Va(c,a.default,s.default)}ho.register(ds,{error:[{kind:"error"},[Wn],(a,[s])=>{throw new Rr(s.evaluate(a))}],typeof:[Wn,[Nn],(a,[s])=>H(Di(s.evaluate(a)))],"to-rgba":[U(Bt,4),[Ur],(a,[s])=>{const[c,d,m,y]=s.evaluate(a).rgb;return[255*c,255*d,255*m,y]}],rgb:[Ur,[Bt,Bt,Bt],$a],rgba:[Ur,[Bt,Bt,Bt,Bt],$a],has:{type:In,overloads:[[[Wn],(a,[s])=>Oc(s.evaluate(a),a.properties())],[[Wn,uo],(a,[s,c])=>Oc(s.evaluate(a),c.evaluate(a))]]},get:{type:Nn,overloads:[[[Wn],(a,[s])=>hl(s.evaluate(a),a.properties())],[[Wn,uo],(a,[s,c])=>hl(s.evaluate(a),c.evaluate(a))]]},"feature-state":[Nn,[Wn],(a,[s])=>hl(s.evaluate(a),a.featureState||{})],properties:[uo,[],a=>a.properties()],"geometry-type":[Wn,[],a=>a.geometryType()],id:[Nn,[],a=>a.id()],zoom:[Bt,[],a=>a.globals.zoom],"heatmap-density":[Bt,[],a=>a.globals.heatmapDensity||0],"line-progress":[Bt,[],a=>a.globals.lineProgress||0],accumulated:[Nn,[],a=>void 0===a.globals.accumulated?null:a.globals.accumulated],"+":[Bt,Ca(Bt),(a,s)=>{let c=0;for(const d of s)c+=d.evaluate(a);return c}],"*":[Bt,Ca(Bt),(a,s)=>{let c=1;for(const d of s)c*=d.evaluate(a);return c}],"-":{type:Bt,overloads:[[[Bt,Bt],(a,[s,c])=>s.evaluate(a)-c.evaluate(a)],[[Bt],(a,[s])=>-s.evaluate(a)]]},"/":[Bt,[Bt,Bt],(a,[s,c])=>s.evaluate(a)/c.evaluate(a)],"%":[Bt,[Bt,Bt],(a,[s,c])=>s.evaluate(a)%c.evaluate(a)],ln2:[Bt,[],()=>Math.LN2],pi:[Bt,[],()=>Math.PI],e:[Bt,[],()=>Math.E],"^":[Bt,[Bt,Bt],(a,[s,c])=>Math.pow(s.evaluate(a),c.evaluate(a))],sqrt:[Bt,[Bt],(a,[s])=>Math.sqrt(s.evaluate(a))],log10:[Bt,[Bt],(a,[s])=>Math.log(s.evaluate(a))/Math.LN10],ln:[Bt,[Bt],(a,[s])=>Math.log(s.evaluate(a))],log2:[Bt,[Bt],(a,[s])=>Math.log(s.evaluate(a))/Math.LN2],sin:[Bt,[Bt],(a,[s])=>Math.sin(s.evaluate(a))],cos:[Bt,[Bt],(a,[s])=>Math.cos(s.evaluate(a))],tan:[Bt,[Bt],(a,[s])=>Math.tan(s.evaluate(a))],asin:[Bt,[Bt],(a,[s])=>Math.asin(s.evaluate(a))],acos:[Bt,[Bt],(a,[s])=>Math.acos(s.evaluate(a))],atan:[Bt,[Bt],(a,[s])=>Math.atan(s.evaluate(a))],min:[Bt,Ca(Bt),(a,s)=>Math.min(...s.map(c=>c.evaluate(a)))],max:[Bt,Ca(Bt),(a,s)=>Math.max(...s.map(c=>c.evaluate(a)))],abs:[Bt,[Bt],(a,[s])=>Math.abs(s.evaluate(a))],round:[Bt,[Bt],(a,[s])=>{const c=s.evaluate(a);return c<0?-Math.round(-c):Math.round(c)}],floor:[Bt,[Bt],(a,[s])=>Math.floor(s.evaluate(a))],ceil:[Bt,[Bt],(a,[s])=>Math.ceil(s.evaluate(a))],"filter-==":[In,[Wn,Nn],(a,[s,c])=>a.properties()[s.value]===c.value],"filter-id-==":[In,[Nn],(a,[s])=>a.id()===s.value],"filter-type-==":[In,[Wn],(a,[s])=>a.geometryType()===s.value],"filter-<":[In,[Wn,Nn],(a,[s,c])=>{const d=a.properties()[s.value],m=c.value;return typeof d==typeof m&&d<m}],"filter-id-<":[In,[Nn],(a,[s])=>{const c=a.id(),d=s.value;return typeof c==typeof d&&c<d}],"filter->":[In,[Wn,Nn],(a,[s,c])=>{const d=a.properties()[s.value],m=c.value;return typeof d==typeof m&&d>m}],"filter-id->":[In,[Nn],(a,[s])=>{const c=a.id(),d=s.value;return typeof c==typeof d&&c>d}],"filter-<=":[In,[Wn,Nn],(a,[s,c])=>{const d=a.properties()[s.value],m=c.value;return typeof d==typeof m&&d<=m}],"filter-id-<=":[In,[Nn],(a,[s])=>{const c=a.id(),d=s.value;return typeof c==typeof d&&c<=d}],"filter->=":[In,[Wn,Nn],(a,[s,c])=>{const d=a.properties()[s.value],m=c.value;return typeof d==typeof m&&d>=m}],"filter-id->=":[In,[Nn],(a,[s])=>{const c=a.id(),d=s.value;return typeof c==typeof d&&c>=d}],"filter-has":[In,[Nn],(a,[s])=>s.value in a.properties()],"filter-has-id":[In,[],a=>null!==a.id()&&void 0!==a.id()],"filter-type-in":[In,[U(Wn)],(a,[s])=>s.value.indexOf(a.geometryType())>=0],"filter-id-in":[In,[U(Nn)],(a,[s])=>s.value.indexOf(a.id())>=0],"filter-in-small":[In,[Wn,U(Nn)],(a,[s,c])=>c.value.indexOf(a.properties()[s.value])>=0],"filter-in-large":[In,[Wn,U(Nn)],(a,[s,c])=>function(d,m,y,b){for(;y<=b;){const C=y+b>>1;if(m[C]===d)return!0;m[C]>d?b=C-1:y=C+1}return!1}(a.properties()[s.value],c.value,0,c.value.length-1)],all:{type:In,overloads:[[[In,In],(a,[s,c])=>s.evaluate(a)&&c.evaluate(a)],[Ca(In),(a,s)=>{for(const c of s)if(!c.evaluate(a))return!1;return!0}]]},any:{type:In,overloads:[[[In,In],(a,[s,c])=>s.evaluate(a)||c.evaluate(a)],[Ca(In),(a,s)=>{for(const c of s)if(c.evaluate(a))return!0;return!1}]]},"!":[In,[In],(a,[s])=>!s.evaluate(a)],"is-supported-script":[In,[Wn],(a,[s])=>{const c=a.globals&&a.globals.isSupportedScript;return!c||c(s.evaluate(a))}],upcase:[Wn,[Wn],(a,[s])=>s.evaluate(a).toUpperCase()],downcase:[Wn,[Wn],(a,[s])=>s.evaluate(a).toLowerCase()],concat:[Wn,Ca(Nn),(a,s)=>s.map(c=>br(c.evaluate(a))).join("")],"resolved-locale":[Wn,[mo],(a,[s])=>s.evaluate(a).resolvedLocale()]});class fl{constructor(s,c){var d;this.expression=s,this._warningHistory={},this._evaluator=new wa,this._defaultValue=c?"color"===(d=c).type&&la(d.default)?new Ri(0,0,0,0):"color"===d.type?Ri.parse(d.default)||null:"padding"===d.type?kr.parse(d.default)||null:"variableAnchorOffsetCollection"===d.type?He.parse(d.default)||null:void 0===d.default?null:d.default:null,this._enumValues=c&&"enum"===c.type?c.values:null}evaluateWithoutErrorHandling(s,c,d,m,y,b){return this._evaluator.globals=s,this._evaluator.feature=c,this._evaluator.featureState=d,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)}evaluate(s,c,d,m,y,b){this._evaluator.globals=s,this._evaluator.feature=c||null,this._evaluator.featureState=d||null,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b||null;try{const C=this.expression.evaluate(this._evaluator);if(null==C||"number"==typeof C&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new Rr(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function pl(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in ds}function ml(a,s){const c=new Ko(ds,Qo,[],s?function(m){const y={color:Ur,string:Wn,number:Bt,enum:Wn,boolean:In,formatted:go,padding:Zr,resolvedImage:io,variableAnchorOffsetCollection:ue};return"array"===m.type?U(y[m.value]||Nn,m.length):y[m.type]}(s):void 0),d=c.parse(a,void 0,void 0,void 0,s&&"string"===s.type?{typeAnnotation:"coerce"}:void 0);return d?Ni(new fl(d,s)):qs(c.errors)}class ja{constructor(s,c){this.kind=s,this._styleExpression=c,this.isStateDependent="constant"!==s&&!yo(c.expression)}evaluateWithoutErrorHandling(s,c,d,m,y,b){return this._styleExpression.evaluateWithoutErrorHandling(s,c,d,m,y,b)}evaluate(s,c,d,m,y,b){return this._styleExpression.evaluate(s,c,d,m,y,b)}}class Yl{constructor(s,c,d,m){this.kind=s,this.zoomStops=d,this._styleExpression=c,this.isStateDependent="camera"!==s&&!yo(c.expression),this.interpolationType=m}evaluateWithoutErrorHandling(s,c,d,m,y,b){return this._styleExpression.evaluateWithoutErrorHandling(s,c,d,m,y,b)}evaluate(s,c,d,m,y,b){return this._styleExpression.evaluate(s,c,d,m,y,b)}interpolationFactor(s,c,d){return this.interpolationType?ai.interpolationFactor(this.interpolationType,s,c,d):0}}function hs(a,s){const c=ml(a,s);if("error"===c.result)return c;const d=c.value.expression,m=Da(d);if(!m&&!es(s))return qs([new hi("","data expressions not supported")]);const y=zo(d,["zoom"]);if(!y&&!Wl(s))return qs([new hi("","zoom expressions not supported")]);const b=Jl(d);return b||y?b instanceof hi?qs([b]):b instanceof ai&&!Zl(s)?qs([new hi("",'"interpolate" expressions cannot be used with this property')]):Ni(b?new Yl(m?"camera":"composite",c.value,b.labels,b instanceof ai?b.interpolation:void 0):new ja(m?"constant":"source",c.value)):qs([new hi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Bc{constructor(s,c){this._parameters=s,this._specification=c,vi(this,Xl(this._parameters,this._specification))}static deserialize(s){return new Bc(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Jl(a){let s=null;if(a instanceof jn)s=Jl(a.result);else if(a instanceof $l){for(const c of a.args)if(s=Jl(c),s)break}else(a instanceof Un||a instanceof ai)&&a.input instanceof ho&&"zoom"===a.input.name&&(s=a);return s instanceof hi||a.eachChild(c=>{const d=Jl(c);d instanceof hi?s=d:!s&&d?s=new hi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&d&&s!==d&&(s=new hi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}function fu(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":return a.length>=3&&("string"!=typeof a[1]||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const s of a.slice(1))if(!fu(s)&&"boolean"!=typeof s)return!1;return!0;default:return!0}}const Ua={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function gl(a){if(null==a)return{filter:()=>!0,needGeometry:!1};fu(a)||(a=Ql(a));const s=ml(a,Ua);if("error"===s.result)throw new Error(s.value.map(c=>`${c.key}: ${c.message}`).join(", "));return{filter:(c,d,m)=>s.value.evaluate(c,d,{},m),needGeometry:Ha(a)}}function ts(a,s){return a<s?-1:a>s?1:0}function Ha(a){if(!Array.isArray(a))return!1;if("within"===a[0]||"distance"===a[0])return!0;for(let s=1;s<a.length;s++)if(Ha(a[s]))return!0;return!1}function Ql(a){if(!a)return!0;const s=a[0];return a.length<=1?"any"!==s:"=="===s?zc(a[1],a[2],"=="):"!="===s?ec(zc(a[1],a[2],"==")):"<"===s||">"===s||"<="===s||">="===s?zc(a[1],a[2],s):"any"===s?(c=a.slice(1),["any"].concat(c.map(Ql))):"all"===s?["all"].concat(a.slice(1).map(Ql)):"none"===s?["all"].concat(a.slice(1).map(Ql).map(ec)):"in"===s?td(a[1],a.slice(2)):"!in"===s?ec(td(a[1],a.slice(2))):"has"===s?Pt(a[1]):"!has"!==s||ec(Pt(a[1]));var c}function zc(a,s,c){switch(a){case"$type":return[`filter-type-${c}`,s];case"$id":return[`filter-id-${c}`,s];default:return[`filter-${c}`,a,s]}}function td(a,s){if(0===s.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(c=>typeof c!=typeof s[0])?["filter-in-large",a,["literal",s.sort(ts)]]:["filter-in-small",a,["literal",s]]}}function Pt(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function ec(a){return["!",a]}function tc(a){const s=typeof a;if("number"===s||"boolean"===s||"string"===s||null==a)return JSON.stringify(a);if(Array.isArray(a)){let m="[";for(const y of a)m+=`${tc(y)},`;return`${m}]`}const c=Object.keys(a).sort();let d="{";for(let m=0;m<c.length;m++)d+=`${JSON.stringify(c[m])}:${tc(a[c[m]])},`;return`${d}}`}function nd(a){let s="";for(const c of Oi)s+=`/${tc(a[c])}`;return s}function ro(a){const s=a.value;return s?[new it(a.key,s,"constants have been deprecated as of v8")]:[]}function $r(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function fs(a){if(Array.isArray(a))return a.map(fs);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const s={};for(const c in a)s[c]=fs(a[c]);return s}return $r(a)}function yn(a){const s=a.key,c=a.value,d=a.valueSpec||{},m=a.objectElementValidators||{},y=a.style,b=a.styleSpec,C=a.validateSpec;let I=[];const M=li(c);if("object"!==M)return[new it(s,c,`object expected, ${M} found`)];for(const O in c){const F=O.split(".")[0],j=d[F]||d["*"];let q;if(m[F])q=m[F];else if(d[F])q=C;else if(m["*"])q=m["*"];else{if(!d["*"]){I.push(new it(s,c[O],`unknown property "${O}"`));continue}q=C}I=I.concat(q({key:(s&&`${s}.`)+O,value:c[O],valueSpec:j,style:y,styleSpec:b,object:c,objectKey:O,validateSpec:C},c))}for(const O in d)m[O]||d[O].required&&void 0===d[O].default&&void 0===c[O]&&I.push(new it(s,c,`missing required property "${O}"`));return I}function oo(a){const s=a.value,c=a.valueSpec,d=a.style,m=a.styleSpec,y=a.key,b=a.arrayElementValidator||a.validateSpec;if("array"!==li(s))return[new it(y,s,`array expected, ${li(s)} found`)];if(c.length&&s.length!==c.length)return[new it(y,s,`array length ${c.length} expected, length ${s.length} found`)];if(c["min-length"]&&s.length<c["min-length"])return[new it(y,s,`array length at least ${c["min-length"]} expected, length ${s.length} found`)];let C={type:c.value,values:c.values};m.$version<7&&(C.function=c.function),"object"===li(c.value)&&(C=c.value);let I=[];for(let M=0;M<s.length;M++)I=I.concat(b({array:s,arrayIndex:M,value:s[M],valueSpec:C,validateSpec:a.validateSpec,style:d,styleSpec:m,key:`${y}[${M}]`}));return I}function wi(a){const s=a.key,c=a.value,d=a.valueSpec;let m=li(c);return"number"===m&&c!=c&&(m="NaN"),"number"!==m?[new it(s,c,`number expected, ${m} found`)]:"minimum"in d&&c<d.minimum?[new it(s,c,`${c} is less than the minimum value ${d.minimum}`)]:"maximum"in d&&c>d.maximum?[new it(s,c,`${c} is greater than the maximum value ${d.maximum}`)]:[]}function Xr(a){const s=a.valueSpec,c=$r(a.value.type);let d,m,y,b={};const C="categorical"!==c&&void 0===a.value.property,I=!C,M="array"===li(a.value.stops)&&"array"===li(a.value.stops[0])&&"object"===li(a.value.stops[0][0]),O=yn({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(q){if("identity"===c)return[new it(q.key,q.value,'identity function may not have a "stops" property')];let Y=[];const ee=q.value;return Y=Y.concat(oo({key:q.key,value:ee,valueSpec:q.valueSpec,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:F})),"array"===li(ee)&&0===ee.length&&Y.push(new it(q.key,ee,"array must have at least one stop")),Y},default:function(q){return q.validateSpec({key:q.key,value:q.value,valueSpec:s,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec})}}});return"identity"===c&&C&&O.push(new it(a.key,a.value,'missing required property "property"')),"identity"===c||a.value.stops||O.push(new it(a.key,a.value,'missing required property "stops"')),"exponential"===c&&a.valueSpec.expression&&!Zl(a.valueSpec)&&O.push(new it(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(I&&!es(a.valueSpec)?O.push(new it(a.key,a.value,"property functions not supported")):C&&!Wl(a.valueSpec)&&O.push(new it(a.key,a.value,"zoom functions not supported"))),"categorical"!==c&&!M||void 0!==a.value.property||O.push(new it(a.key,a.value,'"property" property is required')),O;function F(q){let Y=[];const ee=q.value,le=q.key;if("array"!==li(ee))return[new it(le,ee,`array expected, ${li(ee)} found`)];if(2!==ee.length)return[new it(le,ee,`array length 2 expected, length ${ee.length} found`)];if(M){if("object"!==li(ee[0]))return[new it(le,ee,`object expected, ${li(ee[0])} found`)];if(void 0===ee[0].zoom)return[new it(le,ee,"object stop key must have zoom")];if(void 0===ee[0].value)return[new it(le,ee,"object stop key must have value")];if(y&&y>$r(ee[0].zoom))return[new it(le,ee[0].zoom,"stop zoom values must appear in ascending order")];$r(ee[0].zoom)!==y&&(y=$r(ee[0].zoom),m=void 0,b={}),Y=Y.concat(yn({key:`${le}[0]`,value:ee[0],valueSpec:{zoom:{}},validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:wi,value:j}}))}else Y=Y.concat(j({key:`${le}[0]`,value:ee[0],valueSpec:{},validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec},ee));return pl(fs(ee[1]))?Y.concat([new it(`${le}[1]`,ee[1],"expressions are not allowed in function stops.")]):Y.concat(q.validateSpec({key:`${le}[1]`,value:ee[1],valueSpec:s,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec}))}function j(q,Y){const ee=li(q.value),le=$r(q.value),ye=null!==q.value?q.value:Y;if(d){if(ee!==d)return[new it(q.key,ye,`${ee} stop domain type must match previous stop domain type ${d}`)]}else d=ee;if("number"!==ee&&"string"!==ee&&"boolean"!==ee)return[new it(q.key,ye,"stop domain value must be a number, string, or boolean")];if("number"!==ee&&"categorical"!==c){let Fe=`number expected, ${ee} found`;return es(s)&&void 0===c&&(Fe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new it(q.key,ye,Fe)]}return"categorical"!==c||"number"!==ee||isFinite(le)&&Math.floor(le)===le?"categorical"!==c&&"number"===ee&&void 0!==m&&le<m?[new it(q.key,ye,"stop domain values must appear in ascending order")]:(m=le,"categorical"===c&&le in b?[new it(q.key,ye,"stop domain values must be unique")]:(b[le]=!0,[])):[new it(q.key,ye,`integer expected, found ${le}`)]}}function qr(a){const s=("property"===a.expressionContext?hs:ml)(fs(a.value),a.valueSpec);if("error"===s.result)return s.value.map(d=>new it(`${a.key}${d.key}`,a.value,d.message));const c=s.value.expression||s.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&!c.outputDefined())return[new it(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===a.expressionContext&&"layout"===a.propertyType&&!yo(c))return[new it(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext&&!yo(c))return[new it(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!zo(c,["zoom","feature-state"]))return[new it(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!Da(c))return[new it(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Os(a){const s=a.key,c=a.value,d=a.valueSpec,m=[];return Array.isArray(d.values)?-1===d.values.indexOf($r(c))&&m.push(new it(s,c,`expected one of [${d.values.join(", ")}], ${JSON.stringify(c)} found`)):-1===Object.keys(d.values).indexOf($r(c))&&m.push(new it(s,c,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(c)} found`)),m}function ko(a){return fu(fs(a.value))?qr(vi({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):yl(a)}function yl(a){const s=a.value,c=a.key;if("array"!==li(s))return[new it(c,s,`array expected, ${li(s)} found`)];const d=a.styleSpec;let m,y=[];if(s.length<1)return[new it(c,s,"filter array must have at least 1 element")];switch(y=y.concat(Os({key:`${c}[0]`,value:s[0],valueSpec:d.filter_operator,style:a.style,styleSpec:a.styleSpec})),$r(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&"$type"===$r(s[1])&&y.push(new it(c,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":3!==s.length&&y.push(new it(c,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(m=li(s[1]),"string"!==m&&y.push(new it(`${c}[1]`,s[1],`string expected, ${m} found`)));for(let b=2;b<s.length;b++)m=li(s[b]),"$type"===$r(s[1])?y=y.concat(Os({key:`${c}[${b}]`,value:s[b],valueSpec:d.geometry_type,style:a.style,styleSpec:a.styleSpec})):"string"!==m&&"number"!==m&&"boolean"!==m&&y.push(new it(`${c}[${b}]`,s[b],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let b=1;b<s.length;b++)y=y.concat(yl({key:`${c}[${b}]`,value:s[b],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":m=li(s[1]),2!==s.length?y.push(new it(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):"string"!==m&&y.push(new it(`${c}[1]`,s[1],`string expected, ${m} found`))}return y}function vl(a,s){const c=a.key,d=a.validateSpec,m=a.style,y=a.styleSpec,b=a.value,C=a.objectKey,I=y[`${s}_${a.layerType}`];if(!I)return[];const M=C.match(/^(.*)-transition$/);if("paint"===s&&M&&I[M[1]]&&I[M[1]].transition)return d({key:c,value:b,valueSpec:y.transition,style:m,styleSpec:y});const O=a.valueSpec||I[C];if(!O)return[new it(c,b,`unknown property "${C}"`)];let F;if("string"===li(b)&&es(O)&&!O.tokens&&(F=/^{([^}]+)}$/.exec(b)))return[new it(c,b,`"${C}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(F[1])} }\`.`)];const j=[];return"symbol"===a.layerType&&("text-field"===C&&m&&!m.glyphs&&j.push(new it(c,b,'use of "text-field" requires a style "glyphs" property')),"text-font"===C&&la(fs(b))&&"identity"===$r(b.type)&&j.push(new it(c,b,'"text-font" does not support identity functions'))),j.concat(d({key:a.key,value:b,valueSpec:O,style:m,styleSpec:y,expressionContext:"property",propertyType:s,propertyKey:C}))}function _l(a){return vl(a,"paint")}function pu(a){return vl(a,"layout")}function mu(a){let s=[];const c=a.value,d=a.key,m=a.style,y=a.styleSpec;c.type||c.ref||s.push(new it(d,c,'either "type" or "ref" is required'));let b=$r(c.type);const C=$r(c.ref);if(c.id){const I=$r(c.id);for(let M=0;M<a.arrayIndex;M++){const O=m.layers[M];$r(O.id)===I&&s.push(new it(d,c.id,`duplicate layer id "${c.id}", previously used at line ${O.id.__line__}`))}}if("ref"in c){let I;["type","source","source-layer","filter","layout"].forEach(M=>{M in c&&s.push(new it(d,c[M],`"${M}" is prohibited for ref layers`))}),m.layers.forEach(M=>{$r(M.id)===C&&(I=M)}),I?I.ref?s.push(new it(d,c.ref,"ref cannot reference another ref layer")):b=$r(I.type):s.push(new it(d,c.ref,`ref layer "${C}" not found`))}else if("background"!==b)if(c.source){const I=m.sources&&m.sources[c.source],M=I&&$r(I.type);I?"vector"===M&&"raster"===b?s.push(new it(d,c.source,`layer "${c.id}" requires a raster source`)):"raster-dem"!==M&&"hillshade"===b?s.push(new it(d,c.source,`layer "${c.id}" requires a raster-dem source`)):"raster"===M&&"raster"!==b?s.push(new it(d,c.source,`layer "${c.id}" requires a vector source`)):"vector"!==M||c["source-layer"]?"raster-dem"===M&&"hillshade"!==b?s.push(new it(d,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==b||!c.paint||!c.paint["line-gradient"]||"geojson"===M&&I.lineMetrics||s.push(new it(d,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new it(d,c,`layer "${c.id}" must specify a "source-layer"`)):s.push(new it(d,c.source,`source "${c.source}" not found`))}else s.push(new it(d,c,'missing required property "source"'));return s=s.concat(yn({key:d,value:c,valueSpec:y.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${d}.type`,value:c.type,valueSpec:y.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:c,objectKey:"type"}),filter:ko,layout:I=>yn({layer:c,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":M=>pu(vi({layerType:b},M))}}),paint:I=>yn({layer:c,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":M=>_l(vi({layerType:b},M))}})}})),s}function Ki(a){const s=a.value,c=a.key,d=li(s);return"string"!==d?[new it(c,s,`string expected, ${d} found`)]:[]}const gn={promoteId:function({key:a,value:s}){if("string"===li(s))return Ki({key:a,value:s});{const c=[];for(const d in s)c.push(...Ki({key:`${a}.${d}`,value:s[d]}));return c}}};function ci(a){const s=a.value,c=a.key,d=a.styleSpec,m=a.style,y=a.validateSpec;if(!s.type)return[new it(c,s,'"type" is required')];const b=$r(s.type);let C;switch(b){case"vector":case"raster":return C=yn({key:c,value:s,valueSpec:d[`source_${b.replace("-","_")}`],style:a.style,styleSpec:d,objectElementValidators:gn,validateSpec:y}),C;case"raster-dem":return C=function(I){var M;const O=null!==(M=I.sourceName)&&void 0!==M?M:"",F=I.value,j=I.styleSpec,q=j.source_raster_dem,Y=I.style;let ee=[];const le=li(F);if(void 0===F)return ee;if("object"!==le)return ee.push(new it("source_raster_dem",F,`object expected, ${le} found`)),ee;const ye="custom"===$r(F.encoding),Fe=["redFactor","greenFactor","blueFactor","baseShift"],Ie=I.value.encoding?`"${I.value.encoding}"`:"Default";for(const Re in F)!ye&&Fe.includes(Re)?ee.push(new it(Re,F[Re],`In "${O}": "${Re}" is only valid when "encoding" is set to "custom". ${Ie} encoding found`)):q[Re]?ee=ee.concat(I.validateSpec({key:Re,value:F[Re],valueSpec:q[Re],validateSpec:I.validateSpec,style:Y,styleSpec:j})):ee.push(new it(Re,F[Re],`unknown property "${Re}"`));return ee}({sourceName:c,value:s,style:a.style,styleSpec:d,validateSpec:y}),C;case"geojson":if(C=yn({key:c,value:s,valueSpec:d.source_geojson,style:m,styleSpec:d,validateSpec:y,objectElementValidators:gn}),s.cluster)for(const I in s.clusterProperties){const[M,O]=s.clusterProperties[I],F="string"==typeof M?[M,["accumulated"],["get",I]]:M;C.push(...qr({key:`${c}.${I}.map`,value:O,validateSpec:y,expressionContext:"cluster-map"})),C.push(...qr({key:`${c}.${I}.reduce`,value:F,validateSpec:y,expressionContext:"cluster-reduce"}))}return C;case"video":return yn({key:c,value:s,valueSpec:d.source_video,style:m,validateSpec:y,styleSpec:d});case"image":return yn({key:c,value:s,valueSpec:d.source_image,style:m,validateSpec:y,styleSpec:d});case"canvas":return[new it(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Os({key:`${c}.type`,value:s.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:m,validateSpec:y,styleSpec:d})}}function Cr(a){const s=a.value,c=a.styleSpec,d=c.light,m=a.style;let y=[];const b=li(s);if(void 0===s)return y;if("object"!==b)return y=y.concat([new it("light",s,`object expected, ${b} found`)]),y;for(const C in s){const I=C.match(/^(.*)-transition$/);y=y.concat(I&&d[I[1]]&&d[I[1]].transition?a.validateSpec({key:C,value:s[C],valueSpec:c.transition,validateSpec:a.validateSpec,style:m,styleSpec:c}):d[C]?a.validateSpec({key:C,value:s[C],valueSpec:d[C],validateSpec:a.validateSpec,style:m,styleSpec:c}):[new it(C,s[C],`unknown property "${C}"`)])}return y}function ns(a){const s=a.value,c=a.styleSpec,d=c.sky,m=a.style,y=li(s);if(void 0===s)return[];if("object"!==y)return[new it("sky",s,`object expected, ${y} found`)];let b=[];for(const C in s)b=b.concat(d[C]?a.validateSpec({key:C,value:s[C],valueSpec:d[C],style:m,styleSpec:c}):[new it(C,s[C],`unknown property "${C}"`)]);return b}function ps(a){const s=a.value,c=a.styleSpec,d=c.terrain,m=a.style;let y=[];const b=li(s);if(void 0===s)return y;if("object"!==b)return y=y.concat([new it("terrain",s,`object expected, ${b} found`)]),y;for(const C in s)y=y.concat(d[C]?a.validateSpec({key:C,value:s[C],valueSpec:d[C],validateSpec:a.validateSpec,style:m,styleSpec:c}):[new it(C,s[C],`unknown property "${C}"`)]);return y}function so(a){let s=[];const c=a.value,d=a.key;if(Array.isArray(c)){const m=[],y=[];for(const b in c)c[b].id&&m.includes(c[b].id)&&s.push(new it(d,c,`all the sprites' ids must be unique, but ${c[b].id} is duplicated`)),m.push(c[b].id),c[b].url&&y.includes(c[b].url)&&s.push(new it(d,c,`all the sprites' URLs must be unique, but ${c[b].url} is duplicated`)),y.push(c[b].url),s=s.concat(yn({key:`${d}[${b}]`,value:c[b],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return s}return Ki({key:d,value:c})}const Ea={"*":()=>[],array:oo,boolean:function(a){const s=a.value,c=a.key,d=li(s);return"boolean"!==d?[new it(c,s,`boolean expected, ${d} found`)]:[]},number:wi,color:function(a){const s=a.key,c=a.value,d=li(c);return"string"!==d?[new it(s,c,`color expected, ${d} found`)]:Ri.parse(String(c))?[]:[new it(s,c,`color expected, "${c}" found`)]},constants:ro,enum:Os,filter:ko,function:Xr,layer:mu,object:yn,source:ci,light:Cr,sky:ns,terrain:ps,projection:function(a){const s=a.value,c=a.styleSpec,d=c.projection,m=a.style,y=li(s);if(void 0===s)return[];if("object"!==y)return[new it("projection",s,`object expected, ${y} found`)];let b=[];for(const C in s)b=b.concat(d[C]?a.validateSpec({key:C,value:s[C],valueSpec:d[C],style:m,styleSpec:c}):[new it(C,s[C],`unknown property "${C}"`)]);return b},string:Ki,formatted:function(a){return 0===Ki(a).length?[]:qr(a)},resolvedImage:function(a){return 0===Ki(a).length?[]:qr(a)},padding:function(a){const s=a.key,c=a.value;if("array"===li(c)){if(c.length<1||c.length>4)return[new it(s,c,`padding requires 1 to 4 values; ${c.length} values found`)];const d={type:"number"};let m=[];for(let y=0;y<c.length;y++)m=m.concat(a.validateSpec({key:`${s}[${y}]`,value:c[y],validateSpec:a.validateSpec,valueSpec:d}));return m}return wi({key:s,value:c,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const s=a.key,c=a.value,d=li(c),m=a.styleSpec;if("array"!==d||c.length<1||c.length%2!=0)return[new it(s,c,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let b=0;b<c.length;b+=2)y=y.concat(Os({key:`${s}[${b}]`,value:c[b],valueSpec:m.layout_symbol["text-anchor"]})),y=y.concat(oo({key:`${s}[${b+1}]`,value:c[b+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:m}));return y},sprite:so};function rr(a){const s=a.value,c=a.valueSpec,d=a.styleSpec;return a.validateSpec=rr,c.expression&&la($r(s))?Xr(a):c.expression&&pl(fs(s))?qr(a):c.type&&Ea[c.type]?Ea[c.type](a):yn(vi({},a,{valueSpec:c.type?d[c.type]:c}))}function ua(a){const s=a.value,c=a.key,d=Ki(a);return d.length||(-1===s.indexOf("{fontstack}")&&d.push(new it(c,s,'"glyphs" url must include a "{fontstack}" token')),-1===s.indexOf("{range}")&&d.push(new it(c,s,'"glyphs" url must include a "{range}" token'))),d}function So(a,s=ve){let c=[];return c=c.concat(rr({key:"",value:a,valueSpec:s.$root,styleSpec:s,style:a,validateSpec:rr,objectElementValidators:{glyphs:ua,"*":()=>[]}})),a.constants&&(c=c.concat(ro({key:"constants",value:a.constants,style:a,styleSpec:s,validateSpec:rr}))),Ia(c)}function Hn(a){return function(s){return a({...s,validateSpec:rr})}}function Ia(a){return[].concat(a).sort((s,c)=>s.line-c.line)}function ms(a){return function(...s){return Ia(a.apply(this,s))}}So.source=ms(Hn(ci)),So.sprite=ms(Hn(so)),So.glyphs=ms(Hn(ua)),So.light=ms(Hn(Cr)),So.sky=ms(Hn(ns)),So.terrain=ms(Hn(ps)),So.layer=ms(Hn(mu)),So.filter=ms(Hn(ko)),So.paintProperty=ms(Hn(_l)),So.layoutProperty=ms(Hn(pu));const gs=So,Tr=gs.light,$o=gs.sky,Fs=gs.paintProperty,Zi=gs.layoutProperty;function bl(a,s){let c=!1;if(s&&s.length)for(const d of s)a.fire(new ri(new Error(d.message))),c=!0;return c}class qa{constructor(s,c,d){const m=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;const b=new Int32Array(this.arrayBuffer);s=b[0],this.d=(c=b[1])+2*(d=b[2]);for(let I=0;I<this.d*this.d;I++){const M=b[3+I],O=b[3+I+1];m.push(M===O?null:b.subarray(M,O))}const C=b[3+m.length+1];this.keys=b.subarray(b[3+m.length],C),this.bboxes=b.subarray(C),this.insert=this._insertReadonly}else{this.d=c+2*d;for(let b=0;b<this.d*this.d;b++)m.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=s,this.padding=d,this.scale=c/s,this.uid=0;const y=d/c*s;this.min=-y,this.max=s+y}insert(s,c,d,m,y){this._forEachCell(c,d,m,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(s),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(m),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(s,c,d,m,y,b){this.cells[y].push(b)}query(s,c,d,m,y){const b=this.min,C=this.max;if(s<=b&&c<=b&&C<=d&&C<=m&&!y)return Array.prototype.slice.call(this.keys);{const I=[];return this._forEachCell(s,c,d,m,this._queryCell,I,{},y),I}}_queryCell(s,c,d,m,y,b,C,I){const M=this.cells[y];if(null!==M){const O=this.keys,F=this.bboxes;for(let j=0;j<M.length;j++){const q=M[j];if(void 0===C[q]){const Y=4*q;(I?I(F[Y+0],F[Y+1],F[Y+2],F[Y+3]):s<=F[Y+2]&&c<=F[Y+3]&&d>=F[Y+0]&&m>=F[Y+1])?(C[q]=!0,b.push(O[q])):C[q]=!1}}}}_forEachCell(s,c,d,m,y,b,C,I){const M=this._convertToCellCoord(s),O=this._convertToCellCoord(c),F=this._convertToCellCoord(d),j=this._convertToCellCoord(m);for(let q=M;q<=F;q++)for(let Y=O;Y<=j;Y++){const ee=this.d*Y+q;if((!I||I(this._convertFromCellCoord(q),this._convertFromCellCoord(Y),this._convertFromCellCoord(q+1),this._convertFromCellCoord(Y+1)))&&y.call(this,s,c,d,m,ee,b,C,I))return}}_convertFromCellCoord(s){return(s-this.padding)/this.scale}_convertToCellCoord(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const s=this.cells,c=3+this.cells.length+1+1;let d=0;for(let b=0;b<this.cells.length;b++)d+=this.cells[b].length;const m=new Int32Array(c+d+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let y=c;for(let b=0;b<s.length;b++){const C=s[b];m[3+b]=y,m.set(C,y),y+=C.length}return m[3+s.length]=y,m.set(this.keys,y),y+=this.keys.length,m[3+s.length+1]=y,m.set(this.bboxes,y),y+=this.bboxes.length,m.buffer}static serialize(s,c){const d=s.toArrayBuffer();return c&&c.push(d),{buffer:d}}static deserialize(s){return new qa(s.buffer)}}const vo={};function Zt(a,s,c={}){if(vo[a])throw new Error(`${a} is already registered.`);Object.defineProperty(s,"_classRegistryKey",{value:a,writeable:!1}),vo[a]={klass:s,omit:c.omit||[],shallow:c.shallow||[]}}Zt("Object",Object),Zt("TransferableGridIndex",qa),Zt("Color",Ri),Zt("Error",Error),Zt("AJAXError",qt),Zt("ResolvedImage",St),Zt("StylePropertyFunction",Bc),Zt("StyleExpression",fl,{omit:["_evaluator"]}),Zt("ZoomDependentExpression",Yl),Zt("ZoomConstantExpression",ja),Zt("CompoundExpression",ho,{omit:["_evaluate"]});for(const a in ds)ds[a]._classRegistryKey||Zt(`Expression_${a}`,ds[a]);function wl(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&"ArrayBuffer"===a.constructor.name)}function Ga(a){return a.$name||a.constructor._classRegistryKey}function Ei(a){return!function(s){if(null===s||"object"!=typeof s)return!1;const c=Ga(s);return!(!c||"Object"===c)}(a)&&(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||wl(a)||ut(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function $c(a,s){if(Ei(a))return(wl(a)||ut(a))&&s&&s.push(a),ArrayBuffer.isView(a)&&s&&s.push(a.buffer),a instanceof ImageData&&s&&s.push(a.data.buffer),a;if(Array.isArray(a)){const y=[];for(const b of a)y.push($c(b,s));return y}if("object"!=typeof a)throw new Error("can't serialize object of type "+typeof a);const c=Ga(a);if(!c)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!vo[c])throw new Error(`${c} is not registered.`);const{klass:d}=vo[c],m=d.serialize?d.serialize(a,s):{};if(d.serialize){if(s&&m===s[s.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in a){if(!a.hasOwnProperty(y)||vo[c].omit.indexOf(y)>=0)continue;const b=a[y];m[y]=vo[c].shallow.indexOf(y)>=0?b:$c(b,s)}a instanceof Error&&(m.message=a.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==c&&(m.$name=c),m}function Sa(a){if(Ei(a))return a;if(Array.isArray(a))return a.map(Sa);if("object"!=typeof a)throw new Error("can't deserialize object of type "+typeof a);const s=Ga(a)||"Object";if(!vo[s])throw new Error(`can't deserialize unregistered class ${s}`);const{klass:c}=vo[s];if(!c)throw new Error(`can't deserialize unregistered class ${s}`);if(c.deserialize)return c.deserialize(a);const d=Object.create(c.prototype);for(const m of Object.keys(a)){if("$name"===m)continue;const y=a[m];d[m]=vo[s].shallow.indexOf(m)>=0?y:Sa(y)}return d}class da{constructor(){this.first=!0}update(s,c){const d=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=d,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=d,!0):(this.lastFloorZoom>d?(this.lastIntegerZoom=d+1,this.lastIntegerZoomTime=c):this.lastFloorZoom<d&&(this.lastIntegerZoom=d,this.lastIntegerZoomTime=c),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=d,!0))}}const Yn={"Latin-1 Supplement":a=>a>=128&&a<=255,"Hangul Jamo":a=>a>=4352&&a<=4607,Khmer:a=>a>=6016&&a<=6143,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Katakana:a=>a>=12448&&a<=12543,Kanbun:a=>a>=12688&&a<=12703,"CJK Strokes":a=>a>=12736&&a<=12783,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"Private Use Area":a=>a>=57344&&a<=63743,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function V(a){for(const s of a)if(Ot(s.charCodeAt(0)))return!0;return!1}function T(a){for(const s of a)if(!me(s.charCodeAt(0)))return!1;return!0}function P(a){const s=a.map(c=>{try{return new RegExp(`\\p{sc=${c}}`,"u").source}catch{return null}}).filter(c=>c);return new RegExp(s.join("|"),"u")}const z=P(["Arab","Dupl","Mong","Ougr","Syrc"]);function me(a){return!z.test(String.fromCodePoint(a))}const Ve=P(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Ot(a){return!(746!==a&&747!==a&&(a<4352||!(Yn["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Yn["CJK Compatibility"](a)||Yn["CJK Strokes"](a)||!(!Yn["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||Yn["Enclosed CJK Letters and Months"](a)||Yn["Ideographic Description Characters"](a)||Yn.Kanbun(a)||Yn.Katakana(a)&&12540!==a||!(!Yn["Halfwidth and Fullwidth Forms"](a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!Yn["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Yn["Vertical Forms"](a)||Yn["Yijing Hexagram Symbols"](a)||/\p{sc=Cans}/u.test(String.fromCodePoint(a))||/\p{sc=Hang}/u.test(String.fromCodePoint(a))||Ve.test(String.fromCodePoint(a)))))}function ui(a){return!(Ot(a)||(s=a,Yn["Latin-1 Supplement"](s)&&(167===s||169===s||174===s||177===s||188===s||189===s||190===s||215===s||247===s)||Yn["General Punctuation"](s)&&(8214===s||8224===s||8225===s||8240===s||8241===s||8251===s||8252===s||8258===s||8263===s||8264===s||8265===s||8273===s)||Yn["Letterlike Symbols"](s)||Yn["Number Forms"](s)||Yn["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||9003===s||s>=9085&&s<=9114||s>=9150&&s<=9165||9167===s||s>=9169&&s<=9179||s>=9186&&s<=9215)||Yn["Control Pictures"](s)&&9251!==s||Yn["Optical Character Recognition"](s)||Yn["Enclosed Alphanumerics"](s)||Yn["Geometric Shapes"](s)||Yn["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||Yn["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Yn["CJK Symbols and Punctuation"](s)||Yn.Katakana(s)||Yn["Private Use Area"](s)||Yn["CJK Compatibility Forms"](s)||Yn["Small Form Variants"](s)||Yn["Halfwidth and Fullwidth Forms"](s)||8734===s||8756===s||8757===s||s>=9984&&s<=10087||s>=10102&&s<=10131||65532===s||65533===s));var s}const Xn=P(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function or(a){return Xn.test(String.fromCodePoint(a))}function _o(a,s){return!(!s&&or(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Yn.Khmer(a))}function Xd(a){for(const s of a)if(or(s.charCodeAt(0)))return!0;return!1}const Ta=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText}isParsed(){return null!=this.applyArabicShaping&&null!=this.processBidirectionalText&&null!=this.processStyledBidirectionalText}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class sr{constructor(s,c){this.zoom=s,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.zoomHistory=c.zoomHistory,this.transition=c.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new da,this.transition={})}isSupportedScript(s){return function(c,d){for(const m of c)if(!_o(m.charCodeAt(0),d))return!1;return!0}(s,"loaded"===Ta.getRTLTextPluginStatus())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const s=this.zoom,c=s-Math.floor(s),d=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:c+(1-c)*d}:{fromScale:.5,toScale:1,t:1-(1-d)*c}}}class Kd{constructor(s,c){this.property=s,this.value=c,this.expression=function(d,m){if(la(d))return new Bc(d,m);if(pl(d)){const y=hs(d,m);if("error"===y.result)throw new Error(y.value.map(b=>`${b.key}: ${b.message}`).join(", "));return y.value}{let y=d;return"color"===m.type&&"string"==typeof d?y=Ri.parse(d):"padding"!==m.type||"number"!=typeof d&&!Array.isArray(d)?"variableAnchorOffsetCollection"===m.type&&Array.isArray(d)&&(y=He.parse(d)):y=kr.parse(d),{kind:"constant",evaluate:()=>y}}}(void 0===c?s.specification.default:c,s.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(s,c,d){return this.property.possiblyEvaluate(this,s,c,d)}}class id{constructor(s){this.property=s,this.value=new Kd(s,void 0)}transitioned(s,c){return new Op(this.property,this.value,c,Ze({},s.transition,this.transition),s.now)}untransitioned(){return new Op(this.property,this.value,null,{},0)}}class Vc{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return Je(this._values[s].value.value)}setValue(s,c){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new id(this._values[s].property)),this._values[s].value=new Kd(this._values[s].property,null===c?void 0:Je(c))}getTransition(s){return Je(this._values[s].transition)}setTransition(s,c){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new id(this._values[s].property)),this._values[s].transition=Je(c)||void 0}serialize(){const s={};for(const c of Object.keys(this._values)){const d=this.getValue(c);void 0!==d&&(s[c]=d);const m=this.getTransition(c);void 0!==m&&(s[`${c}-transition`]=m)}return s}transitioned(s,c){const d=new Fp(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].transitioned(s,c._values[m]);return d}untransitioned(){const s=new Fp(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].untransitioned();return s}}class Op{constructor(s,c,d,m,y){this.property=s,this.value=c,this.begin=y+m.delay||0,this.end=this.begin+m.duration||0,s.specification.transition&&(m.delay||m.duration)&&(this.prior=d)}possiblyEvaluate(s,c,d){const m=s.now||0,y=this.value.possiblyEvaluate(s,c,d),b=this.prior;if(b){if(m>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(m<this.begin)return b.possiblyEvaluate(s,c,d);{const C=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(s,c,d),y,function(I){if(I<=0)return 0;if(I>=1)return 1;const M=I*I,O=M*I;return 4*(I<.5?O:3*(I-M)+O-.75)}(C))}}return y}}class Fp{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,c,d){const m=new v(this._properties);for(const y of Object.keys(this._values))m._values[y]=this._values[y].possiblyEvaluate(s,c,d);return m}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class Lp{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}hasValue(s){return void 0!==this._values[s].value}getValue(s){return Je(this._values[s].value)}setValue(s,c){this._values[s]=new Kd(this._values[s].property,null===c?void 0:Je(c))}serialize(){const s={};for(const c of Object.keys(this._values)){const d=this.getValue(c);void 0!==d&&(s[c]=d)}return s}possiblyEvaluate(s,c,d){const m=new v(this._properties);for(const y of Object.keys(this._values))m._values[y]=this._values[y].possiblyEvaluate(s,c,d);return m}}class Wa{constructor(s,c,d){this.property=s,this.value=c,this.parameters=d}isConstant(){return"constant"===this.value.kind}constantOr(s){return"constant"===this.value.kind?this.value.value:s}evaluate(s,c,d,m){return this.property.evaluate(this.value,this.parameters,s,c,d,m)}}class v{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class o{constructor(s){this.specification=s}possiblyEvaluate(s,c){if(s.isDataDriven())throw new Error("Value should not be data driven");return s.expression.evaluate(c)}interpolate(s,c,d){const m=On[this.specification.type];return m?m(s,c,d):s}}class u{constructor(s,c){this.specification=s,this.overrides=c}possiblyEvaluate(s,c,d,m){return new Wa(this,"constant"===s.expression.kind||"camera"===s.expression.kind?{kind:"constant",value:s.expression.evaluate(c,null,{},d,m)}:s.expression,c)}interpolate(s,c,d){if("constant"!==s.value.kind||"constant"!==c.value.kind)return s;if(void 0===s.value.value||void 0===c.value.value)return new Wa(this,{kind:"constant",value:void 0},s.parameters);const m=On[this.specification.type];if(m){const y=m(s.value.value,c.value.value,d);return new Wa(this,{kind:"constant",value:y},s.parameters)}return s}evaluate(s,c,d,m,y,b){return"constant"===s.kind?s.value:s.evaluate(c,d,m,y,b)}}class f extends u{possiblyEvaluate(s,c,d,m){if(void 0===s.value)return new Wa(this,{kind:"constant",value:void 0},c);if("constant"===s.expression.kind){const y=s.expression.evaluate(c,null,{},d,m),b="resolvedImage"===s.property.specification.type&&"string"!=typeof y?y.name:y,C=this._calculate(b,b,b,c);return new Wa(this,{kind:"constant",value:C},c)}if("camera"===s.expression.kind){const y=this._calculate(s.expression.evaluate({zoom:c.zoom-1}),s.expression.evaluate({zoom:c.zoom}),s.expression.evaluate({zoom:c.zoom+1}),c);return new Wa(this,{kind:"constant",value:y},c)}return new Wa(this,s.expression,c)}evaluate(s,c,d,m,y,b){if("source"===s.kind){const C=s.evaluate(c,d,m,y,b);return this._calculate(C,C,C,c)}return"composite"===s.kind?this._calculate(s.evaluate({zoom:Math.floor(c.zoom)-1},d,m),s.evaluate({zoom:Math.floor(c.zoom)},d,m),s.evaluate({zoom:Math.floor(c.zoom)+1},d,m),c):s.value}_calculate(s,c,d,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:s,to:c}:{from:d,to:c}}interpolate(s){return s}}class p{constructor(s){this.specification=s}possiblyEvaluate(s,c,d,m){if(void 0!==s.value){if("constant"===s.expression.kind){const y=s.expression.evaluate(c,null,{},d,m);return this._calculate(y,y,y,c)}return this._calculate(s.expression.evaluate(new sr(Math.floor(c.zoom-1),c)),s.expression.evaluate(new sr(Math.floor(c.zoom),c)),s.expression.evaluate(new sr(Math.floor(c.zoom+1),c)),c)}}_calculate(s,c,d,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:s,to:c}:{from:d,to:c}}interpolate(s){return s}}class _{constructor(s){this.specification=s}possiblyEvaluate(s,c,d,m){return!!s.expression.evaluate(c,null,{},d,m)}interpolate(){return!1}}class D{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const c in s){const d=s[c];d.specification.overridable&&this.overridableProperties.push(c);const m=this.defaultPropertyValues[c]=new Kd(d,void 0),y=this.defaultTransitionablePropertyValues[c]=new id(d);this.defaultTransitioningPropertyValues[c]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=m.possiblyEvaluate({})}}}Zt("DataDrivenProperty",u),Zt("DataConstantProperty",o),Zt("CrossFadedDataDrivenProperty",f),Zt("CrossFadedProperty",p),Zt("ColorRampProperty",_);const S="-transition";class A extends ur{constructor(s,c){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==s.type&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,"background"!==s.type&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),c.layout&&(this._unevaluatedLayout=new Lp(c.layout)),c.paint)){this._transitionablePaint=new Vc(c.paint);for(const d in s.paint)this.setPaintProperty(d,s.paint[d],{validate:!1});for(const d in s.layout)this.setLayoutProperty(d,s.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new v(c.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(s){return"visibility"===s?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,c,d={}){null!=c&&this._validate(Zi,`layers.${this.id}.layout.${s}`,s,c,d)||("visibility"!==s?this._unevaluatedLayout.setValue(s,c):this.visibility=c)}getPaintProperty(s){return s.endsWith(S)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,c,d={}){if(null!=c&&this._validate(Fs,`layers.${this.id}.paint.${s}`,s,c,d))return!1;if(s.endsWith(S))return this._transitionablePaint.setTransition(s.slice(0,-11),c||void 0),!1;{const m=this._transitionablePaint._values[s],y="cross-faded-data-driven"===m.property.specification["property-type"],b=m.value.isDataDriven(),C=m.value;this._transitionablePaint.setValue(s,c),this._handleSpecialPaintPropertyUpdate(s);const I=this._transitionablePaint._values[s].value;return I.isDataDriven()||b||y||this._handleOverridablePaintPropertyUpdate(s,C,I)}}_handleSpecialPaintPropertyUpdate(s){}_handleOverridablePaintPropertyUpdate(s,c,d){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||"none"===this.visibility}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,c){s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,c)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),lt(s,(c,d)=>!(void 0===c||"layout"===d&&!Object.keys(c).length||"paint"===d&&!Object.keys(c).length))}_validate(s,c,d,m,y={}){return(!y||!1!==y.validate)&&bl(this,s.call(gs,{key:c,layerType:this.type,objectKey:d,value:m,styleSpec:ve,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const c=this.paint.get(s);if(c instanceof Wa&&es(c.property.specification)&&("source"===c.value.kind||"composite"===c.value.kind)&&c.value.isStateDependent)return!0}return!1}}const R={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class B{constructor(s,c){this._structArray=s,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class L{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,c){return s._trim(),c&&(s.isTransferred=!0,c.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const c=Object.create(this.prototype);return c.arrayBuffer=s.arrayBuffer,c.length=s.length,c.capacity=s.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function W(a,s=1){let c=0,d=0;return{members:a.map(m=>{const y=R[m.type].BYTES_PER_ELEMENT,b=c=Q(c,Math.max(s,y)),C=m.components||1;return d=Math.max(d,y),c+=y*C,{name:m.name,type:m.type,components:C,offset:b}}),size:Q(c,Math.max(d,s)),alignment:s}}function Q(a,s){return Math.ceil(a/s)*s}class ne extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c){const d=this.length;return this.resize(d+1),this.emplace(d,s,c)}emplace(s,c,d){const m=2*s;return this.int16[m+0]=c,this.int16[m+1]=d,s}}ne.prototype.bytesPerElement=4,Zt("StructArrayLayout2i4",ne);class de extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const y=3*s;return this.int16[y+0]=c,this.int16[y+1]=d,this.int16[y+2]=m,s}}de.prototype.bytesPerElement=6,Zt("StructArrayLayout3i6",de);class se extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const y=this.length;return this.resize(y+1),this.emplace(y,s,c,d,m)}emplace(s,c,d,m,y){const b=4*s;return this.int16[b+0]=c,this.int16[b+1]=d,this.int16[b+2]=m,this.int16[b+3]=y,s}}se.prototype.bytesPerElement=8,Zt("StructArrayLayout4i8",se);class he extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,b){const C=this.length;return this.resize(C+1),this.emplace(C,s,c,d,m,y,b)}emplace(s,c,d,m,y,b,C){const I=6*s;return this.int16[I+0]=c,this.int16[I+1]=d,this.int16[I+2]=m,this.int16[I+3]=y,this.int16[I+4]=b,this.int16[I+5]=C,s}}he.prototype.bytesPerElement=12,Zt("StructArrayLayout2i4i12",he);class Ee extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,b){const C=this.length;return this.resize(C+1),this.emplace(C,s,c,d,m,y,b)}emplace(s,c,d,m,y,b,C){const I=4*s,M=8*s;return this.int16[I+0]=c,this.int16[I+1]=d,this.uint8[M+4]=m,this.uint8[M+5]=y,this.uint8[M+6]=b,this.uint8[M+7]=C,s}}Ee.prototype.bytesPerElement=8,Zt("StructArrayLayout2i4ub8",Ee);class oe extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c){const d=this.length;return this.resize(d+1),this.emplace(d,s,c)}emplace(s,c,d){const m=2*s;return this.float32[m+0]=c,this.float32[m+1]=d,s}}oe.prototype.bytesPerElement=8,Zt("StructArrayLayout2f8",oe);class Me extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,b,C,I,M,O){const F=this.length;return this.resize(F+1),this.emplace(F,s,c,d,m,y,b,C,I,M,O)}emplace(s,c,d,m,y,b,C,I,M,O,F){const j=10*s;return this.uint16[j+0]=c,this.uint16[j+1]=d,this.uint16[j+2]=m,this.uint16[j+3]=y,this.uint16[j+4]=b,this.uint16[j+5]=C,this.uint16[j+6]=I,this.uint16[j+7]=M,this.uint16[j+8]=O,this.uint16[j+9]=F,s}}Me.prototype.bytesPerElement=20,Zt("StructArrayLayout10ui20",Me);class Oe extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,b,C,I,M,O,F,j){const q=this.length;return this.resize(q+1),this.emplace(q,s,c,d,m,y,b,C,I,M,O,F,j)}emplace(s,c,d,m,y,b,C,I,M,O,F,j,q){const Y=12*s;return this.int16[Y+0]=c,this.int16[Y+1]=d,this.int16[Y+2]=m,this.int16[Y+3]=y,this.uint16[Y+4]=b,this.uint16[Y+5]=C,this.uint16[Y+6]=I,this.uint16[Y+7]=M,this.int16[Y+8]=O,this.int16[Y+9]=F,this.int16[Y+10]=j,this.int16[Y+11]=q,s}}Oe.prototype.bytesPerElement=24,Zt("StructArrayLayout4i4ui4i24",Oe);class Be extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const y=3*s;return this.float32[y+0]=c,this.float32[y+1]=d,this.float32[y+2]=m,s}}Be.prototype.bytesPerElement=12,Zt("StructArrayLayout3f12",Be);class ft extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint32[1*s+0]=c,s}}ft.prototype.bytesPerElement=4,Zt("StructArrayLayout1ul4",ft);class Tt extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,b,C,I,M){const O=this.length;return this.resize(O+1),this.emplace(O,s,c,d,m,y,b,C,I,M)}emplace(s,c,d,m,y,b,C,I,M,O){const F=10*s,j=5*s;return this.int16[F+0]=c,this.int16[F+1]=d,this.int16[F+2]=m,this.int16[F+3]=y,this.int16[F+4]=b,this.int16[F+5]=C,this.uint32[j+3]=I,this.uint16[F+8]=M,this.uint16[F+9]=O,s}}Tt.prototype.bytesPerElement=20,Zt("StructArrayLayout6i1ul2ui20",Tt);class cn extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,b){const C=this.length;return this.resize(C+1),this.emplace(C,s,c,d,m,y,b)}emplace(s,c,d,m,y,b,C){const I=6*s;return this.int16[I+0]=c,this.int16[I+1]=d,this.int16[I+2]=m,this.int16[I+3]=y,this.int16[I+4]=b,this.int16[I+5]=C,s}}cn.prototype.bytesPerElement=12,Zt("StructArrayLayout2i2i2i12",cn);class sn extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y){const b=this.length;return this.resize(b+1),this.emplace(b,s,c,d,m,y)}emplace(s,c,d,m,y,b){const C=4*s,I=8*s;return this.float32[C+0]=c,this.float32[C+1]=d,this.float32[C+2]=m,this.int16[I+6]=y,this.int16[I+7]=b,s}}sn.prototype.bytesPerElement=16,Zt("StructArrayLayout2f1f2i16",sn);class At extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,b){const C=this.length;return this.resize(C+1),this.emplace(C,s,c,d,m,y,b)}emplace(s,c,d,m,y,b,C){const I=16*s,M=4*s,O=8*s;return this.uint8[I+0]=c,this.uint8[I+1]=d,this.float32[M+1]=m,this.float32[M+2]=y,this.int16[O+6]=b,this.int16[O+7]=C,s}}At.prototype.bytesPerElement=16,Zt("StructArrayLayout2ub2f2i16",At);class zt extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const y=3*s;return this.uint16[y+0]=c,this.uint16[y+1]=d,this.uint16[y+2]=m,s}}zt.prototype.bytesPerElement=6,Zt("StructArrayLayout3ui6",zt);class Cn extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,b,C,I,M,O,F,j,q,Y,ee,le,ye){const Fe=this.length;return this.resize(Fe+1),this.emplace(Fe,s,c,d,m,y,b,C,I,M,O,F,j,q,Y,ee,le,ye)}emplace(s,c,d,m,y,b,C,I,M,O,F,j,q,Y,ee,le,ye,Fe){const Ie=24*s,Re=12*s,Ge=48*s;return this.int16[Ie+0]=c,this.int16[Ie+1]=d,this.uint16[Ie+2]=m,this.uint16[Ie+3]=y,this.uint32[Re+2]=b,this.uint32[Re+3]=C,this.uint32[Re+4]=I,this.uint16[Ie+10]=M,this.uint16[Ie+11]=O,this.uint16[Ie+12]=F,this.float32[Re+7]=j,this.float32[Re+8]=q,this.uint8[Ge+36]=Y,this.uint8[Ge+37]=ee,this.uint8[Ge+38]=le,this.uint32[Re+10]=ye,this.int16[Ie+22]=Fe,s}}Cn.prototype.bytesPerElement=48,Zt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Cn);class Jn extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,b,C,I,M,O,F,j,q,Y,ee,le,ye,Fe,Ie,Re,Ge,Ct,un,Rn,Jt,Gt,Sn,xn){const vn=this.length;return this.resize(vn+1),this.emplace(vn,s,c,d,m,y,b,C,I,M,O,F,j,q,Y,ee,le,ye,Fe,Ie,Re,Ge,Ct,un,Rn,Jt,Gt,Sn,xn)}emplace(s,c,d,m,y,b,C,I,M,O,F,j,q,Y,ee,le,ye,Fe,Ie,Re,Ge,Ct,un,Rn,Jt,Gt,Sn,xn,vn){const tt=32*s,Mn=16*s;return this.int16[tt+0]=c,this.int16[tt+1]=d,this.int16[tt+2]=m,this.int16[tt+3]=y,this.int16[tt+4]=b,this.int16[tt+5]=C,this.int16[tt+6]=I,this.int16[tt+7]=M,this.uint16[tt+8]=O,this.uint16[tt+9]=F,this.uint16[tt+10]=j,this.uint16[tt+11]=q,this.uint16[tt+12]=Y,this.uint16[tt+13]=ee,this.uint16[tt+14]=le,this.uint16[tt+15]=ye,this.uint16[tt+16]=Fe,this.uint16[tt+17]=Ie,this.uint16[tt+18]=Re,this.uint16[tt+19]=Ge,this.uint16[tt+20]=Ct,this.uint16[tt+21]=un,this.uint16[tt+22]=Rn,this.uint32[Mn+12]=Jt,this.float32[Mn+13]=Gt,this.float32[Mn+14]=Sn,this.uint16[tt+30]=xn,this.uint16[tt+31]=vn,s}}Jn.prototype.bytesPerElement=64,Zt("StructArrayLayout8i15ui1ul2f2ui64",Jn);class Vt extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.float32[1*s+0]=c,s}}Vt.prototype.bytesPerElement=4,Zt("StructArrayLayout1f4",Vt);class Xt extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const y=3*s;return this.uint16[6*s+0]=c,this.float32[y+1]=d,this.float32[y+2]=m,s}}Xt.prototype.bytesPerElement=12,Zt("StructArrayLayout1ui2f12",Xt);class zn extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const y=4*s;return this.uint32[2*s+0]=c,this.uint16[y+2]=d,this.uint16[y+3]=m,s}}zn.prototype.bytesPerElement=8,Zt("StructArrayLayout1ul2ui8",zn);class pr extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c){const d=this.length;return this.resize(d+1),this.emplace(d,s,c)}emplace(s,c,d){const m=2*s;return this.uint16[m+0]=c,this.uint16[m+1]=d,s}}pr.prototype.bytesPerElement=4,Zt("StructArrayLayout2ui4",pr);class yi extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint16[1*s+0]=c,s}}yi.prototype.bytesPerElement=2,Zt("StructArrayLayout1ui2",yi);class Ai extends L{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const y=this.length;return this.resize(y+1),this.emplace(y,s,c,d,m)}emplace(s,c,d,m,y){const b=4*s;return this.float32[b+0]=c,this.float32[b+1]=d,this.float32[b+2]=m,this.float32[b+3]=y,s}}Ai.prototype.bytesPerElement=16,Zt("StructArrayLayout4f16",Ai);class Lr extends B{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Ae(this.anchorPointX,this.anchorPointY)}}Lr.prototype.size=20;class Vo extends Tt{get(s){return new Lr(this,s)}}Zt("CollisionBoxArray",Vo);class ha extends B{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(s){this._structArray.uint8[this._pos1+37]=s}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(s){this._structArray.uint8[this._pos1+38]=s}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(s){this._structArray.uint32[this._pos4+10]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ha.prototype.size=48;class Ar extends Cn{get(s){return new ha(this,s)}}Zt("PlacedSymbolArray",Ar);class is extends B{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(s){this._structArray.uint32[this._pos4+12]=s}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}is.prototype.size=64;class Ro extends Jn{get(s){return new is(this,s)}}Zt("SymbolInstanceArray",Ro);class jo extends Vt{getoffsetX(s){return this.float32[1*s+0]}}Zt("GlyphOffsetArray",jo);class To extends de{getx(s){return this.int16[3*s+0]}gety(s){return this.int16[3*s+1]}gettileUnitDistanceFromAnchor(s){return this.int16[3*s+2]}}Zt("SymbolLineVertexArray",To);class ys extends B{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ys.prototype.size=12;class jc extends Xt{get(s){return new ys(this,s)}}Zt("TextAnchorOffsetArray",jc);class gu extends B{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}gu.prototype.size=8;class xl extends zn{get(s){return new gu(this,s)}}Zt("FeatureIndexArray",xl);class Za extends ne{}class rd extends ne{}class Yd extends ne{}class Gs extends he{}class Ws extends Ee{}class Cl extends oe{}class Zs extends Me{}class rs extends Oe{}class os extends Be{}class Ls extends ft{}class Bi extends cn{}class nc extends At{}class Dl extends zt{}class yu extends pr{}const Wh=W([{name:"a_pos",components:2,type:"Int16"}],4),{members:Zh}=Wh;class Oo{constructor(s=[]){this.segments=s}prepareSegment(s,c,d,m){let y=this.segments[this.segments.length-1];return s>Oo.MAX_VERTEX_ARRAY_LENGTH&&en(`Max vertices per segment is ${Oo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!y||y.vertexLength+s>Oo.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==m)&&(y={vertexOffset:c.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},void 0!==m&&(y.sortKey=m),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const s of this.segments)for(const c in s.vaos)s.vaos[c].destroy()}static simpleSegment(s,c,d,m){return new Oo([{vertexOffset:s,primitiveOffset:c,vertexLength:d,primitiveLength:m,vaos:{},sortKey:0}])}}function Aa(a,s){return 256*(a=Qe(Math.floor(a),0,255))+Qe(Math.floor(s),0,255)}Oo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Zt("SegmentVector",Oo);const vu=W([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var vs={exports:{}},Uc=function(a,s){var c,d,m,y,b,C,I,M;for(d=a.length-(c=3&a.length),m=s,b=3432918353,C=461845907,M=0;M<d;)I=255&a.charCodeAt(M)|(255&a.charCodeAt(++M))<<8|(255&a.charCodeAt(++M))<<16|(255&a.charCodeAt(++M))<<24,++M,m=27492+(65535&(y=5*(65535&(m=(m^=I=(65535&(I=(I=(65535&I)*b+(((I>>>16)*b&65535)<<16)&4294967295)<<15|I>>>17))*C+(((I>>>16)*C&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(I=0,c){case 3:I^=(255&a.charCodeAt(M+2))<<16;case 2:I^=(255&a.charCodeAt(M+1))<<8;case 1:m^=I=(65535&(I=(I=(65535&(I^=255&a.charCodeAt(M)))*b+(((I>>>16)*b&65535)<<16)&4294967295)<<15|I>>>17))*C+(((I>>>16)*C&65535)<<16)&4294967295}return m^=a.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0},Xh=function(a,s){for(var c,d=a.length,m=s^d,y=0;d>=4;)c=1540483477*(65535&(c=255&a.charCodeAt(y)|(255&a.charCodeAt(++y))<<8|(255&a.charCodeAt(++y))<<16|(255&a.charCodeAt(++y))<<24))+((1540483477*(c>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),d-=4,++y;switch(d){case 3:m^=(255&a.charCodeAt(y+2))<<16;case 2:m^=(255&a.charCodeAt(y+1))<<8;case 1:m=1540483477*(65535&(m^=255&a.charCodeAt(y)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};vs.exports=Uc,vs.exports.murmur3=Uc,vs.exports.murmur2=Xh;var _s=an(vs.exports);class Kh{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,c,d,m){this.ids.push(Np(s)),this.positions.push(c,d,m)}getPositions(s){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const c=Np(s);let d=0,m=this.ids.length-1;for(;d<m;){const b=d+m>>1;this.ids[b]>=c?m=b:d=b+1}const y=[];for(;this.ids[d]===c;)y.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return y}static serialize(s,c){const d=new Float64Array(s.ids),m=new Uint32Array(s.positions);return Hc(d,m,0,d.length-1),c&&c.push(d.buffer,m.buffer),{ids:d,positions:m}}static deserialize(s){const c=new Kh;return c.ids=s.ids,c.positions=s.positions,c.indexed=!0,c}}function Np(a){const s=+a;return!isNaN(s)&&s<=Number.MAX_SAFE_INTEGER?s:_s(String(a))}function Hc(a,s,c,d){for(;c<d;){const m=a[c+d>>1];let y=c-1,b=d+1;for(;;){do{y++}while(a[y]<m);do{b--}while(a[b]>m);if(y>=b)break;bs(a,y,b),bs(s,3*y,3*b),bs(s,3*y+1,3*b+1),bs(s,3*y+2,3*b+2)}b-c<d-b?(Hc(a,s,c,b),c=b+1):(Hc(a,s,b+1,d),d=b)}}function bs(a,s,c){const d=a[s];a[s]=a[c],a[c]=d}Zt("FeaturePositionMap",Kh);class _u{constructor(s,c){this.gl=s.gl,this.location=c}}class Yh extends _u{constructor(s,c){super(s,c),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class Og extends _u{constructor(s,c){super(s,c),this.current=[0,0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))}}class ic extends _u{constructor(s,c){super(s,c),this.current=Ri.transparent}set(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))}}const Fg=new Float32Array(16);function Bp(a){return[Aa(255*a.r,255*a.g),Aa(255*a.b,255*a.a)]}class ad{constructor(s,c,d){this.value=s,this.uniformNames=c.map(m=>`u_${m}`),this.type=d}setUniform(s,c,d){s.set(d.constantOr(this.value))}getBinding(s,c,d){return"color"===this.type?new ic(s,c):new Yh(s,c)}}class bu{constructor(s,c){this.uniformNames=c.map(d=>`u_${d}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(s,c){this.pixelRatioFrom=c.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=c.tlbr,this.patternTo=s.tlbr}setUniform(s,c,d,m){const y="u_pattern_to"===m?this.patternTo:"u_pattern_from"===m?this.patternFrom:"u_pixel_ratio_to"===m?this.pixelRatioTo:"u_pixel_ratio_from"===m?this.pixelRatioFrom:null;y&&s.set(y)}getBinding(s,c,d){return"u_pattern"===d.substr(0,9)?new Og(s,c):new Yh(s,c)}}class El{constructor(s,c,d,m){this.expression=s,this.type=d,this.maxValue=0,this.paintVertexAttributes=c.map(y=>({name:`a_${y}`,type:"Float32",components:"color"===d?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(s,c,d,m,y){const b=this.paintVertexArray.length,C=this.expression.evaluate(new sr(0),c,{},m,[],y);this.paintVertexArray.resize(s),this._setPaintValue(b,s,C)}updatePaintArray(s,c,d,m){const y=this.expression.evaluate({zoom:0},d,m);this._setPaintValue(s,c,y)}_setPaintValue(s,c,d){if("color"===this.type){const m=Bp(d);for(let y=s;y<c;y++)this.paintVertexArray.emplace(y,m[0],m[1])}else{for(let m=s;m<c;m++)this.paintVertexArray.emplace(m,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Xa{constructor(s,c,d,m,y,b){this.expression=s,this.uniformNames=c.map(C=>`u_${C}_t`),this.type=d,this.useIntegerZoom=m,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=c.map(C=>({name:`a_${C}`,type:"Float32",components:"color"===d?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(s,c,d,m,y){const b=this.expression.evaluate(new sr(this.zoom),c,{},m,[],y),C=this.expression.evaluate(new sr(this.zoom+1),c,{},m,[],y),I=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(I,s,b,C)}updatePaintArray(s,c,d,m){const y=this.expression.evaluate({zoom:this.zoom},d,m),b=this.expression.evaluate({zoom:this.zoom+1},d,m);this._setPaintValue(s,c,y,b)}_setPaintValue(s,c,d,m){if("color"===this.type){const y=Bp(d),b=Bp(m);for(let C=s;C<c;C++)this.paintVertexArray.emplace(C,y[0],y[1],b[0],b[1])}else{for(let y=s;y<c;y++)this.paintVertexArray.emplace(y,d,m);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(m))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,c){const d=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,m=Qe(this.expression.interpolationFactor(d,this.zoom,this.zoom+1),0,1);s.set(m)}getBinding(s,c,d){return new Yh(s,c)}}class Kn{constructor(s,c,d,m,y,b){this.expression=s,this.type=c,this.useIntegerZoom=d,this.zoom=m,this.layerId=b,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(s,c,d){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(m,s,c.patterns&&c.patterns[this.layerId],d)}updatePaintArray(s,c,d,m,y){this._setPaintValues(s,c,d.patterns&&d.patterns[this.layerId],y)}_setPaintValues(s,c,d,m){if(!m||!d)return;const{min:y,mid:b,max:C}=d,I=m[y],M=m[b],O=m[C];if(I&&M&&O)for(let F=s;F<c;F++)this.zoomInPaintVertexArray.emplace(F,M.tl[0],M.tl[1],M.br[0],M.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],M.pixelRatio,I.pixelRatio),this.zoomOutPaintVertexArray.emplace(F,M.tl[0],M.tl[1],M.br[0],M.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],M.pixelRatio,O.pixelRatio)}upload(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,vu.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,vu.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class zp{constructor(s,c,d){this.binders={},this._buffers=[];const m=[];for(const y in s.paint._values){if(!d(y))continue;const b=s.paint.get(y);if(!(b instanceof Wa&&es(b.property.specification)))continue;const C=G_(y,s.type),I=b.value,M=b.property.specification.type,O=b.property.useIntegerZoom,F=b.property.specification["property-type"],j="cross-faded"===F||"cross-faded-data-driven"===F;if("constant"===I.kind)this.binders[y]=j?new bu(I.value,C):new ad(I.value,C,M),m.push(`/u_${y}`);else if("source"===I.kind||j){const q=Lg(y,M,"source");this.binders[y]=j?new Kn(I,M,O,c,q,s.id):new El(I,C,M,q),m.push(`/a_${y}`)}else{const q=Lg(y,M,"composite");this.binders[y]=new Xa(I,C,M,O,c,q),m.push(`/z_${y}`)}}this.cacheKey=m.sort().join("")}getMaxValue(s){const c=this.binders[s];return c instanceof El||c instanceof Xa?c.maxValue:0}populatePaintArrays(s,c,d,m,y){for(const b in this.binders){const C=this.binders[b];(C instanceof El||C instanceof Xa||C instanceof Kn)&&C.populatePaintArray(s,c,d,m,y)}}setConstantPatternPositions(s,c){for(const d in this.binders){const m=this.binders[d];m instanceof bu&&m.setConstantPatternPositions(s,c)}}updatePaintArrays(s,c,d,m,y){let b=!1;for(const C in s){const I=c.getPositions(C);for(const M of I){const O=d.feature(M.index);for(const F in this.binders){const j=this.binders[F];if((j instanceof El||j instanceof Xa||j instanceof Kn)&&!0===j.expression.isStateDependent){const q=m.paint.get(F);j.expression=q.value,j.updatePaintArray(M.start,M.end,O,s[C],y),b=!0}}}}return b}defines(){const s=[];for(const c in this.binders){const d=this.binders[c];(d instanceof ad||d instanceof bu)&&s.push(...d.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return s}getBinderAttributes(){const s=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof El||d instanceof Xa)for(let m=0;m<d.paintVertexAttributes.length;m++)s.push(d.paintVertexAttributes[m].name);else if(d instanceof Kn)for(let m=0;m<vu.members.length;m++)s.push(vu.members[m].name)}return s}getBinderUniforms(){const s=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof ad||d instanceof bu||d instanceof Xa)for(const m of d.uniformNames)s.push(m)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s,c){const d=[];for(const m in this.binders){const y=this.binders[m];if(y instanceof ad||y instanceof bu||y instanceof Xa)for(const b of y.uniformNames)if(c[b]){const C=y.getBinding(s,c[b],b);d.push({name:b,property:m,binding:C})}}return d}setUniforms(s,c,d,m){for(const{name:y,property:b,binding:C}of c)this.binders[b].setUniform(C,m,d.get(b),y)}updatePaintBuffers(s){this._buffers=[];for(const c in this.binders){const d=this.binders[c];if(s&&d instanceof Kn){const m=2===s.fromScale?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(d instanceof El||d instanceof Xa)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(s){for(const c in this.binders){const d=this.binders[c];(d instanceof El||d instanceof Xa||d instanceof Kn)&&d.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const c=this.binders[s];(c instanceof El||c instanceof Xa||c instanceof Kn)&&c.destroy()}}}class ld{constructor(s,c,d=(()=>!0)){this.programConfigurations={};for(const m of s)this.programConfigurations[m.id]=new zp(m,c,d);this.needsUpload=!1,this._featureMap=new Kh,this._bufferOffset=0}populatePaintArrays(s,c,d,m,y,b){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(s,c,m,y,b);void 0!==c.id&&this._featureMap.add(c.id,d,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,c,d,m){for(const y of d)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(s,this._featureMap,c,y,m)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}function G_(a,s){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${s}-`,"").replace(/-/g,"_")]}function Lg(a,s,c){const m={"line-pattern":{source:Zs,composite:Zs},"fill-pattern":{source:Zs,composite:Zs},"fill-extrusion-pattern":{source:Zs,composite:Zs}}[a];return m&&m[c]||{color:{source:oe,composite:Ai},number:{source:Vt,composite:oe}}[s][c]}Zt("ConstantBinder",ad),Zt("CrossFadedConstantBinder",bu),Zt("SourceExpressionBinder",El),Zt("CrossFadedCompositeBinder",Kn),Zt("CompositeExpressionBinder",Xa),Zt("ProgramConfiguration",zp,{omit:["_buffers"]}),Zt("ProgramConfigurationSet",ld);const fo=8192,Jh=Math.pow(2,14)-1,wu=-Jh-1;function xu(a){const s=fo/a.extent,c=a.loadGeometry();for(let d=0;d<c.length;d++){const m=c[d];for(let y=0;y<m.length;y++){const b=m[y],C=Math.round(b.x*s),I=Math.round(b.y*s);b.x=Qe(C,wu,Jh),b.y=Qe(I,wu,Jh),(C<b.x||C>b.x+1||I<b.y||I>b.y+1)&&en("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return c}function Cu(a,s){return{type:a.type,id:a.id,properties:a.properties,geometry:s?xu(a):[]}}function Qh(a,s,c,d,m){a.emplaceBack(2*s+(d+1)/2,2*c+(m+1)/2)}class $p{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new rd,this.indexArray=new Dl,this.segments=new Oo,this.programConfigurations=new ld(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,d){const m=this.layers[0],y=[];let b=null,C=!1;"circle"===m.type&&(b=m.layout.get("circle-sort-key"),C=!b.isConstant());for(const{feature:I,id:M,index:O,sourceLayerIndex:F}of s){const j=this.layers[0]._featureFilter.needGeometry,q=Cu(I,j);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),q,d))continue;const Y=C?b.evaluate(q,{},d):void 0,ee={id:M,properties:I.properties,type:I.type,sourceLayerIndex:F,index:O,geometry:j?q.geometry:xu(I),patterns:{},sortKey:Y};y.push(ee)}C&&y.sort((I,M)=>I.sortKey-M.sortKey);for(const I of y){const{geometry:M,index:O,sourceLayerIndex:F}=I,j=s[O].feature;this.addFeature(I,M,O,d),c.featureIndex.insert(j,M,O,F,this.index)}}update(s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Zh),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,c,d,m){for(const y of c)for(const b of y){const C=b.x,I=b.y;if(C<0||C>=fo||I<0||I>=fo)continue;const M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),O=M.vertexLength;Qh(this.layoutVertexArray,C,I,-1,-1),Qh(this.layoutVertexArray,C,I,1,-1),Qh(this.layoutVertexArray,C,I,1,1),Qh(this.layoutVertexArray,C,I,-1,1),this.indexArray.emplaceBack(O,O+1,O+2),this.indexArray.emplaceBack(O,O+3,O+2),M.vertexLength+=4,M.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,{},m)}}function Ng(a,s){for(let c=0;c<a.length;c++)if(qc(s,a[c]))return!0;for(let c=0;c<s.length;c++)if(qc(a,s[c]))return!0;return!!cd(a,s)}function Dt(a,s,c){return!!qc(a,s)||!!tf(s,a,c)}function Wi(a,s){if(1===a.length)return Ka(s,a[0]);for(let c=0;c<s.length;c++){const d=s[c];for(let m=0;m<d.length;m++)if(qc(a,d[m]))return!0}for(let c=0;c<a.length;c++)if(Ka(s,a[c]))return!0;for(let c=0;c<s.length;c++)if(cd(a,s[c]))return!0;return!1}function ef(a,s,c){if(a.length>1){if(cd(a,s))return!0;for(let d=0;d<s.length;d++)if(tf(s[d],a,c))return!0}for(let d=0;d<a.length;d++)if(tf(a[d],s,c))return!0;return!1}function cd(a,s){if(0===a.length||0===s.length)return!1;for(let c=0;c<a.length-1;c++){const d=a[c],m=a[c+1];for(let y=0;y<s.length-1;y++)if(ss(d,m,s[y],s[y+1]))return!0}return!1}function ss(a,s,c,d){return $t(a,c,d)!==$t(s,c,d)&&$t(a,s,c)!==$t(a,s,d)}function tf(a,s,c){const d=c*c;if(1===s.length)return a.distSqr(s[0])<d;for(let m=1;m<s.length;m++)if(ud(a,s[m-1],s[m])<d)return!0;return!1}function ud(a,s,c){const d=s.distSqr(c);if(0===d)return a.distSqr(s);const m=((a.x-s.x)*(c.x-s.x)+(a.y-s.y)*(c.y-s.y))/d;return a.distSqr(m<0?s:m>1?c:c.sub(s)._mult(m)._add(s))}function Ka(a,s){let c,d,m,y=!1;for(let b=0;b<a.length;b++){c=a[b];for(let C=0,I=c.length-1;C<c.length;I=C++)d=c[C],m=c[I],d.y>s.y!=m.y>s.y&&s.x<(m.x-d.x)*(s.y-d.y)/(m.y-d.y)+d.x&&(y=!y)}return y}function qc(a,s){let c=!1;for(let d=0,m=a.length-1;d<a.length;m=d++){const y=a[d],b=a[m];y.y>s.y!=b.y>s.y&&s.x<(b.x-y.x)*(s.y-y.y)/(b.y-y.y)+y.x&&(c=!c)}return c}function Vp(a,s,c){const d=c[0],m=c[2];if(a.x<d.x&&s.x<d.x||a.x>m.x&&s.x>m.x||a.y<d.y&&s.y<d.y||a.y>m.y&&s.y>m.y)return!1;const y=$t(a,s,c[0]);return y!==$t(a,s,c[1])||y!==$t(a,s,c[2])||y!==$t(a,s,c[3])}function Jd(a,s,c){const d=s.paint.get(a).value;return"constant"===d.kind?d.value:c.programConfigurations.get(s.id).getMaxValue(a)}function jp(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Qd(a,s,c,d,m){if(!s[0]&&!s[1])return a;const y=Ae.convert(s)._mult(m);"viewport"===c&&y._rotate(-d);const b=[];for(let C=0;C<a.length;C++)b.push(a[C].sub(y));return b}let ws,Il;Zt("CircleBucket",$p,{omit:["layers"]});var Bg={get paint(){return Il=Il||new D({"circle-radius":new u(ve.paint_circle["circle-radius"]),"circle-color":new u(ve.paint_circle["circle-color"]),"circle-blur":new u(ve.paint_circle["circle-blur"]),"circle-opacity":new u(ve.paint_circle["circle-opacity"]),"circle-translate":new o(ve.paint_circle["circle-translate"]),"circle-translate-anchor":new o(ve.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new o(ve.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new o(ve.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new u(ve.paint_circle["circle-stroke-width"]),"circle-stroke-color":new u(ve.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new u(ve.paint_circle["circle-stroke-opacity"])})},get layout(){return ws=ws||new D({"circle-sort-key":new u(ve.layout_circle["circle-sort-key"])})}},bo=1e-6,Xs=typeof Float32Array<"u"?Float32Array:Array;function Up(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Hp(a,s,c){var d=s[0],m=s[1],y=s[2],b=s[3],C=s[4],I=s[5],M=s[6],O=s[7],F=s[8],j=s[9],q=s[10],Y=s[11],ee=s[12],le=s[13],ye=s[14],Fe=s[15],Ie=c[0],Re=c[1],Ge=c[2],Ct=c[3];return a[0]=Ie*d+Re*C+Ge*F+Ct*ee,a[1]=Ie*m+Re*I+Ge*j+Ct*le,a[2]=Ie*y+Re*M+Ge*q+Ct*ye,a[3]=Ie*b+Re*O+Ge*Y+Ct*Fe,a[4]=(Ie=c[4])*d+(Re=c[5])*C+(Ge=c[6])*F+(Ct=c[7])*ee,a[5]=Ie*m+Re*I+Ge*j+Ct*le,a[6]=Ie*y+Re*M+Ge*q+Ct*ye,a[7]=Ie*b+Re*O+Ge*Y+Ct*Fe,a[8]=(Ie=c[8])*d+(Re=c[9])*C+(Ge=c[10])*F+(Ct=c[11])*ee,a[9]=Ie*m+Re*I+Ge*j+Ct*le,a[10]=Ie*y+Re*M+Ge*q+Ct*ye,a[11]=Ie*b+Re*O+Ge*Y+Ct*Fe,a[12]=(Ie=c[12])*d+(Re=c[13])*C+(Ge=c[14])*F+(Ct=c[15])*ee,a[13]=Ie*m+Re*I+Ge*j+Ct*le,a[14]=Ie*y+Re*M+Ge*q+Ct*ye,a[15]=Ie*b+Re*O+Ge*Y+Ct*Fe,a}Math.hypot||(Math.hypot=function(){for(var a=0,s=arguments.length;s--;)a+=arguments[s]*arguments[s];return Math.sqrt(a)});var eh,W_=Hp;function dd(a,s,c){var d=s[0],m=s[1],y=s[2],b=s[3];return a[0]=c[0]*d+c[4]*m+c[8]*y+c[12]*b,a[1]=c[1]*d+c[5]*m+c[9]*y+c[13]*b,a[2]=c[2]*d+c[6]*m+c[10]*y+c[14]*b,a[3]=c[3]*d+c[7]*m+c[11]*y+c[15]*b,a}eh=new Xs(4),Xs!=Float32Array&&(eh[0]=0,eh[1]=0,eh[2]=0,eh[3]=0);class qp extends A{constructor(s){super(s,Bg)}createBucket(s){return new $p(s)}queryRadius(s){const c=s;return Jd("circle-radius",this,c)+Jd("circle-stroke-width",this,c)+jp(this.paint.get("circle-translate"))}queryIntersectsFeature(s,c,d,m,y,b,C,I){const M=Qd(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,C),O=this.paint.get("circle-radius").evaluate(c,d)+this.paint.get("circle-stroke-width").evaluate(c,d),F="map"===this.paint.get("circle-pitch-alignment"),j=F?M:(ee=I,M.map(le=>Gp(le,ee))),q=F?O*C:O;var ee;for(const Y of m)for(const ee of Y){const le=F?ee:Gp(ee,I);let ye=q;const Fe=dd([],[ee.x,ee.y,0,1],I);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?ye*=Fe[3]/b.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(ye*=b.cameraToCenterDistance/Fe[3]),Dt(j,le,ye))return!0}return!1}}function Gp(a,s){const c=dd([],[a.x,a.y,0,1],s);return new Ae(c[0]/c[3],c[1]/c[3])}class nf extends $p{}let zg;Zt("HeatmapBucket",nf,{omit:["layers"]});var $g={get paint(){return zg=zg||new D({"heatmap-radius":new u(ve.paint_heatmap["heatmap-radius"]),"heatmap-weight":new u(ve.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new o(ve.paint_heatmap["heatmap-intensity"]),"heatmap-color":new _(ve.paint_heatmap["heatmap-color"]),"heatmap-opacity":new o(ve.paint_heatmap["heatmap-opacity"])})}};function th(a,{width:s,height:c},d,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==s*c*d)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${s*c*d}`)}else m=new Uint8Array(s*c*d);return a.width=s,a.height=c,a.data=m,a}function Wp(a,{width:s,height:c},d){if(s===a.width&&c===a.height)return;const m=th({},{width:s,height:c},d);rf(a,m,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,s),height:Math.min(a.height,c)},d),a.width=s,a.height=c,a.data=m.data}function rf(a,s,c,d,m,y){if(0===m.width||0===m.height)return s;if(m.width>a.width||m.height>a.height||c.x>a.width-m.width||c.y>a.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>s.width||m.height>s.height||d.x>s.width-m.width||d.y>s.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const b=a.data,C=s.data;if(b===C)throw new Error("srcData equals dstData, so image is already copied");for(let I=0;I<m.height;I++){const M=((c.y+I)*a.width+c.x)*y,O=((d.y+I)*s.width+d.x)*y;for(let F=0;F<m.width*y;F++)C[O+F]=b[M+F]}return s}class hd{constructor(s,c){th(this,s,1,c)}resize(s){Wp(this,s,1)}clone(){return new hd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,d,m,y){rf(s,c,d,m,y,1)}}class Ks{constructor(s,c){th(this,s,4,c)}resize(s){Wp(this,s,4)}replace(s,c){c?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new Ks({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,d,m,y){rf(s,c,d,m,y,4)}}function sf(a){const s={},c=a.resolution||256,d=a.clips?a.clips.length:1,m=a.image||new Ks({width:c,height:d});if(Math.log(c)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${c}`);const y=(b,C,I)=>{s[a.evaluationKey]=I;const M=a.expression.evaluate(s);m.data[b+C+0]=Math.floor(255*M.r/M.a),m.data[b+C+1]=Math.floor(255*M.g/M.a),m.data[b+C+2]=Math.floor(255*M.b/M.a),m.data[b+C+3]=Math.floor(255*M.a)};if(a.clips)for(let b=0,C=0;b<d;++b,C+=4*c)for(let I=0,M=0;I<c;I++,M+=4){const O=I/(c-1),{start:F,end:j}=a.clips[b];y(C,M,F*(1-O)+j*O)}else for(let b=0,C=0;b<c;b++,C+=4)y(0,C,b/(c-1));return m}Zt("AlphaImage",hd),Zt("RGBAImage",Ks);class Z_ extends A{createBucket(s){return new nf(s)}constructor(s){super(s,$g),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){"heatmap-color"===s&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=sf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let Vg;var Ns={get paint(){return Vg=Vg||new D({"hillshade-illumination-direction":new o(ve.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new o(ve.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new o(ve.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new o(ve.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new o(ve.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new o(ve.paint_hillshade["hillshade-accent-color"])})}};class Du extends A{constructor(s){super(s,Ns)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}const ao=W([{name:"a_pos",components:2,type:"Int16"}],4),{members:X_}=ao;function jg(a,s,c=2){const d=s&&s.length,m=d?s[0]*c:a.length;let y=Ug(a,0,m,c,!0);const b=[];if(!y||y.next===y.prev)return b;let C,I,M;if(d&&(y=function(O,F,j,q){const Y=[];for(let ee=0,le=F.length;ee<le;ee++){const ye=Ug(O,F[ee]*q,ee<le-1?F[ee+1]*q:O.length,q,!1);ye===ye.next&&(ye.steiner=!0),Y.push(qg(ye))}Y.sort(lf);for(let ee=0;ee<Y.length;ee++)j=cf(Y[ee],j);return j}(a,s,y,c)),a.length>80*c){C=1/0,I=1/0;let O=-1/0,F=-1/0;for(let j=c;j<m;j+=c){const q=a[j],Y=a[j+1];q<C&&(C=q),Y<I&&(I=Y),q>O&&(O=q),Y>F&&(F=Y)}M=Math.max(O-C,F-I),M=0!==M?32767/M:0}return fd(y,b,c,C,I,M,0),b}function Ug(a,s,c,d,m){let y;if(m===function(b,C,I,M){let O=0;for(let F=C,j=I-M;F<I;F+=M)O+=(b[j]-b[F])*(b[F+1]+b[j+1]),j=F;return O}(a,s,c,d)>0)for(let b=s;b<c;b+=d)y=Zg(b/d|0,a[b],a[b+1],y);else for(let b=c-d;b>=s;b-=d)y=Zg(b/d|0,a[b],a[b+1],y);return y&&Wc(y,y.next)&&(hf(y),y=y.next),y}function Eu(a,s){if(!a)return a;s||(s=a);let c,d=a;do{if(c=!1,d.steiner||!Wc(d,d.next)&&0!==Mr(d.prev,d,d.next))d=d.next;else{if(hf(d),d=s=d.prev,d===d.next)break;c=!0}}while(c||d!==s);return s}function fd(a,s,c,d,m,y,b){if(!a)return;!b&&y&&function(I,M,O,F){let j=I;do{0===j.z&&(j.z=nh(j.x,j.y,M,O,F)),j.prevZ=j.prev,j.nextZ=j.next,j=j.next}while(j!==I);j.prevZ.nextZ=null,j.prevZ=null,function(q){let Y,ee=1;do{let le,ye=q;q=null;let Fe=null;for(Y=0;ye;){Y++;let Ie=ye,Re=0;for(let Ct=0;Ct<ee&&(Re++,Ie=Ie.nextZ,Ie);Ct++);let Ge=ee;for(;Re>0||Ge>0&&Ie;)0!==Re&&(0===Ge||!Ie||ye.z<=Ie.z)?(le=ye,ye=ye.nextZ,Re--):(le=Ie,Ie=Ie.nextZ,Ge--),Fe?Fe.nextZ=le:q=le,le.prevZ=Fe,Fe=le;ye=Ie}Fe.nextZ=null,ee*=2}while(Y>1)}(j)}(a,d,m,y);let C=a;for(;a.prev!==a.next;){const I=a.prev,M=a.next;if(y?af(a,d,m,y):Hg(a))s.push(I.i,a.i,M.i),hf(a),a=M.next,C=M.next;else if((a=M)===C){b?1===b?fd(a=Gc(Eu(a),s),s,c,d,m,y,2):2===b&&K_(a,s,c,d,m,y):fd(Eu(a),s,c,d,m,y,1);break}}}function Hg(a){const s=a.prev,c=a,d=a.next;if(Mr(s,c,d)>=0)return!1;const m=s.x,y=c.x,b=d.x,C=s.y,I=c.y,M=d.y,O=m<y?m<b?m:b:y<b?y:b,F=C<I?C<M?C:M:I<M?I:M,j=m>y?m>b?m:b:y>b?y:b,q=C>I?C>M?C:M:I>M?I:M;let Y=d.next;for(;Y!==s;){if(Y.x>=O&&Y.x<=j&&Y.y>=F&&Y.y<=q&&Iu(m,C,y,I,b,M,Y.x,Y.y)&&Mr(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function af(a,s,c,d){const m=a.prev,y=a,b=a.next;if(Mr(m,y,b)>=0)return!1;const C=m.x,I=y.x,M=b.x,O=m.y,F=y.y,j=b.y,q=C<I?C<M?C:M:I<M?I:M,Y=O<F?O<j?O:j:F<j?F:j,ee=C>I?C>M?C:M:I>M?I:M,le=O>F?O>j?O:j:F>j?F:j,ye=nh(q,Y,s,c,d),Fe=nh(ee,le,s,c,d);let Ie=a.prevZ,Re=a.nextZ;for(;Ie&&Ie.z>=ye&&Re&&Re.z<=Fe;){if(Ie.x>=q&&Ie.x<=ee&&Ie.y>=Y&&Ie.y<=le&&Ie!==m&&Ie!==b&&Iu(C,O,I,F,M,j,Ie.x,Ie.y)&&Mr(Ie.prev,Ie,Ie.next)>=0||(Ie=Ie.prevZ,Re.x>=q&&Re.x<=ee&&Re.y>=Y&&Re.y<=le&&Re!==m&&Re!==b&&Iu(C,O,I,F,M,j,Re.x,Re.y)&&Mr(Re.prev,Re,Re.next)>=0))return!1;Re=Re.nextZ}for(;Ie&&Ie.z>=ye;){if(Ie.x>=q&&Ie.x<=ee&&Ie.y>=Y&&Ie.y<=le&&Ie!==m&&Ie!==b&&Iu(C,O,I,F,M,j,Ie.x,Ie.y)&&Mr(Ie.prev,Ie,Ie.next)>=0)return!1;Ie=Ie.prevZ}for(;Re&&Re.z<=Fe;){if(Re.x>=q&&Re.x<=ee&&Re.y>=Y&&Re.y<=le&&Re!==m&&Re!==b&&Iu(C,O,I,F,M,j,Re.x,Re.y)&&Mr(Re.prev,Re,Re.next)>=0)return!1;Re=Re.nextZ}return!0}function Gc(a,s){let c=a;do{const d=c.prev,m=c.next.next;!Wc(d,m)&&Gg(d,c,c.next,m)&&df(d,m)&&df(m,d)&&(s.push(d.i,c.i,m.i),hf(c),hf(c.next),c=a=m),c=c.next}while(c!==a);return Eu(c)}function K_(a,s,c,d,m,y){let b=a;do{let C=b.next.next;for(;C!==b.prev;){if(b.i!==C.i&&Y_(b,C)){let I=Wg(b,C);return b=Eu(b,b.next),I=Eu(I,I.next),fd(b,s,c,d,m,y,0),void fd(I,s,c,d,m,y,0)}C=C.next}b=b.next}while(b!==a)}function lf(a,s){return a.x-s.x}function cf(a,s){const c=function(m,y){let b=y;const C=m.x,I=m.y;let M,O=-1/0;do{if(I<=b.y&&I>=b.next.y&&b.next.y!==b.y){const ee=b.x+(I-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(ee<=C&&ee>O&&(O=ee,M=b.x<b.next.x?b:b.next,ee===C))return M}b=b.next}while(b!==y);if(!M)return null;const F=M,j=M.x,q=M.y;let Y=1/0;b=M;do{if(C>=b.x&&b.x>=j&&C!==b.x&&Iu(I<q?C:O,I,j,q,I<q?O:C,I,b.x,b.y)){const ee=Math.abs(I-b.y)/(C-b.x);df(b,m)&&(ee<Y||ee===Y&&(b.x>M.x||b.x===M.x&&uf(M,b)))&&(M=b,Y=ee)}b=b.next}while(b!==F);return M}(a,s);if(!c)return s;const d=Wg(c,a);return Eu(d,d.next),Eu(c,c.next)}function uf(a,s){return Mr(a.prev,a,s.prev)<0&&Mr(s.next,a,a.next)<0}function nh(a,s,c,d,m){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-c)*m|0)|a<<8))|a<<4))|a<<2))|a<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-d)*m|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function qg(a){let s=a,c=a;do{(s.x<c.x||s.x===c.x&&s.y<c.y)&&(c=s),s=s.next}while(s!==a);return c}function Iu(a,s,c,d,m,y,b,C){return(m-b)*(s-C)>=(a-b)*(y-C)&&(a-b)*(d-C)>=(c-b)*(s-C)&&(c-b)*(y-C)>=(m-b)*(d-C)}function Y_(a,s){return a.next.i!==s.i&&a.prev.i!==s.i&&!function(c,d){let m=c;do{if(m.i!==c.i&&m.next.i!==c.i&&m.i!==d.i&&m.next.i!==d.i&&Gg(m,m.next,c,d))return!0;m=m.next}while(m!==c);return!1}(a,s)&&(df(a,s)&&df(s,a)&&function(c,d){let m=c,y=!1;const b=(c.x+d.x)/2,C=(c.y+d.y)/2;do{m.y>C!=m.next.y>C&&m.next.y!==m.y&&b<(m.next.x-m.x)*(C-m.y)/(m.next.y-m.y)+m.x&&(y=!y),m=m.next}while(m!==c);return y}(a,s)&&(Mr(a.prev,a,s.prev)||Mr(a,s.prev,s))||Wc(a,s)&&Mr(a.prev,a,a.next)>0&&Mr(s.prev,s,s.next)>0)}function Mr(a,s,c){return(s.y-a.y)*(c.x-s.x)-(s.x-a.x)*(c.y-s.y)}function Wc(a,s){return a.x===s.x&&a.y===s.y}function Gg(a,s,c,d){const m=pd(Mr(a,s,c)),y=pd(Mr(a,s,d)),b=pd(Mr(c,d,a)),C=pd(Mr(c,d,s));return m!==y&&b!==C||!(0!==m||!Zp(a,c,s))||!(0!==y||!Zp(a,d,s))||!(0!==b||!Zp(c,a,d))||!(0!==C||!Zp(c,s,d))}function Zp(a,s,c){return s.x<=Math.max(a.x,c.x)&&s.x>=Math.min(a.x,c.x)&&s.y<=Math.max(a.y,c.y)&&s.y>=Math.min(a.y,c.y)}function pd(a){return a>0?1:a<0?-1:0}function df(a,s){return Mr(a.prev,a,a.next)<0?Mr(a,s,a.next)>=0&&Mr(a,a.prev,s)>=0:Mr(a,s,a.prev)<0||Mr(a,a.next,s)<0}function Wg(a,s){const c=Xg(a.i,a.x,a.y),d=Xg(s.i,s.x,s.y),m=a.next,y=s.prev;return a.next=s,s.prev=a,c.next=m,m.prev=c,d.next=c,c.prev=d,y.next=d,d.prev=y,d}function Zg(a,s,c,d){const m=Xg(a,s,c);return d?(m.next=d.next,m.prev=d,d.next.prev=m,d.next=m):(m.prev=m,m.next=m),m}function hf(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Xg(a,s,c){return{i:a,x:s,y:c,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function ih(a,s,c){const d=c.patternDependencies;let m=!1;for(const y of s){const b=y.paint.get(`${a}-pattern`);b.isConstant()||(m=!0);const C=b.constantOr(null);C&&(m=!0,d[C.to]=!0,d[C.from]=!0)}return m}function Su(a,s,c,d,m){const y=m.patternDependencies;for(const b of s){const C=b.paint.get(`${a}-pattern`).value;if("constant"!==C.kind){let I=C.evaluate({zoom:d-1},c,{},m.availableImages),M=C.evaluate({zoom:d},c,{},m.availableImages),O=C.evaluate({zoom:d+1},c,{},m.availableImages);I=I&&I.name?I.name:I,M=M&&M.name?M.name:M,O=O&&O.name?O.name:O,y[I]=!0,y[M]=!0,y[O]=!0,c.patterns[b.id]={min:I,mid:M,max:O}}}return c}class Xp{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Yd,this.indexArray=new Dl,this.indexArray2=new yu,this.programConfigurations=new ld(s.layers,s.zoom),this.segments=new Oo,this.segments2=new Oo,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,d){this.hasPattern=ih("fill",this.layers,c);const m=this.layers[0].layout.get("fill-sort-key"),y=!m.isConstant(),b=[];for(const{feature:C,id:I,index:M,sourceLayerIndex:O}of s){const F=this.layers[0]._featureFilter.needGeometry,j=Cu(C,F);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),j,d))continue;const q=y?m.evaluate(j,{},d,c.availableImages):void 0,Y={id:I,properties:C.properties,type:C.type,sourceLayerIndex:O,index:M,geometry:F?j.geometry:xu(C),patterns:{},sortKey:q};b.push(Y)}y&&b.sort((C,I)=>C.sortKey-I.sortKey);for(const C of b){const{geometry:I,index:M,sourceLayerIndex:O}=C;if(this.hasPattern){const F=Su("fill",this.layers,C,this.zoom,c);this.patternFeatures.push(F)}else this.addFeature(C,I,M,d,{});c.featureIndex.insert(s[M].feature,I,M,O,this.index)}}update(s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d)}addFeatures(s,c,d){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,X_),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,c,d,m,y){for(const b of Xi(c,500)){let C=0;for(const q of b)C+=q.length;const I=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray),M=I.vertexLength,O=[],F=[];for(const q of b){if(0===q.length)continue;q!==b[0]&&F.push(O.length/2);const Y=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),ee=Y.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack(ee+q.length-1,ee),O.push(q[0].x),O.push(q[0].y);for(let le=1;le<q.length;le++)this.layoutVertexArray.emplaceBack(q[le].x,q[le].y),this.indexArray2.emplaceBack(ee+le-1,ee+le),O.push(q[le].x),O.push(q[le].y);Y.vertexLength+=q.length,Y.primitiveLength+=q.length}const j=jg(O,F);for(let q=0;q<j.length;q+=3)this.indexArray.emplaceBack(M+j[q],M+j[q+1],M+j[q+2]);I.vertexLength+=C,I.primitiveLength+=j.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,y,m)}}let md,ff;Zt("FillBucket",Xp,{omit:["layers","patternFeatures"]});var pf={get paint(){return ff=ff||new D({"fill-antialias":new o(ve.paint_fill["fill-antialias"]),"fill-opacity":new u(ve.paint_fill["fill-opacity"]),"fill-color":new u(ve.paint_fill["fill-color"]),"fill-outline-color":new u(ve.paint_fill["fill-outline-color"]),"fill-translate":new o(ve.paint_fill["fill-translate"]),"fill-translate-anchor":new o(ve.paint_fill["fill-translate-anchor"]),"fill-pattern":new f(ve.paint_fill["fill-pattern"])})},get layout(){return md=md||new D({"fill-sort-key":new u(ve.layout_fill["fill-sort-key"])})}};class HC extends A{constructor(s){super(s,pf)}recalculate(s,c){super.recalculate(s,c);const d=this.paint._values["fill-outline-color"];"constant"===d.value.kind&&void 0===d.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new Xp(s)}queryRadius(){return jp(this.paint.get("fill-translate"))}queryIntersectsFeature(s,c,d,m,y,b,C){return Wi(Qd(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,C),m)}isTileClipped(){return!0}}const Kg=W([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Yg=W([{name:"a_centroid",components:2,type:"Int16"}],4),{members:J_}=Kg;var as={},Q_=hn,rh=Zc;function Zc(a,s,c,d,m){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=m,a.readFields(Jg,this,s)}function Jg(a,s,c){1==a?s.id=c.readVarint():2==a?function(d,m){for(var y=d.readVarint()+d.pos;d.pos<y;){var b=m._keys[d.readVarint()],C=m._values[d.readVarint()];m.properties[b]=C}}(c,s):3==a?s.type=c.readVarint():4==a&&(s._geometry=c.pos)}function mf(a){for(var s,c,d=0,m=0,y=a.length,b=y-1;m<y;b=m++)d+=((c=a[b]).x-(s=a[m]).x)*(s.y+c.y);return d}Zc.types=["Unknown","Point","LineString","Polygon"],Zc.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var s,c=a.readVarint()+a.pos,d=1,m=0,y=0,b=0,C=[];a.pos<c;){if(m<=0){var I=a.readVarint();d=7&I,m=I>>3}if(m--,1===d||2===d)y+=a.readSVarint(),b+=a.readSVarint(),1===d&&(s&&C.push(s),s=[]),s.push(new Q_(y,b));else{if(7!==d)throw new Error("unknown command "+d);s&&s.push(s[0].clone())}}return s&&C.push(s),C},Zc.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var s=a.readVarint()+a.pos,c=1,d=0,m=0,y=0,b=1/0,C=-1/0,I=1/0,M=-1/0;a.pos<s;){if(d<=0){var O=a.readVarint();c=7&O,d=O>>3}if(d--,1===c||2===c)(m+=a.readSVarint())<b&&(b=m),m>C&&(C=m),(y+=a.readSVarint())<I&&(I=y),y>M&&(M=y);else if(7!==c)throw new Error("unknown command "+c)}return[b,I,C,M]},Zc.prototype.toGeoJSON=function(a,s,c){var d,m,y=this.extent*Math.pow(2,c),b=this.extent*a,C=this.extent*s,I=this.loadGeometry(),M=Zc.types[this.type];function O(q){for(var Y=0;Y<q.length;Y++){var ee=q[Y];q[Y]=[360*(ee.x+b)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(ee.y+C)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var F=[];for(d=0;d<I.length;d++)F[d]=I[d][0];O(I=F);break;case 2:for(d=0;d<I.length;d++)O(I[d]);break;case 3:for(I=function(q){var Y=q.length;if(Y<=1)return[q];for(var ee,le,ye=[],Fe=0;Fe<Y;Fe++){var Ie=mf(q[Fe]);0!==Ie&&(void 0===le&&(le=Ie<0),le===Ie<0?(ee&&ye.push(ee),ee=[q[Fe]]):ee.push(q[Fe]))}return ee&&ye.push(ee),ye}(I),d=0;d<I.length;d++)for(m=0;m<I[d].length;m++)O(I[d][m])}1===I.length?I=I[0]:M="Multi"+M;var j={type:"Feature",geometry:{type:M,coordinates:I},properties:this.properties};return"id"in this&&(j.id=this.id),j};var Kp=rh,Qg=Yp;function Yp(a,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(ey,this,s),this.length=this._features.length}function ey(a,s,c){15===a?s.version=c.readVarint():1===a?s.name=c.readString():5===a?s.extent=c.readVarint():2===a?s._features.push(c.pos):3===a?s._keys.push(c.readString()):4===a&&s._values.push(function(d){for(var m=null,y=d.readVarint()+d.pos;d.pos<y;){var b=d.readVarint()>>3;m=1===b?d.readString():2===b?d.readFloat():3===b?d.readDouble():4===b?d.readVarint64():5===b?d.readVarint():6===b?d.readSVarint():7===b?d.readBoolean():null}return m}(c))}Yp.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var s=this._pbf.readVarint()+this._pbf.pos;return new Kp(this._pbf,s,this.extent,this._keys,this._values)};var ty=Qg;function ny(a,s,c){if(3===a){var d=new ty(c,c.readVarint()+c.pos);d.length&&(s[d.name]=d)}}as.VectorTile=function(a,s){this.layers=a.readFields(ny,{},s)},as.VectorTileFeature=rh,as.VectorTileLayer=Qg;const eb=as.VectorTileFeature.types,gd=Math.pow(2,13);function Ya(a,s,c,d,m,y,b,C){a.emplaceBack(s,c,2*Math.floor(d*gd)+b,m*gd*2,y*gd*2,Math.round(C))}class Jp{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Gs,this.centroidVertexArray=new Za,this.indexArray=new Dl,this.programConfigurations=new ld(s.layers,s.zoom),this.segments=new Oo,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,d){this.features=[],this.hasPattern=ih("fill-extrusion",this.layers,c);for(const{feature:m,id:y,index:b,sourceLayerIndex:C}of s){const I=this.layers[0]._featureFilter.needGeometry,M=Cu(m,I);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),M,d))continue;const O={id:y,sourceLayerIndex:C,index:b,geometry:I?M.geometry:xu(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(Su("fill-extrusion",this.layers,O,this.zoom,c)):this.addFeature(O,O.geometry,b,d,{}),c.featureIndex.insert(m,O.geometry,b,C,this.index,!0)}}addFeatures(s,c,d){for(const m of this.features){const{geometry:y}=m;this.addFeature(m,y,m.index,c,d)}}update(s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,J_),this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,Yg.members,!0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(s,c,d,m,y){for(const b of Xi(c,500)){const C={x:0,y:0,vertexCount:0};let I=0;for(const Y of b)I+=Y.length;let M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const Y of b){if(0===Y.length||((a=Y).every(s=>s.x<0)||a.every(s=>s.x>fo)||a.every(s=>s.y<0)||a.every(s=>s.y>fo)))continue;let ee=0;for(let le=0;le<Y.length;le++){const ye=Y[le];if(le>=1){const Fe=Y[le-1];if(!iy(ye,Fe)){M.vertexLength+4>Oo.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ie=ye.sub(Fe)._perp()._unit(),Re=Fe.dist(ye);ee+Re>32768&&(ee=0),Ya(this.layoutVertexArray,ye.x,ye.y,Ie.x,Ie.y,0,0,ee),Ya(this.layoutVertexArray,ye.x,ye.y,Ie.x,Ie.y,0,1,ee),C.x+=2*ye.x,C.y+=2*ye.y,C.vertexCount+=2,ee+=Re,Ya(this.layoutVertexArray,Fe.x,Fe.y,Ie.x,Ie.y,0,0,ee),Ya(this.layoutVertexArray,Fe.x,Fe.y,Ie.x,Ie.y,0,1,ee),C.x+=2*Fe.x,C.y+=2*Fe.y,C.vertexCount+=2;const Ge=M.vertexLength;this.indexArray.emplaceBack(Ge,Ge+2,Ge+1),this.indexArray.emplaceBack(Ge+1,Ge+2,Ge+3),M.vertexLength+=4,M.primitiveLength+=2}}}}if(M.vertexLength+I>Oo.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),"Polygon"!==eb[s.type])continue;const O=[],F=[],j=M.vertexLength;for(const Y of b)if(0!==Y.length){Y!==b[0]&&F.push(O.length/2);for(let ee=0;ee<Y.length;ee++){const le=Y[ee];Ya(this.layoutVertexArray,le.x,le.y,0,0,1,1,0),C.x+=le.x,C.y+=le.y,C.vertexCount+=1,O.push(le.x),O.push(le.y)}}const q=jg(O,F);for(let Y=0;Y<q.length;Y+=3)this.indexArray.emplaceBack(j+q[Y],j+q[Y+2],j+q[Y+1]);M.primitiveLength+=q.length/3,M.vertexLength+=I;for(let Y=0;Y<C.vertexCount;Y++){const ee=Math.floor(C.x/C.vertexCount),le=Math.floor(C.y/C.vertexCount);this.centroidVertexArray.emplaceBack(ee,le)}}var a;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,y,m)}}function iy(a,s){return a.x===s.x&&(a.x<0||a.x>fo)||a.y===s.y&&(a.y<0||a.y>fo)}let yd;Zt("FillExtrusionBucket",Jp,{omit:["layers","features"]});var tb={get paint(){return yd=yd||new D({"fill-extrusion-opacity":new o(ve["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new u(ve["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new o(ve["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new o(ve["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new f(ve["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new u(ve["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new u(ve["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new o(ve["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Bs extends A{constructor(s){super(s,tb)}createBucket(s){return new Jp(s)}queryRadius(){return jp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(s,c,d,m,y,b,C,I){const M=Qd(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,C),O=this.paint.get("fill-extrusion-height").evaluate(c,d),F=this.paint.get("fill-extrusion-base").evaluate(c,d),j=function(Y,ee,le,ye){const Fe=[];for(const Ie of Y){const Re=[Ie.x,Ie.y,0,1];dd(Re,Re,ee),Fe.push(new Ae(Re[0]/Re[3],Re[1]/Re[3]))}return Fe}(M,I),q=function(Y,ee,le,ye){const Fe=[],Ie=[],Re=ye[8]*ee,Ge=ye[9]*ee,Ct=ye[10]*ee,un=ye[11]*ee,Rn=ye[8]*le,Jt=ye[9]*le,Gt=ye[10]*le,Sn=ye[11]*le;for(const xn of Y){const vn=[],tt=[];for(const Mn of xn){const Tn=Mn.x,Qn=Mn.y,gr=ye[0]*Tn+ye[4]*Qn+ye[12],ar=ye[1]*Tn+ye[5]*Qn+ye[13],nr=ye[2]*Tn+ye[6]*Qn+ye[14],xo=ye[3]*Tn+ye[7]*Qn+ye[15],Ho=nr+Ct,Mo=xo+un,Cs=gr+Rn,Ds=ar+Jt,Es=nr+Gt,Kr=xo+Sn,Co=new Ae((gr+Re)/Mo,(ar+Ge)/Mo);Co.z=Ho/Mo,vn.push(Co);const ls=new Ae(Cs/Kr,Ds/Kr);ls.z=Es/Kr,tt.push(ls)}Fe.push(vn),Ie.push(tt)}return[Fe,Ie]}(m,F,O,I);return function(Y,ee,le){let ye=1/0;Wi(le,ee)&&(ye=Gr(le,ee[0]));for(let Fe=0;Fe<ee.length;Fe++){const Ie=ee[Fe],Re=Y[Fe];for(let Ge=0;Ge<Ie.length-1;Ge++){const Ct=Ie[Ge],un=[Ct,Ie[Ge+1],Re[Ge+1],Re[Ge],Ct];Ng(le,un)&&(ye=Math.min(ye,Gr(le,un)))}}return ye!==1/0&&ye}(q[0],q[1],j)}}function oh(a,s){return a.x*s.x+a.y*s.y}function Gr(a,s){if(1===a.length){let c=0;const d=s[c++];let m;for(;!m||d.equals(m);)if(m=s[c++],!m)return 1/0;for(;c<s.length;c++){const y=s[c],b=a[0],C=m.sub(d),I=y.sub(d),M=b.sub(d),O=oh(C,C),F=oh(C,I),j=oh(I,I),q=oh(M,C),Y=oh(M,I),ee=O*j-F*F,le=(j*q-F*Y)/ee,ye=(O*Y-F*q)/ee,Fe=d.z*(1-le-ye)+m.z*le+y.z*ye;if(isFinite(Fe))return Fe}return 1/0}{let c=1/0;for(const d of s)c=Math.min(c,d.z);return c}}const Qp=W([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:nb}=Qp,oy=W([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Xc}=oy,vd=as.VectorTileFeature.types,_d=Math.cos(Math.PI/180*37.5),Tu=Math.pow(2,14)/.5;class gf{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new Ws,this.layoutVertexArray2=new Cl,this.indexArray=new Dl,this.programConfigurations=new ld(s.layers,s.zoom),this.segments=new Oo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,d){this.hasPattern=ih("line",this.layers,c);const m=this.layers[0].layout.get("line-sort-key"),y=!m.isConstant(),b=[];for(const{feature:C,id:I,index:M,sourceLayerIndex:O}of s){const F=this.layers[0]._featureFilter.needGeometry,j=Cu(C,F);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),j,d))continue;const q=y?m.evaluate(j,{},d):void 0,Y={id:I,properties:C.properties,type:C.type,sourceLayerIndex:O,index:M,geometry:F?j.geometry:xu(C),patterns:{},sortKey:q};b.push(Y)}y&&b.sort((C,I)=>C.sortKey-I.sortKey);for(const C of b){const{geometry:I,index:M,sourceLayerIndex:O}=C;if(this.hasPattern){const F=Su("line",this.layers,C,this.zoom,c);this.patternFeatures.push(F)}else this.addFeature(C,I,M,d,{});c.featureIndex.insert(s[M].feature,I,M,O,this.index)}}update(s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d)}addFeatures(s,c,d){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,Xc)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,nb),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,c,d,m,y){const b=this.layers[0].layout,C=b.get("line-join").evaluate(s,{}),I=b.get("line-cap"),M=b.get("line-miter-limit"),O=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const F of c)this.addLine(F,s,C,I,M,O);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,y,m)}addLine(s,c,d,m,y,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ye=0;ye<s.length-1;ye++)this.totalDistance+=s[ye].dist(s[ye+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C="Polygon"===vd[c.type];let I=s.length;for(;I>=2&&s[I-1].equals(s[I-2]);)I--;let M=0;for(;M<I-1&&s[M].equals(s[M+1]);)M++;if(I<(C?3:2))return;"bevel"===d&&(y=1.05);const O=this.overscaling<=16?15*fo/(512*this.overscaling):0,F=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray);let j,q,Y,ee,le;this.e1=this.e2=-1,C&&(j=s[I-2],le=s[M].sub(j)._unit()._perp());for(let ye=M;ye<I;ye++){if(Y=ye===I-1?C?s[M+1]:void 0:s[ye+1],Y&&s[ye].equals(Y))continue;le&&(ee=le),j&&(q=j),j=s[ye],le=Y?Y.sub(j)._unit()._perp():ee,ee=ee||le;let Fe=ee.add(le);0===Fe.x&&0===Fe.y||Fe._unit();const Ie=ee.x*le.x+ee.y*le.y,Re=Fe.x*le.x+Fe.y*le.y,Ge=0!==Re?1/Re:1/0,Ct=2*Math.sqrt(2-2*Re),un=Re<_d&&q&&Y,Rn=ee.x*le.y-ee.y*le.x>0;if(un&&ye>M){const Sn=j.dist(q);if(Sn>2*O){const xn=j.sub(j.sub(q)._mult(O/Sn)._round());this.updateDistance(q,xn),this.addCurrentVertex(xn,ee,0,0,F),q=xn}}const Jt=q&&Y;let Gt=Jt?d:C?"butt":m;if(Jt&&"round"===Gt&&(Ge<b?Gt="miter":Ge<=2&&(Gt="fakeround")),"miter"===Gt&&Ge>y&&(Gt="bevel"),"bevel"===Gt&&(Ge>2&&(Gt="flipbevel"),Ge<y&&(Gt="miter")),q&&this.updateDistance(q,j),"miter"===Gt)Fe._mult(Ge),this.addCurrentVertex(j,Fe,0,0,F);else if("flipbevel"===Gt){if(Ge>100)Fe=le.mult(-1);else{const Sn=Ge*ee.add(le).mag()/ee.sub(le).mag();Fe._perp()._mult(Sn*(Rn?-1:1))}this.addCurrentVertex(j,Fe,0,0,F),this.addCurrentVertex(j,Fe.mult(-1),0,0,F)}else if("bevel"===Gt||"fakeround"===Gt){const Sn=-Math.sqrt(Ge*Ge-1),xn=Rn?Sn:0,vn=Rn?0:Sn;if(q&&this.addCurrentVertex(j,ee,xn,vn,F),"fakeround"===Gt){const tt=Math.round(180*Ct/Math.PI/20);for(let Mn=1;Mn<tt;Mn++){let Tn=Mn/tt;if(.5!==Tn){const gr=Tn-.5;Tn+=Tn*gr*(Tn-1)*((1.0904+Ie*(Ie*(3.55645-1.43519*Ie)-3.2452))*gr*gr+(.848013+Ie*(.215638*Ie-1.06021)))}const Qn=le.sub(ee)._mult(Tn)._add(ee)._unit()._mult(Rn?-1:1);this.addHalfVertex(j,Qn.x,Qn.y,!1,Rn,0,F)}}Y&&this.addCurrentVertex(j,le,-xn,-vn,F)}else if("butt"===Gt)this.addCurrentVertex(j,Fe,0,0,F);else if("square"===Gt){const Sn=q?1:-1;this.addCurrentVertex(j,Fe,Sn,Sn,F)}else"round"===Gt&&(q&&(this.addCurrentVertex(j,ee,0,0,F),this.addCurrentVertex(j,ee,1,1,F,!0)),Y&&(this.addCurrentVertex(j,le,-1,-1,F,!0),this.addCurrentVertex(j,le,0,0,F)));if(un&&ye<I-1){const Sn=j.dist(Y);if(Sn>2*O){const xn=j.add(Y.sub(j)._mult(O/Sn)._round());this.updateDistance(j,xn),this.addCurrentVertex(xn,le,0,0,F),j=xn}}}}addCurrentVertex(s,c,d,m,y,b=!1){const C=c.y*m-c.x,I=-c.y-c.x*m;this.addHalfVertex(s,c.x+c.y*d,c.y-c.x*d,b,!1,d,y),this.addHalfVertex(s,C,I,b,!0,-m,y),this.distance>Tu/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(s,c,d,m,y,b))}addHalfVertex({x:s,y:c},d,m,y,b,C,I){const M=.5*(this.lineClips?this.scaledDistance*(Tu-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(y?1:0),(c<<1)+(b?1:0),Math.round(63*d)+128,Math.round(63*m)+128,1+(0===C?0:C<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const O=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,O),I.primitiveLength++),b?this.e2=O:this.e1=O}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(s,c){this.distance+=s.dist(c),this.updateScaledDistance()}}let yf,Au;Zt("LineBucket",gf,{omit:["layers","patternFeatures"]});var ib={get paint(){return Au=Au||new D({"line-opacity":new u(ve.paint_line["line-opacity"]),"line-color":new u(ve.paint_line["line-color"]),"line-translate":new o(ve.paint_line["line-translate"]),"line-translate-anchor":new o(ve.paint_line["line-translate-anchor"]),"line-width":new u(ve.paint_line["line-width"]),"line-gap-width":new u(ve.paint_line["line-gap-width"]),"line-offset":new u(ve.paint_line["line-offset"]),"line-blur":new u(ve.paint_line["line-blur"]),"line-dasharray":new p(ve.paint_line["line-dasharray"]),"line-pattern":new f(ve.paint_line["line-pattern"]),"line-gradient":new _(ve.paint_line["line-gradient"])})},get layout(){return yf=yf||new D({"line-cap":new o(ve.layout_line["line-cap"]),"line-join":new u(ve.layout_line["line-join"]),"line-miter-limit":new o(ve.layout_line["line-miter-limit"]),"line-round-limit":new o(ve.layout_line["line-round-limit"]),"line-sort-key":new u(ve.layout_line["line-sort-key"])})}};class rb extends u{possiblyEvaluate(s,c){return c=new sr(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),super.possiblyEvaluate(s,c)}evaluate(s,c,d,m){return c=Ze({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(s,c,d,m)}}let em;class qC extends A{constructor(s){super(s,ib),this.gradientVersion=0,em||(em=new rb(ib.paint.properties["line-width"].specification),em.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(s){if("line-gradient"===s){const c=this.gradientExpression();this.stepInterpolant=!(void 0===c._styleExpression)&&c._styleExpression.expression instanceof Un,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,c){super.recalculate(s,c),this.paint._values["line-floorwidth"]=em.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new gf(s)}queryRadius(s){const c=s,d=ob(Jd("line-width",this,c),Jd("line-gap-width",this,c)),m=Jd("line-offset",this,c);return d/2+Math.abs(m)+jp(this.paint.get("line-translate"))}queryIntersectsFeature(s,c,d,m,y,b,C){const I=Qd(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,C),M=C/2*ob(this.paint.get("line-width").evaluate(c,d),this.paint.get("line-gap-width").evaluate(c,d)),O=this.paint.get("line-offset").evaluate(c,d);return O&&(m=function(F,j){const q=[];for(let Y=0;Y<F.length;Y++){const ee=F[Y],le=[];for(let ye=0;ye<ee.length;ye++){const Fe=ee[ye-1],Ie=ee[ye],Re=ee[ye+1],Ge=0===ye?new Ae(0,0):Ie.sub(Fe)._unit()._perp(),Ct=ye===ee.length-1?new Ae(0,0):Re.sub(Ie)._unit()._perp(),un=Ge._add(Ct)._unit(),Rn=un.x*Ct.x+un.y*Ct.y;0!==Rn&&un._mult(1/Rn),le.push(un._mult(j)._add(Ie))}q.push(le)}return q}(m,O*C)),function(F,j,q){for(let Y=0;Y<j.length;Y++){const ee=j[Y];if(F.length>=3)for(let le=0;le<ee.length;le++)if(qc(F,ee[le]))return!0;if(ef(F,ee,q))return!0}return!1}(I,m,M)}isTileClipped(){return!0}}function ob(a,s){return s>0?s+2*a:a}const GC=W([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),WC=W([{name:"a_projected_pos",components:3,type:"Float32"}],4);W([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ZC=W([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);W([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Mu=W([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),sb=W([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ab(a,s,c){return a.sections.forEach(d=>{d.text=function(m,y,b){const C=y.layout.get("text-transform").evaluate(b,{});return"uppercase"===C?m=m.toLocaleUpperCase():"lowercase"===C&&(m=m.toLocaleLowerCase()),Ta.applyArabicShaping&&(m=Ta.applyArabicShaping(m)),m}(d.text,s,c)}),a}W([{name:"triangle",components:3,type:"Uint16"}]),W([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),W([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),W([{type:"Float32",name:"offsetX"}]),W([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),W([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const lo={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var wo=24,bd=ji,sy=function(a,s,c,d,m){var y,b,C=8*m-d-1,I=(1<<C)-1,M=I>>1,O=-7,F=c?m-1:0,j=c?-1:1,q=a[s+F];for(F+=j,y=q&(1<<-O)-1,q>>=-O,O+=C;O>0;y=256*y+a[s+F],F+=j,O-=8);for(b=y&(1<<-O)-1,y>>=-O,O+=d;O>0;b=256*b+a[s+F],F+=j,O-=8);if(0===y)y=1-M;else{if(y===I)return b?NaN:1/0*(q?-1:1);b+=Math.pow(2,d),y-=M}return(q?-1:1)*b*Math.pow(2,y-d)},fa=function(a,s,c,d,m,y){var b,C,I,M=8*y-m-1,O=(1<<M)-1,F=O>>1,j=23===m?Math.pow(2,-24)-Math.pow(2,-77):0,q=d?0:y-1,Y=d?1:-1,ee=s<0||0===s&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(C=isNaN(s)?1:0,b=O):(b=Math.floor(Math.log(s)/Math.LN2),s*(I=Math.pow(2,-b))<1&&(b--,I*=2),(s+=b+F>=1?j/I:j*Math.pow(2,1-F))*I>=2&&(b++,I/=2),b+F>=O?(C=0,b=O):b+F>=1?(C=(s*I-1)*Math.pow(2,m),b+=F):(C=s*Math.pow(2,F-1)*Math.pow(2,m),b=0));m>=8;a[c+q]=255&C,q+=Y,C/=256,m-=8);for(b=b<<m|C,M+=m;M>0;a[c+q]=255&b,q+=Y,b/=256,M-=8);a[c+q-Y]|=128*ee};function ji(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}ji.Varint=0,ji.Fixed64=1,ji.Bytes=2,ji.Fixed32=5;var vf=4294967296,sh=1/vf,wd=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function rc(a){return a.type===ji.Bytes?a.readVarint()+a.pos:a.pos+1}function ay(a,s,c){var d=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));c.realloc(d);for(var m=c.pos-1;m>=a;m--)c.buf[m+d]=c.buf[m]}function XC(a,s){for(var c=0;c<a.length;c++)s.writeVarint(a[c])}function pa(a,s){for(var c=0;c<a.length;c++)s.writeSVarint(a[c])}function tm(a,s){for(var c=0;c<a.length;c++)s.writeFloat(a[c])}function xd(a,s){for(var c=0;c<a.length;c++)s.writeDouble(a[c])}function KC(a,s){for(var c=0;c<a.length;c++)s.writeBoolean(a[c])}function ly(a,s){for(var c=0;c<a.length;c++)s.writeFixed32(a[c])}function lb(a,s){for(var c=0;c<a.length;c++)s.writeSFixed32(a[c])}function cb(a,s){for(var c=0;c<a.length;c++)s.writeFixed64(a[c])}function ub(a,s){for(var c=0;c<a.length;c++)s.writeSFixed64(a[c])}function _f(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16)+16777216*a[s+3]}function Cd(a,s,c){a[c]=s,a[c+1]=s>>>8,a[c+2]=s>>>16,a[c+3]=s>>>24}function cy(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16)+(a[s+3]<<24)}ji.prototype={destroy:function(){this.buf=null},readFields:function(a,s,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),m=d>>3,y=this.pos;this.type=7&d,a(m,s,this),this.pos===y&&this.skip(d)}return s},readMessage:function(a,s){return this.readFields(a,s,this.readVarint()+this.pos)},readFixed32:function(){var a=_f(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=cy(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=_f(this.buf,this.pos)+_f(this.buf,this.pos+4)*vf;return this.pos+=8,a},readSFixed64:function(){var a=_f(this.buf,this.pos)+cy(this.buf,this.pos+4)*vf;return this.pos+=8,a},readFloat:function(){var a=sy(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=sy(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var s,c,d=this.buf;return s=127&(c=d[this.pos++]),c<128?s:(s|=(127&(c=d[this.pos++]))<<7,c<128?s:(s|=(127&(c=d[this.pos++]))<<14,c<128?s:(s|=(127&(c=d[this.pos++]))<<21,c<128?s:function(m,y,b){var C,I,M=b.buf;if(C=(112&(I=M[b.pos++]))>>4,I<128||(C|=(127&(I=M[b.pos++]))<<3,I<128)||(C|=(127&(I=M[b.pos++]))<<10,I<128)||(C|=(127&(I=M[b.pos++]))<<17,I<128)||(C|=(127&(I=M[b.pos++]))<<24,I<128)||(C|=(1&(I=M[b.pos++]))<<31,I<128))return function ah(a,s,c){return c?4294967296*s+(a>>>0):4294967296*(s>>>0)+(a>>>0)}(m,C,y);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(c=d[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,s=this.pos;return this.pos=a,a-s>=12&&wd?wd.decode(this.buf.subarray(s,a)):function(c,d,m){for(var y="",b=d;b<m;){var C,I,M,O=c[b],F=null,j=O>239?4:O>223?3:O>191?2:1;if(b+j>m)break;1===j?O<128&&(F=O):2===j?128==(192&(C=c[b+1]))&&(F=(31&O)<<6|63&C)<=127&&(F=null):3===j?(I=c[b+2],128==(192&(C=c[b+1]))&&128==(192&I)&&((F=(15&O)<<12|(63&C)<<6|63&I)<=2047||F>=55296&&F<=57343)&&(F=null)):4===j&&(I=c[b+2],M=c[b+3],128==(192&(C=c[b+1]))&&128==(192&I)&&128==(192&M)&&((F=(15&O)<<18|(63&C)<<12|(63&I)<<6|63&M)<=65535||F>=1114112)&&(F=null)),null===F?(F=65533,j=1):F>65535&&(F-=65536,y+=String.fromCharCode(F>>>10&1023|55296),F=56320|1023&F),y+=String.fromCharCode(F),b+=j}return y}(this.buf,s,a)},readBytes:function(){var a=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,a);return this.pos=a,s},readPackedVarint:function(a,s){if(this.type!==ji.Bytes)return a.push(this.readVarint(s));var c=rc(this);for(a=a||[];this.pos<c;)a.push(this.readVarint(s));return a},readPackedSVarint:function(a){if(this.type!==ji.Bytes)return a.push(this.readSVarint());var s=rc(this);for(a=a||[];this.pos<s;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==ji.Bytes)return a.push(this.readBoolean());var s=rc(this);for(a=a||[];this.pos<s;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==ji.Bytes)return a.push(this.readFloat());var s=rc(this);for(a=a||[];this.pos<s;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==ji.Bytes)return a.push(this.readDouble());var s=rc(this);for(a=a||[];this.pos<s;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==ji.Bytes)return a.push(this.readFixed32());var s=rc(this);for(a=a||[];this.pos<s;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==ji.Bytes)return a.push(this.readSFixed32());var s=rc(this);for(a=a||[];this.pos<s;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==ji.Bytes)return a.push(this.readFixed64());var s=rc(this);for(a=a||[];this.pos<s;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==ji.Bytes)return a.push(this.readSFixed64());var s=rc(this);for(a=a||[];this.pos<s;)a.push(this.readSFixed64());return a},skip:function(a){var s=7&a;if(s===ji.Varint)for(;this.buf[this.pos++]>127;);else if(s===ji.Bytes)this.pos=this.readVarint()+this.pos;else if(s===ji.Fixed32)this.pos+=4;else{if(s!==ji.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(a,s){this.writeVarint(a<<3|s)},realloc:function(a){for(var s=this.length||16;s<this.pos+a;)s*=2;if(s!==this.length){var c=new Uint8Array(s);c.set(this.buf),this.buf=c,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Cd(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Cd(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Cd(this.buf,-1&a,this.pos),Cd(this.buf,Math.floor(a*sh),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Cd(this.buf,-1&a,this.pos),Cd(this.buf,Math.floor(a*sh),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(s,c){var d,m,y,C;if(s>=0?(d=s%4294967296|0,m=s/4294967296|0):(m=~(-s/4294967296),4294967295^(d=~(-s%4294967296))?d=d+1|0:(d=0,m=m+1|0)),s>=0x10000000000000000||s<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),y=d,(C=c).buf[C.pos++]=127&y|128,y>>>=7,C.buf[C.pos++]=127&y|128,y>>>=7,C.buf[C.pos++]=127&y|128,y>>>=7,C.buf[C.pos++]=127&y|128,C.buf[C.pos]=127&(y>>>=7),function(y,b){var C=(7&y)<<4;b.buf[b.pos++]|=C|((y>>>=3)?128:0),y&&(b.buf[b.pos++]=127&y|((y>>>=7)?128:0),y&&(b.buf[b.pos++]=127&y|((y>>>=7)?128:0),y&&(b.buf[b.pos++]=127&y|((y>>>=7)?128:0),y&&(b.buf[b.pos++]=127&y|((y>>>=7)?128:0),y&&(b.buf[b.pos++]=127&y)))))}(m,c)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var s=this.pos;this.pos=function(d,m,y){for(var b,C,I=0;I<m.length;I++){if((b=m.charCodeAt(I))>55295&&b<57344){if(!C){b>56319||I+1===m.length?(d[y++]=239,d[y++]=191,d[y++]=189):C=b;continue}if(b<56320){d[y++]=239,d[y++]=191,d[y++]=189,C=b;continue}b=C-55296<<10|b-56320|65536,C=null}else C&&(d[y++]=239,d[y++]=191,d[y++]=189,C=null);b<128?d[y++]=b:(b<2048?d[y++]=b>>6|192:(b<65536?d[y++]=b>>12|224:(d[y++]=b>>18|240,d[y++]=b>>12&63|128),d[y++]=b>>6&63|128),d[y++]=63&b|128)}return y}(this.buf,a,this.pos);var c=this.pos-s;c>=128&&ay(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeFloat:function(a){this.realloc(4),fa(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),fa(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var s=a.length;this.writeVarint(s),this.realloc(s);for(var c=0;c<s;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,s){this.pos++;var c=this.pos;a(s,this);var d=this.pos-c;d>=128&&ay(c,d,this),this.pos=c-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,s,c){this.writeTag(a,ji.Bytes),this.writeRawMessage(s,c)},writePackedVarint:function(a,s){s.length&&this.writeMessage(a,XC,s)},writePackedSVarint:function(a,s){s.length&&this.writeMessage(a,pa,s)},writePackedBoolean:function(a,s){s.length&&this.writeMessage(a,KC,s)},writePackedFloat:function(a,s){s.length&&this.writeMessage(a,tm,s)},writePackedDouble:function(a,s){s.length&&this.writeMessage(a,xd,s)},writePackedFixed32:function(a,s){s.length&&this.writeMessage(a,ly,s)},writePackedSFixed32:function(a,s){s.length&&this.writeMessage(a,lb,s)},writePackedFixed64:function(a,s){s.length&&this.writeMessage(a,cb,s)},writePackedSFixed64:function(a,s){s.length&&this.writeMessage(a,ub,s)},writeBytesField:function(a,s){this.writeTag(a,ji.Bytes),this.writeBytes(s)},writeFixed32Field:function(a,s){this.writeTag(a,ji.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(a,s){this.writeTag(a,ji.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(a,s){this.writeTag(a,ji.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(a,s){this.writeTag(a,ji.Fixed64),this.writeSFixed64(s)},writeVarintField:function(a,s){this.writeTag(a,ji.Varint),this.writeVarint(s)},writeSVarintField:function(a,s){this.writeTag(a,ji.Varint),this.writeSVarint(s)},writeStringField:function(a,s){this.writeTag(a,ji.Bytes),this.writeString(s)},writeFloatField:function(a,s){this.writeTag(a,ji.Fixed32),this.writeFloat(s)},writeDoubleField:function(a,s){this.writeTag(a,ji.Fixed64),this.writeDouble(s)},writeBooleanField:function(a,s){this.writeVarintField(a,!!s)}};var lh=an(bd);const Dd=3;function db(a,s,c){1===a&&c.readMessage(bf,s)}function bf(a,s,c){if(3===a){const{id:d,bitmap:m,width:y,height:b,left:C,top:I,advance:M}=c.readMessage(hb,{});s.push({id:d,bitmap:new hd({width:y+2*Dd,height:b+2*Dd},m),metrics:{width:y,height:b,left:C,top:I,advance:M}})}}function hb(a,s,c){1===a?s.id=c.readVarint():2===a?s.bitmap=c.readBytes():3===a?s.width=c.readVarint():4===a?s.height=c.readVarint():5===a?s.left=c.readSVarint():6===a?s.top=c.readSVarint():7===a&&(s.advance=c.readVarint())}const ch=Dd;function uy(a){let s=0,c=0;for(const b of a)s+=b.w*b.h,c=Math.max(c,b.w);a.sort((b,C)=>C.h-b.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),c),h:1/0}];let m=0,y=0;for(const b of a)for(let C=d.length-1;C>=0;C--){const I=d[C];if(!(b.w>I.w||b.h>I.h)){if(b.x=I.x,b.y=I.y,y=Math.max(y,b.y+b.h),m=Math.max(m,b.x+b.w),b.w===I.w&&b.h===I.h){const M=d.pop();C<d.length&&(d[C]=M)}else b.h===I.h?(I.x+=b.w,I.w-=b.w):b.w===I.w?(I.y+=b.h,I.h-=b.h):(d.push({x:I.x+b.w,y:I.y,w:I.w-b.w,h:b.h}),I.y+=b.h,I.h-=b.h);break}}return{w:m,h:y,fill:s/(m*y)||0}}const xs=1;class uh{constructor(s,{pixelRatio:c,version:d,stretchX:m,stretchY:y,content:b,textFitWidth:C,textFitHeight:I}){this.paddedRect=s,this.pixelRatio=c,this.stretchX=m,this.stretchY=y,this.content=b,this.version=d,this.textFitWidth=C,this.textFitHeight=I}get tl(){return[this.paddedRect.x+xs,this.paddedRect.y+xs]}get br(){return[this.paddedRect.x+this.paddedRect.w-xs,this.paddedRect.y+this.paddedRect.h-xs]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*xs)/this.pixelRatio,(this.paddedRect.h-2*xs)/this.pixelRatio]}}class dh{constructor(s,c){const d={},m={};this.haveRenderCallbacks=[];const y=[];this.addImages(s,d,y),this.addImages(c,m,y);const{w:b,h:C}=uy(y),I=new Ks({width:b||1,height:C||1});for(const M in s){const O=s[M],F=d[M].paddedRect;Ks.copy(O.data,I,{x:0,y:0},{x:F.x+xs,y:F.y+xs},O.data)}for(const M in c){const O=c[M],F=m[M].paddedRect,j=F.x+xs,q=F.y+xs,Y=O.data.width,ee=O.data.height;Ks.copy(O.data,I,{x:0,y:0},{x:j,y:q},O.data),Ks.copy(O.data,I,{x:0,y:ee-1},{x:j,y:q-1},{width:Y,height:1}),Ks.copy(O.data,I,{x:0,y:0},{x:j,y:q+ee},{width:Y,height:1}),Ks.copy(O.data,I,{x:Y-1,y:0},{x:j-1,y:q},{width:1,height:ee}),Ks.copy(O.data,I,{x:0,y:0},{x:j+Y,y:q},{width:1,height:ee})}this.image=I,this.iconPositions=d,this.patternPositions=m}addImages(s,c,d){for(const m in s){const y=s[m],b={x:0,y:0,w:y.data.width+2*xs,h:y.data.height+2*xs};d.push(b),c[m]=new uh(b,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(s,c){s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in s.updatedImages)this.patchUpdatedImage(this.iconPositions[d],s.getImage(d),c),this.patchUpdatedImage(this.patternPositions[d],s.getImage(d),c)}patchUpdatedImage(s,c,d){if(!s||!c||s.version===c.version)return;s.version=c.version;const[m,y]=s.tl;d.update(c.data,void 0,{x:m,y})}}var oc;Zt("ImagePosition",uh),Zt("ImageAtlas",dh),X.ah=void 0,(oc=X.ah||(X.ah={}))[oc.none=0]="none",oc[oc.horizontal=1]="horizontal",oc[oc.vertical=2]="vertical",oc[oc.horizontalOnly=3]="horizontalOnly";const hh=-17;class fh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,c){const d=new fh;return d.scale=s||1,d.fontStack=c,d}static forImage(s){const c=new fh;return c.imageName=s,c}}class Ja{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,c){const d=new Ja;for(let m=0;m<s.sections.length;m++){const y=s.sections[m];y.image?d.addImageSection(y):d.addTextSection(y,c)}return d}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(){this.text=function(s){let c="";for(let d=0;d<s.length;d++){const m=s.charCodeAt(d+1)||null,y=s.charCodeAt(d-1)||null;c+=m&&ui(m)&&!lo[s[d+1]]||y&&ui(y)&&!lo[s[d-1]]||!lo[s[d]]?s[d]:lo[s[d]]}return c}(this.text)}trim(){let s=0;for(let d=0;d<this.text.length&&wf[this.text.charCodeAt(d)];d++)s++;let c=this.text.length;for(let d=this.text.length-1;d>=0&&d>=s&&wf[this.text.charCodeAt(d)];d--)c--;this.text=this.text.substring(s,c),this.sectionIndex=this.sectionIndex.slice(s,c)}substring(s,c){const d=new Ja;return d.text=this.text.substring(s,c),d.sectionIndex=this.sectionIndex.slice(s,c),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,c)=>Math.max(s,this.sections[c].scale),0)}addTextSection(s,c){this.text+=s.text,this.sections.push(fh.forText(s.scale,s.fontStack||c));const d=this.sections.length-1;for(let m=0;m<s.text.length;++m)this.sectionIndex.push(d)}addImageSection(s){const c=s.image?s.image.name:"";if(0===c.length)return void en("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(fh.forImage(c)),this.sectionIndex.push(this.sections.length-1)):en("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Kc(a,s,c,d,m,y,b,C,I,M,O,F,j,q,Y){const ee=Ja.fromFeature(a,m);let le;F===X.ah.vertical&&ee.verticalizePunctuation();const{processBidirectionalText:ye,processStyledBidirectionalText:Fe}=Ta;if(ye&&1===ee.sections.length){le=[];const Ge=ye(ee.toString(),Ed(ee,M,y,s,d,q));for(const Ct of Ge){const un=new Ja;un.text=Ct,un.sections=ee.sections;for(let Rn=0;Rn<Ct.length;Rn++)un.sectionIndex.push(0);le.push(un)}}else if(Fe){le=[];const Ge=Fe(ee.text,ee.sectionIndex,Ed(ee,M,y,s,d,q));for(const Ct of Ge){const un=new Ja;un.text=Ct[0],un.sectionIndex=Ct[1],un.sections=ee.sections,le.push(un)}}else le=function(Ge,Ct){const un=[],Rn=Ge.text;let Jt=0;for(const Gt of Ct)un.push(Ge.substring(Jt,Gt)),Jt=Gt;return Jt<Rn.length&&un.push(Ge.substring(Jt,Rn.length)),un}(ee,Ed(ee,M,y,s,d,q));const Ie=[],Re={positionedLines:Ie,text:ee.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:F,iconsInText:!1,verticalizable:!1};return function(Ge,Ct,un,Rn,Jt,Gt,Sn,xn,vn,tt,Mn,Tn){let Qn=0,gr=hh,ar=0,nr=0;const xo="right"===xn?1:"left"===xn?0:.5;let Ho=0;for(const Kr of Jt){Kr.trim();const Co=Kr.getMaxScale(),ls=(Co-1)*wo,qo={positionedGlyphs:[],lineOffset:0};Ge.positionedLines[Ho]=qo;const Is=qo.positionedGlyphs;let Go=0;if(!Kr.length()){gr+=Gt,++Ho;continue}for(let co=0;co<Kr.length();co++){const Pi=Kr.getSection(co),yr=Kr.getSectionIndex(co),Dr=Kr.getCharCode(co);let Vs=0,Yr=null,Dh=null,uc=null,Ma=wo;const Ys=!(vn===X.ah.horizontal||!Mn&&!Ot(Dr)||Mn&&(wf[Dr]||(Mo=Dr,/\p{sc=Arab}/u.test(String.fromCodePoint(Mo)))));if(Pi.imageName){const Pa=Rn[Pi.imageName];if(!Pa)continue;uc=Pi.imageName,Ge.iconsInText=Ge.iconsInText||!0,Dh=Pa.paddedRect;const Wo=Pa.displaySize;Pi.scale=Pi.scale*wo/Tn,Yr={width:Wo[0],height:Wo[1],left:xs,top:-ch,advance:Ys?Wo[1]:Wo[0]},Vs=ls+(wo-Wo[1]*Pi.scale),Ma=Yr.advance;const Tl=Ys?Wo[0]*Pi.scale-wo*Co:Wo[1]*Pi.scale-wo*Co;Tl>0&&Tl>Go&&(Go=Tl)}else{const Pa=un[Pi.fontStack],Wo=Pa&&Pa[Dr];if(Wo&&Wo.rect)Dh=Wo.rect,Yr=Wo.metrics;else{const Tl=Ct[Pi.fontStack],Eh=Tl&&Tl[Dr];if(!Eh)continue;Yr=Eh.metrics}Vs=(Co-Pi.scale)*wo}Ys?(Ge.verticalizable=!0,Is.push({glyph:Dr,imageName:uc,x:Qn,y:gr+Vs,vertical:Ys,scale:Pi.scale,fontStack:Pi.fontStack,sectionIndex:yr,metrics:Yr,rect:Dh}),Qn+=Ma*Pi.scale+tt):(Is.push({glyph:Dr,imageName:uc,x:Qn,y:gr+Vs,vertical:Ys,scale:Pi.scale,fontStack:Pi.fontStack,sectionIndex:yr,metrics:Yr,rect:Dh}),Qn+=Yr.advance*Pi.scale+tt)}0!==Is.length&&(ar=Math.max(Qn-tt,ar),mb(Is,0,Is.length-1,xo,Go)),Qn=0;const Ss=Gt*Co+Go;qo.lineOffset=Math.max(Go,ls),gr+=Ss,nr=Math.max(Ss,nr),++Ho}var Mo;const Cs=gr-hh,{horizontalAlign:Ds,verticalAlign:Es}=xf(Sn);(function(Kr,Co,ls,qo,Is,Go,Ss,co,Pi){const yr=(Co-ls)*Is;let Dr=0;Dr=Go!==Ss?-co*qo-hh:(-qo*Pi+.5)*Ss;for(const Vs of Kr)for(const Yr of Vs.positionedGlyphs)Yr.x+=yr,Yr.y+=Dr})(Ge.positionedLines,xo,Ds,Es,ar,nr,Gt,Cs,Jt.length),Ge.top+=-Es*Cs,Ge.bottom=Ge.top+Cs,Ge.left+=-Ds*ar,Ge.right=Ge.left+ar}(Re,s,c,d,le,b,C,I,F,M,j,Y),!function(Ge){for(const Ct of Ge)if(0!==Ct.positionedGlyphs.length)return!1;return!0}(Ie)&&Re}const wf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},YC={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},dy={40:!0};function hy(a,s,c,d,m,y){if(s.imageName){const b=d[s.imageName];return b?b.displaySize[0]*s.scale*wo/y+m:0}{const b=c[s.fontStack],C=b&&b[a];return C?C.metrics.advance*s.scale+m:0}}function fb(a,s,c,d){const m=Math.pow(a-s,2);return d?a<s?m/2:2*m:m+Math.abs(c)*c}function pb(a,s,c){let d=0;return 10===a&&(d-=1e4),c&&(d+=150),40!==a&&65288!==a||(d+=50),41!==s&&65289!==s||(d+=50),d}function fy(a,s,c,d,m,y){let b=null,C=fb(s,c,m,y);for(const I of d){const M=fb(s-I.x,c,m,y)+I.badness;M<=C&&(b=I,C=M)}return{index:a,x:s,priorBreak:b,badness:C}}function py(a){return a?py(a.priorBreak).concat(a.index):[]}function Ed(a,s,c,d,m,y){if(!a)return[];const b=[],C=function(F,j,q,Y,ee,le){let ye=0;for(let Fe=0;Fe<F.length();Fe++){const Ie=F.getSection(Fe);ye+=hy(F.getCharCode(Fe),Ie,Y,ee,j,le)}return ye/Math.max(1,Math.ceil(ye/q))}(a,s,c,d,m,y),I=a.text.indexOf("\u200b")>=0;let M=0;for(let F=0;F<a.length();F++){const j=a.getSection(F),q=a.getCharCode(F);if(wf[q]||(M+=hy(q,j,d,m,s,y)),F<a.length()-1){const Y=!((O=q)<11904)&&(!!Yn["CJK Compatibility Forms"](O)||!!Yn["CJK Compatibility"](O)||!!Yn["CJK Strokes"](O)||!!Yn["CJK Symbols and Punctuation"](O)||!!Yn["Enclosed CJK Letters and Months"](O)||!!Yn["Halfwidth and Fullwidth Forms"](O)||!!Yn["Ideographic Description Characters"](O)||!!Yn["Vertical Forms"](O)||Ve.test(String.fromCodePoint(O)));(YC[q]||Y||j.imageName||F!==a.length()-2&&dy[a.getCharCode(F+1)])&&b.push(fy(F+1,M,C,b,pb(q,a.getCharCode(F+1),Y&&I),!1))}}var O;return py(fy(a.length(),M,C,b,0,!0))}function xf(a){let s=.5,c=.5;switch(a){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:s,verticalAlign:c}}function mb(a,s,c,d,m){if(!d&&!m)return;const y=a[c],b=(a[c].x+y.metrics.advance*y.scale)*d;for(let C=s;C<=c;C++)a[C].x-=b,a[C].y+=m}function my(a,s,c){const{horizontalAlign:d,verticalAlign:m}=xf(c),y=s[0]-a.displaySize[0]*d,b=s[1]-a.displaySize[1]*m;return{image:a,top:b,bottom:b+a.displaySize[1],left:y,right:y+a.displaySize[0]}}function gb(a){var s,c;let d=a.left,m=a.top,y=a.right-d,b=a.bottom-m;const C=null!==(s=a.image.textFitWidth)&&void 0!==s?s:"stretchOrShrink",I=null!==(c=a.image.textFitHeight)&&void 0!==c?c:"stretchOrShrink",M=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if("proportional"===I){if("stretchOnly"===C&&y/b<M||"proportional"===C){const O=Math.ceil(b*M);d*=O/y,y=O}}else if("proportional"===C&&"stretchOnly"===I&&0!==M&&y/b>M){const O=Math.ceil(y/M);m*=O/b,b=O}return{x1:d,y1:m,x2:d+y,y2:m+b}}function nm(a,s,c,d,m,y){const b=a.image;let C;if(b.content){const le=b.content,ye=b.pixelRatio||1;C=[le[0]/ye,le[1]/ye,b.displaySize[0]-le[2]/ye,b.displaySize[1]-le[3]/ye]}const I=s.left*y,M=s.right*y;let O,F,j,q;"width"===c||"both"===c?(q=m[0]+I-d[3],F=m[0]+M+d[1]):(q=m[0]+(I+M-b.displaySize[0])/2,F=q+b.displaySize[0]);const Y=s.top*y,ee=s.bottom*y;return"height"===c||"both"===c?(O=m[1]+Y-d[0],j=m[1]+ee+d[2]):(O=m[1]+(Y+ee-b.displaySize[1])/2,j=O+b.displaySize[1]),{image:b,top:O,right:F,bottom:j,left:q,collisionPadding:C}}const Cf=255,Sl=128,Yc=Cf*Sl;function Df(a,s){const{expression:c}=s;if("constant"===c.kind)return{kind:"constant",layoutSize:c.evaluate(new sr(a+1))};if("source"===c.kind)return{kind:"source"};{const{zoomStops:d,interpolationType:m}=c;let y=0;for(;y<d.length&&d[y]<=a;)y++;y=Math.max(0,y-1);let b=y;for(;b<d.length&&d[b]<a+1;)b++;b=Math.min(d.length-1,b);const C=d[y],I=d[b];return"composite"===c.kind?{kind:"composite",minZoom:C,maxZoom:I,interpolationType:m}:{kind:"camera",minZoom:C,maxZoom:I,minSize:c.evaluate(new sr(C)),maxSize:c.evaluate(new sr(I)),interpolationType:m}}}function gy(a,s,c){let d="never";const m=a.get(s);return m?d=m:a.get(c)&&(d="always"),d}const JC=as.VectorTileFeature.types,im=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function rm(a,s,c,d,m,y,b,C,I,M,O,F,j){const q=C?Math.min(Yc,Math.round(C[0])):0,Y=C?Math.min(Yc,Math.round(C[1])):0;a.emplaceBack(s,c,Math.round(32*d),Math.round(32*m),y,b,(q<<1)+(I?1:0),Y,16*M,16*O,256*F,256*j)}function yy(a,s,c){a.emplaceBack(s.x,s.y,c),a.emplaceBack(s.x,s.y,c),a.emplaceBack(s.x,s.y,c),a.emplaceBack(s.x,s.y,c)}function QC(a){for(const s of a.sections)if(Xd(s.text))return!0;return!1}class vy{constructor(s){this.layoutVertexArray=new rs,this.indexArray=new Dl,this.programConfigurations=s,this.segments=new Oo,this.dynamicLayoutVertexArray=new os,this.opacityVertexArray=new Ls,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ar}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(s,c,d,m){this.isEmpty()||(d&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,GC.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,WC.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,im,!0),this.opacityVertexBuffer.itemSize=1),(d||m)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Zt("SymbolBuffers",vy);class _y{constructor(s,c,d){this.layoutVertexArray=new s,this.layoutAttributes=c,this.indexArray=new d,this.segments=new Oo,this.collisionVertexArray=new nc}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,ZC.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Zt("CollisionBuffers",_y);class Id{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(b=>b.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Up([]),this.placementViewportMatrix=Up([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Df(this.zoom,c["text-size"]),this.iconSizeData=Df(this.zoom,c["icon-size"]);const d=this.layers[0].layout,m=d.get("symbol-sort-key"),y=d.get("symbol-z-order");this.canOverlap="never"!==gy(d,"text-overlap","text-allow-overlap")||"never"!==gy(d,"icon-overlap","icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==y&&!m.isConstant(),this.sortFeaturesByY=("viewport-y"===y||"auto"===y&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===d.get("symbol-placement")&&(this.writingModes=d.get("text-writing-mode").map(b=>X.ah[b])),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=s.sourceID}createArrays(){this.text=new vy(new ld(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new vy(new ld(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new jo,this.lineVertexArray=new To,this.symbolInstances=new Ro,this.textAnchorOffsets=new jc}calculateGlyphDependencies(s,c,d,m,y){for(let b=0;b<s.length;b++)if(c[s.charCodeAt(b)]=!0,(d||m)&&y){const C=lo[s.charAt(b)];C&&(c[C.charCodeAt(0)]=!0)}}populate(s,c,d){const m=this.layers[0],y=m.layout,b=y.get("text-font"),C=y.get("text-field"),I=y.get("icon-image"),M=("constant"!==C.value.kind||C.value.value instanceof ir&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&("constant"!==b.value.kind||b.value.value.length>0),O="constant"!==I.value.kind||!!I.value.value||Object.keys(I.parameters).length>0,F=y.get("symbol-sort-key");if(this.features=[],!M&&!O)return;const j=c.iconDependencies,q=c.glyphDependencies,Y=c.availableImages,ee=new sr(this.zoom);for(const{feature:le,id:ye,index:Fe,sourceLayerIndex:Ie}of s){const Re=m._featureFilter.needGeometry,Ge=Cu(le,Re);if(!m._featureFilter.filter(ee,Ge,d))continue;let Ct,un;if(Re||(Ge.geometry=xu(le)),M){const Jt=m.getValueAndResolveTokens("text-field",Ge,d,Y),Gt=ir.factory(Jt),Sn=this.hasRTLText=this.hasRTLText||QC(Gt);(!Sn||"unavailable"===Ta.getRTLTextPluginStatus()||Sn&&Ta.isParsed())&&(Ct=ab(Gt,m,Ge))}if(O){const Jt=m.getValueAndResolveTokens("icon-image",Ge,d,Y);un=Jt instanceof St?Jt:St.fromString(Jt)}if(!Ct&&!un)continue;const Rn=this.sortFeaturesByKey?F.evaluate(Ge,{},d):void 0;if(this.features.push({id:ye,text:Ct,icon:un,index:Fe,sourceLayerIndex:Ie,geometry:Ge.geometry,properties:le.properties,type:JC[le.type],sortKey:Rn}),un&&(j[un.name]=!0),Ct){const Jt=b.evaluate(Ge,{},d).join(","),Gt="viewport"!==y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(X.ah.vertical)>=0;for(const Sn of Ct.sections)if(Sn.image)j[Sn.image.name]=!0;else{const xn=V(Ct.toString()),vn=Sn.fontStack||Jt,tt=q[vn]=q[vn]||{};this.calculateGlyphDependencies(Sn.text,tt,Gt,this.allowVerticalPlacement,xn)}}}"line"===y.get("symbol-placement")&&(this.features=function(le){const ye={},Fe={},Ie=[];let Re=0;function Ge(Jt){Ie.push(le[Jt]),Re++}function Ct(Jt,Gt,Sn){const xn=Fe[Jt];return delete Fe[Jt],Fe[Gt]=xn,Ie[xn].geometry[0].pop(),Ie[xn].geometry[0]=Ie[xn].geometry[0].concat(Sn[0]),xn}function un(Jt,Gt,Sn){const xn=ye[Gt];return delete ye[Gt],ye[Jt]=xn,Ie[xn].geometry[0].shift(),Ie[xn].geometry[0]=Sn[0].concat(Ie[xn].geometry[0]),xn}function Rn(Jt,Gt,Sn){const xn=Sn?Gt[0][Gt[0].length-1]:Gt[0][0];return`${Jt}:${xn.x}:${xn.y}`}for(let Jt=0;Jt<le.length;Jt++){const Gt=le[Jt],Sn=Gt.geometry,xn=Gt.text?Gt.text.toString():null;if(!xn){Ge(Jt);continue}const vn=Rn(xn,Sn),tt=Rn(xn,Sn,!0);if(vn in Fe&&tt in ye&&Fe[vn]!==ye[tt]){const Mn=un(vn,tt,Sn),Tn=Ct(vn,tt,Ie[Mn].geometry);delete ye[vn],delete Fe[tt],Fe[Rn(xn,Ie[Tn].geometry,!0)]=Tn,Ie[Mn].geometry=null}else vn in Fe?Ct(vn,tt,Sn):tt in ye?un(vn,tt,Sn):(Ge(Jt),ye[vn]=Re-1,Fe[tt]=Re-1)}return Ie.filter(Jt=>Jt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((le,ye)=>le.sortKey-ye.sortKey)}update(s,c,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,c,this.layers,d),this.icon.programConfigurations.updatePaintArrays(s,c,this.layers,d))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,c){const d=this.lineVertexArray.length;if(void 0!==s.segment){let m=s.dist(c[s.segment+1]),y=s.dist(c[s.segment]);const b={};for(let C=s.segment+1;C<c.length;C++)b[C]={x:c[C].x,y:c[C].y,tileUnitDistanceFromAnchor:m},C<c.length-1&&(m+=c[C+1].dist(c[C]));for(let C=s.segment||0;C>=0;C--)b[C]={x:c[C].x,y:c[C].y,tileUnitDistanceFromAnchor:y},C>0&&(y+=c[C-1].dist(c[C]));for(let C=0;C<c.length;C++){const I=b[C];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(s,c,d,m,y,b,C,I,M,O,F,j){const q=s.indexArray,Y=s.layoutVertexArray,ee=s.segments.prepareSegment(4*c.length,Y,q,this.canOverlap?b.sortKey:void 0),le=this.glyphOffsetArray.length,ye=ee.vertexLength,Fe=this.allowVerticalPlacement&&C===X.ah.vertical?Math.PI/2:0,Ie=b.text&&b.text.sections;for(let Re=0;Re<c.length;Re++){const{tl:Ge,tr:Ct,bl:un,br:Rn,tex:Jt,pixelOffsetTL:Gt,pixelOffsetBR:Sn,minFontScaleX:xn,minFontScaleY:vn,glyphOffset:tt,isSDF:Mn,sectionIndex:Tn}=c[Re],Qn=ee.vertexLength,gr=tt[1];rm(Y,I.x,I.y,Ge.x,gr+Ge.y,Jt.x,Jt.y,d,Mn,Gt.x,Gt.y,xn,vn),rm(Y,I.x,I.y,Ct.x,gr+Ct.y,Jt.x+Jt.w,Jt.y,d,Mn,Sn.x,Gt.y,xn,vn),rm(Y,I.x,I.y,un.x,gr+un.y,Jt.x,Jt.y+Jt.h,d,Mn,Gt.x,Sn.y,xn,vn),rm(Y,I.x,I.y,Rn.x,gr+Rn.y,Jt.x+Jt.w,Jt.y+Jt.h,d,Mn,Sn.x,Sn.y,xn,vn),yy(s.dynamicLayoutVertexArray,I,Fe),q.emplaceBack(Qn,Qn+1,Qn+2),q.emplaceBack(Qn+1,Qn+2,Qn+3),ee.vertexLength+=4,ee.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(tt[0]),Re!==c.length-1&&Tn===c[Re+1].sectionIndex||s.programConfigurations.populatePaintArrays(Y.length,b,b.index,{},j,Ie&&Ie[Tn])}s.placedSymbolArray.emplaceBack(I.x,I.y,le,this.glyphOffsetArray.length-le,ye,M,O,I.segment,d?d[0]:0,d?d[1]:0,m[0],m[1],C,0,!1,0,F)}_addCollisionDebugVertex(s,c,d,m,y,b){return c.emplaceBack(0,0),s.emplaceBack(d.x,d.y,m,y,Math.round(b.x),Math.round(b.y))}addCollisionDebugVertices(s,c,d,m,y,b,C){const I=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),M=I.vertexLength,O=y.layoutVertexArray,F=y.collisionVertexArray,j=C.anchorX,q=C.anchorY;this._addCollisionDebugVertex(O,F,b,j,q,new Ae(s,c)),this._addCollisionDebugVertex(O,F,b,j,q,new Ae(d,c)),this._addCollisionDebugVertex(O,F,b,j,q,new Ae(d,m)),this._addCollisionDebugVertex(O,F,b,j,q,new Ae(s,m)),I.vertexLength+=4;const Y=y.indexArray;Y.emplaceBack(M,M+1),Y.emplaceBack(M+1,M+2),Y.emplaceBack(M+2,M+3),Y.emplaceBack(M+3,M),I.primitiveLength+=4}addDebugCollisionBoxes(s,c,d,m){for(let y=s;y<c;y++){const b=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,m?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,d)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new _y(Bi,Mu.members,yu),this.iconCollisionBox=new _y(Bi,Mu.members,yu);for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this.addDebugCollisionBoxes(c.textBoxStartIndex,c.textBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.iconBoxStartIndex,c.iconBoxEndIndex,c,!1),this.addDebugCollisionBoxes(c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c,!1)}}_deserializeCollisionBoxesForSymbol(s,c,d,m,y,b,C,I,M){const O={};for(let F=c;F<d;F++){const j=s.get(F);O.textBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},O.textFeatureIndex=j.featureIndex;break}for(let F=m;F<y;F++){const j=s.get(F);O.verticalTextBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},O.verticalTextFeatureIndex=j.featureIndex;break}for(let F=b;F<C;F++){const j=s.get(F);O.iconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},O.iconFeatureIndex=j.featureIndex;break}for(let F=I;F<M;F++){const j=s.get(F);O.verticalIconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},O.verticalIconFeatureIndex=j.featureIndex;break}return O}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const d=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,c){const d=s.placedSymbolArray.get(c),m=d.vertexStartIndex+4*d.numGlyphs;for(let y=d.vertexStartIndex;y<m;y+=4)s.indexArray.emplaceBack(y,y+1,y+2),s.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const c=Math.sin(s),d=Math.cos(s),m=[],y=[],b=[];for(let C=0;C<this.symbolInstances.length;++C){b.push(C);const I=this.symbolInstances.get(C);m.push(0|Math.round(c*I.anchorX+d*I.anchorY)),y.push(I.featureIndex)}return b.sort((C,I)=>m[C]-m[I]||y[I]-y[C]),b}addToSortKeyRanges(s,c){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===c?d.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const d=this.symbolInstances.get(c);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach((m,y,b)=>{m>=0&&b.indexOf(m)===y&&this.addIndicesForPlacedSymbol(this.text,m)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ph,mh;Zt("SymbolBucket",Id,{omit:["layers","collisionBoxArray","features","compareText"]}),Id.MAX_GLYPHS=65535,Id.addDynamicAttributes=yy;var Ef={get paint(){return mh=mh||new D({"icon-opacity":new u(ve.paint_symbol["icon-opacity"]),"icon-color":new u(ve.paint_symbol["icon-color"]),"icon-halo-color":new u(ve.paint_symbol["icon-halo-color"]),"icon-halo-width":new u(ve.paint_symbol["icon-halo-width"]),"icon-halo-blur":new u(ve.paint_symbol["icon-halo-blur"]),"icon-translate":new o(ve.paint_symbol["icon-translate"]),"icon-translate-anchor":new o(ve.paint_symbol["icon-translate-anchor"]),"text-opacity":new u(ve.paint_symbol["text-opacity"]),"text-color":new u(ve.paint_symbol["text-color"],{runtimeType:Ur,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new u(ve.paint_symbol["text-halo-color"]),"text-halo-width":new u(ve.paint_symbol["text-halo-width"]),"text-halo-blur":new u(ve.paint_symbol["text-halo-blur"]),"text-translate":new o(ve.paint_symbol["text-translate"]),"text-translate-anchor":new o(ve.paint_symbol["text-translate-anchor"])})},get layout(){return ph=ph||new D({"symbol-placement":new o(ve.layout_symbol["symbol-placement"]),"symbol-spacing":new o(ve.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new o(ve.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new u(ve.layout_symbol["symbol-sort-key"]),"symbol-z-order":new o(ve.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new o(ve.layout_symbol["icon-allow-overlap"]),"icon-overlap":new o(ve.layout_symbol["icon-overlap"]),"icon-ignore-placement":new o(ve.layout_symbol["icon-ignore-placement"]),"icon-optional":new o(ve.layout_symbol["icon-optional"]),"icon-rotation-alignment":new o(ve.layout_symbol["icon-rotation-alignment"]),"icon-size":new u(ve.layout_symbol["icon-size"]),"icon-text-fit":new o(ve.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new o(ve.layout_symbol["icon-text-fit-padding"]),"icon-image":new u(ve.layout_symbol["icon-image"]),"icon-rotate":new u(ve.layout_symbol["icon-rotate"]),"icon-padding":new u(ve.layout_symbol["icon-padding"]),"icon-keep-upright":new o(ve.layout_symbol["icon-keep-upright"]),"icon-offset":new u(ve.layout_symbol["icon-offset"]),"icon-anchor":new u(ve.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new o(ve.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new o(ve.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new o(ve.layout_symbol["text-rotation-alignment"]),"text-field":new u(ve.layout_symbol["text-field"]),"text-font":new u(ve.layout_symbol["text-font"]),"text-size":new u(ve.layout_symbol["text-size"]),"text-max-width":new u(ve.layout_symbol["text-max-width"]),"text-line-height":new o(ve.layout_symbol["text-line-height"]),"text-letter-spacing":new u(ve.layout_symbol["text-letter-spacing"]),"text-justify":new u(ve.layout_symbol["text-justify"]),"text-radial-offset":new u(ve.layout_symbol["text-radial-offset"]),"text-variable-anchor":new o(ve.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new u(ve.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new u(ve.layout_symbol["text-anchor"]),"text-max-angle":new o(ve.layout_symbol["text-max-angle"]),"text-writing-mode":new o(ve.layout_symbol["text-writing-mode"]),"text-rotate":new u(ve.layout_symbol["text-rotate"]),"text-padding":new o(ve.layout_symbol["text-padding"]),"text-keep-upright":new o(ve.layout_symbol["text-keep-upright"]),"text-transform":new u(ve.layout_symbol["text-transform"]),"text-offset":new u(ve.layout_symbol["text-offset"]),"text-allow-overlap":new o(ve.layout_symbol["text-allow-overlap"]),"text-overlap":new o(ve.layout_symbol["text-overlap"]),"text-ignore-placement":new o(ve.layout_symbol["text-ignore-placement"]),"text-optional":new o(ve.layout_symbol["text-optional"])})}};class om{constructor(s){if(void 0===s.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=s.property.overrides?s.property.overrides.runtimeType:Hi,this.defaultValue=s}evaluate(s){if(s.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(s.formattedSection))return c.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Zt("FormatSectionOverride",om,{omit:["defaultValue"]});class gh extends A{constructor(s){super(s,Ef)}recalculate(s,c){if(super.recalculate(s,c),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const d=this.layout.get("text-writing-mode");if(d){const m=[];for(const y of d)m.indexOf(y)<0&&m.push(y);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(s,c,d,m){const y=this.layout.get(s).evaluate(c,{},d,m),b=this._unevaluatedLayout._values[s];return b.isDataDriven()||pl(b.value)||!y?y:(C=c.properties,y.replace(/{([^{}]+)}/g,(M,O)=>C&&O in C?String(C[O]):""));var C}createBucket(s){return new Id(s)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const s of Ef.paint.overridableProperties){if(!gh.hasPaintOverride(this.layout,s))continue;const c=this.paint.get(s),d=new om(c),m=new fl(d,c.property.specification);let y=null;y="constant"===c.value.kind||"source"===c.value.kind?new ja("source",m):new Yl("composite",m,c.value.zoomStops),this.paint._values[s]=new Wa(c.property,y,c.parameters)}}_handleOverridablePaintPropertyUpdate(s,c,d){return!(!this.layout||c.isDataDriven()||d.isDataDriven())&&gh.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,c){const d=s.get("text-field"),m=Ef.paint.properties[c];let y=!1;const b=C=>{for(const I of C)if(m.overrides&&m.overrides.hasOverride(I))return void(y=!0)};if("constant"===d.value.kind&&d.value.value instanceof ir)b(d.value.value.sections);else if("source"===d.value.kind){const C=M=>{y||(M instanceof Hr&&Di(M.value)===go?b(M.value.sections):M instanceof ul?b(M.sections):M.eachChild(C))},I=d.value;I._styleExpression&&C(I._styleExpression.expression)}return y}}let Pu;var by={get paint(){return Pu=Pu||new D({"background-color":new o(ve.paint_background["background-color"]),"background-pattern":new p(ve.paint_background["background-pattern"]),"background-opacity":new o(ve.paint_background["background-opacity"])})}};class wy extends A{constructor(s){super(s,by)}}let yh;var If={get paint(){return yh=yh||new D({"raster-opacity":new o(ve.paint_raster["raster-opacity"]),"raster-hue-rotate":new o(ve.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new o(ve.paint_raster["raster-brightness-min"]),"raster-brightness-max":new o(ve.paint_raster["raster-brightness-max"]),"raster-saturation":new o(ve.paint_raster["raster-saturation"]),"raster-contrast":new o(ve.paint_raster["raster-contrast"]),"raster-resampling":new o(ve.paint_raster["raster-resampling"]),"raster-fade-duration":new o(ve.paint_raster["raster-fade-duration"])})}};class Jc extends A{constructor(s){super(s,If)}}class yb extends A{constructor(s){super(s,{}),this.onAdd=c=>{this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)},this.onRemove=c=>{this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)},this.implementation=s}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class vb{constructor(s){this._methodToThrottle=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const sm=6371008.8;class sc{constructor(s,c){if(isNaN(s)||isNaN(c))throw new Error(`Invalid LngLat object: (${s}, ${c})`);if(this.lng=+s,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new sc(bt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const c=Math.PI/180,d=this.lat*c,m=s.lat*c,y=Math.sin(d)*Math.sin(m)+Math.cos(d)*Math.cos(m)*Math.cos((s.lng-this.lng)*c);return sm*Math.acos(Math.min(y,1))}static convert(s){if(s instanceof sc)return s;if(Array.isArray(s)&&(2===s.length||3===s.length))return new sc(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&"object"==typeof s&&null!==s)return new sc(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Sf=2*Math.PI*sm;function xy(a){return Sf*Math.cos(a*Math.PI/180)}function Cy(a){return(180+a)/360}function Dy(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function am(a,s){return a/xy(s)}function lm(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class vh{constructor(s,c,d=0){this.x=+s,this.y=+c,this.z=+d}static fromLngLat(s,c=0){const d=sc.convert(s);return new vh(Cy(d.lng),Dy(d.lat),am(c,d.lat))}toLngLat(){return new sc(360*this.x-180,lm(this.y))}toAltitude(){return this.z*xy(lm(this.y))}meterInMercatorCoordinateUnits(){return 1/Sf*(s=lm(this.y),1/Math.cos(s*Math.PI/180));var s}}function zs(a,s,c){var d=2*Math.PI*6378137/256/Math.pow(2,c);return[a*d-2*Math.PI*6378137/2,s*d-2*Math.PI*6378137/2]}class _h{constructor(s,c,d){if(y=c,b=d,(m=s)<0||m>25||b<0||b>=Math.pow(2,m)||y<0||y>=Math.pow(2,m))throw new Error(`x=${c}, y=${d}, z=${s} outside of bounds. 0<=x<${Math.pow(2,s)}, 0<=y<${Math.pow(2,s)} 0<=z<=25 `);var m,y,b;this.z=s,this.x=c,this.y=d,this.key=Ao(0,s,s,c,d)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,c,d){const m=(b=this.y,C=this.z,I=zs(256*(y=this.x),256*(b=Math.pow(2,C)-b-1),C),M=zs(256*(y+1),256*(b+1),C),I[0]+","+I[1]+","+M[0]+","+M[1]);var y,b,C,I,M;const O=function(F,j,q){let Y,ee="";for(let le=F;le>0;le--)Y=1<<le-1,ee+=(j&Y?1:0)+(q&Y?2:0);return ee}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===d?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,c>1?"@2x":"").replace(/{quadkey}/g,O).replace(/{bbox-epsg-3857}/g,m)}isChildOf(s){const c=this.z-s.z;return c>0&&s.x===this.x>>c&&s.y===this.y>>c}getTilePoint(s){const c=Math.pow(2,this.z);return new Ae((s.x*c-this.x)*fo,(s.y*c-this.y)*fo)}toString(){return`${this.z}/${this.x}/${this.y}`}}class cm{constructor(s,c){this.wrap=s,this.canonical=c,this.key=Ao(s,c.z,c.z,c.x,c.y)}}class $s{constructor(s,c,d,m,y){if(s<d)throw new Error(`overscaledZ should be >= z; overscaledZ = ${s}; z = ${d}`);this.overscaledZ=s,this.wrap=c,this.canonical=new _h(d,+m,+y),this.key=Ao(c,s,d,m,y)}clone(){return new $s(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-s;return s>this.canonical.z?new $s(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $s(s,this.wrap,s,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(s,c){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-s;return s>this.canonical.z?Ao(this.wrap*+c,s,this.canonical.z,this.canonical.x,this.canonical.y):Ao(this.wrap*+c,s,s,this.canonical.x>>d,this.canonical.y>>d)}isChildOf(s){if(s.wrap!==this.wrap)return!1;const c=this.canonical.z-s.canonical.z;return 0===s.overscaledZ||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>c&&s.canonical.y===this.canonical.y>>c}children(s){if(this.overscaledZ>=s)return[new $s(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,d=2*this.canonical.x,m=2*this.canonical.y;return[new $s(c,this.wrap,c,d,m),new $s(c,this.wrap,c,d+1,m),new $s(c,this.wrap,c,d,m+1),new $s(c,this.wrap,c,d+1,m+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new $s(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new $s(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new cm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(s){return this.canonical.getTilePoint(new vh(s.x-this.wrap,s.y))}}function Ao(a,s,c,d,m){(a*=2)<0&&(a=-1*a-1);const y=1<<c;return(y*y*a+y*m+d).toString(36)+c.toString(36)+s.toString(36)}Zt("CanonicalTileID",_h),Zt("OverscaledTileID",$s,{omit:["posMatrix"]});class Sd{constructor(s,c,d,m=1,y=1,b=1,C=0){if(this.uid=s,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(d&&!["mapbox","terrarium","custom"].includes(d))return void en(`"${d}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=c.height;const I=this.dim=c.height-2;switch(this.data=new Uint32Array(c.data.buffer),d){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=y,this.blueFactor=b,this.baseShift=C;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let M=0;M<I;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(I,M)]=this.data[this._idx(I-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,I)]=this.data[this._idx(M,I-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(I,-1)]=this.data[this._idx(I-1,0)],this.data[this._idx(-1,I)]=this.data[this._idx(0,I-1)],this.data[this._idx(I,I)]=this.data[this._idx(I-1,I-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<I;M++)for(let O=0;O<I;O++){const F=this.get(M,O);F>this.max&&(this.max=F),F<this.min&&(this.min=F)}}get(s,c){const d=new Uint8Array(this.data.buffer),m=4*this._idx(s,c);return this.unpack(d[m],d[m+1],d[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(s,c){if(s<-1||s>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(s+1)}unpack(s,c,d){return s*this.redFactor+c*this.greenFactor+d*this.blueFactor-this.baseShift}getPixels(){return new Ks({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(s,c,d){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let m=c*this.dim,y=c*this.dim+this.dim,b=d*this.dim,C=d*this.dim+this.dim;switch(c){case-1:m=y-1;break;case 1:y=m+1}switch(d){case-1:b=C-1;break;case 1:C=b+1}const I=-c*this.dim,M=-d*this.dim;for(let O=b;O<C;O++)for(let F=m;F<y;F++)this.data[this._idx(F,O)]=s.data[this._idx(F+I,O+M)]}}Zt("DEMData",Sd);class um{constructor(s){this._stringToNumber={},this._numberToString=[];for(let c=0;c<s.length;c++){const d=s[c];this._stringToNumber[d]=c,this._numberToString[c]=d}}encode(s){return this._stringToNumber[s]}decode(s){if(s>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${s} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[s]}}class dm{constructor(s,c,d,m,y){this.type="Feature",this._vectorTileFeature=s,s._z=c,s._x=d,s._y=m,this.properties=s.properties,this.id=y}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={geometry:this.geometry};for(const c in this)"_geometry"!==c&&"_vectorTileFeature"!==c&&(s[c]=this[c]);return s}}class Ey{constructor(s,c){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new qa(fo,16,0),this.grid3D=new qa(fo,16,0),this.featureIndexArray=new xl,this.promoteId=c}insert(s,c,d,m,y,b){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,m,y);const I=b?this.grid3D:this.grid;for(let M=0;M<c.length;M++){const O=c[M],F=[1/0,1/0,-1/0,-1/0];for(let j=0;j<O.length;j++){const q=O[j];F[0]=Math.min(F[0],q.x),F[1]=Math.min(F[1],q.y),F[2]=Math.max(F[2],q.x),F[3]=Math.max(F[3],q.y)}F[0]<fo&&F[1]<fo&&F[2]>=0&&F[3]>=0&&I.insert(C,F[0],F[1],F[2],F[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new as.VectorTile(new lh(this.rawTileData)).layers,this.sourceLayerCoder=new um(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(s,c,d,m){this.loadVTLayers();const y=s.params||{},b=fo/s.tileSize/s.scale,C=gl(y.filter),I=s.queryGeometry,M=s.queryPadding*b,O=Iy(I),F=this.grid.query(O.minX-M,O.minY-M,O.maxX+M,O.maxY+M),j=Iy(s.cameraQueryGeometry),q=this.grid3D.query(j.minX-M,j.minY-M,j.maxX+M,j.maxY+M,(le,ye,Fe,Ie)=>function(Re,Ge,Ct,un,Rn){for(const Gt of Re)if(Ge<=Gt.x&&Ct<=Gt.y&&un>=Gt.x&&Rn>=Gt.y)return!0;const Jt=[new Ae(Ge,Ct),new Ae(Ge,Rn),new Ae(un,Rn),new Ae(un,Ct)];if(Re.length>2)for(const Gt of Jt)if(qc(Re,Gt))return!0;for(let Gt=0;Gt<Re.length-1;Gt++)if(Vp(Re[Gt],Re[Gt+1],Jt))return!0;return!1}(s.cameraQueryGeometry,le-M,ye-M,Fe+M,Ie+M));for(const le of q)F.push(le);F.sort(Sy);const Y={};let ee;for(let le=0;le<F.length;le++){const ye=F[le];if(ye===ee)continue;ee=ye;const Fe=this.featureIndexArray.get(ye);let Ie=null;this.loadMatchingFeature(Y,Fe.bucketIndex,Fe.sourceLayerIndex,Fe.featureIndex,C,y.layers,y.availableImages,c,d,m,(Re,Ge,Ct)=>(Ie||(Ie=xu(Re)),Ge.queryIntersectsFeature(I,Re,Ct,Ie,this.z,s.transform,b,s.pixelPosMatrix)))}return Y}loadMatchingFeature(s,c,d,m,y,b,C,I,M,O,F){const j=this.bucketLayerIDs[c];if(b&&!function(le,ye){for(let Fe=0;Fe<le.length;Fe++)if(ye.indexOf(le[Fe])>=0)return!0;return!1}(b,j))return;const q=this.sourceLayerCoder.decode(d),Y=this.vtLayers[q].feature(m);if(y.needGeometry){const le=Cu(Y,!0);if(!y.filter(new sr(this.tileID.overscaledZ),le,this.tileID.canonical))return}else if(!y.filter(new sr(this.tileID.overscaledZ),Y))return;const ee=this.getId(Y,q);for(let le=0;le<j.length;le++){const ye=j[le];if(b&&b.indexOf(ye)<0)continue;const Fe=I[ye];if(!Fe)continue;let Ie={};ee&&O&&(Ie=O.getState(Fe.sourceLayer||"_geojsonTileLayer",ee));const Re=Ze({},M[ye]);Re.paint=hm(Re.paint,Fe.paint,Y,Ie,C),Re.layout=hm(Re.layout,Fe.layout,Y,Ie,C);const Ge=!F||F(Y,Fe,Ie);if(!Ge)continue;const Ct=new dm(Y,this.z,this.x,this.y,ee);Ct.layer=Re;let un=s[ye];void 0===un&&(un=s[ye]=[]),un.push({featureIndex:m,feature:Ct,intersectionZ:Ge})}}lookupSymbolFeatures(s,c,d,m,y,b,C,I){const M={};this.loadVTLayers();const O=gl(y);for(const F of s)this.loadMatchingFeature(M,d,m,F,O,b,C,I,c);return M}hasLayer(s){for(const c of this.bucketLayerIDs)for(const d of c)if(s===d)return!0;return!1}getId(s,c){let d=s.id;return this.promoteId&&(d=s.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[c]],"boolean"==typeof d&&(d=Number(d))),d}}function hm(a,s,c,d,m){return ze(a,(y,b)=>{const C=s instanceof v?s.get(b):null;return C&&C.evaluate?C.evaluate(c,d,m):C})}function Iy(a){let s=1/0,c=1/0,d=-1/0,m=-1/0;for(const y of a)s=Math.min(s,y.x),c=Math.min(c,y.y),d=Math.max(d,y.x),m=Math.max(m,y.y);return{minX:s,minY:c,maxX:d,maxY:m}}function Sy(a,s){return s-a}function Ty(a,s,c,d,m){const y=[];for(let b=0;b<a.length;b++){const C=a[b];let I;for(let M=0;M<C.length-1;M++){let O=C[M],F=C[M+1];O.x<s&&F.x<s||(O.x<s?O=new Ae(s,O.y+(s-O.x)/(F.x-O.x)*(F.y-O.y))._round():F.x<s&&(F=new Ae(s,O.y+(s-O.x)/(F.x-O.x)*(F.y-O.y))._round()),O.y<c&&F.y<c||(O.y<c?O=new Ae(O.x+(c-O.y)/(F.y-O.y)*(F.x-O.x),c)._round():F.y<c&&(F=new Ae(O.x+(c-O.y)/(F.y-O.y)*(F.x-O.x),c)._round()),O.x>=d&&F.x>=d||(O.x>=d?O=new Ae(d,O.y+(d-O.x)/(F.x-O.x)*(F.y-O.y))._round():F.x>=d&&(F=new Ae(d,O.y+(d-O.x)/(F.x-O.x)*(F.y-O.y))._round()),O.y>=m&&F.y>=m||(O.y>=m?O=new Ae(O.x+(m-O.y)/(F.y-O.y)*(F.x-O.x),m)._round():F.y>=m&&(F=new Ae(O.x+(m-O.y)/(F.y-O.y)*(F.x-O.x),m)._round()),I&&O.equals(I[I.length-1])||(I=[O],y.push(I)),I.push(F)))))}}return y}Zt("FeatureIndex",Ey,{omit:["rawTileData","sourceLayerCoder"]});class ac extends Ae{constructor(s,c,d,m){super(s,c),this.angle=d,void 0!==m&&(this.segment=m)}clone(){return new ac(this.x,this.y,this.angle,this.segment)}}function Ay(a,s,c,d,m){if(void 0===s.segment||0===c)return!0;let y=s,b=s.segment+1,C=0;for(;C>-c/2;){if(b--,b<0)return!1;C-=a[b].dist(y),y=a[b]}C+=a[b].dist(a[b+1]),b++;const I=[];let M=0;for(;C<c/2;){const O=a[b],F=a[b+1];if(!F)return!1;let j=a[b-1].angleTo(O)-O.angleTo(F);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:C,angleDelta:j}),M+=j;C-I[0].distance>d;)M-=I.shift().angleDelta;if(M>m)return!1;b++,C+=O.dist(F)}return!0}function My(a){let s=0;for(let c=0;c<a.length-1;c++)s+=a[c].dist(a[c+1]);return s}function Tf(a,s,c){return a?.6*s*c:0}function Af(a,s){return Math.max(a?a.right-a.left:0,s?s.right-s.left:0)}function _b(a,s,c,d,m,y){const b=Tf(c,m,y),C=Af(c,d)*y;let I=0;const M=My(a)/2;for(let O=0;O<a.length-1;O++){const F=a[O],j=a[O+1],q=F.dist(j);if(I+q>M){const Y=(M-I)/q,ee=On.number(F.x,j.x,Y),le=On.number(F.y,j.y,Y),ye=new ac(ee,le,j.angleTo(F),O);return ye._round(),!b||Ay(a,ye,C,b,s)?ye:void 0}I+=q}}function bh(a,s,c,d,m,y,b,C,I){const M=Tf(d,y,b),O=Af(d,m),F=O*b,j=0===a[0].x||a[0].x===I||0===a[0].y||a[0].y===I;return s-F<s/4&&(s=F+s/4),Py(a,j?s/2*C%s:(O/2+2*y)*b*C%s,s,M,c,F,j,!1,I)}function Py(a,s,c,d,m,y,b,C,I){const M=y/2,O=My(a);let F=0,j=s-c,q=[];for(let Y=0;Y<a.length-1;Y++){const ee=a[Y],le=a[Y+1],ye=ee.dist(le),Fe=le.angleTo(ee);for(;j+c<F+ye;){j+=c;const Ie=(j-F)/ye,Re=On.number(ee.x,le.x,Ie),Ge=On.number(ee.y,le.y,Ie);if(Re>=0&&Re<I&&Ge>=0&&Ge<I&&j-M>=0&&j+M<=O){const Ct=new ac(Re,Ge,Fe,Y);Ct._round(),d&&!Ay(a,Ct,y,d,m)||q.push(Ct)}}F+=ye}return C||q.length||b||(q=Py(a,F/2,c,d,m,y,b,!0,I)),q}Zt("Anchor",ac);const Td=xs;function fm(a,s,c,d){const m=[],y=a.image,b=y.pixelRatio,C=y.paddedRect.w-2*Td,I=y.paddedRect.h-2*Td;let M={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const O=y.stretchX||[[0,C]],F=y.stretchY||[[0,I]],j=(tt,Mn)=>tt+Mn[1]-Mn[0],q=O.reduce(j,0),Y=F.reduce(j,0),ee=C-q,le=I-Y;let ye=0,Fe=q,Ie=0,Re=Y,Ge=0,Ct=ee,un=0,Rn=le;if(y.content&&d){const tt=y.content,Mn=tt[2]-tt[0],Tn=tt[3]-tt[1];(y.textFitWidth||y.textFitHeight)&&(M=gb(a)),ye=wh(O,0,tt[0]),Ie=wh(F,0,tt[1]),Fe=wh(O,tt[0],tt[2]),Re=wh(F,tt[1],tt[3]),Ge=tt[0]-ye,un=tt[1]-Ie,Ct=Mn-Fe,Rn=Tn-Re}const Jt=M.x1,Gt=M.y1,Sn=M.x2-Jt,xn=M.y2-Gt,vn=(tt,Mn,Tn,Qn)=>{const gr=lc(tt.stretch-ye,Fe,Sn,Jt),ar=ku(tt.fixed-Ge,Ct,tt.stretch,q),nr=lc(Mn.stretch-Ie,Re,xn,Gt),xo=ku(Mn.fixed-un,Rn,Mn.stretch,Y),Ho=lc(Tn.stretch-ye,Fe,Sn,Jt),Mo=ku(Tn.fixed-Ge,Ct,Tn.stretch,q),Cs=lc(Qn.stretch-Ie,Re,xn,Gt),Ds=ku(Qn.fixed-un,Rn,Qn.stretch,Y),Es=new Ae(gr,nr),Kr=new Ae(Ho,nr),Co=new Ae(Ho,Cs),ls=new Ae(gr,Cs),qo=new Ae(ar/b,xo/b),Is=new Ae(Mo/b,Ds/b),Go=s*Math.PI/180;if(Go){const Pi=Math.sin(Go),yr=Math.cos(Go),Dr=[yr,-Pi,Pi,yr];Es._matMult(Dr),Kr._matMult(Dr),ls._matMult(Dr),Co._matMult(Dr)}const Ss=tt.stretch+tt.fixed,co=Mn.stretch+Mn.fixed;return{tl:Es,tr:Kr,bl:ls,br:Co,tex:{x:y.paddedRect.x+Td+Ss,y:y.paddedRect.y+Td+co,w:Tn.stretch+Tn.fixed-Ss,h:Qn.stretch+Qn.fixed-co},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:qo,pixelOffsetBR:Is,minFontScaleX:Ct/b/Sn,minFontScaleY:Rn/b/xn,isSDF:c}};if(d&&(y.stretchX||y.stretchY)){const tt=pm(O,ee,q),Mn=pm(F,le,Y);for(let Tn=0;Tn<tt.length-1;Tn++){const Qn=tt[Tn],gr=tt[Tn+1];for(let ar=0;ar<Mn.length-1;ar++)m.push(vn(Qn,Mn[ar],gr,Mn[ar+1]))}}else m.push(vn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:I+1}));return m}function wh(a,s,c){let d=0;for(const m of a)d+=Math.max(s,Math.min(c,m[1]))-Math.max(s,Math.min(c,m[0]));return d}function pm(a,s,c){const d=[{fixed:-Td,stretch:0}];for(const[m,y]of a){const b=d[d.length-1];d.push({fixed:m-b.stretch,stretch:b.stretch}),d.push({fixed:m-b.stretch,stretch:b.stretch+(y-m)})}return d.push({fixed:s+Td,stretch:c}),d}function lc(a,s,c,d){return a/s*c+d}function ku(a,s,c,d){return a-s*c/d}class xh{constructor(s,c,d,m,y,b,C,I,M,O){var F;if(this.boxStartIndex=s.length,M){let j=b.top,q=b.bottom;const Y=b.collisionPadding;Y&&(j-=Y[1],q+=Y[3]);let ee=q-j;ee>0&&(ee=Math.max(10,ee),this.circleDiameter=ee)}else{const j=null!==(F=b.image)&&void 0!==F&&F.content&&(b.image.textFitWidth||b.image.textFitHeight)?gb(b):{x1:b.left,y1:b.top,x2:b.right,y2:b.bottom};j.y1=j.y1*C-I[0],j.y2=j.y2*C+I[2],j.x1=j.x1*C-I[3],j.x2=j.x2*C+I[1];const q=b.collisionPadding;if(q&&(j.x1-=q[0]*C,j.y1-=q[1]*C,j.x2+=q[2]*C,j.y2+=q[3]*C),O){const Y=new Ae(j.x1,j.y1),ee=new Ae(j.x2,j.y1),le=new Ae(j.x1,j.y2),ye=new Ae(j.x2,j.y2),Fe=O*Math.PI/180;Y._rotate(Fe),ee._rotate(Fe),le._rotate(Fe),ye._rotate(Fe),j.x1=Math.min(Y.x,ee.x,le.x,ye.x),j.x2=Math.max(Y.x,ee.x,le.x,ye.x),j.y1=Math.min(Y.y,ee.y,le.y,ye.y),j.y2=Math.max(Y.y,ee.y,le.y,ye.y)}s.emplaceBack(c.x,c.y,j.x1,j.y1,j.x2,j.y2,d,m,y)}this.boxEndIndex=s.length}}class mm{constructor(s=[],c=((d,m)=>d<m?-1:d>m?1:0)){if(this.data=s,this.length=this.data.length,this.compare=c,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(0===this.length)return;const s=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:c,compare:d}=this,m=c[s];for(;s>0;){const y=s-1>>1,b=c[y];if(d(m,b)>=0)break;c[s]=b,s=y}c[s]=m}_down(s){const{data:c,compare:d}=this,m=this.length>>1,y=c[s];for(;s<m;){let b=1+(s<<1);const C=b+1;if(C<this.length&&d(c[C],c[b])<0&&(b=C),d(c[b],y)>=0)break;c[s]=c[b],s=b}c[s]=y}}function Mf(a,s=1,c=!1){let d=1/0,m=1/0,y=-1/0,b=-1/0;const C=a[0];for(let q=0;q<C.length;q++){const Y=C[q];(!q||Y.x<d)&&(d=Y.x),(!q||Y.y<m)&&(m=Y.y),(!q||Y.x>y)&&(y=Y.x),(!q||Y.y>b)&&(b=Y.y)}const I=Math.min(y-d,b-m);let M=I/2;const O=new mm([],bb);if(0===I)return new Ae(d,m);for(let q=d;q<y;q+=I)for(let Y=m;Y<b;Y+=I)O.push(new Ad(q+M,Y+M,M,a));let F=function(q){let Y=0,ee=0,le=0;const ye=q[0];for(let Fe=0,Ie=ye.length,Re=Ie-1;Fe<Ie;Re=Fe++){const Ge=ye[Fe],Ct=ye[Re],un=Ge.x*Ct.y-Ct.x*Ge.y;ee+=(Ge.x+Ct.x)*un,le+=(Ge.y+Ct.y)*un,Y+=3*un}return new Ad(ee/Y,le/Y,0,q)}(a),j=O.length;for(;O.length;){const q=O.pop();(q.d>F.d||!F.d)&&(F=q,c&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,j)),q.max-F.d<=s||(M=q.h/2,O.push(new Ad(q.p.x-M,q.p.y-M,M,a)),O.push(new Ad(q.p.x+M,q.p.y-M,M,a)),O.push(new Ad(q.p.x-M,q.p.y+M,M,a)),O.push(new Ad(q.p.x+M,q.p.y+M,M,a)),j+=4)}return c&&(console.log(`num probes: ${j}`),console.log(`best distance: ${F.d}`)),F.p}function bb(a,s){return s.max-a.max}function Ad(a,s,c,d){this.p=new Ae(a,s),this.h=c,this.d=function(m,y){let b=!1,C=1/0;for(let I=0;I<y.length;I++){const M=y[I];for(let O=0,F=M.length,j=F-1;O<F;j=O++){const q=M[O],Y=M[j];q.y>m.y!=Y.y>m.y&&m.x<(Y.x-q.x)*(m.y-q.y)/(Y.y-q.y)+q.x&&(b=!b),C=Math.min(C,ud(m,q,Y))}}return(b?1:-1)*Math.sqrt(C)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}var Uo;X.aq=void 0,(Uo=X.aq||(X.aq={}))[Uo.center=1]="center",Uo[Uo.left=2]="left",Uo[Uo.right=3]="right",Uo[Uo.top=4]="top",Uo[Uo.bottom=5]="bottom",Uo[Uo["top-left"]=6]="top-left",Uo[Uo["top-right"]=7]="top-right",Uo[Uo["bottom-left"]=8]="bottom-left",Uo[Uo["bottom-right"]=9]="bottom-right";const Qc=7,gm=Number.POSITIVE_INFINITY;function ky(a,s){return s[1]!==gm?function(c,d,m){let y=0,b=0;switch(d=Math.abs(d),m=Math.abs(m),c){case"top-right":case"top-left":case"top":b=m-Qc;break;case"bottom-right":case"bottom-left":case"bottom":b=-m+Qc}switch(c){case"top-right":case"bottom-right":case"right":y=-d;break;case"top-left":case"bottom-left":case"left":y=d}return[y,b]}(a,s[0],s[1]):function(c,d){let m=0,y=0;d<0&&(d=0);const b=d/Math.SQRT2;switch(c){case"top-right":case"top-left":y=b-Qc;break;case"bottom-right":case"bottom-left":y=-b+Qc;break;case"bottom":y=-d+Qc;break;case"top":y=d-Qc}switch(c){case"top-right":case"bottom-right":m=-b;break;case"top-left":case"bottom-left":m=b;break;case"left":m=d;break;case"right":m=-d}return[m,y]}(a,s[0])}function ym(a,s,c){var d;const m=a.layout,y=null===(d=m.get("text-variable-anchor-offset"))||void 0===d?void 0:d.evaluate(s,{},c);if(y){const C=y.values,I=[];for(let M=0;M<C.length;M+=2){const O=I[M]=C[M],F=C[M+1].map(j=>j*wo);O.startsWith("top")?F[1]-=Qc:O.startsWith("bottom")&&(F[1]+=Qc),I[M+1]=F}return new He(I)}const b=m.get("text-variable-anchor");if(b){let C;C=void 0!==a._unevaluatedLayout.getValue("text-radial-offset")?[m.get("text-radial-offset").evaluate(s,{},c)*wo,gm]:m.get("text-offset").evaluate(s,{},c).map(M=>M*wo);const I=[];for(const M of b)I.push(M,ky(M,C));return new He(I)}return null}function Md(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function vm(a,s,c,d,m,y,b,C,I,M,O){let F=y.textMaxSize.evaluate(s,{});void 0===F&&(F=b);const j=a.layers[0].layout,q=j.get("icon-offset").evaluate(s,{},O),Y=Ry(c.horizontal),ee=b/24,le=a.tilePixelRatio*ee,ye=a.tilePixelRatio*F/24,Fe=a.tilePixelRatio*C,Ie=a.tilePixelRatio*j.get("symbol-spacing"),Re=j.get("text-padding")*a.tilePixelRatio,Ge=function(tt,Mn,Tn,Qn=1){const gr=tt.get("icon-padding").evaluate(Mn,{},Tn),ar=gr&&gr.values;return[ar[0]*Qn,ar[1]*Qn,ar[2]*Qn,ar[3]*Qn]}(j,s,O,a.tilePixelRatio),Ct=j.get("text-max-angle")/180*Math.PI,un="viewport"!==j.get("text-rotation-alignment")&&"point"!==j.get("symbol-placement"),Rn="map"===j.get("icon-rotation-alignment")&&"point"!==j.get("symbol-placement"),Jt=j.get("symbol-placement"),Gt=Ie/2,Sn=j.get("icon-text-fit");let xn;d&&"none"!==Sn&&(a.allowVerticalPlacement&&c.vertical&&(xn=nm(d,c.vertical,Sn,j.get("icon-text-fit-padding"),q,ee)),Y&&(d=nm(d,Y,Sn,j.get("icon-text-fit-padding"),q,ee)));const vn=(tt,Mn)=>{Mn.x<0||Mn.x>=fo||Mn.y<0||Mn.y>=fo||function(Tn,Qn,gr,ar,nr,xo,Ho,Mo,Cs,Ds,Es,Kr,Co,ls,qo,Is,Go,Ss,co,Pi,yr,Dr,Vs,Yr,Dh){const uc=Tn.addToLineVertexArray(Qn,gr);let Ma,Ys,Pa,Wo,Tl=0,Eh=0,Fy=0,Ly=0,wm=-1,Nf=-1;const ka={};let xm=_s("");if(Tn.allowVerticalPlacement&&ar.vertical){const Do=Mo.layout.get("text-rotate").evaluate(yr,{},Yr)+90;Pa=new xh(Cs,Qn,Ds,Es,Kr,ar.vertical,Co,ls,qo,Do),Ho&&(Wo=new xh(Cs,Qn,Ds,Es,Kr,Ho,Go,Ss,qo,Do))}if(nr){const Do=Mo.layout.get("icon-rotate").evaluate(yr,{}),Js="none"!==Mo.layout.get("icon-text-fit"),eu=fm(nr,Do,Vs,Js),ga=Ho?fm(Ho,Do,Vs,Js):void 0;Ys=new xh(Cs,Qn,Ds,Es,Kr,nr,Go,Ss,!1,Do),Tl=4*eu.length;const Al=Tn.iconSizeData;let Ml=null;"source"===Al.kind?(Ml=[Sl*Mo.layout.get("icon-size").evaluate(yr,{})],Ml[0]>Yc&&en(`${Tn.layerIds[0]}: Value for "icon-size" is >= ${Cf}. Reduce your "icon-size".`)):"composite"===Al.kind&&(Ml=[Sl*Dr.compositeIconSizes[0].evaluate(yr,{},Yr),Sl*Dr.compositeIconSizes[1].evaluate(yr,{},Yr)],(Ml[0]>Yc||Ml[1]>Yc)&&en(`${Tn.layerIds[0]}: Value for "icon-size" is >= ${Cf}. Reduce your "icon-size".`)),Tn.addSymbols(Tn.icon,eu,Ml,Pi,co,yr,X.ah.none,Qn,uc.lineStartIndex,uc.lineLength,-1,Yr),wm=Tn.icon.placedSymbolArray.length-1,ga&&(Eh=4*ga.length,Tn.addSymbols(Tn.icon,ga,Ml,Pi,co,yr,X.ah.vertical,Qn,uc.lineStartIndex,uc.lineLength,-1,Yr),Nf=Tn.icon.placedSymbolArray.length-1)}const Bf=Object.keys(ar.horizontal);for(const Do of Bf){const Js=ar.horizontal[Do];if(!Ma){xm=_s(Js.text);const ga=Mo.layout.get("text-rotate").evaluate(yr,{},Yr);Ma=new xh(Cs,Qn,Ds,Es,Kr,Js,Co,ls,qo,ga)}const eu=1===Js.positionedLines.length;if(Fy+=Pf(Tn,Qn,Js,xo,Mo,qo,yr,Is,uc,ar.vertical?X.ah.horizontal:X.ah.horizontalOnly,eu?Bf:[Do],ka,wm,Dr,Yr),eu)break}ar.vertical&&(Ly+=Pf(Tn,Qn,ar.vertical,xo,Mo,qo,yr,Is,uc,X.ah.vertical,["vertical"],ka,Nf,Dr,Yr));const Cb=Ma?Ma.boxStartIndex:Tn.collisionBoxArray.length,ma=Ma?Ma.boxEndIndex:Tn.collisionBoxArray.length,Cm=Pa?Pa.boxStartIndex:Tn.collisionBoxArray.length,Db=Pa?Pa.boxEndIndex:Tn.collisionBoxArray.length,Ny=Ys?Ys.boxStartIndex:Tn.collisionBoxArray.length,By=Ys?Ys.boxEndIndex:Tn.collisionBoxArray.length,Eb=Wo?Wo.boxStartIndex:Tn.collisionBoxArray.length,Ib=Wo?Wo.boxEndIndex:Tn.collisionBoxArray.length;let Qa=-1;const zf=(Do,Js)=>Do&&Do.circleDiameter?Math.max(Do.circleDiameter,Js):Js;Qa=zf(Ma,Qa),Qa=zf(Pa,Qa),Qa=zf(Ys,Qa),Qa=zf(Wo,Qa);const Dm=Qa>-1?1:0;Dm&&(Qa*=Dh/wo),Tn.glyphOffsetArray.length>=Id.MAX_GLYPHS&&en("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==yr.sortKey&&Tn.addToSortKeyRanges(Tn.symbolInstances.length,yr.sortKey);const eD=ym(Mo,yr,Yr),[tD,Ih]=function(Do,Js){const eu=Do.length,ga=Js?.values;if(ga?.length>0)for(let Al=0;Al<ga.length;Al+=2){const Ml=ga[Al+1];Do.emplaceBack(X.aq[ga[Al]],Ml[0],Ml[1])}return[eu,Do.length]}(Tn.textAnchorOffsets,eD);Tn.symbolInstances.emplaceBack(Qn.x,Qn.y,ka.right>=0?ka.right:-1,ka.center>=0?ka.center:-1,ka.left>=0?ka.left:-1,ka.vertical||-1,wm,Nf,xm,Cb,ma,Cm,Db,Ny,By,Eb,Ib,Ds,Fy,Ly,Tl,Eh,Dm,0,Co,Qa,tD,Ih)}(a,Mn,tt,c,d,m,xn,a.layers[0],a.collisionBoxArray,s.index,s.sourceLayerIndex,a.index,le,[Re,Re,Re,Re],un,I,Fe,Ge,Rn,q,s,y,M,O,b)};if("line"===Jt)for(const tt of Ty(s.geometry,0,0,fo,fo)){const Mn=bh(tt,Ie,Ct,c.vertical||Y,d,24,ye,a.overscaling,fo);for(const Tn of Mn)Y&&wb(a,Y.text,Gt,Tn)||vn(tt,Tn)}else if("line-center"===Jt){for(const tt of s.geometry)if(tt.length>1){const Mn=_b(tt,Ct,c.vertical||Y,d,24,ye);Mn&&vn(tt,Mn)}}else if("Polygon"===s.type)for(const tt of Xi(s.geometry,0)){const Mn=Mf(tt,16);vn(tt[0],new ac(Mn.x,Mn.y,0))}else if("LineString"===s.type)for(const tt of s.geometry)vn(tt,new ac(tt[0].x,tt[0].y,0));else if("Point"===s.type)for(const tt of s.geometry)for(const Mn of tt)vn([Mn],new ac(Mn.x,Mn.y,0))}function Pf(a,s,c,d,m,y,b,C,I,M,O,F,j,q,Y){const ee=function(Fe,Ie,Re,Ge,Ct,un,Rn,Jt){const Gt=Ge.layout.get("text-rotate").evaluate(un,{})*Math.PI/180,Sn=[];for(const xn of Ie.positionedLines)for(const vn of xn.positionedGlyphs){if(!vn.rect)continue;const tt=vn.rect||{};let Mn=ch+1,Tn=!0,Qn=1,gr=0;const ar=(Ct||Jt)&&vn.vertical,nr=vn.metrics.advance*vn.scale/2;if(Jt&&Ie.verticalizable&&(gr=xn.lineOffset/2-(vn.imageName?-(wo-vn.metrics.width*vn.scale)/2:(vn.scale-1)*wo)),vn.imageName){const Pi=Rn[vn.imageName];Tn=Pi.sdf,Qn=Pi.pixelRatio,Mn=xs/Qn}const xo=Ct?[vn.x+nr,vn.y]:[0,0];let Ho=Ct?[0,0]:[vn.x+nr+Re[0],vn.y+Re[1]-gr],Mo=[0,0];ar&&(Mo=Ho,Ho=[0,0]);const Cs=vn.metrics.isDoubleResolution?2:1,Ds=(vn.metrics.left-Mn)*vn.scale-nr+Ho[0],Es=(-vn.metrics.top-Mn)*vn.scale+Ho[1],Kr=Ds+tt.w/Cs*vn.scale/Qn,Co=Es+tt.h/Cs*vn.scale/Qn,ls=new Ae(Ds,Es),qo=new Ae(Kr,Es),Is=new Ae(Ds,Co),Go=new Ae(Kr,Co);if(ar){const Pi=new Ae(-nr,nr-hh),yr=-Math.PI/2,Dr=wo/2-nr,Vs=new Ae(5-hh-Dr,-(vn.imageName?Dr:0)),Yr=new Ae(...Mo);ls._rotateAround(yr,Pi)._add(Vs)._add(Yr),qo._rotateAround(yr,Pi)._add(Vs)._add(Yr),Is._rotateAround(yr,Pi)._add(Vs)._add(Yr),Go._rotateAround(yr,Pi)._add(Vs)._add(Yr)}if(Gt){const Pi=Math.sin(Gt),yr=Math.cos(Gt),Dr=[yr,-Pi,Pi,yr];ls._matMult(Dr),qo._matMult(Dr),Is._matMult(Dr),Go._matMult(Dr)}const Ss=new Ae(0,0),co=new Ae(0,0);Sn.push({tl:ls,tr:qo,bl:Is,br:Go,tex:tt,writingMode:Ie.writingMode,glyphOffset:xo,sectionIndex:vn.sectionIndex,isSDF:Tn,pixelOffsetTL:Ss,pixelOffsetBR:co,minFontScaleX:0,minFontScaleY:0})}return Sn}(0,c,C,m,y,b,d,a.allowVerticalPlacement),le=a.textSizeData;let ye=null;"source"===le.kind?(ye=[Sl*m.layout.get("text-size").evaluate(b,{})],ye[0]>Yc&&en(`${a.layerIds[0]}: Value for "text-size" is >= ${Cf}. Reduce your "text-size".`)):"composite"===le.kind&&(ye=[Sl*q.compositeTextSizes[0].evaluate(b,{},Y),Sl*q.compositeTextSizes[1].evaluate(b,{},Y)],(ye[0]>Yc||ye[1]>Yc)&&en(`${a.layerIds[0]}: Value for "text-size" is >= ${Cf}. Reduce your "text-size".`)),a.addSymbols(a.text,ee,ye,C,y,b,M,s,I.lineStartIndex,I.lineLength,j,Y);for(const Fe of O)F[Fe]=a.text.placedSymbolArray.length-1;return 4*ee.length}function Ry(a){for(const s in a)return a[s];return null}function wb(a,s,c,d){const m=a.compareText;if(s in m){const y=m[s];for(let b=y.length-1;b>=0;b--)if(d.dist(y[b])<c)return!0}else m[s]=[];return m[s].push(d),!1}const kf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Rf{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,d]=new Uint8Array(s,0,2);if(219!==c)throw new Error("Data does not appear to be in a KDBush format.");const m=d>>4;if(1!==m)throw new Error(`Got v${m} data when expected v1.`);const y=kf[15&d];if(!y)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(s,2,1),[C]=new Uint32Array(s,4,1);return new Rf(C,b,y,s)}constructor(s,c=64,d=Float64Array,m){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=d,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const y=kf.indexOf(this.ArrayType),b=2*s*this.ArrayType.BYTES_PER_ELEMENT,C=s*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-C%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${d}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+C+I,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+b+C+I),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+C+I,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=s)}add(s,c){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=s,this.coords[this._pos++]=c,d}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return cc(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,c,d,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:b,nodeSize:C}=this,I=[0,y.length-1,0],M=[];for(;I.length;){const O=I.pop()||0,F=I.pop()||0,j=I.pop()||0;if(F-j<=C){for(let le=j;le<=F;le++){const ye=b[2*le],Fe=b[2*le+1];ye>=s&&ye<=d&&Fe>=c&&Fe<=m&&M.push(y[le])}continue}const q=j+F>>1,Y=b[2*q],ee=b[2*q+1];Y>=s&&Y<=d&&ee>=c&&ee<=m&&M.push(y[q]),(0===O?s<=Y:c<=ee)&&(I.push(j),I.push(q-1),I.push(1-O)),(0===O?d>=Y:m>=ee)&&(I.push(q+1),I.push(F),I.push(1-O))}return M}within(s,c,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:b}=this,C=[0,m.length-1,0],I=[],M=d*d;for(;C.length;){const O=C.pop()||0,F=C.pop()||0,j=C.pop()||0;if(F-j<=b){for(let le=j;le<=F;le++)xb(y[2*le],y[2*le+1],s,c)<=M&&I.push(m[le]);continue}const q=j+F>>1,Y=y[2*q],ee=y[2*q+1];xb(Y,ee,s,c)<=M&&I.push(m[q]),(0===O?s-d<=Y:c-d<=ee)&&(C.push(j),C.push(q-1),C.push(1-O)),(0===O?s+d>=Y:c+d>=ee)&&(C.push(q+1),C.push(F),C.push(1-O))}return I}}function cc(a,s,c,d,m,y){if(m-d<=c)return;const b=d+m>>1;_m(a,s,b,d,m,y),cc(a,s,c,d,b-1,1-y),cc(a,s,c,b+1,m,1-y)}function _m(a,s,c,d,m,y){for(;m>d;){if(m-d>600){const M=m-d+1,O=c-d+1,F=Math.log(M),j=.5*Math.exp(2*F/3),q=.5*Math.sqrt(F*j*(M-j)/M)*(O-M/2<0?-1:1);_m(a,s,c,Math.max(d,Math.floor(c-O*j/M+q)),Math.min(m,Math.floor(c+(M-O)*j/M+q)),y)}const b=s[2*c+y];let C=d,I=m;for(Pd(a,s,d,c),s[2*m+y]>b&&Pd(a,s,d,m);C<I;){for(Pd(a,s,C,I),C++,I--;s[2*C+y]<b;)C++;for(;s[2*I+y]>b;)I--}s[2*d+y]===b?Pd(a,s,d,I):(I++,Pd(a,s,I,m)),I<=c&&(d=I+1),c<=I&&(m=I-1)}}function Pd(a,s,c,d){bm(a,c,d),bm(s,2*c,2*d),bm(s,2*c+1,2*d+1)}function bm(a,s,c){const d=a[s];a[s]=a[c],a[c]=d}function xb(a,s,c,d){const m=a-c,y=s-d;return m*m+y*y}var kd;X.bf=void 0,(kd=X.bf||(X.bf={})).create="create",kd.load="load",kd.fullLoad="fullLoad";let Of=null,Rd=[];const Ff=1e3/60,Lf="loadTime",Ch="fullLoadTime",Oy={mark(a){performance.mark(a)},frame(a){const s=a;null!=Of&&Rd.push(s-Of),Of=s},clearMetrics(){Of=null,Rd=[],performance.clearMeasures(Lf),performance.clearMeasures(Ch);for(const a in X.bf)performance.clearMarks(X.bf[a])},getPerformanceMetrics(){performance.measure(Lf,X.bf.create,X.bf.load),performance.measure(Ch,X.bf.create,X.bf.fullLoad);const a=performance.getEntriesByName(Lf)[0].duration,s=performance.getEntriesByName(Ch)[0].duration,c=Rd.length,d=1/(Rd.reduce((y,b)=>y+b,0)/c/1e3),m=Rd.filter(y=>y>Ff).reduce((y,b)=>y+(b-Ff)/Ff,0);return{loadTime:a,fullLoadTime:s,fps:d,percentDroppedFrames:m/(c+m)*100,totalFrames:c}}};X.$=class extends se{},X.A=Xs,X.B=$o,X.C=function(a){if(null==on){const s=a.navigator?a.navigator.userAgent:null;on=!!a.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return on},X.D=o,X.E=ur,X.F=class{constructor(a,s){var c,m;this.target=a,this.mapId=s,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new vb(()=>this.process()),this.subscription=(m=c=>this.receive(c),(c=this.target).addEventListener("message",m,!1),{unsubscribe:()=>{c.removeEventListener("message",m,!1)}}),this.globalScope=at(self)?a:window}registerMessageHandler(a,s){this.messageHandlers[a]=s}sendAsync(a,s){return new Promise((c,d)=>{const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[m]={resolve:c,reject:d},s&&s.signal.addEventListener("abort",()=>{delete this.resolveRejects[m];const C={id:m,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(C)},{once:!0});const y=[],b=Object.assign(Object.assign({},a),{id:m,sourceMapId:this.mapId,origin:location.origin,data:$c(a.data,y)});this.target.postMessage(b,{transfer:y})})}receive(a){const s=a.data,c=s.id;if(!("file://"!==s.origin&&"file://"!==location.origin&&"resource://android"!==s.origin&&"resource://android"!==location.origin&&s.origin!==location.origin||s.targetMapId&&this.mapId!==s.targetMapId)){if("<cancel>"===s.type){delete this.tasks[c];const d=this.abortControllers[c];return delete this.abortControllers[c],void(d&&d.abort())}if(at(self)||s.mustQueue)return this.tasks[c]=s,this.taskQueue.push(c),void this.invoker.trigger();this.processTask(c,s)}}process(){if(0===this.taskQueue.length)return;const a=this.taskQueue.shift(),s=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),s&&this.processTask(a,s)}processTask(a,s){return x(this,void 0,void 0,function*(){if("<response>"===s.type){const m=this.resolveRejects[a];return delete this.resolveRejects[a],m?void(s.error?m.reject(Sa(s.error)):m.resolve(Sa(s.data))):void 0}if(!this.messageHandlers[s.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${s.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const c=Sa(s.data),d=new AbortController;this.abortControllers[a]=d;try{const m=yield this.messageHandlers[s.type](s.sourceMapId,c,d);this.completeTask(a,null,m)}catch(m){this.completeTask(a,m)}})}completeTask(a,s,c){const d=[];delete this.abortControllers[a];const m={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:s?$c(s):null,data:$c(c,d)};this.target.postMessage(m,{transfer:d})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},X.G=Ye,X.H=function(){var a=new Xs(16);return Xs!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},X.I=uh,X.J=function(a,s,c){var d,m,y,b,C,I,M,O,F,j,q,Y,ee=c[0],le=c[1],ye=c[2];return s===a?(a[12]=s[0]*ee+s[4]*le+s[8]*ye+s[12],a[13]=s[1]*ee+s[5]*le+s[9]*ye+s[13],a[14]=s[2]*ee+s[6]*le+s[10]*ye+s[14],a[15]=s[3]*ee+s[7]*le+s[11]*ye+s[15]):(m=s[1],y=s[2],b=s[3],C=s[4],I=s[5],M=s[6],O=s[7],F=s[8],j=s[9],q=s[10],Y=s[11],a[0]=d=s[0],a[1]=m,a[2]=y,a[3]=b,a[4]=C,a[5]=I,a[6]=M,a[7]=O,a[8]=F,a[9]=j,a[10]=q,a[11]=Y,a[12]=d*ee+C*le+F*ye+s[12],a[13]=m*ee+I*le+j*ye+s[13],a[14]=y*ee+M*le+q*ye+s[14],a[15]=b*ee+O*le+Y*ye+s[15]),a},X.K=function(a,s,c){var d=c[0],m=c[1],y=c[2];return a[0]=s[0]*d,a[1]=s[1]*d,a[2]=s[2]*d,a[3]=s[3]*d,a[4]=s[4]*m,a[5]=s[5]*m,a[6]=s[6]*m,a[7]=s[7]*m,a[8]=s[8]*y,a[9]=s[9]*y,a[10]=s[10]*y,a[11]=s[11]*y,a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15],a},X.L=Hp,X.M=function(a,s){const c={};for(let d=0;d<s.length;d++){const m=s[d];m in a&&(c[m]=a[m])}return c},X.N=sc,X.O=Cy,X.P=Ae,X.Q=Dy,X.R=Ks,X.S=$s,X.T=Vc,X.U=ct,X.V=It,X.W=Nt,X.X=fo,X.Y=W,X.Z=vh,X._=x,X.a=fe,X.a$=function(a,s){return a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a[4]=s[4],a[5]=s[5],a[6]=s[6],a[7]=s[7],a[8]=s[8],a[9]=s[9],a[10]=s[10],a[11]=s[11],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15],a},X.a0=Oo,X.a1=_h,X.a2=it,X.a3=a=>{const s=window.document.createElement("video");return s.muted=!0,new Promise(c=>{s.onloadstart=()=>{c(s)};for(const d of a){const m=window.document.createElement("source");jt(d)||(s.crossOrigin="Anonymous"),m.src=d,s.appendChild(m)}})},X.a4=function(){return bn++},X.a5=Vo,X.a6=Id,X.a7=gl,X.a8=Cu,X.a9=dm,X.aA=function(a){if("custom"===a.type)return new yb(a);switch(a.type){case"background":return new wy(a);case"circle":return new qp(a);case"fill":return new HC(a);case"fill-extrusion":return new Bs(a);case"heatmap":return new Z_(a);case"hillshade":return new Du(a);case"line":return new qC(a);case"raster":return new Jc(a);case"symbol":return new gh(a)}},X.aB=Je,X.aC=function(a,s){if(!a)return[{command:"setStyle",args:[s]}];let c=[];try{if(!Pn(a.version,s.version))return[{command:"setStyle",args:[s]}];Pn(a.center,s.center)||c.push({command:"setCenter",args:[s.center]}),Pn(a.zoom,s.zoom)||c.push({command:"setZoom",args:[s.zoom]}),Pn(a.bearing,s.bearing)||c.push({command:"setBearing",args:[s.bearing]}),Pn(a.pitch,s.pitch)||c.push({command:"setPitch",args:[s.pitch]}),Pn(a.sprite,s.sprite)||c.push({command:"setSprite",args:[s.sprite]}),Pn(a.glyphs,s.glyphs)||c.push({command:"setGlyphs",args:[s.glyphs]}),Pn(a.transition,s.transition)||c.push({command:"setTransition",args:[s.transition]}),Pn(a.light,s.light)||c.push({command:"setLight",args:[s.light]}),Pn(a.terrain,s.terrain)||c.push({command:"setTerrain",args:[s.terrain]}),Pn(a.sky,s.sky)||c.push({command:"setSky",args:[s.sky]}),Pn(a.projection,s.projection)||c.push({command:"setProjection",args:[s.projection]});const d={},m=[];!function(b,C,I,M){let O;for(O in C=C||{},b=b||{})Object.prototype.hasOwnProperty.call(b,O)&&(Object.prototype.hasOwnProperty.call(C,O)||Ne(O,I,M));for(O in C)Object.prototype.hasOwnProperty.call(C,O)&&(Object.prototype.hasOwnProperty.call(b,O)?Pn(b[O],C[O])||("geojson"===b[O].type&&"geojson"===C[O].type&&wn(b,C,O)?Vn(I,{command:"setGeoJSONSourceData",args:[O,C[O].data]}):et(O,C,I,M)):ht(O,C,I))}(a.sources,s.sources,m,d);const y=[];a.layers&&a.layers.forEach(b=>{"source"in b&&d[b.source]?c.push({command:"removeLayer",args:[b.id]}):y.push(b)}),c=c.concat(m),function(b,C,I){C=C||[];const M=(b=b||[]).map($i),O=C.map($i),F=b.reduce(ki,{}),j=C.reduce(ki,{}),q=M.slice(),Y=Object.create(null);let ee,le,ye,Fe,Ie;for(let Re=0,Ge=0;Re<M.length;Re++)ee=M[Re],Object.prototype.hasOwnProperty.call(j,ee)?Ge++:(Vn(I,{command:"removeLayer",args:[ee]}),q.splice(q.indexOf(ee,Ge),1));for(let Re=0,Ge=0;Re<O.length;Re++)ee=O[O.length-1-Re],q[q.length-1-Re]!==ee&&(Object.prototype.hasOwnProperty.call(F,ee)?(Vn(I,{command:"removeLayer",args:[ee]}),q.splice(q.lastIndexOf(ee,q.length-Ge),1)):Ge++,Fe=q[q.length-Re],Vn(I,{command:"addLayer",args:[j[ee],Fe]}),q.splice(q.length-Re,0,ee),Y[ee]=!0);for(let Re=0;Re<O.length;Re++)if(ee=O[Re],le=F[ee],ye=j[ee],!Y[ee]&&!Pn(le,ye))if(Pn(le.source,ye.source)&&Pn(le["source-layer"],ye["source-layer"])&&Pn(le.type,ye.type)){for(Ie in Fn(le.layout,ye.layout,I,ee,null,"setLayoutProperty"),Fn(le.paint,ye.paint,I,ee,null,"setPaintProperty"),Pn(le.filter,ye.filter)||Vn(I,{command:"setFilter",args:[ee,ye.filter]}),Pn(le.minzoom,ye.minzoom)&&Pn(le.maxzoom,ye.maxzoom)||Vn(I,{command:"setLayerZoomRange",args:[ee,ye.minzoom,ye.maxzoom]}),le)Object.prototype.hasOwnProperty.call(le,Ie)&&"layout"!==Ie&&"paint"!==Ie&&"filter"!==Ie&&"metadata"!==Ie&&"minzoom"!==Ie&&"maxzoom"!==Ie&&(0===Ie.indexOf("paint.")?Fn(le[Ie],ye[Ie],I,ee,Ie.slice(6),"setPaintProperty"):Pn(le[Ie],ye[Ie])||Vn(I,{command:"setLayerProperty",args:[ee,Ie,ye[Ie]]}));for(Ie in ye)Object.prototype.hasOwnProperty.call(ye,Ie)&&!Object.prototype.hasOwnProperty.call(le,Ie)&&"layout"!==Ie&&"paint"!==Ie&&"filter"!==Ie&&"metadata"!==Ie&&"minzoom"!==Ie&&"maxzoom"!==Ie&&(0===Ie.indexOf("paint.")?Fn(le[Ie],ye[Ie],I,ee,Ie.slice(6),"setPaintProperty"):Pn(le[Ie],ye[Ie])||Vn(I,{command:"setLayerProperty",args:[ee,Ie,ye[Ie]]}))}else Vn(I,{command:"removeLayer",args:[ee]}),Fe=q[q.lastIndexOf(ee)+1],Vn(I,{command:"addLayer",args:[ye,Fe]})}(y,s.layers,c)}catch(d){console.warn("Unable to compute style diff:",d),c=[{command:"setStyle",args:[s]}]}return c},X.aD=function(a){const s=[],c=a.id;return void 0===c&&s.push({message:`layers.${c}: missing required property "id"`}),void 0===a.render&&s.push({message:`layers.${c}: missing required method "render"`}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&s.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),s},X.aE=function a(s,c){if(Array.isArray(s)){if(!Array.isArray(c)||s.length!==c.length)return!1;for(let d=0;d<s.length;d++)if(!a(s[d],c[d]))return!1;return!0}if("object"==typeof s&&null!==s&&null!==c){if("object"!=typeof c||Object.keys(s).length!==Object.keys(c).length)return!1;for(const d in s)if(!a(s[d],c[d]))return!1;return!0}return s===c},X.aF=ze,X.aG=lt,X.aH=class extends _u{constructor(a,s){super(a,s),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},X.aI=Yh,X.aJ=class extends _u{constructor(a,s){super(a,s),this.current=Fg}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let s=1;s<16;s++)if(a[s]!==this.current[s]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},X.aK=Og,X.aL=ic,X.aM=Ri,X.aN=class extends _u{constructor(a,s){super(a,s),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},X.aO=class extends _u{constructor(a,s){super(a,s),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},X.aP=function(a,s,c,d,m,y,b){var C=1/(s-c),I=1/(d-m),M=1/(y-b);return a[0]=-2*C,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*I,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*M,a[11]=0,a[12]=(s+c)*C,a[13]=(m+d)*I,a[14]=(b+y)*M,a[15]=1,a},X.aQ=W_,X.aR=class extends sn{},X.aS=sb,X.aT=class extends zt{},X.aU=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},X.aV=sf,X.aW=Za,X.aX=Dl,X.aY=class extends yi{},X.aZ=function(a,s){return a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]&&a[3]===s[3]&&a[4]===s[4]&&a[5]===s[5]&&a[6]===s[6]&&a[7]===s[7]&&a[8]===s[8]&&a[9]===s[9]&&a[10]===s[10]&&a[11]===s[11]&&a[12]===s[12]&&a[13]===s[13]&&a[14]===s[14]&&a[15]===s[15]},X.a_=function(a,s){var c=a[0],d=a[1],m=a[2],y=a[3],b=a[4],C=a[5],I=a[6],M=a[7],O=a[8],F=a[9],j=a[10],q=a[11],Y=a[12],ee=a[13],le=a[14],ye=a[15],Fe=s[0],Ie=s[1],Re=s[2],Ge=s[3],Ct=s[4],un=s[5],Rn=s[6],Jt=s[7],Gt=s[8],Sn=s[9],xn=s[10],vn=s[11],tt=s[12],Mn=s[13],Tn=s[14],Qn=s[15];return Math.abs(c-Fe)<=bo*Math.max(1,Math.abs(c),Math.abs(Fe))&&Math.abs(d-Ie)<=bo*Math.max(1,Math.abs(d),Math.abs(Ie))&&Math.abs(m-Re)<=bo*Math.max(1,Math.abs(m),Math.abs(Re))&&Math.abs(y-Ge)<=bo*Math.max(1,Math.abs(y),Math.abs(Ge))&&Math.abs(b-Ct)<=bo*Math.max(1,Math.abs(b),Math.abs(Ct))&&Math.abs(C-un)<=bo*Math.max(1,Math.abs(C),Math.abs(un))&&Math.abs(I-Rn)<=bo*Math.max(1,Math.abs(I),Math.abs(Rn))&&Math.abs(M-Jt)<=bo*Math.max(1,Math.abs(M),Math.abs(Jt))&&Math.abs(O-Gt)<=bo*Math.max(1,Math.abs(O),Math.abs(Gt))&&Math.abs(F-Sn)<=bo*Math.max(1,Math.abs(F),Math.abs(Sn))&&Math.abs(j-xn)<=bo*Math.max(1,Math.abs(j),Math.abs(xn))&&Math.abs(q-vn)<=bo*Math.max(1,Math.abs(q),Math.abs(vn))&&Math.abs(Y-tt)<=bo*Math.max(1,Math.abs(Y),Math.abs(tt))&&Math.abs(ee-Mn)<=bo*Math.max(1,Math.abs(ee),Math.abs(Mn))&&Math.abs(le-Tn)<=bo*Math.max(1,Math.abs(le),Math.abs(Tn))&&Math.abs(ye-Qn)<=bo*Math.max(1,Math.abs(ye),Math.abs(Qn))},X.aa=function(a){const s={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,d,m,y)=>{const b=m||y;return s[d]=!b||b.toLowerCase(),""}),s["max-age"]){const c=parseInt(s["max-age"],10);isNaN(c)?delete s["max-age"]:s["max-age"]=c}return s},X.ab=function(a,s){const c=[];for(const d in a)d in s||c.push(d);return c},X.ac=Qe,X.ad=function(a,s,c){var d=Math.sin(c),m=Math.cos(c),y=s[0],b=s[1],C=s[2],I=s[3],M=s[4],O=s[5],F=s[6],j=s[7];return s!==a&&(a[8]=s[8],a[9]=s[9],a[10]=s[10],a[11]=s[11],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[0]=y*m+M*d,a[1]=b*m+O*d,a[2]=C*m+F*d,a[3]=I*m+j*d,a[4]=M*m-y*d,a[5]=O*m-b*d,a[6]=F*m-C*d,a[7]=j*m-I*d,a},X.ae=function(a){var s=new Xs(16);return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4],s[5]=a[5],s[6]=a[6],s[7]=a[7],s[8]=a[8],s[9]=a[9],s[10]=a[10],s[11]=a[11],s[12]=a[12],s[13]=a[13],s[14]=a[14],s[15]=a[15],s},X.af=dd,X.ag=function(a,s){let c=0,d=0;if("constant"===a.kind)d=a.layoutSize;else if("source"!==a.kind){const{interpolationType:m,minZoom:y,maxZoom:b}=a,C=m?Qe(ai.interpolationFactor(m,s,y,b),0,1):0;"camera"===a.kind?d=On.number(a.minSize,a.maxSize,C):c=C}return{uSizeT:c,uSize:d}},X.ai=function(a,{uSize:s,uSizeT:c},{lowerSize:d,upperSize:m}){return"source"===a.kind?d/Sl:"composite"===a.kind?On.number(d/Sl,m/Sl,c):s},X.aj=yy,X.ak=function(a,s,c,d){const m=s.y-a.y,y=s.x-a.x,b=d.y-c.y,C=d.x-c.x,I=b*y-C*m;if(0===I)return null;const M=(C*(a.y-c.y)-b*(a.x-c.x))/I;return new Ae(a.x+M*y,a.y+M*m)},X.al=Ty,X.am=Ng,X.an=Up,X.ao=function(a){let s=1/0,c=1/0,d=-1/0,m=-1/0;for(const y of a)s=Math.min(s,y.x),c=Math.min(c,y.y),d=Math.max(d,y.x),m=Math.max(m,y.y);return[s,c,d,m]},X.ap=wo,X.ar=gy,X.as=function(a,s){var c=s[0],d=s[1],m=s[2],y=s[3],b=s[4],C=s[5],I=s[6],M=s[7],O=s[8],F=s[9],j=s[10],q=s[11],Y=s[12],ee=s[13],le=s[14],ye=s[15],Fe=c*C-d*b,Ie=c*I-m*b,Re=c*M-y*b,Ge=d*I-m*C,Ct=d*M-y*C,un=m*M-y*I,Rn=O*ee-F*Y,Jt=O*le-j*Y,Gt=O*ye-q*Y,Sn=F*le-j*ee,xn=F*ye-q*ee,vn=j*ye-q*le,tt=Fe*vn-Ie*xn+Re*Sn+Ge*Gt-Ct*Jt+un*Rn;return tt?(a[0]=(C*vn-I*xn+M*Sn)*(tt=1/tt),a[1]=(m*xn-d*vn-y*Sn)*tt,a[2]=(ee*un-le*Ct+ye*Ge)*tt,a[3]=(j*Ct-F*un-q*Ge)*tt,a[4]=(I*Gt-b*vn-M*Jt)*tt,a[5]=(c*vn-m*Gt+y*Jt)*tt,a[6]=(le*Re-Y*un-ye*Ie)*tt,a[7]=(O*un-j*Re+q*Ie)*tt,a[8]=(b*xn-C*Gt+M*Rn)*tt,a[9]=(d*Gt-c*xn-y*Rn)*tt,a[10]=(Y*Ct-ee*Re+ye*Fe)*tt,a[11]=(F*Re-O*Ct-q*Fe)*tt,a[12]=(C*Jt-b*Sn-I*Rn)*tt,a[13]=(c*Sn-d*Jt+m*Rn)*tt,a[14]=(ee*Ie-Y*Ge-le*Fe)*tt,a[15]=(O*Ge-F*Ie+j*Fe)*tt,a):null},X.at=Md,X.au=xf,X.av=Rf,X.aw=function(){const a={},s=ve.$version;for(const c in ve.$root){const d=ve.$root[c];if(d.required){let m=null;m="version"===c?s:"array"===d.type?[]:{},null!=m&&(a[c]=m)}}return a},X.ax=da,X.ay=kt,X.az=function(a){a=a.slice();const s=Object.create(null);for(let c=0;c<a.length;c++)s[a[c].id]=a[c];for(let c=0;c<a.length;c++)"ref"in a[c]&&(a[c]=dr(a[c],s[a[c].ref]));return a},X.b=ut,X.b0=function(a,s,c){return a[0]=s[0]*c[0],a[1]=s[1]*c[1],a[2]=s[2]*c[2],a[3]=s[3]*c[3],a},X.b1=function(a,s){return a[0]*s[0]+a[1]*s[1]+a[2]*s[2]+a[3]*s[3]},X.b2=bt,X.b3=cm,X.b4=am,X.b5=function(a,s,c,d,m){var y,b=1/Math.tan(s/2);return a[0]=b/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=m&&m!==1/0?(a[10]=(m+d)*(y=1/(d-m)),a[14]=2*m*d*y):(a[10]=-1,a[14]=-2*d),a},X.b6=function(a,s,c){var d=Math.sin(c),m=Math.cos(c),y=s[4],b=s[5],C=s[6],I=s[7],M=s[8],O=s[9],F=s[10],j=s[11];return s!==a&&(a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[4]=y*m+M*d,a[5]=b*m+O*d,a[6]=C*m+F*d,a[7]=I*m+j*d,a[8]=M*m-y*d,a[9]=O*m-b*d,a[10]=F*m-C*d,a[11]=j*m-I*d,a},X.b7=pt,X.b8=mt,X.b9=function(a){return a*Math.PI/180},X.bA=function(a){return a.message===ge},X.bB=ml,X.bC=Ta,X.ba=function(a,s){const{x:c,y:d}=vh.fromLngLat(s);return!(a<0||a>25||d<0||d>=1||c<0||c>=1)},X.bb=function(a,s){return a[0]=s[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=s[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},X.bc=class extends de{},X.bd=sm,X.be=Oy,X.bg=qt,X.bh=function(a,s){fe.REGISTERED_PROTOCOLS[a]=s},X.bi=function(a){delete fe.REGISTERED_PROTOCOLS[a]},X.bj=function(a,s){const c={};for(let m=0;m<a.length;m++){const y=s&&s[a[m].id]||nd(a[m]);s&&(s[a[m].id]=y);let b=c[y];b||(b=c[y]=[]),b.push(a[m])}const d=[];for(const m in c)d.push(c[m]);return d},X.bk=Zt,X.bl=um,X.bm=Ey,X.bn=dh,X.bo=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=fo/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const s=a.bucket.layers[0],c=s.layout,d=s._unevaluatedLayout._values,m={layoutIconSize:d["icon-size"].possiblyEvaluate(new sr(a.bucket.zoom+1),a.canonical),layoutTextSize:d["text-size"].possiblyEvaluate(new sr(a.bucket.zoom+1),a.canonical),textMaxSize:d["text-size"].possiblyEvaluate(new sr(18))};if("composite"===a.bucket.textSizeData.kind){const{minZoom:M,maxZoom:O}=a.bucket.textSizeData;m.compositeTextSizes=[d["text-size"].possiblyEvaluate(new sr(M),a.canonical),d["text-size"].possiblyEvaluate(new sr(O),a.canonical)]}if("composite"===a.bucket.iconSizeData.kind){const{minZoom:M,maxZoom:O}=a.bucket.iconSizeData;m.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new sr(M),a.canonical),d["icon-size"].possiblyEvaluate(new sr(O),a.canonical)]}const y=c.get("text-line-height")*wo,b="viewport"!==c.get("text-rotation-alignment")&&"point"!==c.get("symbol-placement"),C=c.get("text-keep-upright"),I=c.get("text-size");for(const M of a.bucket.features){const O=c.get("text-font").evaluate(M,{},a.canonical).join(","),F=I.evaluate(M,{},a.canonical),j=m.layoutTextSize.evaluate(M,{},a.canonical),q=m.layoutIconSize.evaluate(M,{},a.canonical),Y={horizontal:{},vertical:void 0},ee=M.text;let le,ye=[0,0];if(ee){const Re=ee.toString(),Ge=c.get("text-letter-spacing").evaluate(M,{},a.canonical)*wo,Ct=T(Re)?Ge:0,un=c.get("text-anchor").evaluate(M,{},a.canonical),Rn=ym(s,M,a.canonical);if(!Rn){const xn=c.get("text-radial-offset").evaluate(M,{},a.canonical);ye=xn?ky(un,[xn*wo,gm]):c.get("text-offset").evaluate(M,{},a.canonical).map(vn=>vn*wo)}let Jt=b?"center":c.get("text-justify").evaluate(M,{},a.canonical);const Gt="point"===c.get("symbol-placement")?c.get("text-max-width").evaluate(M,{},a.canonical)*wo:1/0,Sn=()=>{a.bucket.allowVerticalPlacement&&V(Re)&&(Y.vertical=Kc(ee,a.glyphMap,a.glyphPositions,a.imagePositions,O,Gt,y,un,"left",Ct,ye,X.ah.vertical,!0,j,F))};if(!b&&Rn){const xn=new Set;if("auto"===Jt)for(let tt=0;tt<Rn.values.length;tt+=2)xn.add(Md(Rn.values[tt]));else xn.add(Jt);let vn=!1;for(const tt of xn)if(!Y.horizontal[tt])if(vn)Y.horizontal[tt]=Y.horizontal[0];else{const Mn=Kc(ee,a.glyphMap,a.glyphPositions,a.imagePositions,O,Gt,y,"center",tt,Ct,ye,X.ah.horizontal,!1,j,F);Mn&&(Y.horizontal[tt]=Mn,vn=1===Mn.positionedLines.length)}Sn()}else{"auto"===Jt&&(Jt=Md(un));const xn=Kc(ee,a.glyphMap,a.glyphPositions,a.imagePositions,O,Gt,y,un,Jt,Ct,ye,X.ah.horizontal,!1,j,F);xn&&(Y.horizontal[Jt]=xn),Sn(),V(Re)&&b&&C&&(Y.vertical=Kc(ee,a.glyphMap,a.glyphPositions,a.imagePositions,O,Gt,y,un,Jt,Ct,ye,X.ah.vertical,!1,j,F))}}let Fe=!1;if(M.icon&&M.icon.name){const Re=a.imageMap[M.icon.name];Re&&(le=my(a.imagePositions[M.icon.name],c.get("icon-offset").evaluate(M,{},a.canonical),c.get("icon-anchor").evaluate(M,{},a.canonical)),Fe=!!Re.sdf,void 0===a.bucket.sdfIcons?a.bucket.sdfIcons=Fe:a.bucket.sdfIcons!==Fe&&en("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Re.pixelRatio!==a.bucket.pixelRatio||0!==c.get("icon-rotate").constantOr(1))&&(a.bucket.iconsNeedLinear=!0))}const Ie=Ry(Y.horizontal)||Y.vertical;a.bucket.iconsInText=!!Ie&&Ie.iconsInText,(Ie||le)&&vm(a.bucket,M,Y,le,a.imageMap,m,j,q,ye,Fe,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},X.bp=gf,X.bq=Xp,X.br=Jp,X.bs=as,X.bt=lh,X.bu=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return 0===a.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},X.bv=function(a,s,c,d,m){return x(this,void 0,void 0,function*(){if(It())try{return yield Nt(a,s,c,d,m)}catch{}return function(y,b,C,I,M){const O=y.width,F=y.height;gt&&Xe||(gt=new OffscreenCanvas(O,F),Xe=gt.getContext("2d",{willReadFrequently:!0})),gt.width=O,gt.height=F,Xe.drawImage(y,0,0,O,F);const j=Xe.getImageData(b,C,I,M);return Xe.clearRect(0,0,O,F),j.data}(a,s,c,d,m)})},X.bw=Sd,X.bx=an,X.by=hn,X.bz=bd,X.c=be,X.d=a=>x(void 0,void 0,void 0,function*(){if(0===a.byteLength)return createImageBitmap(new ImageData(1,1));const s=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(s)}catch(c){throw new Error(`Could not load image because of ${c.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),X.e=Ze,X.f=a=>new Promise((s,c)=>{const d=new Image;d.onload=()=>{s(d),URL.revokeObjectURL(d.src),d.onload=null,window.requestAnimationFrame(()=>{d.src=Gn})},d.onerror=()=>c(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const m=new Blob([new Uint8Array(a)],{type:"image/png"});d.src=a.byteLength?URL.createObjectURL(m):Gn}),X.g=Z,X.h=(a,s)=>Lt(Ze(a,{type:"json"}),s),X.i=at,X.j=ri,X.k=Ui,X.l=(a,s)=>Lt(Ze(a,{type:"arrayBuffer"}),s),X.m=Lt,X.n=function(a){return new lh(a).readFields(db,[])},X.o=hd,X.p=uy,X.q=D,X.r=Tr,X.s=jt,X.t=bl,X.u=gs,X.v=ve,X.w=en,X.x=function([a,s,c]){return s+=90,s*=Math.PI/180,c*=Math.PI/180,{x:a*Math.cos(s)*Math.sin(c),y:a*Math.sin(s)*Math.sin(c),z:a*Math.cos(c)}},X.y=On,X.z=sr}),We("worker",0,function(X){class x{constructor(U){this.keyCache={},U&&this.replace(U)}replace(U){this._layerConfigs={},this._layers={},this.update(U,[])}update(U,H){for(const re of U){this._layerConfigs[re.id]=re;const Ce=this._layers[re.id]=X.aA(re);Ce._featureFilter=X.a7(Ce.filter),this.keyCache[re.id]&&delete this.keyCache[re.id]}for(const re of H)delete this.keyCache[re],delete this._layerConfigs[re],delete this._layers[re];this.familiesBySource={};const J=X.bj(Object.values(this._layerConfigs),this.keyCache);for(const re of J){const Ce=re.map(Le=>this._layers[Le.id]),Te=Ce[0];if("none"===Te.visibility)continue;const ke=Te.source||"";let ce=this.familiesBySource[ke];ce||(ce=this.familiesBySource[ke]={});const $e=Te.sourceLayer||"_geojsonTileLayer";let rt=ce[$e];rt||(rt=ce[$e]=[]),rt.push(Ce)}}}class an{constructor(U){const H={},J=[];for(const ke in U){const ce=U[ke],$e=H[ke]={};for(const rt in ce){const Le=ce[+rt];if(!Le||0===Le.bitmap.width||0===Le.bitmap.height)continue;const wt={x:0,y:0,w:Le.bitmap.width+2,h:Le.bitmap.height+2};J.push(wt),$e[rt]={rect:wt,metrics:Le.metrics}}}const{w:re,h:Ce}=X.p(J),Te=new X.o({width:re||1,height:Ce||1});for(const ke in U){const ce=U[ke];for(const $e in ce){const rt=ce[+$e];if(!rt||0===rt.bitmap.width||0===rt.bitmap.height)continue;const Le=H[ke][$e].rect;X.o.copy(rt.bitmap,Te,{x:0,y:0},{x:Le.x+1,y:Le.y+1},rt.bitmap)}}this.image=Te,this.positions=H}}X.bk("GlyphAtlas",an);class hn{constructor(U){this.tileID=new X.S(U.tileID.overscaledZ,U.tileID.wrap,U.tileID.canonical.z,U.tileID.canonical.x,U.tileID.canonical.y),this.uid=U.uid,this.zoom=U.zoom,this.pixelRatio=U.pixelRatio,this.tileSize=U.tileSize,this.source=U.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=U.showCollisionBoxes,this.collectResourceTiming=!!U.collectResourceTiming,this.returnDependencies=!!U.returnDependencies,this.promoteId=U.promoteId,this.inFlightDependencies=[]}parse(U,H,J,re){return X._(this,void 0,void 0,function*(){this.status="parsing",this.data=U,this.collisionBoxArray=new X.a5;const Ce=new X.bl(Object.keys(U.layers).sort()),Te=new X.bm(this.tileID,this.promoteId);Te.bucketLayerIDs=[];const ke={},ce={featureIndex:Te,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:J},$e=H.familiesBySource[this.source];for(const ei in $e){const si=U.layers[ei];if(!si)continue;1===si.version&&X.w(`Vector tile source "${this.source}" layer "${ei}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const qi=Ce.encode(ei),mi=[];for(let _r=0;_r<si.length;_r++){const Ci=si.feature(_r),Us=Te.getId(Ci,ei);mi.push({feature:Ci,id:Us,index:_r,sourceLayerIndex:qi})}for(const _r of $e[ei]){const Ci=_r[0];Ci.source!==this.source&&X.w(`layer.source = ${Ci.source} does not equal this.source = ${this.source}`),Ci.minzoom&&this.zoom<Math.floor(Ci.minzoom)||Ci.maxzoom&&this.zoom>=Ci.maxzoom||"none"!==Ci.visibility&&(st(_r,this.zoom,J),(ke[Ci.id]=Ci.createBucket({index:Te.bucketLayerIDs.length,layers:_r,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:qi,sourceID:this.source})).populate(mi,ce,this.tileID.canonical),Te.bucketLayerIDs.push(_r.map(Us=>Us.id)))}}const rt=X.aF(ce.glyphDependencies,ei=>Object.keys(ei).map(Number));this.inFlightDependencies.forEach(ei=>ei?.abort()),this.inFlightDependencies=[];let Le=Promise.resolve({});if(Object.keys(rt).length){const ei=new AbortController;this.inFlightDependencies.push(ei),Le=re.sendAsync({type:"GG",data:{stacks:rt,source:this.source,tileID:this.tileID,type:"glyphs"}},ei)}const wt=Object.keys(ce.iconDependencies);let Ut=Promise.resolve({});if(wt.length){const ei=new AbortController;this.inFlightDependencies.push(ei),Ut=re.sendAsync({type:"GI",data:{icons:wt,source:this.source,tileID:this.tileID,type:"icons"}},ei)}const tn=Object.keys(ce.patternDependencies);let kn=Promise.resolve({});if(tn.length){const ei=new AbortController;this.inFlightDependencies.push(ei),kn=re.sendAsync({type:"GI",data:{icons:tn,source:this.source,tileID:this.tileID,type:"patterns"}},ei)}const[oi,Dn,xi]=yield Promise.all([Le,Ut,kn]),pi=new an(oi),bi=new X.bn(Dn,xi);for(const ei in ke){const si=ke[ei];si instanceof X.a6?(st(si.layers,this.zoom,J),X.bo({bucket:si,glyphMap:oi,glyphPositions:pi.positions,imageMap:Dn,imagePositions:bi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):si.hasPattern&&(si instanceof X.bp||si instanceof X.bq||si instanceof X.br)&&(st(si.layers,this.zoom,J),si.addFeatures(ce,this.tileID.canonical,bi.patternPositions))}return this.status="done",{buckets:Object.values(ke).filter(ei=>!ei.isEmpty()),featureIndex:Te,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:pi.image,imageAtlas:bi,glyphMap:this.returnDependencies?oi:null,iconMap:this.returnDependencies?Dn:null,glyphPositions:this.returnDependencies?pi.positions:null}})}}function st(ue,U,H){const J=new X.z(U);for(const re of ue)re.recalculate(J,H)}class Ae{constructor(U,H,J){this.actor=U,this.layerIndex=H,this.availableImages=J,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(U,H){return X._(this,void 0,void 0,function*(){const J=yield X.l(U.request,H);try{return{vectorTile:new X.bs.VectorTile(new X.bt(J.data)),rawData:J.data,cacheControl:J.cacheControl,expires:J.expires}}catch(re){const Ce=new Uint8Array(J.data);let Te=`Unable to parse the tile at ${U.request.url}, `;throw Te+=31===Ce[0]&&139===Ce[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${re.message}`,new Error(Te)}})}loadTile(U){return X._(this,void 0,void 0,function*(){const H=U.uid,J=!!(U&&U.request&&U.request.collectResourceTiming)&&new X.bu(U.request),re=new hn(U);this.loading[H]=re;const Ce=new AbortController;re.abort=Ce;try{const Te=yield this.loadVectorTile(U,Ce);if(delete this.loading[H],!Te)return null;const ke=Te.rawData,ce={};Te.expires&&(ce.expires=Te.expires),Te.cacheControl&&(ce.cacheControl=Te.cacheControl);const $e={};if(J){const Le=J.finish();Le&&($e.resourceTiming=JSON.parse(JSON.stringify(Le)))}re.vectorTile=Te.vectorTile;const rt=re.parse(Te.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[H]=re,this.fetching[H]={rawTileData:ke,cacheControl:ce,resourceTiming:$e};try{const Le=yield rt;return X.e({rawTileData:ke.slice(0)},Le,ce,$e)}finally{delete this.fetching[H]}}catch(Te){throw delete this.loading[H],re.status="done",this.loaded[H]=re,Te}})}reloadTile(U){return X._(this,void 0,void 0,function*(){const H=U.uid;if(!this.loaded||!this.loaded[H])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const J=this.loaded[H];if(J.showCollisionBoxes=U.showCollisionBoxes,"parsing"===J.status){const re=yield J.parse(J.vectorTile,this.layerIndex,this.availableImages,this.actor);let Ce;if(this.fetching[H]){const{rawTileData:Te,cacheControl:ke,resourceTiming:ce}=this.fetching[H];delete this.fetching[H],Ce=X.e({rawTileData:Te.slice(0)},re,ke,ce)}else Ce=re;return Ce}if("done"===J.status&&J.vectorTile)return J.parse(J.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(U){return X._(this,void 0,void 0,function*(){const H=this.loading,J=U.uid;H&&H[J]&&H[J].abort&&(H[J].abort.abort(),delete H[J])})}removeTile(U){return X._(this,void 0,void 0,function*(){this.loaded&&this.loaded[U.uid]&&delete this.loaded[U.uid]})}}class De{constructor(){this.loaded={}}loadTile(U){return X._(this,void 0,void 0,function*(){const{uid:H,encoding:J,rawImageData:re,redFactor:Ce,greenFactor:Te,blueFactor:ke,baseShift:ce}=U,$e=re.width+2,rt=re.height+2,Le=X.b(re)?new X.R({width:$e,height:rt},yield X.bv(re,-1,-1,$e,rt)):re,wt=new X.bw(H,Le,J,Ce,Te,ke,ce);return this.loaded=this.loaded||{},this.loaded[H]=wt,wt})}removeTile(U){const H=this.loaded,J=U.uid;H&&H[J]&&delete H[J]}}function pn(ue,U){if(0!==ue.length){xt(ue[0],U);for(var H=1;H<ue.length;H++)xt(ue[H],!U)}}function xt(ue,U){for(var H=0,J=0,re=0,Ce=ue.length,Te=Ce-1;re<Ce;Te=re++){var ke=(ue[re][0]-ue[Te][0])*(ue[Te][1]+ue[re][1]),ce=H+ke;J+=Math.abs(H)>=Math.abs(ke)?H-ce+ke:ke-ce+H,H=ce}H+J>=0!=!!U&&ue.reverse()}var Mt=X.bx(function ue(U,H){var J,re=U&&U.type;if("FeatureCollection"===re)for(J=0;J<U.features.length;J++)ue(U.features[J],H);else if("GeometryCollection"===re)for(J=0;J<U.geometries.length;J++)ue(U.geometries[J],H);else if("Feature"===re)ue(U.geometry,H);else if("Polygon"===re)pn(U.coordinates,H);else if("MultiPolygon"===re)for(J=0;J<U.coordinates.length;J++)pn(U.coordinates[J],H);return U});const nt=X.bs.VectorTileFeature.prototype.toGeoJSON;var ct={exports:{}},It=X.by,pt=X.bs.VectorTileFeature,mt=Qe;function Qe(ue,U){this.options=U||{},this.features=ue,this.length=ue.length}function bt(ue,U){this.id="number"==typeof ue.id?ue.id:void 0,this.type=ue.type,this.rawGeometry=1===ue.type?[ue.geometry]:ue.geometry,this.properties=ue.tags,this.extent=U||4096}Qe.prototype.feature=function(ue){return new bt(this.features[ue],this.options.extent)},bt.prototype.loadGeometry=function(){var ue=this.rawGeometry;this.geometry=[];for(var U=0;U<ue.length;U++){for(var H=ue[U],J=[],re=0;re<H.length;re++)J.push(new It(H[re][0],H[re][1]));this.geometry.push(J)}return this.geometry},bt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ue=this.geometry,U=1/0,H=-1/0,J=1/0,re=-1/0,Ce=0;Ce<ue.length;Ce++)for(var Te=ue[Ce],ke=0;ke<Te.length;ke++){var ce=Te[ke];U=Math.min(U,ce.x),H=Math.max(H,ce.x),J=Math.min(J,ce.y),re=Math.max(re,ce.y)}return[U,J,H,re]},bt.prototype.toGeoJSON=pt.prototype.toGeoJSON;var Ze=X.bz,bn=mt;function ze(ue){var U=new Ze;return function(H,J){for(var re in H.layers)J.writeMessage(3,lt,H.layers[re])}(ue,U),U.finish()}function lt(ue,U){var H;U.writeVarintField(15,ue.version||1),U.writeStringField(1,ue.name||""),U.writeVarintField(5,ue.extent||4096);var J={keys:[],values:[],keycache:{},valuecache:{}};for(H=0;H<ue.length;H++)J.feature=ue.feature(H),U.writeMessage(2,Je,J);var re=J.keys;for(H=0;H<re.length;H++)U.writeStringField(3,re[H]);var Ce=J.values;for(H=0;H<Ce.length;H++)U.writeMessage(4,on,Ce[H])}function Je(ue,U){var H=ue.feature;void 0!==H.id&&U.writeVarintField(1,H.id),U.writeMessage(2,Yt,ue),U.writeVarintField(3,H.type),U.writeMessage(4,at,H)}function Yt(ue,U){var H=ue.feature,J=ue.keys,re=ue.values,Ce=ue.keycache,Te=ue.valuecache;for(var ke in H.properties){var ce=H.properties[ke],$e=Ce[ke];if(null!==ce){void 0===$e&&(J.push(ke),Ce[ke]=$e=J.length-1),U.writeVarint($e);var rt=typeof ce;"string"!==rt&&"boolean"!==rt&&"number"!==rt&&(ce=JSON.stringify(ce));var Le=rt+":"+ce,wt=Te[Le];void 0===wt&&(re.push(ce),Te[Le]=wt=re.length-1),U.writeVarint(wt)}}}function en(ue,U){return(U<<3)+(7&ue)}function $t(ue){return ue<<1^ue>>31}function at(ue,U){for(var H=ue.loadGeometry(),J=ue.type,re=0,Ce=0,Te=H.length,ke=0;ke<Te;ke++){var ce=H[ke],$e=1;1===J&&($e=ce.length),U.writeVarint(en(1,$e));for(var rt=3===J?ce.length-1:ce.length,Le=0;Le<rt;Le++){1===Le&&1!==J&&U.writeVarint(en(2,rt-1));var wt=ce[Le].x-re,Ut=ce[Le].y-Ce;U.writeVarint($t(wt)),U.writeVarint($t(Ut)),re+=wt,Ce+=Ut}3===J&&U.writeVarint(en(7,1))}}function on(ue,U){var H=typeof ue;"string"===H?U.writeStringField(1,ue):"boolean"===H?U.writeBooleanField(7,ue):"number"===H&&(ue%1!=0?U.writeDoubleField(3,ue):ue<0?U.writeSVarintField(6,ue):U.writeVarintField(5,ue))}ct.exports=ze,ct.exports.fromVectorTileJs=ze,ct.exports.fromGeojsonVt=function(ue,U){U=U||{};var H={};for(var J in ue)H[J]=new bn(ue[J].features,U),H[J].name=J,H[J].version=U.version,H[J].extent=U.extent;return ze({layers:H})},ct.exports.GeoJSONWrapper=bn;var ut=X.bx(ct.exports);const Gn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ue=>ue},Nt=Math.fround||(gt=new Float32Array(1),ue=>(gt[0]=+ue,gt[0]));var gt;const Xe=3,ge=5,be=6;class fe{constructor(U){this.options=Object.assign(Object.create(Gn),U),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(U){const{log:H,minZoom:J,maxZoom:re}=this.options;H&&console.time("total time");const Ce=`prepare ${U.length} points`;H&&console.time(Ce),this.points=U;const Te=[];for(let ce=0;ce<U.length;ce++){const $e=U[ce];if(!$e.geometry)continue;const[rt,Le]=$e.geometry.coordinates,wt=Nt(qt(rt)),Ut=Nt(kt(Le));Te.push(wt,Ut,1/0,ce,-1,1),this.options.reduce&&Te.push(0)}let ke=this.trees[re+1]=this._createTree(Te);H&&console.timeEnd(Ce);for(let ce=re;ce>=J;ce--){const $e=+Date.now();ke=this.trees[ce]=this._createTree(this._cluster(ke,ce)),H&&console.log("z%d: %d clusters in %dms",ce,ke.numItems,+Date.now()-$e)}return H&&console.timeEnd("total time"),this}getClusters(U,H){let J=((U[0]+180)%360+360)%360-180;const re=Math.max(-90,Math.min(90,U[1]));let Ce=180===U[2]?180:((U[2]+180)%360+360)%360-180;const Te=Math.max(-90,Math.min(90,U[3]));if(U[2]-U[0]>=360)J=-180,Ce=180;else if(J>Ce){const Le=this.getClusters([J,re,180,Te],H),wt=this.getClusters([-180,re,Ce,Te],H);return Le.concat(wt)}const ke=this.trees[this._limitZoom(H)],ce=ke.range(qt(J),kt(Te),qt(Ce),kt(re)),$e=ke.data,rt=[];for(const Le of ce){const wt=this.stride*Le;rt.push($e[wt+ge]>1?Z($e,wt,this.clusterProps):this.points[$e[wt+Xe]])}return rt}getChildren(U){const H=this._getOriginId(U),J=this._getOriginZoom(U),re="No cluster with the specified id.",Ce=this.trees[J];if(!Ce)throw new Error(re);const Te=Ce.data;if(H*this.stride>=Te.length)throw new Error(re);const ke=this.options.radius/(this.options.extent*Math.pow(2,J-1)),ce=Ce.within(Te[H*this.stride],Te[H*this.stride+1],ke),$e=[];for(const rt of ce){const Le=rt*this.stride;Te[Le+4]===U&&$e.push(Te[Le+ge]>1?Z(Te,Le,this.clusterProps):this.points[Te[Le+Xe]])}if(0===$e.length)throw new Error(re);return $e}getLeaves(U,H,J){const re=[];return this._appendLeaves(re,U,H=H||10,J=J||0,0),re}getTile(U,H,J){const re=this.trees[this._limitZoom(U)],Ce=Math.pow(2,U),{extent:Te,radius:ke}=this.options,ce=ke/Te,$e=(J-ce)/Ce,rt=(J+1+ce)/Ce,Le={features:[]};return this._addTileFeatures(re.range((H-ce)/Ce,$e,(H+1+ce)/Ce,rt),re.data,H,J,Ce,Le),0===H&&this._addTileFeatures(re.range(1-ce/Ce,$e,1,rt),re.data,Ce,J,Ce,Le),H===Ce-1&&this._addTileFeatures(re.range(0,$e,ce/Ce,rt),re.data,-1,J,Ce,Le),Le.features.length?Le:null}getClusterExpansionZoom(U){let H=this._getOriginZoom(U)-1;for(;H<=this.options.maxZoom;){const J=this.getChildren(U);if(H++,1!==J.length)break;U=J[0].properties.cluster_id}return H}_appendLeaves(U,H,J,re,Ce){const Te=this.getChildren(H);for(const ke of Te){const ce=ke.properties;if(ce&&ce.cluster?Ce+ce.point_count<=re?Ce+=ce.point_count:Ce=this._appendLeaves(U,ce.cluster_id,J,re,Ce):Ce<re?Ce++:U.push(ke),U.length===J)break}return Ce}_createTree(U){const H=new X.av(U.length/this.stride|0,this.options.nodeSize,Float32Array);for(let J=0;J<U.length;J+=this.stride)H.add(U[J],U[J+1]);return H.finish(),H.data=U,H}_addTileFeatures(U,H,J,re,Ce,Te){for(const ke of U){const ce=ke*this.stride,$e=H[ce+ge]>1;let rt,Le,wt;if($e)rt=Ye(H,ce,this.clusterProps),Le=H[ce],wt=H[ce+1];else{const kn=this.points[H[ce+Xe]];rt=kn.properties;const[oi,Dn]=kn.geometry.coordinates;Le=qt(oi),wt=kt(Dn)}const Ut={type:1,geometry:[[Math.round(this.options.extent*(Le*Ce-J)),Math.round(this.options.extent*(wt*Ce-re))]],tags:rt};let tn;tn=$e||this.options.generateId?H[ce+Xe]:this.points[H[ce+Xe]].id,void 0!==tn&&(Ut.id=tn),Te.features.push(Ut)}}_limitZoom(U){return Math.max(this.options.minZoom,Math.min(Math.floor(+U),this.options.maxZoom+1))}_cluster(U,H){const{radius:J,extent:re,reduce:Ce,minPoints:Te}=this.options,ke=J/(re*Math.pow(2,H)),ce=U.data,$e=[],rt=this.stride;for(let Le=0;Le<ce.length;Le+=rt){if(ce[Le+2]<=H)continue;ce[Le+2]=H;const wt=ce[Le],Ut=ce[Le+1],tn=U.within(ce[Le],ce[Le+1],ke),kn=ce[Le+ge];let oi=kn;for(const Dn of tn){const xi=Dn*rt;ce[xi+2]>H&&(oi+=ce[xi+ge])}if(oi>kn&&oi>=Te){let Dn,xi=wt*kn,pi=Ut*kn,bi=-1;const ei=((Le/rt|0)<<5)+(H+1)+this.points.length;for(const si of tn){const qi=si*rt;if(ce[qi+2]<=H)continue;ce[qi+2]=H;const mi=ce[qi+ge];xi+=ce[qi]*mi,pi+=ce[qi+1]*mi,ce[qi+4]=ei,Ce&&(Dn||(Dn=this._map(ce,Le,!0),bi=this.clusterProps.length,this.clusterProps.push(Dn)),Ce(Dn,this._map(ce,qi)))}ce[Le+4]=ei,$e.push(xi/oi,pi/oi,1/0,ei,-1,oi),Ce&&$e.push(bi)}else{for(let Dn=0;Dn<rt;Dn++)$e.push(ce[Le+Dn]);if(oi>1)for(const Dn of tn){const xi=Dn*rt;if(!(ce[xi+2]<=H)){ce[xi+2]=H;for(let pi=0;pi<rt;pi++)$e.push(ce[xi+pi])}}}}return $e}_getOriginId(U){return U-this.points.length>>5}_getOriginZoom(U){return(U-this.points.length)%32}_map(U,H,J){if(U[H+ge]>1){const Te=this.clusterProps[U[H+be]];return J?Object.assign({},Te):Te}const re=this.points[U[H+Xe]].properties,Ce=this.options.map(re);return J&&Ce===re?Object.assign({},Ce):Ce}}function Z(ue,U,H){return{type:"Feature",id:ue[U+Xe],properties:Ye(ue,U,H),geometry:{type:"Point",coordinates:[(J=ue[U],360*(J-.5)),Lt(ue[U+1])]}};var J}function Ye(ue,U,H){const J=ue[U+ge],re=J>=1e4?`${Math.round(J/1e3)}k`:J>=1e3?Math.round(J/100)/10+"k":J,Ce=ue[U+be],Te=-1===Ce?{}:Object.assign({},H[Ce]);return Object.assign(Te,{cluster:!0,cluster_id:ue[U+Xe],point_count:J,point_count_abbreviated:re})}function qt(ue){return ue/360+.5}function kt(ue){const U=Math.sin(ue*Math.PI/180),H=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return H<0?0:H>1?1:H}function Lt(ue){const U=(180-360*ue)*Math.PI/180;return 360*Math.atan(Math.exp(U))/Math.PI-90}function jt(ue,U,H,J){let re=J;const Ce=U+(H-U>>1);let Te,ke=H-U;const ce=ue[U],$e=ue[U+1],rt=ue[H],Le=ue[H+1];for(let wt=U+3;wt<H;wt+=3){const Ut=mn(ue[wt],ue[wt+1],ce,$e,rt,Le);if(Ut>re)Te=wt,re=Ut;else if(Ut===re){const tn=Math.abs(wt-Ce);tn<ke&&(Te=wt,ke=tn)}}re>J&&(Te-U>3&&jt(ue,U,Te,J),ue[Te+2]=re,H-Te>3&&jt(ue,Te,H,J))}function mn(ue,U,H,J,re,Ce){let Te=re-H,ke=Ce-J;if(0!==Te||0!==ke){const ce=((ue-H)*Te+(U-J)*ke)/(Te*Te+ke*ke);ce>1?(H=re,J=Ce):ce>0&&(H+=Te*ce,J+=ke*ce)}return Te=ue-H,ke=U-J,Te*Te+ke*ke}function di(ue,U,H,J){const re={id:ue??null,type:U,geometry:H,tags:J,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if("Point"===U||"MultiPoint"===U||"LineString"===U)Ui(re,H);else if("Polygon"===U)Ui(re,H[0]);else if("MultiLineString"===U)for(const Ce of H)Ui(re,Ce);else if("MultiPolygon"===U)for(const Ce of H)Ui(re,Ce[0]);return re}function Ui(ue,U){for(let H=0;H<U.length;H+=3)ue.minX=Math.min(ue.minX,U[H]),ue.minY=Math.min(ue.minY,U[H+1]),ue.maxX=Math.max(ue.maxX,U[H]),ue.maxY=Math.max(ue.maxY,U[H+1])}function ri(ue,U,H,J){if(!U.geometry)return;const re=U.geometry.coordinates;if(re&&0===re.length)return;const Ce=U.geometry.type,Te=Math.pow(H.tolerance/((1<<H.maxZoom)*H.extent),2);let ke=[],ce=U.id;if(H.promoteId?ce=U.properties[H.promoteId]:H.generateId&&(ce=J||0),"Point"===Ce)ur(re,ke);else if("MultiPoint"===Ce)for(const $e of re)ur($e,ke);else if("LineString"===Ce)ve(re,ke,Te,!1);else if("MultiLineString"===Ce){if(H.lineMetrics){for(const $e of re)ke=[],ve($e,ke,Te,!1),ue.push(di(ce,"LineString",ke,U.properties));return}Oi(re,ke,Te,!1)}else if("Polygon"===Ce)Oi(re,ke,Te,!0);else{if("MultiPolygon"!==Ce){if("GeometryCollection"===Ce){for(const $e of U.geometry.geometries)ri(ue,{id:ce,geometry:$e,properties:U.properties},H,J);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const $e of re){const rt=[];Oi($e,rt,Te,!0),ke.push(rt)}}ue.push(di(ce,Ce,ke,U.properties))}function ur(ue,U){U.push(dr(ue[0]),Pn(ue[1]),0)}function ve(ue,U,H,J){let re,Ce,Te=0;for(let ce=0;ce<ue.length;ce++){const $e=dr(ue[ce][0]),rt=Pn(ue[ce][1]);U.push($e,rt,0),ce>0&&(Te+=J?(re*rt-$e*Ce)/2:Math.sqrt(Math.pow($e-re,2)+Math.pow(rt-Ce,2))),re=$e,Ce=rt}const ke=U.length-3;U[2]=1,jt(U,0,ke,H),U[ke+2]=1,U.size=Math.abs(Te),U.start=0,U.end=U.size}function Oi(ue,U,H,J){for(let re=0;re<ue.length;re++){const Ce=[];ve(ue[re],Ce,H,J),U.push(Ce)}}function dr(ue){return ue/360+.5}function Pn(ue){const U=Math.sin(ue*Math.PI/180),H=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return H<0?0:H>1?1:H}function Vn(ue,U,H,J,re,Ce,Te,ke){if(J/=U,Ce>=(H/=U)&&Te<J)return ue;if(Te<H||Ce>=J)return null;const ce=[];for(const $e of ue){const rt=$e.geometry;let Le=$e.type;const wt=0===re?$e.minX:$e.minY,Ut=0===re?$e.maxX:$e.maxY;if(wt>=H&&Ut<J){ce.push($e);continue}if(Ut<H||wt>=J)continue;let tn=[];if("Point"===Le||"MultiPoint"===Le)ht(rt,tn,H,J,re);else if("LineString"===Le)Ne(rt,tn,H,J,re,!1,ke.lineMetrics);else if("MultiLineString"===Le)wn(rt,tn,H,J,re,!1);else if("Polygon"===Le)wn(rt,tn,H,J,re,!0);else if("MultiPolygon"===Le)for(const kn of rt){const oi=[];wn(kn,oi,H,J,re,!0),oi.length&&tn.push(oi)}if(tn.length){if(ke.lineMetrics&&"LineString"===Le){for(const kn of tn)ce.push(di($e.id,Le,kn,$e.tags));continue}"LineString"!==Le&&"MultiLineString"!==Le||(1===tn.length?(Le="LineString",tn=tn[0]):Le="MultiLineString"),"Point"!==Le&&"MultiPoint"!==Le||(Le=3===tn.length?"Point":"MultiPoint"),ce.push(di($e.id,Le,tn,$e.tags))}}return ce.length?ce:null}function ht(ue,U,H,J,re){for(let Ce=0;Ce<ue.length;Ce+=3){const Te=ue[Ce+re];Te>=H&&Te<=J&&Fn(U,ue[Ce],ue[Ce+1],ue[Ce+2])}}function Ne(ue,U,H,J,re,Ce,Te){let ke=et(ue);const ce=0===re?$i:ki;let $e,rt,Le=ue.start;for(let oi=0;oi<ue.length-3;oi+=3){const Dn=ue[oi],xi=ue[oi+1],pi=ue[oi+2],bi=ue[oi+3],ei=ue[oi+4],si=0===re?Dn:xi,qi=0===re?bi:ei;let mi=!1;Te&&($e=Math.sqrt(Math.pow(Dn-bi,2)+Math.pow(xi-ei,2))),si<H?qi>H&&(rt=ce(ke,Dn,xi,bi,ei,H),Te&&(ke.start=Le+$e*rt)):si>J?qi<J&&(rt=ce(ke,Dn,xi,bi,ei,J),Te&&(ke.start=Le+$e*rt)):Fn(ke,Dn,xi,pi),qi<H&&si>=H&&(rt=ce(ke,Dn,xi,bi,ei,H),mi=!0),qi>J&&si<=J&&(rt=ce(ke,Dn,xi,bi,ei,J),mi=!0),!Ce&&mi&&(Te&&(ke.end=Le+$e*rt),U.push(ke),ke=et(ue)),Te&&(Le+=$e)}let wt=ue.length-3;const Ut=ue[wt],tn=ue[wt+1],kn=0===re?Ut:tn;kn>=H&&kn<=J&&Fn(ke,Ut,tn,ue[wt+2]),wt=ke.length-3,Ce&&wt>=3&&(ke[wt]!==ke[0]||ke[wt+1]!==ke[1])&&Fn(ke,ke[0],ke[1],ke[2]),ke.length&&U.push(ke)}function et(ue){const U=[];return U.size=ue.size,U.start=ue.start,U.end=ue.end,U}function wn(ue,U,H,J,re,Ce){for(const Te of ue)Ne(Te,U,H,J,re,Ce,!1)}function Fn(ue,U,H,J){ue.push(U,H,J)}function $i(ue,U,H,J,re,Ce){const Te=(Ce-U)/(J-U);return Fn(ue,Ce,H+(re-H)*Te,1),Te}function ki(ue,U,H,J,re,Ce){const Te=(Ce-H)/(re-H);return Fn(ue,U+(J-U)*Te,Ce,1),Te}function it(ue,U){const H=[];for(let J=0;J<ue.length;J++){const re=ue[J],Ce=re.type;let Te;if("Point"===Ce||"MultiPoint"===Ce||"LineString"===Ce)Te=vi(re.geometry,U);else if("MultiLineString"===Ce||"Polygon"===Ce){Te=[];for(const ke of re.geometry)Te.push(vi(ke,U))}else if("MultiPolygon"===Ce){Te=[];for(const ke of re.geometry){const ce=[];for(const $e of ke)ce.push(vi($e,U));Te.push(ce)}}H.push(di(re.id,Ce,Te,re.tags))}return H}function vi(ue,U){const H=[];H.size=ue.size,void 0!==ue.start&&(H.start=ue.start,H.end=ue.end);for(let J=0;J<ue.length;J+=3)H.push(ue[J]+U,ue[J+1],ue[J+2]);return H}function hi(ue,U){if(ue.transformed)return ue;const H=1<<ue.z,J=ue.x,re=ue.y;for(const Ce of ue.features){const Te=Ce.geometry,ke=Ce.type;if(Ce.geometry=[],1===ke)for(let ce=0;ce<Te.length;ce+=2)Ce.geometry.push(hr(Te[ce],Te[ce+1],U,H,J,re));else for(let ce=0;ce<Te.length;ce++){const $e=[];for(let rt=0;rt<Te[ce].length;rt+=2)$e.push(hr(Te[ce][rt],Te[ce][rt+1],U,H,J,re));Ce.geometry.push($e)}}return ue.transformed=!0,ue}function hr(ue,U,H,J,re,Ce){return[Math.round(H*(ue*J-re)),Math.round(H*(U*J-Ce))]}function Hi(ue,U,H,J,re){const Ce=U===re.maxZoom?0:re.tolerance/((1<<U)*re.extent),Te={features:[],numPoints:0,numSimplified:0,numFeatures:ue.length,source:null,x:H,y:J,z:U,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ke of ue)Bt(Te,ke,Ce,re);return Te}function Bt(ue,U,H,J){const re=U.geometry,Ce=U.type,Te=[];if(ue.minX=Math.min(ue.minX,U.minX),ue.minY=Math.min(ue.minY,U.minY),ue.maxX=Math.max(ue.maxX,U.maxX),ue.maxY=Math.max(ue.maxY,U.maxY),"Point"===Ce||"MultiPoint"===Ce)for(let ke=0;ke<re.length;ke+=3)Te.push(re[ke],re[ke+1]),ue.numPoints++,ue.numSimplified++;else if("LineString"===Ce)Wn(Te,re,ue,H,!1,!1);else if("MultiLineString"===Ce||"Polygon"===Ce)for(let ke=0;ke<re.length;ke++)Wn(Te,re[ke],ue,H,"Polygon"===Ce,0===ke);else if("MultiPolygon"===Ce)for(let ke=0;ke<re.length;ke++){const ce=re[ke];for(let $e=0;$e<ce.length;$e++)Wn(Te,ce[$e],ue,H,!0,0===$e)}if(Te.length){let ke=U.tags||null;if("LineString"===Ce&&J.lineMetrics){ke={};for(const $e in U.tags)ke[$e]=U.tags[$e];ke.mapbox_clip_start=re.start/re.size,ke.mapbox_clip_end=re.end/re.size}const ce={geometry:Te,type:"Polygon"===Ce||"MultiPolygon"===Ce?3:"LineString"===Ce||"MultiLineString"===Ce?2:1,tags:ke};null!==U.id&&(ce.id=U.id),ue.features.push(ce)}}function Wn(ue,U,H,J,re,Ce){const Te=J*J;if(J>0&&U.size<(re?Te:J))return void(H.numPoints+=U.length/3);const ke=[];for(let ce=0;ce<U.length;ce+=3)(0===J||U[ce+2]>Te)&&(H.numSimplified++,ke.push(U[ce],U[ce+1])),H.numPoints++;re&&function(ce,$e){let rt=0;for(let Le=0,wt=ce.length,Ut=wt-2;Le<wt;Ut=Le,Le+=2)rt+=(ce[Le]-ce[Ut])*(ce[Le+1]+ce[Ut+1]);if(rt>0===$e)for(let Le=0,wt=ce.length;Le<wt/2;Le+=2){const Ut=ce[Le],tn=ce[Le+1];ce[Le]=ce[wt-2-Le],ce[Le+1]=ce[wt-1-Le],ce[wt-2-Le]=Ut,ce[wt-1-Le]=tn}}(ke,Ce),ue.push(ke)}const In={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ur{constructor(U,H){const J=(H=this.options=function(Ce,Te){for(const ke in Te)Ce[ke]=Te[ke];return Ce}(Object.create(In),H)).debug;if(J&&console.time("preprocess data"),H.maxZoom<0||H.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(H.promoteId&&H.generateId)throw new Error("promoteId and generateId cannot be used together.");let re=function(Ce,Te){const ke=[];if("FeatureCollection"===Ce.type)for(let ce=0;ce<Ce.features.length;ce++)ri(ke,Ce.features[ce],Te,ce);else ri(ke,"Feature"===Ce.type?Ce:{geometry:Ce},Te);return ke}(U,H);this.tiles={},this.tileCoords=[],J&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",H.indexMaxZoom,H.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),re=function(Ce,Te){const ke=Te.buffer/Te.extent;let ce=Ce;const $e=Vn(Ce,1,-1-ke,ke,0,-1,2,Te),rt=Vn(Ce,1,1-ke,2+ke,0,-1,2,Te);return($e||rt)&&(ce=Vn(Ce,1,-ke,1+ke,0,-1,2,Te)||[],$e&&(ce=it($e,1).concat(ce)),rt&&(ce=ce.concat(it(rt,-1)))),ce}(re,H),re.length&&this.splitTile(re,0,0,0),J&&(re.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(U,H,J,re,Ce,Te,ke){const ce=[U,H,J,re],$e=this.options,rt=$e.debug;for(;ce.length;){re=ce.pop(),J=ce.pop(),H=ce.pop(),U=ce.pop();const Le=1<<H,wt=uo(H,J,re);let Ut=this.tiles[wt];if(!Ut&&(rt>1&&console.time("creation"),Ut=this.tiles[wt]=Hi(U,H,J,re,$e),this.tileCoords.push({z:H,x:J,y:re}),rt)){rt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",H,J,re,Ut.numFeatures,Ut.numPoints,Ut.numSimplified),console.timeEnd("creation"));const mi=`z${H}`;this.stats[mi]=(this.stats[mi]||0)+1,this.total++}if(Ut.source=U,null==Ce){if(H===$e.indexMaxZoom||Ut.numPoints<=$e.indexMaxPoints)continue}else{if(H===$e.maxZoom||H===Ce)continue;if(null!=Ce){const mi=Ce-H;if(J!==Te>>mi||re!==ke>>mi)continue}}if(Ut.source=null,0===U.length)continue;rt>1&&console.time("clipping");const tn=.5*$e.buffer/$e.extent,kn=.5-tn,oi=.5+tn,Dn=1+tn;let xi=null,pi=null,bi=null,ei=null,si=Vn(U,Le,J-tn,J+oi,0,Ut.minX,Ut.maxX,$e),qi=Vn(U,Le,J+kn,J+Dn,0,Ut.minX,Ut.maxX,$e);U=null,si&&(xi=Vn(si,Le,re-tn,re+oi,1,Ut.minY,Ut.maxY,$e),pi=Vn(si,Le,re+kn,re+Dn,1,Ut.minY,Ut.maxY,$e),si=null),qi&&(bi=Vn(qi,Le,re-tn,re+oi,1,Ut.minY,Ut.maxY,$e),ei=Vn(qi,Le,re+kn,re+Dn,1,Ut.minY,Ut.maxY,$e),qi=null),rt>1&&console.timeEnd("clipping"),ce.push(xi||[],H+1,2*J,2*re),ce.push(pi||[],H+1,2*J,2*re+1),ce.push(bi||[],H+1,2*J+1,2*re),ce.push(ei||[],H+1,2*J+1,2*re+1)}}getTile(U,H,J){U=+U,H=+H,J=+J;const re=this.options,{extent:Ce,debug:Te}=re;if(U<0||U>24)return null;const ke=1<<U,ce=uo(U,H=H+ke&ke-1,J);if(this.tiles[ce])return hi(this.tiles[ce],Ce);Te>1&&console.log("drilling down to z%d-%d-%d",U,H,J);let $e,rt=U,Le=H,wt=J;for(;!$e&&rt>0;)rt--,Le>>=1,wt>>=1,$e=this.tiles[uo(rt,Le,wt)];return $e&&$e.source?(Te>1&&(console.log("found parent tile z%d-%d-%d",rt,Le,wt),console.time("drilling down")),this.splitTile($e.source,rt,Le,wt,U,H,J),Te>1&&console.timeEnd("drilling down"),this.tiles[ce]?hi(this.tiles[ce],Ce):null):null}}function uo(ue,U,H){return 32*((1<<ue)*H+U)+ue}function Nn(ue,U){return U?ue.properties[U]:ue.id}function mo(ue,U){if(null==ue)return!0;if("Feature"===ue.type)return null!=Nn(ue,U);if("FeatureCollection"===ue.type){const H=new Set;for(const J of ue.features){const re=Nn(J,U);if(null==re||H.has(re))return!1;H.add(re)}return!0}return!1}function go(ue,U){const H=new Map;if(null!=ue)if("Feature"===ue.type)H.set(Nn(ue,U),ue);else for(const J of ue.features)H.set(Nn(J,U),J);return H}class Zr extends Ae{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(U,H){return X._(this,void 0,void 0,function*(){const J=U.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const re=this._geoJSONIndex.getTile(J.z,J.x,J.y);if(!re)return null;const Ce=new class{constructor(ke){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=X.X,this.length=ke.length,this._features=ke}feature(ke){return new class{constructor(ce){this._feature=ce,this.extent=X.X,this.type=ce.type,this.properties=ce.tags,"id"in ce&&!isNaN(ce.id)&&(this.id=parseInt(ce.id,10))}loadGeometry(){if(1===this._feature.type){const ce=[];for(const $e of this._feature.geometry)ce.push([new X.P($e[0],$e[1])]);return ce}{const ce=[];for(const $e of this._feature.geometry){const rt=[];for(const Le of $e)rt.push(new X.P(Le[0],Le[1]));ce.push(rt)}return ce}}toGeoJSON(ce,$e,rt){return nt.call(this,ce,$e,rt)}}(this._features[ke])}}(re.features);let Te=ut(Ce);return 0===Te.byteOffset&&Te.byteLength===Te.buffer.byteLength||(Te=new Uint8Array(Te)),{vectorTile:Ce,rawData:Te.buffer}})}loadData(U){return X._(this,void 0,void 0,function*(){var H;null===(H=this._pendingRequest)||void 0===H||H.abort();const J=!!(U&&U.request&&U.request.collectResourceTiming)&&new X.bu(U.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(U,this._pendingRequest),this._geoJSONIndex=U.cluster?new fe(function({superclusterOptions:Te,clusterProperties:ke}){if(!ke||!Te)return Te;const ce={},$e={},rt={accumulated:null,zoom:0},Le={properties:null},wt=Object.keys(ke);for(const Ut of wt){const[tn,kn]=ke[Ut],oi=X.bB(kn),Dn=X.bB("string"==typeof tn?[tn,["accumulated"],["get",Ut]]:tn);ce[Ut]=oi.value,$e[Ut]=Dn.value}return Te.map=Ut=>{Le.properties=Ut;const tn={};for(const kn of wt)tn[kn]=ce[kn].evaluate(rt,Le);return tn},Te.reduce=(Ut,tn)=>{Le.properties=tn;for(const kn of wt)rt.accumulated=Ut[kn],Ut[kn]=$e[kn].evaluate(rt,Le)},Te}(U)).load((yield this._pendingData).features):(re=yield this._pendingData,new Ur(re,U.geojsonVtOptions)),this.loaded={};const Ce={};if(J){const Te=J.finish();Te&&(Ce.resourceTiming={},Ce.resourceTiming[U.source]=JSON.parse(JSON.stringify(Te)))}return Ce}catch(Ce){if(delete this._pendingRequest,X.bA(Ce))return{abandoned:!0};throw Ce}var re})}getData(){return X._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(U){const H=this.loaded;return H&&H[U.uid]?super.reloadTile(U):this.loadTile(U)}loadAndProcessGeoJSON(U,H){return X._(this,void 0,void 0,function*(){let J=yield this.loadGeoJSON(U,H);if(delete this._pendingRequest,"object"!=typeof J)throw new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`);if(Mt(J,!0),U.filter){const re=X.bB(U.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===re.result)throw new Error(re.value.map(Te=>`${Te.key}: ${Te.message}`).join(", "));J={type:"FeatureCollection",features:J.features.filter(Te=>re.value.evaluate({zoom:0},Te))}}return J})}loadGeoJSON(U,H){return X._(this,void 0,void 0,function*(){const{promoteId:J}=U;if(U.request){const re=yield X.h(U.request,H);return this._dataUpdateable=mo(re.data,J)?go(re.data,J):void 0,re.data}if("string"==typeof U.data)try{const re=JSON.parse(U.data);return this._dataUpdateable=mo(re,J)?go(re,J):void 0,re}catch{throw new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`)}if(!U.dataDiff)throw new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${U.source}`);return function(re,Ce,Te){var ke,ce,$e,rt;if(Ce.removeAll&&re.clear(),Ce.remove)for(const Le of Ce.remove)re.delete(Le);if(Ce.add)for(const Le of Ce.add){const wt=Nn(Le,Te);null!=wt&&re.set(wt,Le)}if(Ce.update)for(const Le of Ce.update){let wt=re.get(Le.id);if(null==wt)continue;const Ut=!Le.removeAllProperties&&((null===(ke=Le.removeProperties)||void 0===ke?void 0:ke.length)>0||(null===(ce=Le.addOrUpdateProperties)||void 0===ce?void 0:ce.length)>0);if((Le.newGeometry||Le.removeAllProperties||Ut)&&(wt=Object.assign({},wt),re.set(Le.id,wt),Ut&&(wt.properties=Object.assign({},wt.properties))),Le.newGeometry&&(wt.geometry=Le.newGeometry),Le.removeAllProperties)wt.properties={};else if((null===($e=Le.removeProperties)||void 0===$e?void 0:$e.length)>0)for(const tn of Le.removeProperties)Object.prototype.hasOwnProperty.call(wt.properties,tn)&&delete wt.properties[tn];if((null===(rt=Le.addOrUpdateProperties)||void 0===rt?void 0:rt.length)>0)for(const{key:tn,value:kn}of Le.addOrUpdateProperties)wt.properties[tn]=kn}}(this._dataUpdateable,U.dataDiff,J),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(U){return X._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(U){return this._geoJSONIndex.getClusterExpansionZoom(U.clusterId)}getClusterChildren(U){return this._geoJSONIndex.getChildren(U.clusterId)}getClusterLeaves(U){return this._geoJSONIndex.getLeaves(U.clusterId,U.limit,U.offset)}}class io{constructor(U){this.self=U,this.actor=new X.F(U),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(H,J)=>{if(this.externalWorkerSourceTypes[H])throw new Error(`Worker source with name "${H}" already registered.`);this.externalWorkerSourceTypes[H]=J},this.self.addProtocol=X.bh,this.self.removeProtocol=X.bi,this.self.registerRTLTextPlugin=H=>{if(X.bC.isParsed())throw new Error("RTL text plugin already registered.");X.bC.setMethods(H)},this.actor.registerMessageHandler("LDT",(H,J)=>this._getDEMWorkerSource(H,J.source).loadTile(J)),this.actor.registerMessageHandler("RDT",(H,J)=>X._(this,void 0,void 0,function*(){this._getDEMWorkerSource(H,J.source).removeTile(J)})),this.actor.registerMessageHandler("GCEZ",(H,J)=>X._(this,void 0,void 0,function*(){return this._getWorkerSource(H,J.type,J.source).getClusterExpansionZoom(J)})),this.actor.registerMessageHandler("GCC",(H,J)=>X._(this,void 0,void 0,function*(){return this._getWorkerSource(H,J.type,J.source).getClusterChildren(J)})),this.actor.registerMessageHandler("GCL",(H,J)=>X._(this,void 0,void 0,function*(){return this._getWorkerSource(H,J.type,J.source).getClusterLeaves(J)})),this.actor.registerMessageHandler("LD",(H,J)=>this._getWorkerSource(H,J.type,J.source).loadData(J)),this.actor.registerMessageHandler("GD",(H,J)=>this._getWorkerSource(H,J.type,J.source).getData()),this.actor.registerMessageHandler("LT",(H,J)=>this._getWorkerSource(H,J.type,J.source).loadTile(J)),this.actor.registerMessageHandler("RT",(H,J)=>this._getWorkerSource(H,J.type,J.source).reloadTile(J)),this.actor.registerMessageHandler("AT",(H,J)=>this._getWorkerSource(H,J.type,J.source).abortTile(J)),this.actor.registerMessageHandler("RMT",(H,J)=>this._getWorkerSource(H,J.type,J.source).removeTile(J)),this.actor.registerMessageHandler("RS",(H,J)=>X._(this,void 0,void 0,function*(){if(!this.workerSources[H]||!this.workerSources[H][J.type]||!this.workerSources[H][J.type][J.source])return;const re=this.workerSources[H][J.type][J.source];delete this.workerSources[H][J.type][J.source],void 0!==re.removeSource&&re.removeSource(J)})),this.actor.registerMessageHandler("RM",H=>X._(this,void 0,void 0,function*(){delete this.layerIndexes[H],delete this.availableImages[H],delete this.workerSources[H],delete this.demWorkerSources[H]})),this.actor.registerMessageHandler("SR",(H,J)=>X._(this,void 0,void 0,function*(){this.referrer=J})),this.actor.registerMessageHandler("SRPS",(H,J)=>this._syncRTLPluginState(H,J)),this.actor.registerMessageHandler("IS",(H,J)=>X._(this,void 0,void 0,function*(){this.self.importScripts(J)})),this.actor.registerMessageHandler("SI",(H,J)=>this._setImages(H,J)),this.actor.registerMessageHandler("UL",(H,J)=>X._(this,void 0,void 0,function*(){this._getLayerIndex(H).update(J.layers,J.removedIds)})),this.actor.registerMessageHandler("SL",(H,J)=>X._(this,void 0,void 0,function*(){this._getLayerIndex(H).replace(J)}))}_setImages(U,H){return X._(this,void 0,void 0,function*(){this.availableImages[U]=H;for(const J in this.workerSources[U]){const re=this.workerSources[U][J];for(const Ce in re)re[Ce].availableImages=H}})}_syncRTLPluginState(U,H){return X._(this,void 0,void 0,function*(){if(X.bC.isParsed())return X.bC.getState();if("loading"!==H.pluginStatus)return X.bC.setState(H),H;const J=H.pluginURL;if(this.self.importScripts(J),X.bC.isParsed()){const re={pluginStatus:"loaded",pluginURL:J};return X.bC.setState(re),re}throw X.bC.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${J}`)})}_getAvailableImages(U){let H=this.availableImages[U];return H||(H=[]),H}_getLayerIndex(U){let H=this.layerIndexes[U];return H||(H=this.layerIndexes[U]=new x),H}_getWorkerSource(U,H,J){if(this.workerSources[U]||(this.workerSources[U]={}),this.workerSources[U][H]||(this.workerSources[U][H]={}),!this.workerSources[U][H][J]){const re={sendAsync:(Ce,Te)=>(Ce.targetMapId=U,this.actor.sendAsync(Ce,Te))};switch(H){case"vector":this.workerSources[U][H][J]=new Ae(re,this._getLayerIndex(U),this._getAvailableImages(U));break;case"geojson":this.workerSources[U][H][J]=new Zr(re,this._getLayerIndex(U),this._getAvailableImages(U));break;default:this.workerSources[U][H][J]=new this.externalWorkerSourceTypes[H](re,this._getLayerIndex(U),this._getAvailableImages(U))}}return this.workerSources[U][H][J]}_getDEMWorkerSource(U,H){return this.demWorkerSources[U]||(this.demWorkerSources[U]={}),this.demWorkerSources[U][H]||(this.demWorkerSources[U][H]=new De),this.demWorkerSources[U][H]}}return X.i(self)&&(self.worker=new io(self)),io}),We("index",0,function(X,x){let hn,st;const Ae={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:v=>new Promise((o,u)=>{const f=requestAnimationFrame(o);v.signal.addEventListener("abort",()=>{cancelAnimationFrame(f),u(x.c())})}),getImageData(v,o=0){return this.getImageCanvasContext(v).getImageData(-o,-o,v.width+2*o,v.height+2*o)},getImageCanvasContext(v){const o=window.document.createElement("canvas"),u=o.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return o.width=v.width,o.height=v.height,u.drawImage(v,0,0,v.width,v.height),u},resolveURL:v=>(hn||(hn=document.createElement("a")),hn.href=v,hn.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==st&&(st=matchMedia("(prefers-reduced-motion: reduce)")),st.matches)}};class De{static testProp(o){if(!De.docStyle)return o[0];for(let u=0;u<o.length;u++)if(o[u]in De.docStyle)return o[u];return o[0]}static create(o,u,f){const p=window.document.createElement(o);return void 0!==u&&(p.className=u),f&&f.appendChild(p),p}static createNS(o,u){return window.document.createElementNS(o,u)}static disableDrag(){De.docStyle&&De.selectProp&&(De.userSelect=De.docStyle[De.selectProp],De.docStyle[De.selectProp]="none")}static enableDrag(){De.docStyle&&De.selectProp&&(De.docStyle[De.selectProp]=De.userSelect)}static setTransform(o,u){o.style[De.transformProp]=u}static addEventListener(o,u,f,p={}){o.addEventListener(u,f,"passive"in p?p:p.capture)}static removeEventListener(o,u,f,p={}){o.removeEventListener(u,f,"passive"in p?p:p.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",De.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",De.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",De.suppressClickInternal,!0)},0)}static getScale(o){const u=o.getBoundingClientRect();return{x:u.width/o.offsetWidth||1,y:u.height/o.offsetHeight||1,boundingClientRect:u}}static getPoint(o,u,f){const p=u.boundingClientRect;return new x.P((f.clientX-p.left)/u.x-o.clientLeft,(f.clientY-p.top)/u.y-o.clientTop)}static mousePos(o,u){const f=De.getScale(o);return De.getPoint(o,f,u)}static touchPos(o,u){const f=[],p=De.getScale(o);for(let _=0;_<u.length;_++)f.push(De.getPoint(o,p,u[_]));return f}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}De.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,De.selectProp=De.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),De.transformProp=De.testProp(["transform","WebkitTransform"]);const pn={supported:!1,testSupport:function(v){!nt&&Mt&&(ct?It(v):xt=v)}};let xt,Mt,nt=!1,ct=!1;function It(v){const o=v.createTexture();v.bindTexture(v.TEXTURE_2D,o);try{if(v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,Mt),v.isContextLost())return;pn.supported=!0}catch{}v.deleteTexture(o),nt=!0}var pt;typeof document<"u"&&(Mt=document.createElement("img"),Mt.onload=()=>{xt&&It(xt),xt=null,ct=!0},Mt.onerror=()=>{nt=!0,xt=null},Mt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(v){let o,u,f,p;v.resetRequestQueue=()=>{o=[],u=0,f=0,p={}},v.addThrottleControl=A=>{const R=f++;return p[R]=A,R},v.removeThrottleControl=A=>{delete p[A],D()},v.getImage=(A,R,B=!0)=>new Promise((L,W)=>{pn.supported&&(A.headers||(A.headers={}),A.headers.accept="image/webp,*/*"),x.e(A,{type:"image"}),o.push({abortController:R,requestParameters:A,supportImageRefresh:B,state:"queued",onError:Q=>{W(Q)},onSuccess:Q=>{L(Q)}}),D()});const _=A=>x._(this,void 0,void 0,function*(){A.state="running";const{requestParameters:R,supportImageRefresh:B,onError:L,onSuccess:W,abortController:Q}=A,ne=!1===B&&!x.i(self)&&!x.g(R.url)&&(!R.headers||Object.keys(R.headers).reduce((he,Ee)=>he&&"accept"===Ee,!0));u++;const de=ne?S(R,Q):x.m(R,Q);try{const he=yield de;delete A.abortController,A.state="completed",he.data instanceof HTMLImageElement||x.b(he.data)?W(he):he.data&&W({data:yield(se=he.data,"function"==typeof createImageBitmap?x.d(se):x.f(se)),cacheControl:he.cacheControl,expires:he.expires})}catch(he){delete A.abortController,L(he)}finally{u--,D()}var se}),D=()=>{const A=(()=>{for(const R of Object.keys(p))if(p[R]())return!0;return!1})()?x.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:x.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let R=u;R<A&&o.length>0;R++){const B=o.shift();B.abortController.signal.aborted?R--:_(B)}},S=(A,R)=>new Promise((B,L)=>{const W=new Image,Q=A.url,ne=A.credentials;ne&&"include"===ne?W.crossOrigin="use-credentials":(ne&&"same-origin"===ne||!x.s(Q))&&(W.crossOrigin="anonymous"),R.signal.addEventListener("abort",()=>{W.src="",L(x.c())}),W.fetchPriority="high",W.onload=()=>{W.onerror=W.onload=null,B({data:W})},W.onerror=()=>{W.onerror=W.onload=null,R.signal.aborted||L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},W.src=Q})}(pt||(pt={})),pt.resetRequestQueue();class mt{constructor(o){this._transformRequestFn=o}transformRequest(o,u){return this._transformRequestFn&&this._transformRequestFn(o,u)||{url:o}}setTransformRequest(o){this._transformRequestFn=o}}function Qe(v){var o=new x.A(3);return o[0]=v[0],o[1]=v[1],o[2]=v[2],o}var bt,Ze=function(v,o,u){return v[0]=o[0]-u[0],v[1]=o[1]-u[1],v[2]=o[2]-u[2],v};bt=new x.A(3),x.A!=Float32Array&&(bt[0]=0,bt[1]=0,bt[2]=0);var v,bn=function(v){var o=v[0],u=v[1];return o*o+u*u};function ze(v){const o=[];if("string"==typeof v)o.push({id:"default",url:v});else if(v&&v.length>0){const u=[];for(const{id:f,url:p}of v){const _=`${f}${p}`;-1===u.indexOf(_)&&(u.push(_),o.push({id:f,url:p}))}}return o}function lt(v,o,u){const f=v.split("?");return f[0]+=`${o}${u}`,f.join("?")}v=new x.A(2),x.A!=Float32Array&&(v[0]=0,v[1]=0);class Je{constructor(o,u,f,p){this.context=o,this.format=f,this.texture=o.gl.createTexture(),this.update(u,p)}update(o,u,f){const{width:p,height:_}=o,D=!(this.size&&this.size[0]===p&&this.size[1]===_||f),{context:S}=this,{gl:A}=S;if(this.useMipmap=!(!u||!u.useMipmap),A.bindTexture(A.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===A.RGBA&&(!u||!1!==u.premultiply)),D)this.size=[p,_],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||x.b(o)?A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,A.UNSIGNED_BYTE,o):A.texImage2D(A.TEXTURE_2D,0,this.format,p,_,0,this.format,A.UNSIGNED_BYTE,o.data);else{const{x:R,y:B}=f||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||x.b(o)?A.texSubImage2D(A.TEXTURE_2D,0,R,B,A.RGBA,A.UNSIGNED_BYTE,o):A.texSubImage2D(A.TEXTURE_2D,0,R,B,p,_,A.RGBA,A.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&A.generateMipmap(A.TEXTURE_2D)}bind(o,u,f){const{context:p}=this,{gl:_}=p;_.bindTexture(_.TEXTURE_2D,this.texture),f!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=_.LINEAR),o!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,o),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,f||o),this.filter=o),u!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,u),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function Yt(v){const{userImage:o}=v;return!!(o&&o.render&&o.render())&&(v.data.replace(new Uint8Array(o.data.buffer)),!0)}class en extends x.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new x.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:u,promiseResolve:f}of this.requestors)f(this._getImagesForIds(u));this.requestors=[]}}getImage(o){const u=this.images[o];if(u&&!u.data&&u.spriteData){const f=u.spriteData;u.data=new x.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),u.spriteData=null}return u}addImage(o,u){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,u)&&(this.images[o]=u)}_validate(o,u){let f=!0;const p=u.data||u.spriteData;return this._validateStretch(u.stretchX,p&&p.width)||(this.fire(new x.j(new Error(`Image "${o}" has invalid "stretchX" value`))),f=!1),this._validateStretch(u.stretchY,p&&p.height)||(this.fire(new x.j(new Error(`Image "${o}" has invalid "stretchY" value`))),f=!1),this._validateContent(u.content,u)||(this.fire(new x.j(new Error(`Image "${o}" has invalid "content" value`))),f=!1),f}_validateStretch(o,u){if(!o)return!0;let f=0;for(const p of o){if(p[0]<f||p[1]<p[0]||u<p[1])return!1;f=p[1]}return!0}_validateContent(o,u){if(!o)return!0;if(4!==o.length)return!1;const f=u.spriteData,p=f&&f.width||u.data.width,_=f&&f.height||u.data.height;return!(o[0]<0||p<o[0]||o[1]<0||_<o[1]||o[2]<0||p<o[2]||o[3]<0||_<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,u,f=!0){const p=this.getImage(o);if(f&&(p.data.width!==u.data.width||p.data.height!==u.data.height))throw new Error(`size mismatch between old image (${p.data.width}x${p.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=p.version+1,this.images[o]=u,this.updatedImages[o]=!0}removeImage(o){const u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o){return new Promise((u,f)=>{let p=!0;if(!this.isLoaded())for(const _ of o)this.images[_]||(p=!1);this.isLoaded()||p?u(this._getImagesForIds(o)):this.requestors.push({ids:o,promiseResolve:u})})}_getImagesForIds(o){const u={};for(const f of o){let p=this.getImage(f);p||(this.fire(new x.k("styleimagemissing",{id:f})),p=this.getImage(f)),p?u[f]={data:p.data.clone(),pixelRatio:p.pixelRatio,sdf:p.sdf,version:p.version,stretchX:p.stretchX,stretchY:p.stretchY,content:p.content,textFitWidth:p.textFitWidth,textFitHeight:p.textFitHeight,hasRenderCallback:!(!p.userImage||!p.userImage.render)}:x.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:o,height:u}=this.atlasImage;return{width:o,height:u}}getPattern(o){const u=this.patterns[o],f=this.getImage(o);if(!f)return null;if(u&&u.position.version===f.version)return u.position;if(u)u.position.version=f.version;else{const p={w:f.data.width+2,h:f.data.height+2,x:0,y:0},_=new x.I(p,f);this.patterns[o]={bin:p,position:_}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Je(o,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const _ in this.patterns)o.push(this.patterns[_].bin);const{w:u,h:f}=x.p(o),p=this.atlasImage;p.resize({width:u||1,height:f||1});for(const _ in this.patterns){const{bin:D}=this.patterns[_],S=D.x+1,A=D.y+1,R=this.getImage(_).data,B=R.width,L=R.height;x.R.copy(R,p,{x:0,y:0},{x:S,y:A},{width:B,height:L}),x.R.copy(R,p,{x:0,y:L-1},{x:S,y:A-1},{width:B,height:1}),x.R.copy(R,p,{x:0,y:0},{x:S,y:A+L},{width:B,height:1}),x.R.copy(R,p,{x:B-1,y:0},{x:S-1,y:A},{width:1,height:L}),x.R.copy(R,p,{x:0,y:0},{x:S+B,y:A},{width:1,height:L})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const u of o){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const f=this.getImage(u);f||x.w(`Image with ID: "${u}" was not found`),Yt(f)&&this.updateImage(u,f)}}}const $t=1e20;function at(v,o,u,f,p,_,D,S,A){for(let R=o;R<o+f;R++)on(v,u*_+R,_,p,D,S,A);for(let R=u;R<u+p;R++)on(v,R*_+o,1,f,D,S,A)}function on(v,o,u,f,p,_,D){_[0]=0,D[0]=-$t,D[1]=$t,p[0]=v[o];for(let S=1,A=0,R=0;S<f;S++){p[S]=v[o+S*u];const B=S*S;do{const L=_[A];R=(p[S]-p[L]+B-L*L)/(S-L)/2}while(R<=D[A]&&--A>-1);A++,_[A]=S,D[A]=R,D[A+1]=$t}for(let S=0,A=0;S<f;S++){for(;D[A+1]<S;)A++;const R=_[A],B=S-R;v[o+S*u]=p[R]+B*B}}class ut{constructor(o,u){this.requestManager=o,this.localIdeographFontFamily=u,this.entries={}}setURL(o){this.url=o}getGlyphs(o){return x._(this,void 0,void 0,function*(){const u=[];for(const _ in o)for(const D of o[_])u.push(this._getAndCacheGlyphsPromise(_,D));const f=yield Promise.all(u),p={};for(const{stack:_,id:D,glyph:S}of f)p[_]||(p[_]={}),p[_][D]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics};return p})}_getAndCacheGlyphsPromise(o,u){return x._(this,void 0,void 0,function*(){let f=this.entries[o];f||(f=this.entries[o]={glyphs:{},requests:{},ranges:{}});let p=f.glyphs[u];if(void 0!==p)return{stack:o,id:u,glyph:p};if(p=this._tinySDF(f,o,u),p)return f.glyphs[u]=p,{stack:o,id:u,glyph:p};const _=Math.floor(u/256);if(256*_>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[_])return{stack:o,id:u,glyph:p};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[_]){const S=ut.loadGlyphRange(o,_,this.url,this.requestManager);f.requests[_]=S}const D=yield f.requests[_];for(const S in D)this._doesCharSupportLocalGlyph(+S)||(f.glyphs[+S]=D[+S]);return f.ranges[_]=!0,{stack:o,id:u,glyph:D[u]||null}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&/\p{Ideo}|\p{sc=Hang}|\p{sc=Hira}|\p{sc=Kana}/u.test(String.fromCodePoint(o))}_tinySDF(o,u,f){const p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(f))return;let _=o.tinySDF;if(!_){let S="400";/bold/i.test(u)?S="900":/medium/i.test(u)?S="500":/light/i.test(u)&&(S="200"),_=o.tinySDF=new ut.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:p,fontWeight:S})}const D=_.draw(String.fromCharCode(f));return{id:f,bitmap:new x.o({width:D.width||60,height:D.height||60},D.data),metrics:{width:D.glyphWidth/2||24,height:D.glyphHeight/2||24,left:D.glyphLeft/2+.5||0,top:D.glyphTop/2-27.5||-8,advance:D.glyphAdvance/2||24,isDoubleResolution:!0}}}}ut.loadGlyphRange=function(v,o,u,f){return x._(this,void 0,void 0,function*(){const p=256*o,_=p+255,D=f.transformRequest(u.replace("{fontstack}",v).replace("{range}",`${p}-${_}`),"Glyphs"),S=yield x.l(D,new AbortController);if(!S||!S.data)throw new Error(`Could not load glyph range. range: ${o}, ${p}-${_}`);const A={};for(const R of x.n(S.data))A[R.id]=R;return A})},ut.TinySDF=class{constructor({fontSize:v=24,buffer:o=3,radius:u=8,cutoff:f=.25,fontFamily:p="sans-serif",fontWeight:_="normal",fontStyle:D="normal"}={}){this.buffer=o,this.cutoff=f,this.radius=u;const S=this.size=v+4*o,A=this._createCanvas(S),R=this.ctx=A.getContext("2d",{willReadFrequently:!0});R.font=`${D} ${_} ${v}px ${p}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(v){const o=document.createElement("canvas");return o.width=o.height=v,o}draw(v){const{width:o,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:p,actualBoundingBoxRight:_}=this.ctx.measureText(v),D=Math.ceil(u),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-p))),A=Math.min(this.size-this.buffer,D+Math.ceil(f)),R=S+2*this.buffer,B=A+2*this.buffer,L=Math.max(R*B,0),W=new Uint8ClampedArray(L),Q={data:W,width:R,height:B,glyphWidth:S,glyphHeight:A,glyphTop:D,glyphLeft:0,glyphAdvance:o};if(0===S||0===A)return Q;const{ctx:ne,buffer:de,gridInner:se,gridOuter:he}=this;ne.clearRect(de,de,S,A),ne.fillText(v,de,de+D);const Ee=ne.getImageData(de,de,S,A);he.fill($t,0,L),se.fill(0,0,L);for(let oe=0;oe<A;oe++)for(let Me=0;Me<S;Me++){const Oe=Ee.data[4*(oe*S+Me)+3]/255;if(0===Oe)continue;const Be=(oe+de)*R+Me+de;if(1===Oe)he[Be]=0,se[Be]=$t;else{const ft=.5-Oe;he[Be]=ft>0?ft*ft:0,se[Be]=ft<0?ft*ft:0}}at(he,0,0,R,B,R,this.f,this.v,this.z),at(se,de,de,S,A,R,this.f,this.v,this.z);for(let oe=0;oe<L;oe++){const Me=Math.sqrt(he[oe])-Math.sqrt(se[oe]);W[oe]=Math.round(255-255*(Me/this.radius+this.cutoff))}return Q}};class Gn{constructor(){this.specification=x.v.light.position}possiblyEvaluate(o,u){return x.x(o.expression.evaluate(u))}interpolate(o,u,f){return{x:x.y.number(o.x,u.x,f),y:x.y.number(o.y,u.y,f),z:x.y.number(o.z,u.z,f)}}}let Nt;class gt extends x.E{constructor(o){super(),Nt=Nt||new x.q({anchor:new x.D(x.v.light.anchor),position:new Gn,color:new x.D(x.v.light.color),intensity:new x.D(x.v.light.intensity)}),this._transitionable=new x.T(Nt),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,u={}){if(!this._validate(x.r,o,u))for(const f in o){const p=o[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),p):this._transitionable.setValue(f,p)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,f){return(!f||!1!==f.validate)&&x.t(this,o.call(x.u,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:x.v}))}}const Xe=new x.q({"sky-color":new x.D(x.v.sky["sky-color"]),"horizon-color":new x.D(x.v.sky["horizon-color"]),"fog-color":new x.D(x.v.sky["fog-color"]),"fog-ground-blend":new x.D(x.v.sky["fog-ground-blend"]),"horizon-fog-blend":new x.D(x.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new x.D(x.v.sky["sky-horizon-blend"]),"atmosphere-blend":new x.D(x.v.sky["atmosphere-blend"])});class ge extends x.E{constructor(o){super(),this._transitionable=new x.T(Xe),this.setSky(o),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new x.z(0))}setSky(o,u={}){if(!this._validate(x.B,o,u)){o||(o={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent"});for(const f in o){const p=o[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),p):this._transitionable.setValue(f,p)}}}getSky(){return this._transitionable.serialize()}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,f={}){return!1!==f?.validate&&x.t(this,o.call(x.u,x.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:x.v})))}calculateFogBlendOpacity(o){return o<60?0:o<70?(o-60)/10:1}}class be{constructor(o,u){this.width=o,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,u){const f=o.join(",")+String(u);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(o,u)),this.dashEntry[f]}getDashRanges(o,u,f){const p=[];let _=o.length%2==1?-o[o.length-1]*f:0,D=o[0]*f,S=!0;p.push({left:_,right:D,isDash:S,zeroLength:0===o[0]});let A=o[0];for(let R=1;R<o.length;R++){S=!S;const B=o[R];_=A*f,A+=B,D=A*f,p.push({left:_,right:D,isDash:S,zeroLength:0===B})}return p}addRoundDash(o,u,f){const p=u/2;for(let _=-f;_<=f;_++){const D=this.width*(this.nextRow+f+_);let S=0,A=o[S];for(let R=0;R<this.width;R++){R/A.right>1&&(A=o[++S]);const B=Math.abs(R-A.left),L=Math.abs(R-A.right),W=Math.min(B,L);let Q;const ne=_/f*(p+1);if(A.isDash){const de=p-Math.abs(ne);Q=Math.sqrt(W*W+de*de)}else Q=p-Math.sqrt(W*W+ne*ne);this.data[D+R]=Math.max(0,Math.min(255,Q+128))}}}addRegularDash(o){for(let S=o.length-1;S>=0;--S){const A=o[S],R=o[S+1];A.zeroLength?o.splice(S,1):R&&R.isDash===A.isDash&&(R.left=A.left,o.splice(S,1))}const u=o[0],f=o[o.length-1];u.isDash===f.isDash&&(u.left=f.left-this.width,f.right=u.right+this.width);const p=this.width*this.nextRow;let _=0,D=o[_];for(let S=0;S<this.width;S++){S/D.right>1&&(D=o[++_]);const A=Math.abs(S-D.left),R=Math.abs(S-D.right),B=Math.min(A,R);this.data[p+S]=Math.max(0,Math.min(255,(D.isDash?B:-B)+128))}}addDash(o,u){const f=u?7:0,p=2*f+1;if(this.nextRow+p>this.height)return x.w("LineAtlas out of space"),null;let _=0;for(let S=0;S<o.length;S++)_+=o[S];if(0!==_){const S=this.width/_,A=this.getDashRanges(o,this.width,S);u?this.addRoundDash(A,S,f):this.addRegularDash(A)}const D={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:_};return this.nextRow+=p,this.dirty=!0,D}bind(o){const u=o.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const fe="maplibre_preloaded_worker_pool";class Z{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<Z.workerCount;)this.workers.push(new Worker(x.a.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],0===this.numActive()&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[fe]}numActive(){return Object.keys(this.active).length}}const Ye=Math.floor(Ae.hardwareConcurrency/2);let qt,kt;function Lt(){return qt||(qt=new Z),qt}Z.workerCount=x.C(globalThis)?Math.max(Math.min(Ye,3),1):1;class jt{constructor(o,u){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=u;const f=this.workerPool.acquire(u);for(let p=0;p<f.length;p++){const _=new x.F(f[p],u);_.name=`Worker ${p}`,this.actors.push(_)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,u){const f=[];for(const p of this.actors)f.push(p.sendAsync({type:o,data:u}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}registerMessageHandler(o,u){for(const f of this.actors)f.registerMessageHandler(o,u)}}function mn(){return kt||(kt=new jt(Lt(),x.G),kt.registerMessageHandler("GR",(v,o,u)=>x.m(o,u))),kt}function di(v,o){const u=x.H();return x.J(u,u,[1,1,0]),x.K(u,u,[.5*v.width,.5*v.height,1]),x.L(u,u,v.calculatePosMatrix(o.toUnwrapped()))}function Ui(v,o,u,f,p,_){const D=function(L,W,Q){if(L)for(const ne of L){const de=W[ne];if(de&&de.source===Q&&"fill-extrusion"===de.type)return!0}else for(const ne in W){const de=W[ne];if(de.source===Q&&"fill-extrusion"===de.type)return!0}return!1}(p&&p.layers,o,v.id),S=_.maxPitchScaleFactor(),A=v.tilesIn(f,S,D);A.sort(ri);const R=[];for(const L of A)R.push({wrappedTileID:L.tileID.wrapped().key,queryResults:L.tile.queryRenderedFeatures(o,u,v._state,L.queryGeometry,L.cameraQueryGeometry,L.scale,p,_,S,di(v.transform,L.tileID))});const B=function(L){const W={},Q={};for(const ne of L){const de=ne.queryResults,se=ne.wrappedTileID,he=Q[se]=Q[se]||{};for(const Ee in de){const oe=de[Ee],Me=he[Ee]=he[Ee]||{},Oe=W[Ee]=W[Ee]||[];for(const Be of oe)Me[Be.featureIndex]||(Me[Be.featureIndex]=!0,Oe.push(Be))}}return W}(R);for(const L in B)B[L].forEach(W=>{const Q=W.feature,ne=v.getFeatureState(Q.layer["source-layer"],Q.id);Q.source=Q.layer.source,Q.layer["source-layer"]&&(Q.sourceLayer=Q.layer["source-layer"]),Q.state=ne});return B}function ri(v,o){const u=v.tileID,f=o.tileID;return u.overscaledZ-f.overscaledZ||u.canonical.y-f.canonical.y||u.wrap-f.wrap||u.canonical.x-f.canonical.x}function ur(v,o,u){return x._(this,void 0,void 0,function*(){let f=v;if(v.url?f=(yield x.h(o.transformRequest(v.url,"Source"),u)).data:yield Ae.frameAsync(u),!f)return null;const p=x.M(x.e(f,v),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(p.vectorLayerIds=f.vector_layers.map(_=>_.id)),p})}class ve{constructor(o,u){o&&(u?this.setSouthWest(o).setNorthEast(u):Array.isArray(o)&&(4===o.length?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof x.N?new x.N(o.lng,o.lat):x.N.convert(o),this}setSouthWest(o){return this._sw=o instanceof x.N?new x.N(o.lng,o.lat):x.N.convert(o),this}extend(o){const u=this._sw,f=this._ne;let p,_;if(o instanceof x.N)p=o,_=o;else{if(!(o instanceof ve))return Array.isArray(o)?4===o.length||o.every(Array.isArray)?this.extend(ve.convert(o)):this.extend(x.N.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(x.N.convert(o)):this;if(p=o._sw,_=o._ne,!p||!_)return this}return u||f?(u.lng=Math.min(p.lng,u.lng),u.lat=Math.min(p.lat,u.lat),f.lng=Math.max(_.lng,f.lng),f.lat=Math.max(_.lat,f.lat)):(this._sw=new x.N(p.lng,p.lat),this._ne=new x.N(_.lng,_.lat)),this}getCenter(){return new x.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new x.N(this.getWest(),this.getNorth())}getSouthEast(){return new x.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:u,lat:f}=x.N.convert(o);let p=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&p}static convert(o){return o instanceof ve?o:o&&new ve(o)}static fromLngLat(o,u=0){const f=360*u/40075017,p=f/Math.cos(Math.PI/180*o.lat);return new ve(new x.N(o.lng-p,o.lat-f),new x.N(o.lng+p,o.lat+f))}}class Oi{constructor(o,u,f){this.bounds=ve.convert(this.validateBounds(o)),this.minzoom=u||0,this.maxzoom=f||24}validateBounds(o){return Array.isArray(o)&&4===o.length?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const u=Math.pow(2,o.z),f=Math.floor(x.O(this.bounds.getWest())*u),p=Math.floor(x.Q(this.bounds.getNorth())*u),_=Math.ceil(x.O(this.bounds.getEast())*u),D=Math.ceil(x.Q(this.bounds.getSouth())*u);return o.x>=f&&o.x<_&&o.y>=p&&o.y<D}}class dr extends x.E{constructor(o,u,f,p){if(super(),this.id=o,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,x.e(this,x.M(u,["url","scheme","tileSize","promoteId"])),this._options=x.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}load(){return x._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new x.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield ur(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),o&&(x.e(this,o),o.bounds&&(this.tileBounds=new Oi(o.bounds,this.minzoom,this.maxzoom)),this.fire(new x.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new x.k("data",{dataType:"source",sourceDataType:"content"})))}catch(o){this._tileJSONRequest=null,this.fire(new x.j(o))}})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.abort(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return x.e({},this._options)}loadTile(o){return x._(this,void 0,void 0,function*(){const u=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(u,"Tile"),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};f.request.collectResourceTiming=this._collectResourceTiming;let p="RT";if(o.actor&&"expired"!==o.state){if("loading"===o.state)return new Promise((_,D)=>{o.reloadPromise={resolve:_,reject:D}})}else o.actor=this.dispatcher.getActor(),p="LT";o.abortController=new AbortController;try{const _=yield o.actor.sendAsync({type:p,data:f},o.abortController);if(delete o.abortController,o.aborted)return;this._afterTileLoadWorkerResponse(o,_)}catch(_){if(delete o.abortController,o.aborted)return;if(_&&404!==_.status)throw _;this._afterTileLoadWorkerResponse(o,null)}})}_afterTileLoadWorkerResponse(o,u){if(u&&u.resourceTiming&&(o.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&o.setExpiryData(u),o.loadVectorData(u,this.map.painter),o.reloadPromise){const f=o.reloadPromise;o.reloadPromise=null,this.loadTile(o).then(f.resolve).catch(f.reject)}}abortTile(o){return x._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.actor&&(yield o.actor.sendAsync({type:"AT",data:{uid:o.uid,type:this.type,source:this.id}}))})}unloadTile(o){return x._(this,void 0,void 0,function*(){o.unloadVectorData(),o.actor&&(yield o.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Pn extends x.E{constructor(o,u,f,p){super(),this.id=o,this.dispatcher=f,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=x.e({type:"raster"},u),x.e(this,x.M(u,["url","scheme","tileSize"]))}load(){return x._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new x.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield ur(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,o&&(x.e(this,o),o.bounds&&(this.tileBounds=new Oi(o.bounds,this.minzoom,this.maxzoom)),this.fire(new x.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new x.k("data",{dataType:"source",sourceDataType:"content"})))}catch(o){this._tileJSONRequest=null,this.fire(new x.j(o))}})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}serialize(){return x.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o){return x._(this,void 0,void 0,function*(){const u=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.abortController=new AbortController;try{const f=yield pt.getImage(this.map._requestManager.transformRequest(u,"Tile"),o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&f.cacheControl&&f.expires&&o.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const p=this.map.painter.context,_=p.gl,D=f.data;o.texture=this.map.painter.getTileTexture(D.width),o.texture?o.texture.update(D,{useMipmap:!0}):(o.texture=new Je(p,D,_.RGBA,{useMipmap:!0}),o.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST)),o.state="loaded"}}catch(f){if(delete o.abortController,o.aborted)o.state="unloaded";else if(f)throw o.state="errored",f}})}abortTile(o){return x._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController)})}unloadTile(o){return x._(this,void 0,void 0,function*(){o.texture&&this.map.painter.saveTileTexture(o.texture)})}hasTransition(){return!1}}class Vn extends Pn{constructor(o,u,f,p){super(o,u,f,p),this.type="raster-dem",this.maxzoom=22,this._options=x.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(o){return x._(this,void 0,void 0,function*(){const u=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(u,"Tile");o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.abortController=new AbortController;try{const p=yield pt.getImage(f,o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(p&&p.data){const _=p.data;this.map._refreshExpiredTiles&&p.cacheControl&&p.expires&&o.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});const D=x.b(_)&&x.U()?_:yield this.readImageNow(_),S={type:this.type,uid:o.uid,source:this.id,rawImageData:D,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!o.actor||"expired"===o.state){o.actor=this.dispatcher.getActor();const A=yield o.actor.sendAsync({type:"LDT",data:S});o.dem=A,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded"}}}catch(p){if(delete o.abortController,o.aborted)o.state="unloaded";else if(p)throw o.state="errored",p}})}readImageNow(o){return x._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&x.V()){const u=o.width+2,f=o.height+2;try{return new x.R({width:u,height:f},yield x.W(o,-1,-1,u,f))}catch{}}return Ae.getImageData(o,1)})}_getNeighboringTiles(o){const u=o.canonical,f=Math.pow(2,u.z),p=(u.x-1+f)%f,_=0===u.x?o.wrap-1:o.wrap,D=(u.x+1+f)%f,S=u.x+1===f?o.wrap+1:o.wrap,A={};return A[new x.S(o.overscaledZ,_,u.z,p,u.y).key]={backfilled:!1},A[new x.S(o.overscaledZ,S,u.z,D,u.y).key]={backfilled:!1},u.y>0&&(A[new x.S(o.overscaledZ,_,u.z,p,u.y-1).key]={backfilled:!1},A[new x.S(o.overscaledZ,o.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},A[new x.S(o.overscaledZ,S,u.z,D,u.y-1).key]={backfilled:!1}),u.y+1<f&&(A[new x.S(o.overscaledZ,_,u.z,p,u.y+1).key]={backfilled:!1},A[new x.S(o.overscaledZ,o.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},A[new x.S(o.overscaledZ,S,u.z,D,u.y+1).key]={backfilled:!1}),A}unloadTile(o){return x._(this,void 0,void 0,function*(){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&(yield o.actor.sendAsync({type:"RDT",data:{type:this.type,uid:o.uid,source:this.id}}))})}}class ht extends x.E{constructor(o,u,f,p){super(),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=f.getActor(),this.setEventedParent(p),this._data=u.data,this._options=x.e({},u),this._collectResourceTiming=u.collectResourceTiming,void 0!==u.maxzoom&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const _=x.X/this.tileSize;this.workerOptions=x.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(void 0!==u.buffer?u.buffer:128)*_,tolerance:(void 0!==u.tolerance?u.tolerance:.375)*_,extent:x.X,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:void 0!==u.clusterMaxZoom?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:x.X,radius:(u.clusterRadius||50)*_,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}load(){return x._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData(),this}updateData(o){return this._updateWorkerData(o),this}getData(){return x._(this,void 0,void 0,function*(){const o=x.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:o})})}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o&&(void 0!==o.clusterRadius&&(this.workerOptions.superclusterOptions.radius=o.clusterRadius),void 0!==o.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=o.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(o){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:o,source:this.id}})}getClusterChildren(o){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:o,source:this.id}})}getClusterLeaves(o,u,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:o,limit:u,offset:f}})}_updateWorkerData(o){return x._(this,void 0,void 0,function*(){const u=x.e({type:this.type},this.workerOptions);o?u.dataDiff=o:"string"==typeof this._data?(u.request=this.map._requestManager.transformRequest(Ae.resolveURL(this._data),"Source"),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new x.k("dataloading",{dataType:"source"}));try{const f=yield this.actor.sendAsync({type:"LD",data:u});if(this._pendingLoads--,this._removed||f.abandoned)return void this.fire(new x.k("dataabort",{dataType:"source"}));let p=null;f.resourceTiming&&f.resourceTiming[this.id]&&(p=f.resourceTiming[this.id].slice(0));const _={dataType:"source"};this._collectResourceTiming&&p&&p.length>0&&x.e(_,{resourceTiming:p}),this.fire(new x.k("data",Object.assign(Object.assign({},_),{sourceDataType:"metadata"}))),this.fire(new x.k("data",Object.assign(Object.assign({},_),{sourceDataType:"content"})))}catch(f){if(this._pendingLoads--,this._removed)return void this.fire(new x.k("dataabort",{dataType:"source"}));this.fire(new x.j(f))}})}loaded(){return 0===this._pendingLoads}loadTile(o){return x._(this,void 0,void 0,function*(){const u=o.actor?"RT":"LT";o.actor=this.actor;const f={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.abortController=new AbortController;const p=yield this.actor.sendAsync({type:u,data:f},o.abortController);delete o.abortController,o.unloadVectorData(),o.aborted||o.loadVectorData(p,this.map.painter,"RT"===u)})}abortTile(o){return x._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.aborted=!0})}unloadTile(o){return x._(this,void 0,void 0,function*(){o.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return x.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Ne=x.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class et extends x.E{constructor(o,u,f,p){super(),this.id=o,this.dispatcher=f,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=u}load(o){return x._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new x.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield pt.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,o&&(this.coordinates=o),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new x.j(u))}})}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=o.url,this.load(o.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new x.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(o){this.coordinates=o;const u=o.map(x.Z.fromLngLat);this.tileID=function(p){let _=1/0,D=1/0,S=-1/0,A=-1/0;for(const W of p)_=Math.min(_,W.x),D=Math.min(D,W.y),S=Math.max(S,W.x),A=Math.max(A,W.y);const R=Math.max(S-_,A-D),B=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),L=Math.pow(2,B);return new x.a1(B,Math.floor((_+S)/2*L),Math.floor((D+A)/2*L))}(u),this.minzoom=this.maxzoom=this.tileID.z;const f=u.map(p=>this.tileID.getTilePoint(p)._round());return this._boundsArray=new x.$,this._boundsArray.emplaceBack(f[0].x,f[0].y,0,0),this._boundsArray.emplaceBack(f[1].x,f[1].y,x.X,0),this._boundsArray.emplaceBack(f[3].x,f[3].y,0,x.X),this._boundsArray.emplaceBack(f[2].x,f[2].y,x.X,x.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new x.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const o=this.map.painter.context,u=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ne.members)),this.boundsSegments||(this.boundsSegments=x.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Je(o,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(const p in this.tiles){const _=this.tiles[p];"loaded"!==_.state&&(_.state="loaded",_.texture=this.texture,f=!0)}f&&this.fire(new x.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(o){return x._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={}):o.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class wn extends et{constructor(o,u,f,p){super(o,u,f,p),this.roundZoom=!0,this.type="video",this.options=u}load(){return x._(this,void 0,void 0,function*(){this._loaded=!1;const o=this.options;this.urls=[];for(const u of o.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield x.a3(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new x.j(u))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const u=this.video.seekable;o<u.start(0)||o>u.end(0)?this.fire(new x.j(new x.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const o=this.map.painter.context,u=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ne.members)),this.boundsSegments||(this.boundsSegments=x.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new Je(o,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(const p in this.tiles){const _=this.tiles[p];"loaded"!==_.state&&(_.state="loaded",_.texture=this.texture,f=!0)}f&&this.fire(new x.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Fn extends et{constructor(o,u,f,p){super(o,u,f,p),u.coordinates?Array.isArray(u.coordinates)&&4===u.coordinates.length&&!u.coordinates.some(_=>!Array.isArray(_)||2!==_.length||_.some(D=>"number"!=typeof D))||this.fire(new x.j(new x.a2(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new x.j(new x.a2(`sources.${o}`,null,'missing required property "coordinates"'))),u.animate&&"boolean"!=typeof u.animate&&this.fire(new x.j(new x.a2(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),u.canvas?"string"==typeof u.canvas||u.canvas instanceof HTMLCanvasElement||this.fire(new x.j(new x.a2(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new x.j(new x.a2(`sources.${o}`,null,'missing required property "canvas"'))),this.options=u,this.animate=void 0===u.animate||u.animate}load(){return x._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new x.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const u=this.map.painter.context,f=u.gl;this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,Ne.members)),this.boundsSegments||(this.boundsSegments=x.a0.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Je(u,this.canvas,f.RGBA,{premultiply:!0});let p=!1;for(const _ in this.tiles){const D=this.tiles[_];"loaded"!==D.state&&(D.state="loaded",D.texture=this.texture,p=!0)}p&&this.fire(new x.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const $i={},ki=v=>{switch(v){case"geojson":return ht;case"image":return et;case"raster":return Pn;case"raster-dem":return Vn;case"vector":return dr;case"video":return wn;case"canvas":return Fn}return $i[v]},it="RTLPluginLoaded";class vi extends x.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=mn()}_syncState(o){return this.status=o,this.dispatcher.broadcast("SRPS",{pluginStatus:o,pluginURL:this.url}).catch(u=>{throw this.status="error",u})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(o){return x._(this,arguments,void 0,function*(u,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=Ae.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if("unavailable"===this.status){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if("requested"===this.status)return this._requestImport()})}_requestImport(){return x._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new x.k(it))})}lazyLoad(){"unavailable"===this.status?this.status="requested":"deferred"===this.status&&this._requestImport()}}let hi=null;function hr(){return hi||(hi=new vi),hi}class Hi{constructor(o,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=o,this.uid=x.a4(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const u=o+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,u,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(p,_){const D={};if(!_)return D;for(const S of p){const A=S.layerIds.map(R=>_.getLayer(R)).filter(Boolean);if(0!==A.length){S.layers=A,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(R=>A.filter(B=>B.id===R)[0]));for(const R of A)D[R.id]=S}}return D}(o.buckets,u.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const _=this.buckets[p];if(_ instanceof x.a6){if(this.hasSymbolBuckets=!0,!f)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const _=this.buckets[p];if(_ instanceof x.a6&&_.hasRTLText){this.hasRTLText=!0,hr().lazyLoad();break}}this.queryPadding=0;for(const p in this.buckets){const _=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(p).queryRadius(_))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new x.a5}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const f in this.buckets){const p=this.buckets[f];p.uploadPending()&&p.upload(o)}const u=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Je(o,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Je(o,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,u,f,p,_,D,S,A,R,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:_,scale:D,tileSize:this.tileSize,pixelPosMatrix:B,transform:A,params:S,queryPadding:this.queryPadding*R},o,u,f):{}}querySourceFeatures(o,u){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const p=f.loadVTLayers(),_=u&&u.sourceLayer?u.sourceLayer:"",D=p._geojsonTileLayer||p[_];if(!D)return;const S=x.a7(u&&u.filter),{z:A,x:R,y:B}=this.tileID.canonical,L={z:A,x:R,y:B};for(let W=0;W<D.length;W++){const Q=D.feature(W);if(S.needGeometry){const se=x.a8(Q,!0);if(!S.filter(new x.z(this.tileID.overscaledZ),se,this.tileID.canonical))continue}else if(!S.filter(new x.z(this.tileID.overscaledZ),Q))continue;const ne=f.getId(Q,_),de=new x.a9(Q,A,R,B,ne);de.tile=L,o.push(de)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const u=this.expirationTime;if(o.cacheControl){const f=x.aa(o.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const f=Date.now();let p=!1;if(this.expirationTime>f)p=!1;else if(u)if(this.expirationTime<u)p=!0;else{const _=this.expirationTime-u;_?this.expirationTime=f+Math.max(_,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(o,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(o).length)return;const f=this.latestFeatureIndex.loadVTLayers();for(const p in this.buckets){if(!u.style.hasLayer(p))continue;const _=this.buckets[p],D=_.layers[0].sourceLayer||"_geojsonTileLayer",S=f[D],A=o[D];if(!S||!A||0===Object.keys(A).length)continue;_.update(A,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});const R=u&&u.style&&u.style.getLayer(p);R&&(this.queryPadding=Math.max(this.queryPadding,R.queryRadius(_)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ae.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=Ae.now()+o}setDependencies(o,u){const f={};for(const p of u)f[p]=!0;this.dependencies[o]=f}hasDependency(o,u){for(const f of o){const p=this.dependencies[f];if(p)for(const _ of u)if(p[_])return!0}return!1}}class Bt{constructor(o,u){this.max=o,this.onRemove=u,this.reset()}reset(){for(const o in this.data)for(const u of this.data[o])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(o,u,f){const p=o.wrapped().key;void 0===this.data[p]&&(this.data[p]=[]);const _={value:u,timeout:void 0};if(void 0!==f&&(_.timeout=setTimeout(()=>{this.remove(o,_)},f)),this.data[p].push(_),this.order.push(p),this.order.length>this.max){const D=this._getAndRemoveByKey(this.order[0]);D&&this.onRemove(D)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const u=this.data[o].shift();return u.timeout&&clearTimeout(u.timeout),0===this.data[o].length&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),u.value}getByKey(o){const u=this.data[o];return u?u[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,u){if(!this.has(o))return this;const f=o.wrapped().key,p=void 0===u?0:this.data[f].indexOf(u),_=this.data[f][p];return this.data[f].splice(p,1),_.timeout&&clearTimeout(_.timeout),0===this.data[f].length&&delete this.data[f],this.onRemove(_.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(o){const u=[];for(const f in this.data)for(const p of this.data[f])o(p.value)||u.push(p);for(const f of u)this.remove(f.value.tileID,f)}}class Wn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,u,f){const p=String(u);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][p]=this.stateChanges[o][p]||{},x.e(this.stateChanges[o][p],f),null===this.deletedStates[o]){this.deletedStates[o]={};for(const _ in this.state[o])_!==p&&(this.deletedStates[o][_]=null)}else if(this.deletedStates[o]&&null===this.deletedStates[o][p]){this.deletedStates[o][p]={};for(const _ in this.state[o][p])f[_]||(this.deletedStates[o][p][_]=null)}else for(const _ in f)this.deletedStates[o]&&this.deletedStates[o][p]&&null===this.deletedStates[o][p][_]&&delete this.deletedStates[o][p][_]}removeFeatureState(o,u,f){if(null===this.deletedStates[o])return;const p=String(u);if(this.deletedStates[o]=this.deletedStates[o]||{},f&&void 0!==u)null!==this.deletedStates[o][p]&&(this.deletedStates[o][p]=this.deletedStates[o][p]||{},this.deletedStates[o][p][f]=null);else if(void 0!==u)if(this.stateChanges[o]&&this.stateChanges[o][p])for(f in this.deletedStates[o][p]={},this.stateChanges[o][p])this.deletedStates[o][p][f]=null;else this.deletedStates[o][p]=null;else this.deletedStates[o]=null}getState(o,u){const f=String(u),p=x.e({},(this.state[o]||{})[f],(this.stateChanges[o]||{})[f]);if(null===this.deletedStates[o])return{};if(this.deletedStates[o]){const _=this.deletedStates[o][u];if(null===_)return{};for(const D in _)delete p[D]}return p}initializeTileState(o,u){o.setFeatureState(this.state,u)}coalesceChanges(o,u){const f={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const _={};for(const D in this.stateChanges[p])this.state[p][D]||(this.state[p][D]={}),x.e(this.state[p][D],this.stateChanges[p][D]),_[D]=this.state[p][D];f[p]=_}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const _={};if(null===this.deletedStates[p])for(const D in this.state[p])_[D]={},this.state[p][D]={};else for(const D in this.deletedStates[p]){if(null===this.deletedStates[p][D])this.state[p][D]={};else for(const S of Object.keys(this.deletedStates[p][D]))delete this.state[p][D][S];_[D]=this.state[p][D]}f[p]=f[p]||{},x.e(f[p],_)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(f).length)for(const p in o)o[p].setFeatureState(f,u)}}class In extends x.E{constructor(o,u,f){super(),this.id=o,this.dispatcher=f,this.on("data",p=>this._dataHandler(p)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((p,_,D,S)=>{const A=new(ki(_.type))(p,_,D,S);if(A.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${A.id}`);return A})(o,u,f,this),this._tiles={},this._cache=new Bt(0,p=>this._unloadTile(p)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Wn,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const u=this._tiles[o];if("loaded"!==u.state&&"errored"!==u.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,u,f){return x._(this,void 0,void 0,function*(){try{yield this._source.loadTile(o),this._tileLoaded(o,u,f)}catch(p){o.state="errored",404!==p.status?this._source.fire(new x.j(p,{tile:o})):this.update(this.transform,this.terrain)}})}_unloadTile(o){this._source.unloadTile&&this._source.unloadTile(o)}_abortTile(o){this._source.abortTile&&this._source.abortTile(o),this._source.fire(new x.k("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const f=this._tiles[u];f.upload(o),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(Ur).map(o=>o.key)}getRenderableIds(o){const u=[];for(const f in this._tiles)this._isIdRenderable(f,o)&&u.push(this._tiles[f]);return o?u.sort((f,p)=>{const _=f.tileID,D=p.tileID,S=new x.P(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),A=new x.P(D.canonical.x,D.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-D.overscaledZ||A.y-S.y||A.x-S.x}).map(f=>f.tileID.key):u.map(f=>f.tileID).sort(Ur).map(f=>f.key)}hasRenderableParent(o){const u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(o,u){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)"errored"!==this._tiles[o].state&&this._reloadTile(o,"reloading")}}_reloadTile(o,u){return x._(this,void 0,void 0,function*(){const f=this._tiles[o];f&&("loading"!==f.state&&(f.state=u),yield this._loadTile(f,o,u))})}_tileLoaded(o,u,f){o.timeAdded=Ae.now(),"expired"===f&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),"raster-dem"===this.getSource().type&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new x.k("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const u=this.getRenderableIds();for(let p=0;p<u.length;p++){const _=u[p];if(o.neighboringTiles&&o.neighboringTiles[_]){const D=this.getTileByID(_);f(o,D),f(D,o)}}function f(p,_){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let D=_.tileID.canonical.x-p.tileID.canonical.x;const S=_.tileID.canonical.y-p.tileID.canonical.y,A=Math.pow(2,p.tileID.canonical.z),R=_.tileID.key;0===D&&0===S||Math.abs(S)>1||(Math.abs(D)>1&&(1===Math.abs(D+A)?D+=A:1===Math.abs(D-A)&&(D-=A)),_.dem&&p.dem&&(p.dem.backfillBorder(_.dem,D,S),p.neighboringTiles&&p.neighboringTiles[R]&&(p.neighboringTiles[R].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,u,f,p){for(const _ in this._tiles){let D=this._tiles[_];if(p[_]||!D.hasData()||D.tileID.overscaledZ<=u||D.tileID.overscaledZ>f)continue;let S=D.tileID;for(;D&&D.tileID.overscaledZ>u+1;){const R=D.tileID.scaledTo(D.tileID.overscaledZ-1);D=this._tiles[R.key],D&&D.hasData()&&(S=R)}let A=S;for(;A.overscaledZ>u;)if(A=A.scaledTo(A.overscaledZ-1),o[A.key]){p[S.key]=S;break}}}findLoadedParent(o,u){if(o.key in this._loadedParentTiles){const f=this._loadedParentTiles[o.key];return f&&f.tileID.overscaledZ>=u?f:null}for(let f=o.overscaledZ-1;f>=u;f--){const p=o.scaledTo(f),_=this._getLoadedTile(p);if(_)return _}}findLoadedSibling(o){return this._getLoadedTile(o)}_getLoadedTile(o){const u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const u=Math.ceil(o.width/this._source.tileSize)+1,f=Math.ceil(o.height/this._source.tileSize)+1,p=Math.floor(u*f*(null===this._maxTileCacheZoomLevels?x.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),_="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(_)}handleWrapJump(o){const u=Math.round((o-(void 0===this._prevLng?o:this._prevLng))/360);if(this._prevLng=o,u){const f={};for(const p in this._tiles){const _=this._tiles[p];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+u),f[_.tileID.key]=_}this._tiles=f;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}_updateCoveredAndRetainedTiles(o,u,f,p,_,D){const S={},A={},R=Object.keys(o),B=Ae.now();for(const L of R){const W=o[L],Q=this._tiles[L];if(!Q||0!==Q.fadeEndTime&&Q.fadeEndTime<=B)continue;const ne=this.findLoadedParent(W,u),de=this.findLoadedSibling(W),se=ne||de||null;se&&(this._addTile(se.tileID),S[se.tileID.key]=se.tileID),A[L]=W}this._retainLoadedChildren(A,p,f,o);for(const L in S)o[L]||(this._coveredTiles[L]=!0,o[L]=S[L]);if(D){const L={},W={};for(const Q of _)this._tiles[Q.key].hasData()?L[Q.key]=Q:W[Q.key]=Q;for(const Q in W){const ne=W[Q].children(this._source.maxzoom);this._tiles[ne[0].key]&&this._tiles[ne[1].key]&&this._tiles[ne[2].key]&&this._tiles[ne[3].key]&&(L[ne[0].key]=o[ne[0].key]=ne[0],L[ne[1].key]=o[ne[1].key]=ne[1],L[ne[2].key]=o[ne[2].key]=ne[2],L[ne[3].key]=o[ne[3].key]=ne[3],delete W[Q])}for(const Q in W){const ne=W[Q],de=this.findLoadedParent(ne,this._source.minzoom),se=this.findLoadedSibling(ne),he=de||se||null;if(he){L[he.tileID.key]=o[he.tileID.key]=he.tileID;for(const Ee in L)L[Ee].isChildOf(he.tileID)&&delete L[Ee]}}for(const Q in this._tiles)L[Q]||(this._coveredTiles[Q]=!0)}}update(o,u){if(!this._sourceLoaded||this._paused)return;let f;this.transform=o,this.terrain=u,this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(B=>new x.S(B.canonical.z,B.wrap,B.canonical.z,B.canonical.x,B.canonical.y)):(f=o.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u}),this._source.hasTile&&(f=f.filter(B=>this._source.hasTile(B)))):f=[];const p=o.coveringZoomLevel(this._source),_=Math.max(p-In.maxOverzooming,this._source.minzoom),D=Math.max(p+In.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const B={};for(const L of f)if(L.canonical.z>this._source.minzoom){const W=L.scaledTo(L.canonical.z-1);B[W.key]=W;const Q=L.scaledTo(Math.max(this._source.minzoom,Math.min(L.canonical.z,5)));B[Q.key]=Q}f=f.concat(Object.values(B))}const S=0===f.length&&!this._updated&&this._didEmitContent;this._updated=!0,S&&this.fire(new x.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const A=this._updateRetainedTiles(f,p);uo(this._source.type)&&this._updateCoveredAndRetainedTiles(A,_,D,p,f,u);for(const B in A)this._tiles[B].clearFadeHold();const R=x.ab(this._tiles,A);for(const B of R){const L=this._tiles[B];L.hasSymbolBuckets&&!L.holdingForFade()?L.setHoldDuration(this.map._fadeDuration):L.hasSymbolBuckets&&!L.symbolFadeFinished()||this._removeTile(B)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,u){var f;const p={},_={},D=Math.max(u-In.maxOverzooming,this._source.minzoom),S=Math.max(u+In.maxUnderzooming,this._source.minzoom),A={};for(const R of o){const B=this._addTile(R);p[R.key]=R,B.hasData()||u<this._source.maxzoom&&(A[R.key]=R)}this._retainLoadedChildren(A,u,S,p);for(const R of o){let B=this._tiles[R.key];if(B.hasData())continue;if(u+1>this._source.maxzoom){const W=R.children(this._source.maxzoom)[0],Q=this.getTile(W);if(Q&&Q.hasData()){p[W.key]=W;continue}}else{const W=R.children(this._source.maxzoom);if(p[W[0].key]&&p[W[1].key]&&p[W[2].key]&&p[W[3].key])continue}let L=B.wasRequested();for(let W=R.overscaledZ-1;W>=D;--W){const Q=R.scaledTo(W);if(_[Q.key])break;if(_[Q.key]=!0,B=this.getTile(Q),!B&&L&&(B=this._addTile(Q)),B){const ne=B.hasData();if((ne||!(null!==(f=this.map)&&void 0!==f&&f.cancelPendingTileRequestsWhileZooming)||L)&&(p[Q.key]=Q),L=B.wasRequested(),ne)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const u=[];let f,p=this._tiles[o].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){f=this._loadedParentTiles[p.key];break}u.push(p.key);const _=p.scaledTo(p.overscaledZ-1);if(f=this._getLoadedTile(_),f)break;p=_}for(const _ of u)this._loadedParentTiles[_]=f}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const o in this._tiles){const u=this._tiles[o].tileID,f=this._getLoadedTile(u);this._loadedSiblingTiles[u.key]=f}}_addTile(o){let u=this._tiles[o.key];if(u)return u;u=this._cache.getAndRemove(o),u&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));const f=u;return u||(u=new Hi(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(u,o.key,u.state)),u.uses++,this._tiles[o.key]=u,f||this._source.fire(new x.k("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(o,u){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const f=u.getExpiryTimeout();f&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},f))}_removeTile(o){const u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&"reloading"!==u.state?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(o){const u=o.sourceDataType;"source"===o.dataType&&"metadata"===u&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===o.dataType&&"content"===u&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,u,f){const p=[],_=this.transform;if(!_)return p;const D=f?_.getCameraQueryGeometry(o):o,S=o.map(ne=>_.pointCoordinate(ne,this.terrain)),A=D.map(ne=>_.pointCoordinate(ne,this.terrain)),R=this.getIds();let B=1/0,L=1/0,W=-1/0,Q=-1/0;for(const ne of A)B=Math.min(B,ne.x),L=Math.min(L,ne.y),W=Math.max(W,ne.x),Q=Math.max(Q,ne.y);for(let ne=0;ne<R.length;ne++){const de=this._tiles[R[ne]];if(de.holdingForFade())continue;const se=de.tileID,he=Math.pow(2,_.zoom-de.tileID.overscaledZ),Ee=u*de.queryPadding*x.X/de.tileSize/he,oe=[se.getTilePoint(new x.Z(B,L)),se.getTilePoint(new x.Z(W,Q))];if(oe[0].x-Ee<x.X&&oe[0].y-Ee<x.X&&oe[1].x+Ee>=0&&oe[1].y+Ee>=0){const Me=S.map(Be=>se.getTilePoint(Be)),Oe=A.map(Be=>se.getTilePoint(Be));p.push({tile:de,tileID:se,queryGeometry:Me,cameraQueryGeometry:Oe,scale:he})}}return p}getVisibleCoordinates(o){const u=this.getRenderableIds(o).map(f=>this._tiles[f].tileID);for(const f of u)f.posMatrix=this.transform.calculatePosMatrix(f.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(uo(this._source.type)){const o=Ae.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=o)return!0}return!1}setFeatureState(o,u,f){this._state.updateState(o=o||"_geojsonTileLayer",u,f)}removeFeatureState(o,u,f){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,f)}getFeatureState(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)}setDependencies(o,u,f){const p=this._tiles[o];p&&p.setDependencies(u,f)}reloadTilesForDependencies(o,u){for(const f in this._tiles)this._tiles[f].hasDependency(o,u)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(o,u))}}function Ur(v,o){const u=Math.abs(2*v.wrap)-+(v.wrap<0),f=Math.abs(2*o.wrap)-+(o.wrap<0);return v.overscaledZ-o.overscaledZ||f-u||o.canonical.y-v.canonical.y||o.canonical.x-v.canonical.x}function uo(v){return"raster"===v||"image"===v||"video"===v}In.maxOverzooming=10,In.maxUnderzooming=3;class Nn{constructor(o,u){this.reset(o,u)}reset(o,u){this.points=o||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(1===this.points.length)return this.points[0];o=x.ac(o,0,1);let u=1,f=this._distances[u];const p=o*this.paddedLength+this.padding;for(;f<p&&u<this._distances.length;)f=this._distances[++u];const _=u-1,D=this._distances[_],S=f-D,A=S>0?(p-D)/S:0;return this.points[_].mult(1-A).add(this.points[u].mult(A))}}function mo(v,o){let u=!0;return"always"===v||"never"!==v&&"never"!==o||(u=!1),u}class go{constructor(o,u,f){const p=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(o/f),this.yCellCount=Math.ceil(u/f);for(let D=0;D<this.xCellCount*this.yCellCount;D++)p.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=u,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,u,f,p,_){this._forEachCell(u,f,p,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(p),this.bboxes.push(_)}insertCircle(o,u,f,p){this._forEachCell(u-p,f-p,u+p,f+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(u),this.circles.push(f),this.circles.push(p)}_insertBoxCell(o,u,f,p,_,D){this.boxCells[_].push(D)}_insertCircleCell(o,u,f,p,_,D){this.circleCells[_].push(D)}_query(o,u,f,p,_,D,S){if(f<0||o>this.width||p<0||u>this.height)return[];const A=[];if(o<=0&&u<=0&&this.width<=f&&this.height<=p){if(_)return[{key:null,x1:o,y1:u,x2:f,y2:p}];for(let R=0;R<this.boxKeys.length;R++)A.push({key:this.boxKeys[R],x1:this.bboxes[4*R],y1:this.bboxes[4*R+1],x2:this.bboxes[4*R+2],y2:this.bboxes[4*R+3]});for(let R=0;R<this.circleKeys.length;R++){const B=this.circles[3*R],L=this.circles[3*R+1],W=this.circles[3*R+2];A.push({key:this.circleKeys[R],x1:B-W,y1:L-W,x2:B+W,y2:L+W})}}else this._forEachCell(o,u,f,p,this._queryCell,A,{hitTest:_,overlapMode:D,seenUids:{box:{},circle:{}}},S);return A}query(o,u,f,p){return this._query(o,u,f,p,!1,null)}hitTest(o,u,f,p,_,D){return this._query(o,u,f,p,!0,_,D).length>0}hitTestCircle(o,u,f,p,_){const D=o-f,S=o+f,A=u-f,R=u+f;if(S<0||D>this.width||R<0||A>this.height)return!1;const B=[];return this._forEachCell(D,A,S,R,this._queryCellCircle,B,{hitTest:!0,overlapMode:p,circle:{x:o,y:u,radius:f},seenUids:{box:{},circle:{}}},_),B.length>0}_queryCell(o,u,f,p,_,D,S,A){const{seenUids:R,hitTest:B,overlapMode:L}=S,W=this.boxCells[_];if(null!==W){const ne=this.bboxes;for(const de of W)if(!R.box[de]){R.box[de]=!0;const se=4*de,he=this.boxKeys[de];if(o<=ne[se+2]&&u<=ne[se+3]&&f>=ne[se+0]&&p>=ne[se+1]&&(!A||A(he))&&(!B||!mo(L,he.overlapMode))&&(D.push({key:he,x1:ne[se],y1:ne[se+1],x2:ne[se+2],y2:ne[se+3]}),B))return!0}}const Q=this.circleCells[_];if(null!==Q){const ne=this.circles;for(const de of Q)if(!R.circle[de]){R.circle[de]=!0;const se=3*de,he=this.circleKeys[de];if(this._circleAndRectCollide(ne[se],ne[se+1],ne[se+2],o,u,f,p)&&(!A||A(he))&&(!B||!mo(L,he.overlapMode))){const Ee=ne[se],oe=ne[se+1],Me=ne[se+2];if(D.push({key:he,x1:Ee-Me,y1:oe-Me,x2:Ee+Me,y2:oe+Me}),B)return!0}}}return!1}_queryCellCircle(o,u,f,p,_,D,S,A){const{circle:R,seenUids:B,overlapMode:L}=S,W=this.boxCells[_];if(null!==W){const ne=this.bboxes;for(const de of W)if(!B.box[de]){B.box[de]=!0;const se=4*de,he=this.boxKeys[de];if(this._circleAndRectCollide(R.x,R.y,R.radius,ne[se+0],ne[se+1],ne[se+2],ne[se+3])&&(!A||A(he))&&!mo(L,he.overlapMode))return D.push(!0),!0}}const Q=this.circleCells[_];if(null!==Q){const ne=this.circles;for(const de of Q)if(!B.circle[de]){B.circle[de]=!0;const se=3*de,he=this.circleKeys[de];if(this._circlesCollide(ne[se],ne[se+1],ne[se+2],R.x,R.y,R.radius)&&(!A||A(he))&&!mo(L,he.overlapMode))return D.push(!0),!0}}}_forEachCell(o,u,f,p,_,D,S,A){const R=this._convertToXCellCoord(o),B=this._convertToYCellCoord(u),L=this._convertToXCellCoord(f),W=this._convertToYCellCoord(p);for(let Q=R;Q<=L;Q++)for(let ne=B;ne<=W;ne++)if(_.call(this,o,u,f,p,this.xCellCount*ne+Q,D,S,A))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,u,f,p,_,D){const S=p-o,A=_-u,R=f+D;return R*R>S*S+A*A}_circleAndRectCollide(o,u,f,p,_,D,S){const A=(D-p)/2,R=Math.abs(o-(p+A));if(R>A+f)return!1;const B=(S-_)/2,L=Math.abs(u-(_+B));if(L>B+f)return!1;if(R<=A||L<=B)return!0;const W=R-A,Q=L-B;return W*W+Q*Q<=f*f}}function Zr(v,o,u,f,p){const _=x.H();return o?(x.K(_,_,[1/p,1/p,1]),u||x.ad(_,_,f.angle)):x.L(_,f.labelPlaneMatrix,v),_}function io(v,o,u,f,p){if(o){const _=x.ae(v);return x.K(_,_,[p,p,1]),u||x.ad(_,_,-f.angle),_}return f.glCoordMatrix}function ue(v,o,u){let f;u?(f=[v.x,v.y,u(v.x,v.y),1],x.af(f,f,o)):(f=[v.x,v.y,0,1],function(_,D,S){const A=D[0],R=D[1];_[0]=S[0]*A+S[4]*R+S[12],_[1]=S[1]*A+S[5]*R+S[13],_[3]=S[3]*A+S[7]*R+S[15]}(f,f,o));const p=f[3];return{point:new x.P(f[0]/p,f[1]/p),signedDistanceFromCamera:p,isOccluded:!1}}function U(v,o){return.5+v/o*.5}function H(v,o){return v.x>=-o[0]&&v.x<=o[0]&&v.y>=-o[1]&&v.y<=o[1]}function J(v,o,u,f,p,_,D,S,A,R,B,L,W,Q,ne){const de=f?v.textSizeData:v.iconSizeData,se=x.ag(de,u.transform.zoom),he=[256/u.width*2+1,256/u.height*2+1],Ee=f?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;Ee.clear();const oe=v.lineVertexArray,Me=f?v.text.placedSymbolArray:v.icon.placedSymbolArray,Oe=u.transform.width/u.transform.height;let Be=!1;for(let ft=0;ft<Me.length;ft++){const Tt=Me.get(ft);if(Tt.hidden||Tt.writingMode===x.ah.vertical&&!Be){tn(Tt.numGlyphs,Ee);continue}Be=!1;const cn=ue(new x.P(Tt.anchorX,Tt.anchorY),o,ne);if(!H(cn.point,he)){tn(Tt.numGlyphs,Ee);continue}const sn=U(u.transform.cameraToCenterDistance,cn.signedDistanceFromCamera),At=x.ai(de,se,Tt),zt=D?At/sn:At*sn,Cn={getElevation:ne,labelPlaneMatrix:p,lineVertexArray:oe,pitchWithMap:D,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:R,tileAnchorPoint:new x.P(Tt.anchorX,Tt.anchorY),unwrappedTileID:B,width:L,height:W,translation:Q},Jn=Te(Cn,Tt,zt,!1,S,o,_,v.glyphOffsetArray,Ee,Oe,A);Be=Jn.useVertical,(Jn.notEnoughRoom||Be||Jn.needsFlipping&&Te(Cn,Tt,zt,!0,S,o,_,v.glyphOffsetArray,Ee,Oe,A).notEnoughRoom)&&tn(Tt.numGlyphs,Ee)}f?v.text.dynamicLayoutVertexBuffer.updateData(Ee):v.icon.dynamicLayoutVertexBuffer.updateData(Ee)}function re(v,o,u,f,p,_,D,S){const A=_.glyphStartIndex+_.numGlyphs,R=_.lineStartIndex,B=_.lineStartIndex+_.lineLength,L=o.getoffsetX(_.glyphStartIndex),W=o.getoffsetX(A-1),Q=wt(v*L,u,f,p,_.segment,R,B,S,D);if(!Q)return null;const ne=wt(v*W,u,f,p,_.segment,R,B,S,D);return ne?S.projectionCache.anyProjectionOccluded?null:{first:Q,last:ne}:null}function Ce(v,o,u,f){return v===x.ah.horizontal&&Math.abs(u.y-o.y)>Math.abs(u.x-o.x)*f?{useVertical:!0}:(v===x.ah.vertical?o.y<u.y:o.x>u.x)?{needsFlipping:!0}:null}function Te(v,o,u,f,p,_,D,S,A,R,B){const L=u/24,W=o.lineOffsetX*L,Q=o.lineOffsetY*L;let ne;if(o.numGlyphs>1){const de=o.glyphStartIndex+o.numGlyphs,se=o.lineStartIndex,he=o.lineStartIndex+o.lineLength,Ee=re(L,S,W,Q,f,o,B,v);if(!Ee)return{notEnoughRoom:!0};const oe=ue(Ee.first.point,D,v.getElevation).point,Me=ue(Ee.last.point,D,v.getElevation).point;if(p&&!f){const Oe=Ce(o.writingMode,oe,Me,R);if(Oe)return Oe}ne=[Ee.first];for(let Oe=o.glyphStartIndex+1;Oe<de-1;Oe++)ne.push(wt(L*S.getoffsetX(Oe),W,Q,f,o.segment,se,he,v,B));ne.push(Ee.last)}else{if(p&&!f){const se=ue(v.tileAnchorPoint,_,v.getElevation).point,he=o.lineStartIndex+o.segment+1,Ee=new x.P(v.lineVertexArray.getx(he),v.lineVertexArray.gety(he)),oe=ue(Ee,_,v.getElevation),Me=oe.signedDistanceFromCamera>0?oe.point:ke(v.tileAnchorPoint,Ee,se,1,_,v),Oe=Ce(o.writingMode,se,Me,R);if(Oe)return Oe}const de=wt(L*S.getoffsetX(o.glyphStartIndex),W,Q,f,o.segment,o.lineStartIndex,o.lineStartIndex+o.lineLength,v,B);if(!de||v.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ne=[de]}for(const de of ne)x.aj(A,de.point,de.angle);return{}}function ke(v,o,u,f,p,_){const D=v.add(v.sub(o)._unit()),S=void 0!==p?ue(D,p,_.getElevation).point:$e(D.x,D.y,_).point,A=u.sub(S);return u.add(A._mult(f/A.mag()))}function ce(v,o,u){const f=o.projectionCache;if(f.projections[v])return f.projections[v];const p=new x.P(o.lineVertexArray.getx(v),o.lineVertexArray.gety(v)),_=$e(p.x,p.y,o);if(_.signedDistanceFromCamera>0)return f.projections[v]=_.point,f.anyProjectionOccluded=f.anyProjectionOccluded||_.isOccluded,_.point;const D=v-u.direction;return ke(0===u.distanceFromAnchor?o.tileAnchorPoint:new x.P(o.lineVertexArray.getx(D),o.lineVertexArray.gety(D)),p,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,void 0,o)}function $e(v,o,u){const f=v+u.translation[0],p=o+u.translation[1];let _;return!u.pitchWithMap&&u.projection.useSpecialProjectionForSymbols?(_=u.projection.projectTileCoordinates(f,p,u.unwrappedTileID,u.getElevation),_.point.x=(.5*_.point.x+.5)*u.width,_.point.y=(.5*-_.point.y+.5)*u.height):(_=ue(new x.P(f,p),u.labelPlaneMatrix,u.getElevation),_.isOccluded=!1),_}function rt(v,o,u){return v._unit()._perp()._mult(o*u)}function Le(v,o,u,f,p,_,D,S,A){if(S.projectionCache.offsets[v])return S.projectionCache.offsets[v];const R=u.add(o);if(v+A.direction<f||v+A.direction>=p)return S.projectionCache.offsets[v]=R,R;const B=ce(v+A.direction,S,A),L=rt(B.sub(u),D,A.direction),W=u.add(L),Q=B.add(L);return S.projectionCache.offsets[v]=x.ak(_,R,W,Q)||R,S.projectionCache.offsets[v]}function wt(v,o,u,f,p,_,D,S,A){const R=f?v-o:v+o;let B=R>0?1:-1,L=0;f&&(B*=-1,L=Math.PI),B<0&&(L+=Math.PI);let W,Q=B>0?_+p:_+p+1;S.projectionCache.cachedAnchorPoint?W=S.projectionCache.cachedAnchorPoint:(W=$e(S.tileAnchorPoint.x,S.tileAnchorPoint.y,S).point,S.projectionCache.cachedAnchorPoint=W);let ne,de,se=W,he=W,Ee=0,oe=0;const Me=Math.abs(R),Oe=[];let Be;for(;Ee+oe<=Me;){if(Q+=B,Q<_||Q>=D)return null;Ee+=oe,he=se,de=ne;const cn={absOffsetX:Me,direction:B,distanceFromAnchor:Ee,previousVertex:he};if(se=ce(Q,S,cn),0===u)Oe.push(he),Be=se.sub(he);else{let sn;const At=se.sub(he);sn=0===At.mag()?rt(ce(Q+B,S,cn).sub(se),u,B):rt(At,u,B),de||(de=he.add(sn)),ne=Le(Q,sn,se,_,D,de,u,S,cn),Oe.push(de),Be=ne.sub(de)}oe=Be.mag()}const ft=Be._mult((Me-Ee)/oe)._add(de||he),Tt=L+Math.atan2(se.y-he.y,se.x-he.x);return Oe.push(ft),{point:ft,angle:A?Tt:0,path:Oe}}const Ut=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function tn(v,o){for(let u=0;u<v;u++){const f=o.length;o.resize(f+4),o.float32.set(Ut,3*f)}}const kn=100;class oi{constructor(o,u,f=new go(o.width+200,o.height+200,25),p=new go(o.width+200,o.height+200,25)){this.transform=o,this.mapProjection=u,this.grid=f,this.ignoredGrid=p,this.pitchFactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+kn,this.screenBottomBoundary=o.height+kn,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,u,f,p,_,D,S,A,R,B,L){const W=o.anchorPointX+A[0],Q=o.anchorPointY+A[1],ne=this.projectAndGetPerspectiveRatio(p,W,Q,_,B),de=this._projectCollisionBox(o,f,p,_,D,S,A,ne,B,L),[se,he,Ee,oe]=de.box;return this.mapProjection.useSpecialProjectionForSymbols&&(D?de.allPointsOccluded:this.mapProjection.isOccluded(W,Q,_))||ne.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(se,he,Ee,oe)||"always"!==u&&this.grid.hitTest(se,he,Ee,oe,u,R)?{box:[se,he,Ee,oe],placeable:!1,offscreen:!1}:{box:[se,he,Ee,oe],placeable:!0,offscreen:this.isOffscreen(se,he,Ee,oe)}}placeCollisionCircles(o,u,f,p,_,D,S,A,R,B,L,W,Q,ne,de,se){const he=[],Ee=new x.P(u.anchorX,u.anchorY),oe=this.getPerspectiveRatio(D,Ee.x,Ee.y,S,se),Me=(L?_/oe:_*oe)/x.ap,Oe={getElevation:se,labelPlaneMatrix:A,lineVertexArray:f,pitchWithMap:L,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:Ee,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:de},Be=re(Me,p,u.lineOffsetX*Me,u.lineOffsetY*Me,!1,u,!1,Oe);let ft=!1,Tt=!1,cn=!0;if(Be){const sn=.5*Q*oe+ne,At=new x.P(-100,-100),zt=new x.P(this.screenRightBoundary,this.screenBottomBoundary),Cn=new Nn,Jn=Be.first,Vt=Be.last;let Xt=[];for(let yi=Jn.path.length-1;yi>=1;yi--)Xt.push(Jn.path[yi]);for(let yi=1;yi<Vt.path.length;yi++)Xt.push(Vt.path[yi]);const zn=2.5*sn;if(R){const yi=this.projectPathToScreenSpace(Xt,Oe,R);Xt=yi.some(Ai=>Ai.signedDistanceFromCamera<=0)?[]:yi.map(Ai=>Ai.point)}let pr=[];if(Xt.length>0){const yi=Xt[0].clone(),Ai=Xt[0].clone();for(let Lr=1;Lr<Xt.length;Lr++)yi.x=Math.min(yi.x,Xt[Lr].x),yi.y=Math.min(yi.y,Xt[Lr].y),Ai.x=Math.max(Ai.x,Xt[Lr].x),Ai.y=Math.max(Ai.y,Xt[Lr].y);pr=yi.x>=At.x&&Ai.x<=zt.x&&yi.y>=At.y&&Ai.y<=zt.y?[Xt]:Ai.x<At.x||yi.x>zt.x||Ai.y<At.y||yi.y>zt.y?[]:x.al([Xt],At.x,At.y,zt.x,zt.y)}for(const yi of pr){Cn.reset(yi,.25*sn);let Ai=0;Ai=Cn.length<=.5*sn?1:Math.ceil(Cn.paddedLength/zn)+1;for(let Lr=0;Lr<Ai;Lr++){const Vo=Lr/Math.max(Ai-1,1),ha=Cn.lerp(Vo),Ar=ha.x+kn,is=ha.y+kn;he.push(Ar,is,sn,0);const Ro=Ar-sn,jo=is-sn,To=Ar+sn,ys=is+sn;if(cn=cn&&this.isOffscreen(Ro,jo,To,ys),Tt=Tt||this.isInsideGrid(Ro,jo,To,ys),"always"!==o&&this.grid.hitTestCircle(Ar,is,sn,o,W)&&(ft=!0,!B))return{circles:[],offscreen:!1,collisionDetected:ft}}}}return{circles:!B&&ft||!Tt||oe<this.perspectiveRatioCutoff?[]:he,offscreen:cn,collisionDetected:ft}}projectPathToScreenSpace(o,u,f){return o.map(p=>ue(p,f,u.getElevation))}queryRenderedSymbols(o){if(0===o.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const u=[];let f=1/0,p=1/0,_=-1/0,D=-1/0;for(const B of o){const L=new x.P(B.x+kn,B.y+kn);f=Math.min(f,L.x),p=Math.min(p,L.y),_=Math.max(_,L.x),D=Math.max(D,L.y),u.push(L)}const S=this.grid.query(f,p,_,D).concat(this.ignoredGrid.query(f,p,_,D)),A={},R={};for(const B of S){const L=B.key;if(void 0===A[L.bucketInstanceId]&&(A[L.bucketInstanceId]={}),A[L.bucketInstanceId][L.featureIndex])continue;const W=[new x.P(B.x1,B.y1),new x.P(B.x2,B.y1),new x.P(B.x2,B.y2),new x.P(B.x1,B.y2)];x.am(u,W)&&(A[L.bucketInstanceId][L.featureIndex]=!0,void 0===R[L.bucketInstanceId]&&(R[L.bucketInstanceId]=[]),R[L.bucketInstanceId].push(L.featureIndex))}return R}insertCollisionBox(o,u,f,p,_,D){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:_,collisionGroupID:D,overlapMode:u},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,u,f,p,_,D){const S=f?this.ignoredGrid:this.grid,A={bucketInstanceId:p,featureIndex:_,collisionGroupID:D,overlapMode:u};for(let R=0;R<o.length;R+=4)S.insertCircle(A,o[R],o[R+1],o[R+2])}projectAndGetPerspectiveRatio(o,u,f,p,_){const D=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(u,f,p,_):ue(new x.P(u,f),o,_);return{point:new x.P((D.point.x+1)/2*this.transform.width+kn,(1-D.point.y)/2*this.transform.height+kn),perspectiveRatio:.5+this.transform.cameraToCenterDistance/D.signedDistanceFromCamera*.5,isOccluded:D.isOccluded,signedDistanceFromCamera:D.signedDistanceFromCamera}}getPerspectiveRatio(o,u,f,p,_){const D=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(u,f,p,_):ue(new x.P(u,f),o,_);return.5+this.transform.cameraToCenterDistance/D.signedDistanceFromCamera*.5}isOffscreen(o,u,f,p){return f<kn||o>=this.screenRightBoundary||p<kn||u>this.screenBottomBoundary}isInsideGrid(o,u,f,p){return f>=0&&o<this.gridRightBoundary&&p>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const o=x.an([]);return x.J(o,o,[-100,-100,0]),o}_projectCollisionBox(o,u,f,p,_,D,S,A,R,B){const L=u*A.perspectiveRatio;let W=new x.P(1,0),Q=new x.P(0,1);const ne=new x.P(o.anchorPointX+S[0],o.anchorPointY+S[1]);if(D&&!_){const sn=this.projectAndGetPerspectiveRatio(f,ne.x+1,ne.y,p,R).point.sub(A.point).unit(),At=Math.atan(sn.y/sn.x)+(sn.x<0?Math.PI:0),zt=Math.sin(At),Cn=Math.cos(At);W=new x.P(Cn,zt),Q=new x.P(-zt,Cn)}else if(!D&&_){const sn=-this.transform.angle,At=Math.sin(sn),zt=Math.cos(sn);W=new x.P(zt,At),Q=new x.P(-At,zt)}let de=A.point,se=L;if(_){de=ne;const sn=this.transform.zoom-Math.floor(this.transform.zoom);se=Math.pow(2,-sn),se*=this.mapProjection.getPitchedTextCorrection(this.transform,ne,p),B||(se*=x.ac(.5+A.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}B&&(de=de.add(W.mult(B.x*se)).add(Q.mult(B.y*se)));const he=o.x1*se,Ee=o.x2*se,oe=(he+Ee)/2,Me=o.y1*se,Oe=o.y2*se,Be=(Me+Oe)/2,ft=[{offsetX:he,offsetY:Me},{offsetX:oe,offsetY:Me},{offsetX:Ee,offsetY:Me},{offsetX:Ee,offsetY:Be},{offsetX:Ee,offsetY:Oe},{offsetX:oe,offsetY:Oe},{offsetX:he,offsetY:Oe},{offsetX:he,offsetY:Be}];let Tt=[];for(const{offsetX:sn,offsetY:At}of ft)Tt.push(new x.P(de.x+W.x*sn+Q.x*At,de.y+W.y*sn+Q.y*At));let cn=!1;if(_){const sn=Tt.map(At=>this.projectAndGetPerspectiveRatio(f,At.x,At.y,p,R));cn=sn.some(At=>!At.isOccluded),Tt=sn.map(At=>At.point)}else cn=!0;return{box:x.ao(Tt),allPointsOccluded:!cn}}}function Dn(v,o,u){return o*(x.X/(v.tileSize*Math.pow(2,u-v.tileID.overscaledZ)))}class xi{constructor(o,u,f,p){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?u:-u))):p&&f?1:0,this.placed=f}isHidden(){return 0===this.opacity&&!this.placed}}class pi{constructor(o,u,f,p,_){this.text=new xi(o?o.text:null,u,f,_),this.icon=new xi(o?o.icon:null,u,p,_)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class bi{constructor(o,u,f){this.text=o,this.icon=u,this.skipFade=f}}class ei{constructor(){this.invProjMatrix=x.H(),this.viewportMatrix=x.H(),this.circles=[]}}class si{constructor(o,u,f,p,_){this.bucketInstanceId=o,this.featureIndex=u,this.sourceLayerIndex=f,this.bucketIndex=p,this.tileID=_}}class qi{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const u=++this.maxGroupID;this.collisionGroups[o]={ID:u,predicate:f=>f.collisionGroupID===u}}return this.collisionGroups[o]}}function mi(v,o,u,f,p){const{horizontalAlign:_,verticalAlign:D}=x.au(v);return new x.P(-(_-.5)*o+f[0]*p,-(D-.5)*u+f[1]*p)}class _r{constructor(o,u,f,p,_,D){this.transform=o.clone(),this.terrain=f,this.collisionIndex=new oi(this.transform,u),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new qi(_),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=D,D&&(D.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(o){const u=this.terrain;return u?(f,p)=>u.getElevation(o,f,p):null}getBucketParts(o,u,f,p){const _=f.getBucket(u),D=f.latestFeatureIndex;if(!_||!D||u.id!==_.layerIds[0])return;const S=f.collisionBoxArray,A=_.layers[0].layout,R=_.layers[0].paint,B=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),L=f.tileSize/x.X,W=f.tileID.toUnwrapped(),Q=this.transform.calculatePosMatrix(W),ne="map"===A.get("text-pitch-alignment"),de="map"===A.get("text-rotation-alignment"),se=Dn(f,1,this.transform.zoom),he=this.collisionIndex.mapProjection.translatePosition(this.transform,f,R.get("text-translate"),R.get("text-translate-anchor")),Ee=this.collisionIndex.mapProjection.translatePosition(this.transform,f,R.get("icon-translate"),R.get("icon-translate-anchor")),oe=Zr(Q,ne,de,this.transform,se);let Me=null;if(ne){const Be=io(Q,ne,de,this.transform,se);Me=x.L([],this.transform.labelPlaneMatrix,Be)}this.retainedQueryData[_.bucketInstanceId]=new si(_.bucketInstanceId,D,_.sourceLayerIndex,_.index,f.tileID);const Oe={bucket:_,layout:A,translationText:he,translationIcon:Ee,posMatrix:Q,unwrappedTileID:W,textLabelPlaneMatrix:oe,labelToScreenMatrix:Me,scale:B,textPixelRatio:L,holdingForFade:f.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:x.ag(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(p)for(const Be of _.sortKeyRanges){const{sortKey:ft,symbolInstanceStart:Tt,symbolInstanceEnd:cn}=Be;o.push({sortKey:ft,symbolInstanceStart:Tt,symbolInstanceEnd:cn,parameters:Oe})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:Oe})}attemptAnchorPlacement(o,u,f,p,_,D,S,A,R,B,L,W,Q,ne,de,se,he,Ee,oe){const Me=x.aq[o.textAnchor],Oe=[o.textOffset0,o.textOffset1],Be=mi(Me,f,p,Oe,_),ft=this.collisionIndex.placeCollisionBox(u,W,A,R,B,S,D,se,L.predicate,oe,Be);if((!Ee||this.collisionIndex.placeCollisionBox(Ee,W,A,R,B,S,D,he,L.predicate,oe,Be).placeable)&&ft.placeable){let Tt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Q.crossTileID]&&this.prevPlacement.placements[Q.crossTileID]&&this.prevPlacement.placements[Q.crossTileID].text&&(Tt=this.prevPlacement.variableOffsets[Q.crossTileID].anchor),0===Q.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Q.crossTileID]={textOffset:Oe,width:f,height:p,anchor:Me,textBoxScale:_,prevAnchor:Tt},this.markUsedJustification(ne,Me,Q,de),ne.allowVerticalPlacement&&(this.markUsedOrientation(ne,de,Q),this.placedOrientations[Q.crossTileID]=de),{shift:Be,placedGlyphBoxes:ft}}}placeLayerBucketPart(o,u,f){const{bucket:p,layout:_,translationText:D,translationIcon:S,posMatrix:A,unwrappedTileID:R,textLabelPlaneMatrix:B,labelToScreenMatrix:L,textPixelRatio:W,holdingForFade:Q,collisionBoxArray:ne,partiallyEvaluatedTextSize:de,collisionGroup:se}=o.parameters,he=_.get("text-optional"),Ee=_.get("icon-optional"),oe=x.ar(_,"text-overlap","text-allow-overlap"),Me="always"===oe,Oe=x.ar(_,"icon-overlap","icon-allow-overlap"),Be="always"===Oe,ft="map"===_.get("text-rotation-alignment"),Tt="map"===_.get("text-pitch-alignment"),cn="none"!==_.get("icon-text-fit"),sn="viewport-y"===_.get("symbol-z-order"),At=Me&&(Be||!p.hasIconData()||Ee),zt=Be&&(Me||!p.hasTextData()||he);!p.collisionArrays&&ne&&p.deserializeCollisionBoxes(ne);const Cn=this._getTerrainElevationFunc(this.retainedQueryData[p.bucketInstanceId].tileID),Jn=(Vt,Xt,zn)=>{var pr,yi;if(u[Vt.crossTileID])return;if(Q)return void(this.placements[Vt.crossTileID]=new bi(!1,!1,!1));let Ai=!1,Lr=!1,Vo=!0,ha=null,Ar={box:null,placeable:!1,offscreen:null},is={box:null,placeable:!1,offscreen:null},Ro=null,jo=null,To=null,ys=0,jc=0,gu=0;Xt.textFeatureIndex?ys=Xt.textFeatureIndex:Vt.useRuntimeCollisionCircles&&(ys=Vt.featureIndex),Xt.verticalTextFeatureIndex&&(jc=Xt.verticalTextFeatureIndex);const xl=Xt.textBox;if(xl){const Gs=rs=>{let os=x.ah.horizontal;if(p.allowVerticalPlacement&&!rs&&this.prevPlacement){const Ls=this.prevPlacement.placedOrientations[Vt.crossTileID];Ls&&(this.placedOrientations[Vt.crossTileID]=Ls,os=Ls,this.markUsedOrientation(p,os,Vt))}return os},Ws=(rs,os)=>{if(p.allowVerticalPlacement&&Vt.numVerticalGlyphVertices>0&&Xt.verticalTextBox){for(const Ls of p.writingModes)if(Ls===x.ah.vertical?(Ar=os(),is=Ar):Ar=rs(),Ar&&Ar.placeable)break}else Ar=rs()},Cl=Vt.textAnchorOffsetStartIndex,Zs=Vt.textAnchorOffsetEndIndex;if(Zs===Cl){const rs=(os,Ls)=>{const Bi=this.collisionIndex.placeCollisionBox(os,oe,W,A,R,Tt,ft,D,se.predicate,Cn);return Bi&&Bi.placeable&&(this.markUsedOrientation(p,Ls,Vt),this.placedOrientations[Vt.crossTileID]=Ls),Bi};Ws(()=>rs(xl,x.ah.horizontal),()=>{const os=Xt.verticalTextBox;return p.allowVerticalPlacement&&Vt.numVerticalGlyphVertices>0&&os?rs(os,x.ah.vertical):{box:null,offscreen:null}}),Gs(Ar&&Ar.placeable)}else{let rs=x.aq[null===(yi=null===(pr=this.prevPlacement)||void 0===pr?void 0:pr.variableOffsets[Vt.crossTileID])||void 0===yi?void 0:yi.anchor];const os=(Bi,nc,Dl)=>{const yu=Bi.x2-Bi.x1,Wh=Bi.y2-Bi.y1,Zh=Vt.textBoxScale,Oo=cn&&"never"===Oe?nc:null;let Aa=null,vu="never"===oe?1:2,vs="never";rs&&vu++;for(let od=0;od<vu;od++){for(let sd=Cl;sd<Zs;sd++){const mr=p.textAnchorOffsets.get(sd);if(rs&&mr.textAnchor!==rs)continue;const Uc=this.attemptAnchorPlacement(mr,Bi,yu,Wh,Zh,ft,Tt,W,A,R,se,vs,Vt,p,Dl,D,S,Oo,Cn);if(Uc&&(Aa=Uc.placedGlyphBoxes,Aa&&Aa.placeable))return Ai=!0,ha=Uc.shift,Aa}rs?rs=null:vs=oe}return f&&!Aa&&(Aa={box:this.collisionIndex.placeCollisionBox(xl,"always",W,A,R,Tt,ft,D,se.predicate,Cn,new x.P(0,0)).box,offscreen:!1,placeable:!1}),Aa};Ws(()=>os(xl,Xt.iconBox,x.ah.horizontal),()=>{const Bi=Xt.verticalTextBox;return p.allowVerticalPlacement&&(!Ar||!Ar.placeable)&&Vt.numVerticalGlyphVertices>0&&Bi?os(Bi,Xt.verticalIconBox,x.ah.vertical):{box:null,occluded:!0,offscreen:null}}),Ar&&(Ai=Ar.placeable,Vo=Ar.offscreen);const Ls=Gs(Ar&&Ar.placeable);if(!Ai&&this.prevPlacement){const Bi=this.prevPlacement.variableOffsets[Vt.crossTileID];Bi&&(this.variableOffsets[Vt.crossTileID]=Bi,this.markUsedJustification(p,Bi.anchor,Vt,Ls))}}}if(Ro=Ar,Ai=Ro&&Ro.placeable,Vo=Ro&&Ro.offscreen,Vt.useRuntimeCollisionCircles){const Gs=p.text.placedSymbolArray.get(Vt.centerJustifiedTextSymbolIndex),Ws=x.ai(p.textSizeData,de,Gs),Cl=_.get("text-padding");jo=this.collisionIndex.placeCollisionCircles(oe,Gs,p.lineVertexArray,p.glyphOffsetArray,Ws,A,R,B,L,f,Tt,se.predicate,Vt.collisionCircleDiameter,Cl,D,Cn),jo.circles.length&&jo.collisionDetected&&!f&&x.w("Collisions detected, but collision boxes are not shown"),Ai=Me||jo.circles.length>0&&!jo.collisionDetected,Vo=Vo&&jo.offscreen}if(Xt.iconFeatureIndex&&(gu=Xt.iconFeatureIndex),Xt.iconBox){const Gs=Ws=>this.collisionIndex.placeCollisionBox(Ws,Oe,W,A,R,Tt,ft,S,se.predicate,Cn,cn&&ha?ha:void 0);is&&is.placeable&&Xt.verticalIconBox?(To=Gs(Xt.verticalIconBox),Lr=To.placeable):(To=Gs(Xt.iconBox),Lr=To.placeable),Vo=Vo&&To.offscreen}const Za=he||0===Vt.numHorizontalGlyphVertices&&0===Vt.numVerticalGlyphVertices,rd=Ee||0===Vt.numIconVertices;Za||rd?rd?Za||(Lr=Lr&&Ai):Ai=Lr&&Ai:Lr=Ai=Lr&&Ai;const Yd=Lr&&To.placeable;if(Ai&&Ro.placeable&&this.collisionIndex.insertCollisionBox(Ro.box,oe,_.get("text-ignore-placement"),p.bucketInstanceId,is&&is.placeable&&jc?jc:ys,se.ID),Yd&&this.collisionIndex.insertCollisionBox(To.box,Oe,_.get("icon-ignore-placement"),p.bucketInstanceId,gu,se.ID),jo&&Ai&&this.collisionIndex.insertCollisionCircles(jo.circles,oe,_.get("text-ignore-placement"),p.bucketInstanceId,ys,se.ID),f&&this.storeCollisionData(p.bucketInstanceId,zn,Xt,Ro,To,jo),0===Vt.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===p.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Vt.crossTileID]=new bi(Ai||At,Lr||zt,Vo||p.justReloaded),u[Vt.crossTileID]=!0};if(sn){if(0!==o.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const Vt=p.getSortedSymbolIndexes(this.transform.angle);for(let Xt=Vt.length-1;Xt>=0;--Xt){const zn=Vt[Xt];Jn(p.symbolInstances.get(zn),p.collisionArrays[zn],zn)}}else for(let Vt=o.symbolInstanceStart;Vt<o.symbolInstanceEnd;Vt++)Jn(p.symbolInstances.get(Vt),p.collisionArrays[Vt],Vt);if(f&&p.bucketInstanceId in this.collisionCircleArrays){const Vt=this.collisionCircleArrays[p.bucketInstanceId];x.as(Vt.invProjMatrix,A),Vt.viewportMatrix=this.collisionIndex.getViewportMatrix()}p.justReloaded=!1}storeCollisionData(o,u,f,p,_,D){if(f.textBox||f.iconBox){let S,A;this.collisionBoxArrays.has(o)?S=this.collisionBoxArrays.get(o):(S=new Map,this.collisionBoxArrays.set(o,S)),S.has(u)?A=S.get(u):(A={text:null,icon:null},S.set(u,A)),f.textBox&&(A.text=p.box),f.iconBox&&(A.icon=_.box)}if(D){let S=this.collisionCircleArrays[o];void 0===S&&(S=this.collisionCircleArrays[o]=new ei);for(let A=0;A<D.circles.length;A+=4)S.circles.push(D.circles[A+0]),S.circles.push(D.circles[A+1]),S.circles.push(D.circles[A+2]),S.circles.push(D.collisionDetected?1:0)}}markUsedJustification(o,u,f,p){let _;_=p===x.ah.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[x.at(u)];const D=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const S of D)S>=0&&(o.text.placedSymbolArray.get(S).crossTileID=_>=0&&S!==_?0:f.crossTileID)}markUsedOrientation(o,u,f){const p=u===x.ah.horizontal||u===x.ah.horizontalOnly?u:0,_=u===x.ah.vertical?u:0,D=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const S of D)o.text.placedSymbolArray.get(S).placedOrientation=p;f.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=_)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let f=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const p=u?u.symbolFadeChange(o):1,_=u?u.opacities:{},D=u?u.variableOffsets:{},S=u?u.placedOrientations:{};for(const A in this.placements){const R=this.placements[A],B=_[A];B?(this.opacities[A]=new pi(B,p,R.text,R.icon),f=f||R.text!==B.text.placed||R.icon!==B.icon.placed):(this.opacities[A]=new pi(null,p,R.text,R.icon,R.skipFade),f=f||R.text||R.icon)}for(const A in _){const R=_[A];if(!this.opacities[A]){const B=new pi(R,p,!1,!1);B.isHidden()||(this.opacities[A]=B,f=f||R.text.placed||R.icon.placed)}}for(const A in D)this.variableOffsets[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.variableOffsets[A]=D[A]);for(const A in S)this.placedOrientations[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.placedOrientations[A]=S[A]);if(u&&void 0===u.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=o:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:o)}updateLayerOpacities(o,u){const f={};for(const p of u){const _=p.getBucket(o);_&&p.latestFeatureIndex&&o.id===_.layerIds[0]&&this.updateBucketOpacities(_,p.tileID,f,p.collisionBoxArray)}}updateBucketOpacities(o,u,f,p){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const _=o.layers[0],D=_.layout,S=new pi(null,0,!1,!1,!0),A=D.get("text-allow-overlap"),R=D.get("icon-allow-overlap"),B=_._unevaluatedLayout.hasValue("text-variable-anchor")||_._unevaluatedLayout.hasValue("text-variable-anchor-offset"),L="map"===D.get("text-rotation-alignment"),W="map"===D.get("text-pitch-alignment"),Q="none"!==D.get("icon-text-fit"),ne=new pi(null,0,A&&(R||!o.hasIconData()||D.get("icon-optional")),R&&(A||!o.hasTextData()||D.get("text-optional")),!0);!o.collisionArrays&&p&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(p);const de=(he,Ee,oe)=>{for(let Me=0;Me<Ee/4;Me++)he.opacityVertexArray.emplaceBack(oe);he.hasVisibleVertices=he.hasVisibleVertices||oe!==St},se=this.collisionBoxArrays.get(o.bucketInstanceId);for(let he=0;he<o.symbolInstances.length;he++){const Ee=o.symbolInstances.get(he),{numHorizontalGlyphVertices:oe,numVerticalGlyphVertices:Me,crossTileID:Oe}=Ee;let Be=this.opacities[Oe];f[Oe]?Be=S:Be||(Be=ne,this.opacities[Oe]=Be),f[Oe]=!0;const ft=Ee.numIconVertices>0,Tt=this.placedOrientations[Ee.crossTileID],cn=Tt===x.ah.vertical,sn=Tt===x.ah.horizontal||Tt===x.ah.horizontalOnly;if(oe>0||Me>0){const zt=He(Be.text);de(o.text,oe,cn?St:zt),de(o.text,Me,sn?St:zt);const Cn=Be.text.isHidden();[Ee.rightJustifiedTextSymbolIndex,Ee.centerJustifiedTextSymbolIndex,Ee.leftJustifiedTextSymbolIndex].forEach(Xt=>{Xt>=0&&(o.text.placedSymbolArray.get(Xt).hidden=Cn||cn?1:0)}),Ee.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(Ee.verticalPlacedTextSymbolIndex).hidden=Cn||sn?1:0);const Jn=this.variableOffsets[Ee.crossTileID];Jn&&this.markUsedJustification(o,Jn.anchor,Ee,Tt);const Vt=this.placedOrientations[Ee.crossTileID];Vt&&(this.markUsedJustification(o,"left",Ee,Vt),this.markUsedOrientation(o,Vt,Ee))}if(ft){const zt=He(Be.icon),Cn=!(Q&&Ee.verticalPlacedIconSymbolIndex&&cn);Ee.placedIconSymbolIndex>=0&&(de(o.icon,Ee.numIconVertices,Cn?zt:St),o.icon.placedSymbolArray.get(Ee.placedIconSymbolIndex).hidden=Be.icon.isHidden()),Ee.verticalPlacedIconSymbolIndex>=0&&(de(o.icon,Ee.numVerticalIconVertices,Cn?St:zt),o.icon.placedSymbolArray.get(Ee.verticalPlacedIconSymbolIndex).hidden=Be.icon.isHidden())}const At=se&&se.has(he)?se.get(he):{text:null,icon:null};if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const zt=o.collisionArrays[he];if(zt){let Cn=new x.P(0,0);if(zt.textBox||zt.verticalTextBox){let Jn=!0;if(B){const Vt=this.variableOffsets[Oe];Vt?(Cn=mi(Vt.anchor,Vt.width,Vt.height,Vt.textOffset,Vt.textBoxScale),L&&Cn._rotate(W?this.transform.angle:-this.transform.angle)):Jn=!1}if(zt.textBox||zt.verticalTextBox){let Vt;zt.textBox&&(Vt=cn),zt.verticalTextBox&&(Vt=sn),Ci(o.textCollisionBox.collisionVertexArray,Be.text.placed,!Jn||Vt,At.text,Cn.x,Cn.y)}}if(zt.iconBox||zt.verticalIconBox){const Jn=!(sn||!zt.verticalIconBox);let Vt;zt.iconBox&&(Vt=Jn),zt.verticalIconBox&&(Vt=!Jn),Ci(o.iconCollisionBox.collisionVertexArray,Be.icon.placed,Vt,At.icon,Q?Cn.x:0,Q?Cn.y:0)}}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);if(o.bucketInstanceId in this.collisionCircleArrays){const he=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=he.invProjMatrix,o.placementViewportMatrix=he.viewportMatrix,o.collisionCircleArray=he.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return 0===this.fadeDuration?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,u){const f=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*f>o}setStale(){this.stale=!0}}function Ci(v,o,u,f,p,_){f&&0!==f.length||(f=[0,0,0,0]);const D=f[0]-kn,S=f[1]-kn,A=f[2]-kn,R=f[3]-kn;v.emplaceBack(o?1:0,u?1:0,p||0,_||0,D,S),v.emplaceBack(o?1:0,u?1:0,p||0,_||0,A,S),v.emplaceBack(o?1:0,u?1:0,p||0,_||0,A,R),v.emplaceBack(o?1:0,u?1:0,p||0,_||0,D,R)}const Us=Math.pow(2,25),Ri=Math.pow(2,24),Xo=Math.pow(2,17),us=Math.pow(2,16),ir=Math.pow(2,9),kr=Math.pow(2,8),Nl=Math.pow(2,1);function He(v){if(0===v.opacity&&!v.placed)return 0;if(1===v.opacity&&v.placed)return 4294967295;const o=v.placed?1:0,u=Math.floor(127*v.opacity);return u*Us+o*Ri+u*Xo+o*us+u*ir+o*kr+u*Nl+o}const St=0;function ii(){return{isOccluded:(v,o,u)=>!1,getPitchedTextCorrection:(v,o,u)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(v,o,u,f){throw new Error("Not implemented.")},translatePosition:(v,o,u,f)=>function(p,_,D,S,A=!1){if(!D[0]&&!D[1])return[0,0];const R=A?"map"===S?p.angle:0:"viewport"===S?-p.angle:0;if(R){const B=Math.sin(R),L=Math.cos(R);D=[D[0]*L-D[1]*B,D[0]*B+D[1]*L]}return[A?D[0]:Dn(_,D[0],p.zoom),A?D[1]:Dn(_,D[1],p.zoom)]}(v,o,u,f),getCircleRadiusCorrection:v=>1}}class Gi{constructor(o){this._sortAcrossTiles="viewport-y"!==o.layout.get("symbol-z-order")&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,u,f,p,_){const D=this._bucketParts;for(;this._currentTileIndex<o.length;)if(u.getBucketParts(D,p,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((S,A)=>S.sortKey-A.sortKey));this._currentPartIndex<D.length;)if(u.placeLayerBucketPart(D[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,_())return!0;return!1}}class Di{constructor(o,u,f,p,_,D,S,A){this.placement=new _r(o,ii(),u,D,S,A),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(o,u,f){const p=Ae.now(),_=()=>!this._forceFullPlacement&&Ae.now()-p>2;for(;this._currentPlacementIndex>=0;){const D=u[o[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if("symbol"===D.type&&(!D.minzoom||D.minzoom<=S)&&(!D.maxzoom||D.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new Gi(D)),this._inProgressLayer.continuePlacement(f[D.source],this.placement,this._showCollisionBoxes,D,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const br=512/x.X/2;class Hr{constructor(o,u,f){this.tileID=o,this.bucketInstanceId=f,this._symbolsByKey={};const p=new Map;for(let _=0;_<u.length;_++){const D=u.get(_),S=D.key,A=p.get(S);A?A.push(D):p.set(S,[D])}for(const[_,D]of p){const S={positions:D.map(A=>({x:Math.floor(A.anchorX*br),y:Math.floor(A.anchorY*br)})),crossTileIDs:D.map(A=>A.crossTileID)};if(S.positions.length>128){const A=new x.av(S.positions.length,16,Uint16Array);for(const{x:R,y:B}of S.positions)A.add(R,B);A.finish(),delete S.positions,S.index=A}this._symbolsByKey[_]=S}}getScaledCoordinates(o,u){const{x:f,y:p,z:_}=this.tileID.canonical,{x:D,y:S,z:A}=u.canonical,R=br/Math.pow(2,A-_),B=(S*x.X+o.anchorY)*R,L=p*x.X*br;return{x:Math.floor((D*x.X+o.anchorX)*R-f*x.X*br),y:Math.floor(B-L)}}findMatches(o,u,f){const p=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let _=0;_<o.length;_++){const D=o.get(_);if(D.crossTileID)continue;const S=this._symbolsByKey[D.key];if(!S)continue;const A=this.getScaledCoordinates(D,u);if(S.index){const R=S.index.range(A.x-p,A.y-p,A.x+p,A.y+p).sort();for(const B of R){const L=S.crossTileIDs[B];if(!f[L]){f[L]=!0,D.crossTileID=L;break}}}else if(S.positions)for(let R=0;R<S.positions.length;R++){const B=S.positions[R],L=S.crossTileIDs[R];if(Math.abs(B.x-A.x)<=p&&Math.abs(B.y-A.y)<=p&&!f[L]){f[L]=!0,D.crossTileID=L;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class Rr{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class La{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const u=Math.round((o-this.lng)/360);if(0!==u)for(const f in this.indexes){const p=this.indexes[f],_={};for(const D in p){const S=p[D];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+u),_[S.tileID.key]=S}this.indexes[f]=_}this.lng=o}addBucket(o,u,f){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let _=0;_<u.symbolInstances.length;_++)u.symbolInstances.get(_).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const p=this.usedCrossTileIDs[o.overscaledZ];for(const _ in this.indexes){const D=this.indexes[_];if(Number(_)>o.overscaledZ)for(const S in D){const A=D[S];A.tileID.isChildOf(o)&&A.findMatches(u.symbolInstances,o,p)}else{const S=D[o.scaledTo(Number(_)).key];S&&S.findMatches(u.symbolInstances,o,p)}}for(let _=0;_<u.symbolInstances.length;_++){const D=u.symbolInstances.get(_);D.crossTileID||(D.crossTileID=f.generate(),p[D.crossTileID]=!0)}return void 0===this.indexes[o.overscaledZ]&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Hr(o,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(o,u){for(const f of u.getCrossTileIDsLists())for(const p of f)delete this.usedCrossTileIDs[o][p]}removeStaleBuckets(o){let u=!1;for(const f in this.indexes){const p=this.indexes[f];for(const _ in p)o[p[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,p[_]),delete p[_],u=!0)}return u}}class Vi{constructor(){this.layerIndexes={},this.crossTileIDs=new Rr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,u,f){let p=this.layerIndexes[o.id];void 0===p&&(p=this.layerIndexes[o.id]=new La);let _=!1;const D={};p.handleWrapJump(f);for(const S of u){const A=S.getBucket(o);A&&o.id===A.layerIds[0]&&(A.bucketInstanceId||(A.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(S.tileID,A,this.crossTileIDs)&&(_=!0),D[A.bucketInstanceId]=!0)}return p.removeStaleBuckets(D)&&(_=!0),_}pruneUnusedLayers(o){const u={};o.forEach(f=>{u[f]=!0});for(const f in this.layerIndexes)u[f]||delete this.layerIndexes[f]}}const Na=(v,o)=>x.t(v,o&&o.filter(u=>"source.canvas"!==u.identifier)),ti=x.aw();class Zn extends x.E{constructor(o,u={}){super(),this._rtlPluginLoaded=()=>{for(const f in this.sourceCaches){const p=this.sourceCaches[f].getSource().type;"vector"!==p&&"geojson"!==p||this.sourceCaches[f].reload()}},this.map=o,this.dispatcher=new jt(Lt(),o._getMapId()),this.dispatcher.registerMessageHandler("GG",(f,p)=>this.getGlyphs(f,p)),this.dispatcher.registerMessageHandler("GI",(f,p)=>this.getImages(f,p)),this.imageManager=new en,this.imageManager.setEventedParent(this),this.glyphManager=new ut(o._requestManager,u.localIdeographFontFamily),this.lineAtlas=new be(256,512),this.crossTileSymbolIndex=new Vi,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new x.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",x.ay()),hr().on(it,this._rtlPluginLoaded),this.on("data",f=>{if("source"!==f.dataType||"metadata"!==f.sourceDataType)return;const p=this.sourceCaches[f.sourceId];if(!p)return;const _=p.getSource();if(_&&_.vectorLayerIds)for(const D in this._layers){const S=this._layers[D];S.source===_.id&&this._validateLayer(S)}})}loadURL(o,u={},f){this.fire(new x.k("dataloading",{dataType:"style"})),u.validate="boolean"!=typeof u.validate||u.validate;const p=this.map._requestManager.transformRequest(o,"Style");this._loadStyleRequest=new AbortController;const _=this._loadStyleRequest;x.h(p,this._loadStyleRequest).then(D=>{this._loadStyleRequest=null,this._load(D.data,u,f)}).catch(D=>{this._loadStyleRequest=null,D&&!_.signal.aborted&&this.fire(new x.j(D))})}loadJSON(o,u={},f){this.fire(new x.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,Ae.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,u.validate=!1!==u.validate,this._load(o,u,f)}).catch(()=>{})}loadEmpty(){this.fire(new x.k("dataloading",{dataType:"style"})),this._load(ti,{validate:!1})}_load(o,u,f){var p;const _=u.transformStyle?u.transformStyle(f,o):o;if(!u.validate||!Na(this,x.u(_))){this._loaded=!0,this.stylesheet=_;for(const D in _.sources)this.addSource(D,_.sources[D],{validate:!1});_.sprite?this._loadSprite(_.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_.glyphs),this._createLayers(),this.light=new gt(this.stylesheet.light),this.sky=new ge(this.stylesheet.sky),this.map.setTerrain(null!==(p=this.stylesheet.terrain)&&void 0!==p?p:null),this.fire(new x.k("data",{dataType:"style"})),this.fire(new x.k("style.load"))}}_createLayers(){const o=x.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",o),this._order=o.map(u=>u.id),this._layers={},this._serializedLayers=null;for(const u of o){const f=x.aA(u);f.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=f}}_loadSprite(o,u=!1,f=void 0){let p;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(_,D,S,A){return x._(this,void 0,void 0,function*(){const R=ze(_),B=S>1?"@2x":"",L={},W={};for(const{id:Q,url:ne}of R){const de=D.transformRequest(lt(ne,B,".json"),"SpriteJSON");L[Q]=x.h(de,A);const se=D.transformRequest(lt(ne,B,".png"),"SpriteImage");W[Q]=pt.getImage(se,A)}return yield Promise.all([...Object.values(L),...Object.values(W)]),function(Q,ne){return x._(this,void 0,void 0,function*(){const de={};for(const se in Q){de[se]={};const he=Ae.getImageCanvasContext((yield ne[se]).data),Ee=(yield Q[se]).data;for(const oe in Ee){const{width:Me,height:Oe,x:Be,y:ft,sdf:Tt,pixelRatio:cn,stretchX:sn,stretchY:At,content:zt,textFitWidth:Cn,textFitHeight:Jn}=Ee[oe];de[se][oe]={data:null,pixelRatio:cn,sdf:Tt,stretchX:sn,stretchY:At,content:zt,textFitWidth:Cn,textFitHeight:Jn,spriteData:{width:Me,height:Oe,x:Be,y:ft,context:he}}}}return de})}(L,W)})}(o,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(_=>{if(this._spriteRequest=null,_)for(const D in _){this._spritesImagesIds[D]=[];const S=this._spritesImagesIds[D]?this._spritesImagesIds[D].filter(A=>!(A in _)):[];for(const A of S)this.imageManager.removeImage(A),this._changedImages[A]=!0;for(const A in _[D]){const R="default"===D?A:`${D}:${A}`;this._spritesImagesIds[D].push(R),R in this.imageManager.images?this.imageManager.updateImage(R,_[D][A],!1):this.imageManager.addImage(R,_[D][A]),u&&(this._changedImages[R]=!0)}}}).catch(_=>{this._spriteRequest=null,p=_,this.fire(new x.j(p))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new x.k("data",{dataType:"style"})),f&&f(p)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new x.k("data",{dataType:"style"}))}_validateLayer(o){const u=this.sourceCaches[o.source];if(!u)return;const f=o.sourceLayer;if(!f)return;const p=u.getSource();("geojson"===p.type||p.vectorLayerIds&&-1===p.vectorLayerIds.indexOf(f))&&this.fire(new x.j(new Error(`Source layer "${f}" does not exist on source "${p.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o,u=!1){const f=this._serializedAllLayers();if(!o||0===o.length)return Object.values(u?x.aB(f):f);const p=[];for(const _ of o)if(f[_]){const D=u?x.aB(f[_]):f[_];p.push(D)}return p}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const u=Object.keys(this._layers);for(const f of u){const p=this._layers[f];"custom"!==p.type&&(o[f]=p.serialize())}return o}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const u=this._changed;if(u){const p=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);(p.length||_.length)&&this._updateWorkerLayers(p,_);for(const D in this._updatedSources){const S=this._updatedSources[D];if("reload"===S)this._reloadSource(D);else{if("clear"!==S)throw new Error(`Invalid action ${S}`);this._clearSource(D)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const D in this._updatedPaintProps)this._layers[D].updateTransitions(o);this.light.updateTransitions(o),this.sky.updateTransitions(o),this._resetUpdates()}const f={};for(const p in this.sourceCaches){const _=this.sourceCaches[p];f[p]=_.used,_.used=!1}for(const p of this._order){const _=this._layers[p];_.recalculate(o,this._availableImages),!_.isHidden(o.zoom)&&_.source&&(this.sourceCaches[_.source].used=!0)}for(const p in f){const _=this.sourceCaches[p];!!f[p]!=!!_.used&&_.fire(new x.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(o),this.sky.recalculate(o),this.z=o.zoom,u&&this.fire(new x.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(o,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,u={}){var f;this._checkLoaded();const p=this.serialize();if(o=u.transformStyle?u.transformStyle(p,o):o,(null===(f=u.validate)||void 0===f||f)&&Na(this,x.u(o)))return!1;(o=x.aB(o)).layers=x.az(o.layers);const _=x.aC(p,o),D=this._getOperationsToPerform(_);if(D.unimplemented.length>0)throw new Error(`Unimplemented: ${D.unimplemented.join(", ")}.`);if(0===D.operations.length)return!1;for(const S of D.operations)S();return this.stylesheet=o,this._serializedLayers=null,!0}_getOperationsToPerform(o){const u=[],f=[];for(const p of o)switch(p.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":u.push(()=>this.addLayer.apply(this,p.args));break;case"removeLayer":u.push(()=>this.removeLayer.apply(this,p.args));break;case"setPaintProperty":u.push(()=>this.setPaintProperty.apply(this,p.args));break;case"setLayoutProperty":u.push(()=>this.setLayoutProperty.apply(this,p.args));break;case"setFilter":u.push(()=>this.setFilter.apply(this,p.args));break;case"addSource":u.push(()=>this.addSource.apply(this,p.args));break;case"removeSource":u.push(()=>this.removeSource.apply(this,p.args));break;case"setLayerZoomRange":u.push(()=>this.setLayerZoomRange.apply(this,p.args));break;case"setLight":u.push(()=>this.setLight.apply(this,p.args));break;case"setGeoJSONSourceData":u.push(()=>this.setGeoJSONSourceData.apply(this,p.args));break;case"setGlyphs":u.push(()=>this.setGlyphs.apply(this,p.args));break;case"setSprite":u.push(()=>this.setSprite.apply(this,p.args));break;case"setSky":u.push(()=>this.setSky.apply(this,p.args));break;case"setTerrain":u.push(()=>this.map.setTerrain.apply(this,p.args));break;case"setTransition":u.push(()=>{});break;default:f.push(p.command)}return{operations:u,unimplemented:f}}addImage(o,u){if(this.getImage(o))return this.fire(new x.j(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,u),this._afterImageUpdated(o)}updateImage(o,u){this.imageManager.updateImage(o,u)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new x.j(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new x.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,u,f={}){if(this._checkLoaded(),void 0!==this.sourceCaches[o])throw new Error(`Source "${o}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(x.u.source,`sources.${o}`,u,null,f))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const p=this.sourceCaches[o]=new In(o,u,this.dispatcher);p.style=this,p.setEventedParent(this,()=>({isSourceLoaded:p.loaded(),source:p.serialize(),sourceId:o})),p.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),void 0===this.sourceCaches[o])throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===o)return this.fire(new x.j(new Error(`Source "${o}" cannot be removed while layer "${f}" is using it.`)));const u=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],u.fire(new x.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,u){if(this._checkLoaded(),void 0===this.sourceCaches[o])throw new Error(`There is no source with this ID=${o}`);const f=this.sourceCaches[o].getSource();if("geojson"!==f.type)throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(u),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,u,f={}){this._checkLoaded();const p=o.id;if(this.getLayer(p))return void this.fire(new x.j(new Error(`Layer "${p}" already exists on this map.`)));let _;if("custom"===o.type){if(Na(this,x.aD(o)))return;_=x.aA(o)}else{if("source"in o&&"object"==typeof o.source&&(this.addSource(p,o.source),o=x.aB(o),o=x.e(o,{source:p})),this._validate(x.u.layer,`layers.${p}`,o,{arrayIndex:-1},f))return;_=x.aA(o),this._validateLayer(_),_.setEventedParent(this,{layer:{id:p}})}const D=u?this._order.indexOf(u):this._order.length;if(u&&-1===D)this.fire(new x.j(new Error(`Cannot add layer "${p}" before non-existing layer "${u}".`)));else{if(this._order.splice(D,0,p),this._layerOrderChanged=!0,this._layers[p]=_,this._removedLayers[p]&&_.source&&"custom"!==_.type){const S=this._removedLayers[p];delete this._removedLayers[p],S.type!==_.type?this._updatedSources[_.source]="clear":(this._updatedSources[_.source]="reload",this.sourceCaches[_.source].pause())}this._updateLayer(_),_.onAdd&&_.onAdd(this.map)}}moveLayer(o,u){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new x.j(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===u)return;const f=this._order.indexOf(o);this._order.splice(f,1);const p=u?this._order.indexOf(u):this._order.length;u&&-1===p?this.fire(new x.j(new Error(`Cannot move layer "${o}" before non-existing layer "${u}".`))):(this._order.splice(p,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const u=this._layers[o];if(!u)return void this.fire(new x.j(new Error(`Cannot remove non-existing layer "${o}".`)));u.setEventedParent(null);const f=this._order.indexOf(o);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map)}getLayer(o){return this._layers[o]}getLayersOrder(){return[...this._order]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,u,f){this._checkLoaded();const p=this.getLayer(o);p?p.minzoom===u&&p.maxzoom===f||(null!=u&&(p.minzoom=u),null!=f&&(p.maxzoom=f),this._updateLayer(p)):this.fire(new x.j(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,u,f={}){this._checkLoaded();const p=this.getLayer(o);if(p){if(!x.aE(p.filter,u))return null==u?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(x.u.filter,`layers.${p.id}.filter`,u,null,f)||(p.filter=x.aB(u),this._updateLayer(p)))}else this.fire(new x.j(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return x.aB(this.getLayer(o).filter)}setLayoutProperty(o,u,f,p={}){this._checkLoaded();const _=this.getLayer(o);_?x.aE(_.getLayoutProperty(u),f)||(_.setLayoutProperty(u,f,p),this._updateLayer(_)):this.fire(new x.j(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,u){const f=this.getLayer(o);if(f)return f.getLayoutProperty(u);this.fire(new x.j(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,u,f,p={}){this._checkLoaded();const _=this.getLayer(o);_?x.aE(_.getPaintProperty(u),f)||(_.setPaintProperty(u,f,p)&&this._updateLayer(_),this._changed=!0,this._updatedPaintProps[o]=!0,this._serializedLayers=null):this.fire(new x.j(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,u){return this.getLayer(o).getPaintProperty(u)}setFeatureState(o,u){this._checkLoaded();const f=o.source,p=o.sourceLayer,_=this.sourceCaches[f];if(void 0===_)return void this.fire(new x.j(new Error(`The source '${f}' does not exist in the map's style.`)));const D=_.getSource().type;"geojson"===D&&p?this.fire(new x.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==D||p?(void 0===o.id&&this.fire(new x.j(new Error("The feature id parameter must be provided."))),_.setFeatureState(p,o.id,u)):this.fire(new x.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,u){this._checkLoaded();const f=o.source,p=this.sourceCaches[f];if(void 0===p)return void this.fire(new x.j(new Error(`The source '${f}' does not exist in the map's style.`)));const _=p.getSource().type,D="vector"===_?o.sourceLayer:void 0;"vector"!==_||D?u&&"string"!=typeof o.id&&"number"!=typeof o.id?this.fire(new x.j(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(D,o.id,u):this.fire(new x.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const u=o.source,f=o.sourceLayer,p=this.sourceCaches[u];if(void 0!==p)return"vector"!==p.getSource().type||f?(void 0===o.id&&this.fire(new x.j(new Error("The feature id parameter must be provided."))),p.getFeatureState(f,o.id)):void this.fire(new x.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new x.j(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return x.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=x.aF(this.sourceCaches,_=>_.serialize()),u=this._serializeByIds(this._order,!0),f=this.map.getTerrain()||void 0,p=this.stylesheet;return x.aG({version:p.version,name:p.name,metadata:p.metadata,light:p.light,sky:p.sky,center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,sprite:p.sprite,glyphs:p.glyphs,transition:p.transition,sources:o,layers:u,terrain:f},_=>void 0!==_)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&"raster"!==this.sourceCaches[o.source].getSource().type&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const u=D=>"fill-extrusion"===this._layers[D].type,f={},p=[];for(let D=this._order.length-1;D>=0;D--){const S=this._order[D];if(u(S)){f[S]=D;for(const A of o){const R=A[S];if(R)for(const B of R)p.push(B)}}}p.sort((D,S)=>S.intersectionZ-D.intersectionZ);const _=[];for(let D=this._order.length-1;D>=0;D--){const S=this._order[D];if(u(S))for(let A=p.length-1;A>=0;A--){const R=p[A].feature;if(f[R.layer.id]<D)break;_.push(R),p.pop()}else for(const A of o){const R=A[S];if(R)for(const B of R)_.push(B.feature)}}return _}queryRenderedFeatures(o,u,f){u&&u.filter&&this._validate(x.u.filter,"queryRenderedFeatures.filter",u.filter,null,u);const p={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new x.j(new Error("parameters.layers must be an Array."))),[];for(const S of u.layers){const A=this._layers[S];if(!A)return this.fire(new x.j(new Error(`The layer '${S}' does not exist in the map's style and cannot be queried for features.`))),[];p[A.source]=!0}}const _=[];u.availableImages=this._availableImages;const D=this._serializedAllLayers();for(const S in this.sourceCaches)u.layers&&!p[S]||_.push(Ui(this.sourceCaches[S],this._layers,D,o,u,f));return this.placement&&_.push(function(S,A,R,B,L,W,Q){const ne={},de=W.queryRenderedSymbols(B),se=[];for(const he of Object.keys(de).map(Number))se.push(Q[he]);se.sort(ri);for(const he of se){const Ee=he.featureIndex.lookupSymbolFeatures(de[he.bucketInstanceId],A,he.bucketIndex,he.sourceLayerIndex,L.filter,L.layers,L.availableImages,S);for(const oe in Ee){const Me=ne[oe]=ne[oe]||[],Oe=Ee[oe];Oe.sort((Be,ft)=>{const Tt=he.featureSortOrder;if(Tt){const cn=Tt.indexOf(Be.featureIndex);return Tt.indexOf(ft.featureIndex)-cn}return ft.featureIndex-Be.featureIndex});for(const Be of Oe)Me.push(Be)}}for(const he in ne)ne[he].forEach(Ee=>{const oe=Ee.feature,Me=R[S[he].source].getFeatureState(oe.layer["source-layer"],oe.id);oe.source=oe.layer.source,oe.layer["source-layer"]&&(oe.sourceLayer=oe.layer["source-layer"]),oe.state=Me});return ne}(this._layers,D,this.sourceCaches,o,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_)}querySourceFeatures(o,u){u&&u.filter&&this._validate(x.u.filter,"querySourceFeatures.filter",u.filter,null,u);const f=this.sourceCaches[o];return f?function(p,_){const D=p.getRenderableIds().map(R=>p.getTileByID(R)),S=[],A={};for(let R=0;R<D.length;R++){const B=D[R],L=B.tileID.canonical.key;A[L]||(A[L]=!0,B.querySourceFeatures(S,_))}return S}(f,u):[]}getLight(){return this.light.getLight()}setLight(o,u={}){this._checkLoaded();const f=this.light.getLight();let p=!1;for(const D in o)if(!x.aE(o[D],f[D])){p=!0;break}if(!p)return;const _={now:Ae.now(),transition:x.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,u),this.light.updateTransitions(_)}getSky(){var o;return null===(o=this.stylesheet)||void 0===o?void 0:o.sky}setSky(o,u={}){const f=this.getSky();let p=!1;if(!o&&!f)return;if(o&&!f)p=!0;else if(!o&&f)p=!0;else for(const D in o)if(!x.aE(o[D],f[D])){p=!0;break}if(!p)return;const _={now:Ae.now(),transition:x.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=o,this.sky.setSky(o,u),this.sky.updateTransitions(_)}_validate(o,u,f,p,_={}){return(!_||!1!==_.validate)&&Na(this,o.call(x.u,x.e({key:u,style:this.serialize(),value:f,styleSpec:x.v},p)))}_remove(o=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),hr().off(it,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const f=this.sourceCaches[u];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),o&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(o)}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const u in this.sourceCaches)this.sourceCaches[u].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,u,f,p,_=!1){let D=!1,S=!1;const A={};for(const R of this._order){const B=this._layers[R];if("symbol"!==B.type)continue;if(!A[B.source]){const W=this.sourceCaches[B.source];A[B.source]=W.getRenderableIds(!0).map(Q=>W.getTileByID(Q)).sort((Q,ne)=>ne.tileID.overscaledZ-Q.tileID.overscaledZ||(Q.tileID.isLessThan(ne.tileID)?-1:1))}const L=this.crossTileSymbolIndex.addLayer(B,A[B.source],o.center.lng);D=D||L}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((_=_||this._layerOrderChanged||0===f)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Ae.now(),o.zoom))&&(this.pauseablePlacement=new Di(o,this.map.terrain,this._order,_,u,f,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,A),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Ae.now()),S=!0),D&&this.pauseablePlacement.placement.setStale()),S||D)for(const R of this._order){const B=this._layers[R];"symbol"===B.type&&this.placement.updateLayerOpacities(B,A[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Ae.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,u){return x._(this,void 0,void 0,function*(){const f=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const p=this.sourceCaches[u.source];return p&&p.setDependencies(u.tileID.key,u.type,u.icons),f})}getGlyphs(o,u){return x._(this,void 0,void 0,function*(){const f=yield this.glyphManager.getGlyphs(u.stacks),p=this.sourceCaches[u.source];return p&&p.setDependencies(u.tileID.key,u.type,[""]),f})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,u={}){this._checkLoaded(),o&&this._validate(x.u.glyphs,"glyphs",o,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}addSprite(o,u,f={},p){this._checkLoaded();const _=[{id:o,url:u}],D=[...ze(this.stylesheet.sprite),..._];this._validate(x.u.sprite,"sprite",D,null,f)||(this.stylesheet.sprite=D,this._loadSprite(_,!0,p))}removeSprite(o){this._checkLoaded();const u=ze(this.stylesheet.sprite);if(u.find(f=>f.id===o)){if(this._spritesImagesIds[o])for(const f of this._spritesImagesIds[o])this.imageManager.removeImage(f),this._changedImages[f]=!0;u.splice(u.findIndex(f=>f.id===o),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new x.k("data",{dataType:"style"}))}else this.fire(new x.j(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return ze(this.stylesheet.sprite)}setSprite(o,u={},f){this._checkLoaded(),o&&this._validate(x.u.sprite,"sprite",o,null,u)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,f):(this._unloadSprite(),f&&f(null)))}}var wa=x.Y([{name:"a_pos",type:"Int16",components:2}]);const Ko={prelude:jn("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:jn("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:jn("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:jn("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:jn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:jn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:jn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:jn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:jn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:jn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:jn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:jn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:jn("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:jn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:jn("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:jn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:jn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:jn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:jn("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:jn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:jn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:jn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:jn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:jn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:jn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:jn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:jn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:jn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:jn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:jn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function jn(v,o){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=o.match(/attribute ([\w]+) ([\w]+)/g),p=v.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),D=_?_.concat(p):p,S={};return{fragmentSource:v=v.replace(u,(A,R,B,L,W)=>(S[W]=!0,"define"===R?`\n#ifndef HAS_UNIFORM_u_${W}\nvarying ${B} ${L} ${W};\n#else\nuniform ${B} ${L} u_${W};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${W}\n    ${B} ${L} ${W} = u_${W};\n#endif\n`)),vertexSource:o=o.replace(u,(A,R,B,L,W)=>{const Q="float"===L?"vec2":"vec4",ne=W.match(/color/)?"color":Q;return S[W]?"define"===R?`\n#ifndef HAS_UNIFORM_u_${W}\nuniform lowp float u_${W}_t;\nattribute ${B} ${Q} a_${W};\nvarying ${B} ${L} ${W};\n#else\nuniform ${B} ${L} u_${W};\n#endif\n`:"vec4"===ne?`\n#ifndef HAS_UNIFORM_u_${W}\n    ${W} = a_${W};\n#else\n    ${B} ${L} ${W} = u_${W};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${W}\n    ${W} = unpack_mix_${ne}(a_${W}, u_${W}_t);\n#else\n    ${B} ${L} ${W} = u_${W};\n#endif\n`:"define"===R?`\n#ifndef HAS_UNIFORM_u_${W}\nuniform lowp float u_${W}_t;\nattribute ${B} ${Q} a_${W};\n#else\nuniform ${B} ${L} u_${W};\n#endif\n`:"vec4"===ne?`\n#ifndef HAS_UNIFORM_u_${W}\n    ${B} ${L} ${W} = a_${W};\n#else\n    ${B} ${L} ${W} = u_${W};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${W}\n    ${B} ${L} ${W} = unpack_mix_${ne}(a_${W}, u_${W}_t);\n#else\n    ${B} ${L} ${W} = u_${W};\n#endif\n`}),staticAttributes:f,staticUniforms:D}}class xa{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,u,f,p,_,D,S,A,R){this.context=o;let B=this.boundPaintVertexBuffers.length!==p.length;for(let L=0;!B&&L<p.length;L++)this.boundPaintVertexBuffers[L]!==p[L]&&(B=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==f||B||this.boundIndexBuffer!==_||this.boundVertexOffset!==D||this.boundDynamicVertexBuffer!==S||this.boundDynamicVertexBuffer2!==A||this.boundDynamicVertexBuffer3!==R?this.freshBind(u,f,p,_,D,S,A,R):(o.bindVertexArray.set(this.vao),S&&S.bind(),_&&_.dynamicDraw&&_.bind(),A&&A.bind(),R&&R.bind())}freshBind(o,u,f,p,_,D,S,A){const R=o.numAttributes,B=this.context,L=B.gl;this.vao&&this.destroy(),this.vao=B.createVertexArray(),B.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=p,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=D,this.boundDynamicVertexBuffer2=S,this.boundDynamicVertexBuffer3=A,u.enableAttributes(L,o);for(const W of f)W.enableAttributes(L,o);D&&D.enableAttributes(L,o),S&&S.enableAttributes(L,o),A&&A.enableAttributes(L,o),u.bind(),u.setVertexAttribPointers(L,o,_);for(const W of f)W.bind(),W.setVertexAttribPointers(L,o,_);D&&(D.bind(),D.setVertexAttribPointers(L,o,_)),p&&p.bind(),S&&(S.bind(),S.setVertexAttribPointers(L,o,_)),A&&(A.bind(),A.setVertexAttribPointers(L,o,_)),B.currentNumAttributes=R}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Bl=(v,o,u,f,p)=>({u_matrix:v,u_texture:0,u_ele_delta:o,u_fog_matrix:u,u_fog_color:f?f.properties.get("fog-color"):x.aM.white,u_fog_ground_blend:f?f.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:f?f.calculateFogBlendOpacity(p):0,u_horizon_color:f?f.properties.get("horizon-color"):x.aM.white,u_horizon_fog_blend:f?f.properties.get("horizon-fog-blend"):1});function Ti(v){const o=[];for(let u=0;u<v.length;u++){if(null===v[u])continue;const f=v[u].split(" ");o.push(f.pop())}return o}class Bo{constructor(o,u,f,p,_,D){const S=o.gl;this.program=S.createProgram();const A=Ti(u.staticAttributes),R=f?f.getBinderAttributes():[],B=A.concat(R),L=Ko.prelude.staticUniforms?Ti(Ko.prelude.staticUniforms):[],W=u.staticUniforms?Ti(u.staticUniforms):[],Q=f?f.getBinderUniforms():[],ne=L.concat(W).concat(Q),de=[];for(const Be of ne)de.indexOf(Be)<0&&de.push(Be);const se=f?f.defines():[];_&&se.push("#define OVERDRAW_INSPECTOR;"),D&&se.push("#define TERRAIN3D;");const he=se.concat(Ko.prelude.fragmentSource,u.fragmentSource).join("\n"),Ee=se.concat(Ko.prelude.vertexSource,u.vertexSource).join("\n"),oe=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);if(S.shaderSource(oe,he),S.compileShader(oe),!S.getShaderParameter(oe,S.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${S.getShaderInfoLog(oe)}`);S.attachShader(this.program,oe);const Me=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);if(S.shaderSource(Me,Ee),S.compileShader(Me),!S.getShaderParameter(Me,S.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${S.getShaderInfoLog(Me)}`);S.attachShader(this.program,Me),this.attributes={};const Oe={};this.numAttributes=B.length;for(let Be=0;Be<this.numAttributes;Be++)B[Be]&&(S.bindAttribLocation(this.program,Be,B[Be]),this.attributes[B[Be]]=Be);if(S.linkProgram(this.program),!S.getProgramParameter(this.program,S.LINK_STATUS))throw new Error(`Program failed to link: ${S.getProgramInfoLog(this.program)}`);S.deleteShader(Me),S.deleteShader(oe);for(let Be=0;Be<de.length;Be++){const ft=de[Be];if(ft&&!Oe[ft]){const Tt=S.getUniformLocation(this.program,ft);Tt&&(Oe[ft]=Tt)}}var Be,ft;this.fixedUniforms=p(o,Oe),this.terrainUniforms={u_depth:new x.aH(Be=o,(ft=Oe).u_depth),u_terrain:new x.aH(Be,ft.u_terrain),u_terrain_dim:new x.aI(Be,ft.u_terrain_dim),u_terrain_matrix:new x.aJ(Be,ft.u_terrain_matrix),u_terrain_unpack:new x.aK(Be,ft.u_terrain_unpack),u_terrain_exaggeration:new x.aI(Be,ft.u_terrain_exaggeration)},this.binderUniforms=f?f.getUniforms(o,Oe):[]}draw(o,u,f,p,_,D,S,A,R,B,L,W,Q,ne,de,se,he,Ee){const oe=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(f),o.setStencilMode(p),o.setColorMode(_),o.setCullFace(D),A){o.activeTexture.set(oe.TEXTURE2),oe.bindTexture(oe.TEXTURE_2D,A.depthTexture),o.activeTexture.set(oe.TEXTURE3),oe.bindTexture(oe.TEXTURE_2D,A.texture);for(const Oe in this.terrainUniforms)this.terrainUniforms[Oe].set(A[Oe])}for(const Oe in this.fixedUniforms)this.fixedUniforms[Oe].set(S[Oe]);de&&de.setUniforms(o,this.binderUniforms,Q,{zoom:ne});let Me=0;switch(u){case oe.LINES:Me=2;break;case oe.TRIANGLES:Me=3;break;case oe.LINE_STRIP:Me=1}for(const Oe of W.get()){const Be=Oe.vaos||(Oe.vaos={});(Be[R]||(Be[R]=new xa)).bind(o,this,B,de?de.getPaintVertexBuffers():[],L,Oe.vertexOffset,se,he,Ee),oe.drawElements(u,Oe.primitiveLength*Me,oe.UNSIGNED_SHORT,Oe.primitiveOffset*Me*2)}}}function wr(v,o,u){const f=1/Dn(u,1,o.transform.tileZoom),p=Math.pow(2,u.tileID.overscaledZ),_=u.tileSize*Math.pow(2,o.transform.tileZoom)/p,D=_*(u.tileID.canonical.x+u.tileID.wrap*p),S=_*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[f,v.fromScale,v.toScale],u_fade:v.t,u_pixel_coord_upper:[D>>16,S>>16],u_pixel_coord_lower:[65535&D,65535&S]}}const Yo=(v,o,u,f)=>{const p=o.style.light,_=p.properties.get("position"),D=[_.x,_.y,_.z],S=(R=new x.A(9),x.A!=Float32Array&&(R[1]=0,R[2]=0,R[3]=0,R[5]=0,R[6]=0,R[7]=0),R[0]=1,R[4]=1,R[8]=1,R);var R;"viewport"===p.properties.get("anchor")&&function(R,B){var L=Math.sin(B),W=Math.cos(B);R[0]=W,R[1]=L,R[2]=0,R[3]=-L,R[4]=W,R[5]=0,R[6]=0,R[7]=0,R[8]=1}(S,-o.transform.angle),function(R,B,L){var W=B[0],Q=B[1],ne=B[2];R[0]=W*L[0]+Q*L[3]+ne*L[6],R[1]=W*L[1]+Q*L[4]+ne*L[7],R[2]=W*L[2]+Q*L[5]+ne*L[8]}(D,D,S);const A=p.properties.get("color");return{u_matrix:v,u_lightpos:D,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[A.r,A.g,A.b],u_vertical_gradient:+u,u_opacity:f}},fr=(v,o,u,f,p,_,D)=>x.e(Yo(v,o,u,f),wr(_,o,D),{u_height_factor:-Math.pow(2,p.overscaledZ)/D.tileSize/8}),Fi=v=>({u_matrix:v}),Un=(v,o,u,f)=>x.e(Fi(v),wr(u,o,f)),zl=(v,o)=>({u_matrix:v,u_world:o}),al=(v,o,u,f,p)=>x.e(Un(v,o,u,f),{u_world:p}),du=(v,o,u,f)=>{const p=v.transform;let _,D;if("map"===f.paint.get("circle-pitch-alignment")){const S=Dn(u,1,p.zoom);_=!0,D=[S,S]}else _=!1,D=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+("map"===f.paint.get("circle-pitch-scale")),u_matrix:v.translatePosMatrix(o.posMatrix,u,f.paint.get("circle-translate"),f.paint.get("circle-translate-anchor")),u_pitch_with_map:+_,u_device_pixel_ratio:v.pixelRatio,u_extrude_scale:D}},xc=(v,o,u)=>({u_matrix:v,u_inv_matrix:o,u_camera_to_center_distance:u.cameraToCenterDistance,u_viewport_size:[u.width,u.height]}),qe=(v,o,u=1)=>({u_matrix:v,u_color:o,u_overlay:0,u_overlay_scale:u}),Ps=v=>({u_matrix:v}),On=(v,o,u,f)=>({u_matrix:v,u_extrude_scale:Dn(o,1,u),u_intensity:f});function ai(v,o){const u=Math.pow(2,o.canonical.z),f=o.canonical.y;return[new x.Z(0,f/u).toLngLat().lat,new x.Z(0,(f+1)/u).toLngLat().lat]}const Ba=(v,o,u,f)=>{const p=v.transform;return{u_matrix:Dc(v,o,u,f),u_ratio:1/Dn(o,1,p.zoom),u_device_pixel_ratio:v.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},$l=(v,o,u,f,p)=>x.e(Ba(v,o,u,p),{u_image:0,u_image_height:f}),Cc=(v,o,u,f,p)=>{const _=v.transform,D=Or(o,_);return{u_matrix:Dc(v,o,u,p),u_texsize:o.imageAtlasTexture.size,u_ratio:1/Dn(o,1,_.zoom),u_device_pixel_ratio:v.pixelRatio,u_image:0,u_scale:[D,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},ll=(v,o,u,f,p,_)=>{const D=v.lineAtlas,S=Or(o,v.transform),A="round"===u.layout.get("line-cap"),R=D.getDash(f.from,A),B=D.getDash(f.to,A),L=R.width*p.fromScale,W=B.width*p.toScale;return x.e(Ba(v,o,u,_),{u_patternscale_a:[S/L,-R.height/2],u_patternscale_b:[S/W,-B.height/2],u_sdfgamma:D.width/(256*Math.min(L,W)*v.pixelRatio)/2,u_image:0,u_tex_y_a:R.y,u_tex_y_b:B.y,u_mix:p.t})};function Or(v,o){return 1/Dn(v,1,o.tileZoom)}function Dc(v,o,u,f){return v.translatePosMatrix(f?f.posMatrix:o.tileID.posMatrix,o,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const cl=(v,o,u,f,p)=>{return{u_matrix:v,u_tl_parent:o,u_scale_parent:u,u_buffer_scale:1,u_fade_t:f.mix,u_opacity:f.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(D=p.paint.get("raster-saturation"),D>0?1-1/(1.001-D):-D),u_contrast_factor:(_=p.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:Vl(p.paint.get("raster-hue-rotate"))};var _,D};function Vl(v){v*=Math.PI/180;const o=Math.sin(v),u=Math.cos(v);return[(2*u+1)/3,(-Math.sqrt(3)*o-u+1)/3,(Math.sqrt(3)*o-u+1)/3]}const Hs=(v,o,u,f,p,_,D,S,A,R,B,L,W,Q)=>{const ne=D.transform;return{u_is_size_zoom_constant:+("constant"===v||"source"===v),u_is_size_feature_constant:+("constant"===v||"camera"===v),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:ne.cameraToCenterDistance,u_pitch:ne.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:ne.width/ne.height,u_fade_change:D.options.fadeDuration?D.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:A,u_coord_matrix:R,u_is_text:+L,u_pitch_with_map:+f,u_is_along_line:p,u_is_variable_anchor:_,u_texsize:W,u_texture:0,u_translation:B,u_pitched_scale:Q}},jl=(v,o,u,f,p,_,D,S,A,R,B,L,W,Q,ne)=>{const de=D.transform;return x.e(Hs(v,o,u,f,p,_,D,S,A,R,B,L,W,ne),{u_gamma_scale:f?Math.cos(de._pitch)*de.cameraToCenterDistance:1,u_device_pixel_ratio:D.pixelRatio,u_is_halo:+Q})},Ku=(v,o,u,f,p,_,D,S,A,R,B,L,W,Q)=>x.e(jl(v,o,u,f,p,_,D,S,A,R,B,!0,L,!0,Q),{u_texsize_icon:W,u_texture_icon:1}),Ul=(v,o,u)=>({u_matrix:v,u_opacity:o,u_color:u}),oa=(v,o,u,f,p,_)=>x.e(function(D,S,A,R){const B=A.imageManager.getPattern(D.from.toString()),L=A.imageManager.getPattern(D.to.toString()),{width:W,height:Q}=A.imageManager.getPixelSize(),ne=Math.pow(2,R.tileID.overscaledZ),de=R.tileSize*Math.pow(2,A.transform.tileZoom)/ne,se=de*(R.tileID.canonical.x+R.tileID.wrap*ne),he=de*R.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:L.tl,u_pattern_br_b:L.br,u_texsize:[W,Q],u_mix:S.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:L.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/Dn(R,1,A.transform.tileZoom),u_pixel_coord_upper:[se>>16,he>>16],u_pixel_coord_lower:[65535&se,65535&he]}}(f,_,u,p),{u_matrix:v,u_opacity:o}),ul={fillExtrusion:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_lightpos:new x.aN(v,o.u_lightpos),u_lightintensity:new x.aI(v,o.u_lightintensity),u_lightcolor:new x.aN(v,o.u_lightcolor),u_vertical_gradient:new x.aI(v,o.u_vertical_gradient),u_opacity:new x.aI(v,o.u_opacity)}),fillExtrusionPattern:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_lightpos:new x.aN(v,o.u_lightpos),u_lightintensity:new x.aI(v,o.u_lightintensity),u_lightcolor:new x.aN(v,o.u_lightcolor),u_vertical_gradient:new x.aI(v,o.u_vertical_gradient),u_height_factor:new x.aI(v,o.u_height_factor),u_image:new x.aH(v,o.u_image),u_texsize:new x.aO(v,o.u_texsize),u_pixel_coord_upper:new x.aO(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new x.aO(v,o.u_pixel_coord_lower),u_scale:new x.aN(v,o.u_scale),u_fade:new x.aI(v,o.u_fade),u_opacity:new x.aI(v,o.u_opacity)}),fill:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix)}),fillPattern:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_image:new x.aH(v,o.u_image),u_texsize:new x.aO(v,o.u_texsize),u_pixel_coord_upper:new x.aO(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new x.aO(v,o.u_pixel_coord_lower),u_scale:new x.aN(v,o.u_scale),u_fade:new x.aI(v,o.u_fade)}),fillOutline:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_world:new x.aO(v,o.u_world)}),fillOutlinePattern:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_world:new x.aO(v,o.u_world),u_image:new x.aH(v,o.u_image),u_texsize:new x.aO(v,o.u_texsize),u_pixel_coord_upper:new x.aO(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new x.aO(v,o.u_pixel_coord_lower),u_scale:new x.aN(v,o.u_scale),u_fade:new x.aI(v,o.u_fade)}),circle:(v,o)=>({u_camera_to_center_distance:new x.aI(v,o.u_camera_to_center_distance),u_scale_with_map:new x.aH(v,o.u_scale_with_map),u_pitch_with_map:new x.aH(v,o.u_pitch_with_map),u_extrude_scale:new x.aO(v,o.u_extrude_scale),u_device_pixel_ratio:new x.aI(v,o.u_device_pixel_ratio),u_matrix:new x.aJ(v,o.u_matrix)}),collisionBox:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_pixel_extrude_scale:new x.aO(v,o.u_pixel_extrude_scale)}),collisionCircle:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_inv_matrix:new x.aJ(v,o.u_inv_matrix),u_camera_to_center_distance:new x.aI(v,o.u_camera_to_center_distance),u_viewport_size:new x.aO(v,o.u_viewport_size)}),debug:(v,o)=>({u_color:new x.aL(v,o.u_color),u_matrix:new x.aJ(v,o.u_matrix),u_overlay:new x.aH(v,o.u_overlay),u_overlay_scale:new x.aI(v,o.u_overlay_scale)}),clippingMask:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix)}),heatmap:(v,o)=>({u_extrude_scale:new x.aI(v,o.u_extrude_scale),u_intensity:new x.aI(v,o.u_intensity),u_matrix:new x.aJ(v,o.u_matrix)}),heatmapTexture:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_world:new x.aO(v,o.u_world),u_image:new x.aH(v,o.u_image),u_color_ramp:new x.aH(v,o.u_color_ramp),u_opacity:new x.aI(v,o.u_opacity)}),hillshade:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_image:new x.aH(v,o.u_image),u_latrange:new x.aO(v,o.u_latrange),u_light:new x.aO(v,o.u_light),u_shadow:new x.aL(v,o.u_shadow),u_highlight:new x.aL(v,o.u_highlight),u_accent:new x.aL(v,o.u_accent)}),hillshadePrepare:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_image:new x.aH(v,o.u_image),u_dimension:new x.aO(v,o.u_dimension),u_zoom:new x.aI(v,o.u_zoom),u_unpack:new x.aK(v,o.u_unpack)}),line:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_ratio:new x.aI(v,o.u_ratio),u_device_pixel_ratio:new x.aI(v,o.u_device_pixel_ratio),u_units_to_pixels:new x.aO(v,o.u_units_to_pixels)}),lineGradient:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_ratio:new x.aI(v,o.u_ratio),u_device_pixel_ratio:new x.aI(v,o.u_device_pixel_ratio),u_units_to_pixels:new x.aO(v,o.u_units_to_pixels),u_image:new x.aH(v,o.u_image),u_image_height:new x.aI(v,o.u_image_height)}),linePattern:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_texsize:new x.aO(v,o.u_texsize),u_ratio:new x.aI(v,o.u_ratio),u_device_pixel_ratio:new x.aI(v,o.u_device_pixel_ratio),u_image:new x.aH(v,o.u_image),u_units_to_pixels:new x.aO(v,o.u_units_to_pixels),u_scale:new x.aN(v,o.u_scale),u_fade:new x.aI(v,o.u_fade)}),lineSDF:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_ratio:new x.aI(v,o.u_ratio),u_device_pixel_ratio:new x.aI(v,o.u_device_pixel_ratio),u_units_to_pixels:new x.aO(v,o.u_units_to_pixels),u_patternscale_a:new x.aO(v,o.u_patternscale_a),u_patternscale_b:new x.aO(v,o.u_patternscale_b),u_sdfgamma:new x.aI(v,o.u_sdfgamma),u_image:new x.aH(v,o.u_image),u_tex_y_a:new x.aI(v,o.u_tex_y_a),u_tex_y_b:new x.aI(v,o.u_tex_y_b),u_mix:new x.aI(v,o.u_mix)}),raster:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_tl_parent:new x.aO(v,o.u_tl_parent),u_scale_parent:new x.aI(v,o.u_scale_parent),u_buffer_scale:new x.aI(v,o.u_buffer_scale),u_fade_t:new x.aI(v,o.u_fade_t),u_opacity:new x.aI(v,o.u_opacity),u_image0:new x.aH(v,o.u_image0),u_image1:new x.aH(v,o.u_image1),u_brightness_low:new x.aI(v,o.u_brightness_low),u_brightness_high:new x.aI(v,o.u_brightness_high),u_saturation_factor:new x.aI(v,o.u_saturation_factor),u_contrast_factor:new x.aI(v,o.u_contrast_factor),u_spin_weights:new x.aN(v,o.u_spin_weights)}),symbolIcon:(v,o)=>({u_is_size_zoom_constant:new x.aH(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new x.aH(v,o.u_is_size_feature_constant),u_size_t:new x.aI(v,o.u_size_t),u_size:new x.aI(v,o.u_size),u_camera_to_center_distance:new x.aI(v,o.u_camera_to_center_distance),u_pitch:new x.aI(v,o.u_pitch),u_rotate_symbol:new x.aH(v,o.u_rotate_symbol),u_aspect_ratio:new x.aI(v,o.u_aspect_ratio),u_fade_change:new x.aI(v,o.u_fade_change),u_matrix:new x.aJ(v,o.u_matrix),u_label_plane_matrix:new x.aJ(v,o.u_label_plane_matrix),u_coord_matrix:new x.aJ(v,o.u_coord_matrix),u_is_text:new x.aH(v,o.u_is_text),u_pitch_with_map:new x.aH(v,o.u_pitch_with_map),u_is_along_line:new x.aH(v,o.u_is_along_line),u_is_variable_anchor:new x.aH(v,o.u_is_variable_anchor),u_texsize:new x.aO(v,o.u_texsize),u_texture:new x.aH(v,o.u_texture),u_translation:new x.aO(v,o.u_translation),u_pitched_scale:new x.aI(v,o.u_pitched_scale)}),symbolSDF:(v,o)=>({u_is_size_zoom_constant:new x.aH(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new x.aH(v,o.u_is_size_feature_constant),u_size_t:new x.aI(v,o.u_size_t),u_size:new x.aI(v,o.u_size),u_camera_to_center_distance:new x.aI(v,o.u_camera_to_center_distance),u_pitch:new x.aI(v,o.u_pitch),u_rotate_symbol:new x.aH(v,o.u_rotate_symbol),u_aspect_ratio:new x.aI(v,o.u_aspect_ratio),u_fade_change:new x.aI(v,o.u_fade_change),u_matrix:new x.aJ(v,o.u_matrix),u_label_plane_matrix:new x.aJ(v,o.u_label_plane_matrix),u_coord_matrix:new x.aJ(v,o.u_coord_matrix),u_is_text:new x.aH(v,o.u_is_text),u_pitch_with_map:new x.aH(v,o.u_pitch_with_map),u_is_along_line:new x.aH(v,o.u_is_along_line),u_is_variable_anchor:new x.aH(v,o.u_is_variable_anchor),u_texsize:new x.aO(v,o.u_texsize),u_texture:new x.aH(v,o.u_texture),u_gamma_scale:new x.aI(v,o.u_gamma_scale),u_device_pixel_ratio:new x.aI(v,o.u_device_pixel_ratio),u_is_halo:new x.aH(v,o.u_is_halo),u_translation:new x.aO(v,o.u_translation),u_pitched_scale:new x.aI(v,o.u_pitched_scale)}),symbolTextAndIcon:(v,o)=>({u_is_size_zoom_constant:new x.aH(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new x.aH(v,o.u_is_size_feature_constant),u_size_t:new x.aI(v,o.u_size_t),u_size:new x.aI(v,o.u_size),u_camera_to_center_distance:new x.aI(v,o.u_camera_to_center_distance),u_pitch:new x.aI(v,o.u_pitch),u_rotate_symbol:new x.aH(v,o.u_rotate_symbol),u_aspect_ratio:new x.aI(v,o.u_aspect_ratio),u_fade_change:new x.aI(v,o.u_fade_change),u_matrix:new x.aJ(v,o.u_matrix),u_label_plane_matrix:new x.aJ(v,o.u_label_plane_matrix),u_coord_matrix:new x.aJ(v,o.u_coord_matrix),u_is_text:new x.aH(v,o.u_is_text),u_pitch_with_map:new x.aH(v,o.u_pitch_with_map),u_is_along_line:new x.aH(v,o.u_is_along_line),u_is_variable_anchor:new x.aH(v,o.u_is_variable_anchor),u_texsize:new x.aO(v,o.u_texsize),u_texsize_icon:new x.aO(v,o.u_texsize_icon),u_texture:new x.aH(v,o.u_texture),u_texture_icon:new x.aH(v,o.u_texture_icon),u_gamma_scale:new x.aI(v,o.u_gamma_scale),u_device_pixel_ratio:new x.aI(v,o.u_device_pixel_ratio),u_is_halo:new x.aH(v,o.u_is_halo),u_translation:new x.aO(v,o.u_translation),u_pitched_scale:new x.aI(v,o.u_pitched_scale)}),background:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_opacity:new x.aI(v,o.u_opacity),u_color:new x.aL(v,o.u_color)}),backgroundPattern:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_opacity:new x.aI(v,o.u_opacity),u_image:new x.aH(v,o.u_image),u_pattern_tl_a:new x.aO(v,o.u_pattern_tl_a),u_pattern_br_a:new x.aO(v,o.u_pattern_br_a),u_pattern_tl_b:new x.aO(v,o.u_pattern_tl_b),u_pattern_br_b:new x.aO(v,o.u_pattern_br_b),u_texsize:new x.aO(v,o.u_texsize),u_mix:new x.aI(v,o.u_mix),u_pattern_size_a:new x.aO(v,o.u_pattern_size_a),u_pattern_size_b:new x.aO(v,o.u_pattern_size_b),u_scale_a:new x.aI(v,o.u_scale_a),u_scale_b:new x.aI(v,o.u_scale_b),u_pixel_coord_upper:new x.aO(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new x.aO(v,o.u_pixel_coord_lower),u_tile_units_to_pixels:new x.aI(v,o.u_tile_units_to_pixels)}),terrain:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_texture:new x.aH(v,o.u_texture),u_ele_delta:new x.aI(v,o.u_ele_delta),u_fog_matrix:new x.aJ(v,o.u_fog_matrix),u_fog_color:new x.aL(v,o.u_fog_color),u_fog_ground_blend:new x.aI(v,o.u_fog_ground_blend),u_fog_ground_blend_opacity:new x.aI(v,o.u_fog_ground_blend_opacity),u_horizon_color:new x.aL(v,o.u_horizon_color),u_horizon_fog_blend:new x.aI(v,o.u_horizon_fog_blend)}),terrainDepth:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_ele_delta:new x.aI(v,o.u_ele_delta)}),terrainCoords:(v,o)=>({u_matrix:new x.aJ(v,o.u_matrix),u_texture:new x.aH(v,o.u_texture),u_terrain_coords_id:new x.aI(v,o.u_terrain_coords_id),u_ele_delta:new x.aI(v,o.u_ele_delta)}),sky:(v,o)=>({u_sky_color:new x.aL(v,o.u_sky_color),u_horizon_color:new x.aL(v,o.u_horizon_color),u_horizon:new x.aI(v,o.u_horizon),u_sky_horizon_blend:new x.aI(v,o.u_sky_horizon_blend)})};class N{constructor(o,u,f){this.context=o;const p=o.gl;this.buffer=p.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const K={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ae{constructor(o,u,f,p){this.length=u.length,this.attributes=f,this.itemSize=u.bytesPerElement,this.dynamicDraw=p,this.context=o;const _=o.gl;this.buffer=_.createBuffer(),o.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,u){for(let f=0;f<this.attributes.length;f++){const p=u.attributes[this.attributes[f].name];void 0!==p&&o.enableVertexAttribArray(p)}}setVertexAttribPointers(o,u,f){for(let p=0;p<this.attributes.length;p++){const _=this.attributes[p],D=u.attributes[_.name];void 0!==D&&o.vertexAttribPointer(D,_.components,o[K[_.type]],!1,this.itemSize,_.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const pe=new WeakMap;function _e(v){var o;if(pe.has(v))return pe.get(v);{const u=null===(o=v.getParameter(v.VERSION))||void 0===o?void 0:o.startsWith("WebGL 2.0");return pe.set(v,u),u}}class xe{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ot extends xe{getDefault(){return x.aM.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class _t extends xe{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Pe extends xe{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class yt extends xe{getDefault(){return[!0,!0,!0,!0]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Rt extends xe{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class nn extends xe{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class An extends xe{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Bn extends xe{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Li extends xe{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}}class Ji extends xe{getDefault(){return[0,1]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Sr extends xe{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}}class Qi extends xe{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Fr extends xe{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}}class Hl extends xe{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Ln extends xe{getDefault(){return x.aM.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Ec extends xe{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class Yu extends xe{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}}class Io extends xe{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class dl extends xe{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class za extends xe{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class Xi extends xe{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Wd extends xe{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Ic extends xe{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class ln extends xe{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Sc extends xe{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Tc extends xe{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class ql extends xe{getDefault(){return null}set(o){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class sa extends xe{getDefault(){return null}set(o){var u;if(o===this.current&&!this.dirty)return;const f=this.gl;_e(f)?f.bindVertexArray(o):null===(u=f.getExtension("OES_vertex_array_object"))||void 0===u||u.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class Ac extends xe{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class ks extends xe{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Ju extends xe{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Mc extends xe{constructor(o,u){super(o),this.context=o,this.parent=u}getDefault(){return null}}class Qu extends Mc{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Zd extends Mc{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class ed extends Mc{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Rs{constructor(o,u,f,p,_){this.context=o,this.width=u,this.height=f;const D=o.gl,S=this.framebuffer=D.createFramebuffer();if(this.colorAttachment=new Qu(o,S),p)this.depthAttachment=_?new ed(o,S):new Zd(o,S);else if(_)throw new Error("Stencil cannot be set without depth");if(D.checkFramebufferStatus(D.FRAMEBUFFER)!==D.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const o=this.context.gl,u=this.colorAttachment.get();if(u&&o.deleteTexture(u),this.depthAttachment){const f=this.depthAttachment.get();f&&o.deleteRenderbuffer(f)}o.deleteFramebuffer(this.framebuffer)}}class xr{constructor(o,u,f){this.blendFunction=o,this.blendColor=u,this.mask=f}}xr.Replace=[1,0],xr.disabled=new xr(xr.Replace,x.aM.transparent,[!1,!1,!1,!1]),xr.unblended=new xr(xr.Replace,x.aM.transparent,[!0,!0,!0,!0]),xr.alphaBlended=new xr([1,771],x.aM.transparent,[!0,!0,!0,!0]);class Pc{constructor(o){var u,f;if(this.gl=o,this.clearColor=new ot(this),this.clearDepth=new _t(this),this.clearStencil=new Pe(this),this.colorMask=new yt(this),this.depthMask=new Rt(this),this.stencilMask=new nn(this),this.stencilFunc=new An(this),this.stencilOp=new Bn(this),this.stencilTest=new Li(this),this.depthRange=new Ji(this),this.depthTest=new Sr(this),this.depthFunc=new Qi(this),this.blend=new Fr(this),this.blendFunc=new Hl(this),this.blendColor=new Ln(this),this.blendEquation=new Ec(this),this.cullFace=new Yu(this),this.cullFaceSide=new Io(this),this.frontFace=new dl(this),this.program=new za(this),this.activeTexture=new Xi(this),this.viewport=new Wd(this),this.bindFramebuffer=new Ic(this),this.bindRenderbuffer=new ln(this),this.bindTexture=new Sc(this),this.bindVertexBuffer=new Tc(this),this.bindElementBuffer=new ql(this),this.bindVertexArray=new sa(this),this.pixelStoreUnpack=new Ac(this),this.pixelStoreUnpackPremultiplyAlpha=new ks(this),this.pixelStoreUnpackFlipY=new Ju(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),_e(o)){this.HALF_FLOAT=o.HALF_FLOAT;const p=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(u=o.RGBA16F)&&void 0!==u?u:p?.RGBA16F_EXT,this.RGB16F=null!==(f=o.RGB16F)&&void 0!==f?f:p?.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const p=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=p?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,u){return new N(this,o,u)}createVertexBuffer(o,u,f){return new ae(this,o,u,f)}createRenderbuffer(o,u,f){const p=this.gl,_=p.createRenderbuffer();return this.bindRenderbuffer.set(_),p.renderbufferStorage(p.RENDERBUFFER,o,u,f),this.bindRenderbuffer.set(null),_}createFramebuffer(o,u,f,p){return new Rs(this,o,u,f,p)}clear({color:o,depth:u,stencil:f}){const p=this.gl;let _=0;o&&(_|=p.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),void 0!==u&&(_|=p.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),void 0!==f&&(_|=p.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),p.clear(_)}setCullFace(o){!1===o.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){x.aE(o.blendFunction,xr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return _e(this.gl)?this.gl.createVertexArray():null===(o=this.gl.getExtension("OES_vertex_array_object"))||void 0===o?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var u;return _e(this.gl)?this.gl.deleteVertexArray(o):null===(u=this.gl.getExtension("OES_vertex_array_object"))||void 0===u?void 0:u.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}class gi{constructor(o,u,f){this.func=o,this.mask=u,this.range=f}}gi.ReadOnly=!1,gi.ReadWrite=!0,gi.disabled=new gi(519,gi.ReadOnly,[0,1]);class er{constructor(o,u,f,p,_,D){this.test=o,this.ref=u,this.mask=f,this.fail=p,this.depthFail=_,this.pass=D}}er.disabled=new er({func:519,mask:0},0,0,7680,7680,7680);class tr{constructor(o,u,f){this.enable=o,this.mode=u,this.frontFace=f}}let aa;function hu(v,o,u,f,p){const _=v.context,D=_.gl,S=v.useProgram("collisionBox"),A=[];let R=0,B=0;for(let he=0;he<f.length;he++){const Ee=f[he],oe=o.getTile(Ee).getBucket(u);if(!oe)continue;const Me=p?oe.textCollisionBox:oe.iconCollisionBox,Oe=oe.collisionCircleArray;if(Oe.length>0){const Be=x.H();x.aQ(Be,oe.placementInvProjMatrix,v.transform.glCoordMatrix),x.aQ(Be,Be,oe.placementViewportMatrix),A.push({circleArray:Oe,circleOffset:B,transform:Ee.posMatrix,invTransform:Be,coord:Ee}),R+=Oe.length/4,B=R}Me&&S.draw(_,D.LINES,gi.disabled,er.disabled,v.colorModeForRenderPass(),tr.disabled,{u_matrix:Ee.posMatrix,u_pixel_extrude_scale:[1/(L=v.transform).width,1/L.height]},v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ee),u.id,Me.layoutVertexBuffer,Me.indexBuffer,Me.segments,null,v.transform.zoom,null,null,Me.collisionVertexBuffer)}var L;if(!p||!A.length)return;const W=v.useProgram("collisionCircle"),Q=new x.aR;Q.resize(4*R),Q._trim();let ne=0;for(const he of A)for(let Ee=0;Ee<he.circleArray.length/4;Ee++){const oe=4*Ee,Me=he.circleArray[oe+0],Oe=he.circleArray[oe+1],Be=he.circleArray[oe+2],ft=he.circleArray[oe+3];Q.emplace(ne++,Me,Oe,Be,ft,0),Q.emplace(ne++,Me,Oe,Be,ft,1),Q.emplace(ne++,Me,Oe,Be,ft,2),Q.emplace(ne++,Me,Oe,Be,ft,3)}(!aa||aa.length<2*R)&&(aa=function(he){const Ee=2*he,oe=new x.aT;oe.resize(Ee),oe._trim();for(let Me=0;Me<Ee;Me++){const Oe=6*Me;oe.uint16[Oe+0]=4*Me+0,oe.uint16[Oe+1]=4*Me+1,oe.uint16[Oe+2]=4*Me+2,oe.uint16[Oe+3]=4*Me+2,oe.uint16[Oe+4]=4*Me+3,oe.uint16[Oe+5]=4*Me+0}return oe}(R));const de=_.createIndexBuffer(aa,!0),se=_.createVertexBuffer(Q,x.aS.members,!0);for(const he of A){const Ee=xc(he.transform,he.invTransform,v.transform);W.draw(_,D.TRIANGLES,gi.disabled,er.disabled,v.colorModeForRenderPass(),tr.disabled,Ee,v.style.map.terrain&&v.style.map.terrain.getTerrainData(he.coord),u.id,se,de,x.a0.simpleSegment(0,2*he.circleOffset,he.circleArray.length,he.circleArray.length/2),null,v.transform.zoom,null,null,null)}se.destroy(),de.destroy()}tr.disabled=new tr(!1,1029,2305),tr.backCCW=new tr(!0,1029,2305);const Jo=x.an(new Float32Array(16));function Rc(v,o,u,f,p,_){const{horizontalAlign:D,verticalAlign:S}=x.au(v);return new x.P((-(D-.5)*o/p+f[0])*_,(-(S-.5)*u/p+f[1])*_)}function Ht(v,o,u,f,p,_){const D=o.tileAnchorPoint.add(new x.P(o.translation[0],o.translation[1]));if(o.pitchWithMap){let S=f.mult(_);return u||(S=S.rotate(-p)),ue(D.add(S),o.labelPlaneMatrix,o.getElevation).point}if(u){const S=$e(o.tileAnchorPoint.x+1,o.tileAnchorPoint.y,o).point.sub(v),A=Math.atan(S.y/S.x)+(S.x<0?Math.PI:0);return v.add(f.rotate(A))}return v.add(f)}function Gl(v,o,u,f,p,_,D,S,A,R,B,L,W,Q){const ne=v.text.placedSymbolArray,de=v.text.dynamicLayoutVertexArray,se=v.icon.dynamicLayoutVertexArray,he={};de.clear();for(let Ee=0;Ee<ne.length;Ee++){const oe=ne.get(Ee),Me=oe.hidden||!oe.crossTileID||v.allowVerticalPlacement&&!oe.placedOrientation?null:f[oe.crossTileID];if(Me){const Oe=new x.P(oe.anchorX,oe.anchorY),Be={getElevation:Q,width:p.width,height:p.height,labelPlaneMatrix:_,lineVertexArray:null,pitchWithMap:u,projection:B,projectionCache:null,tileAnchorPoint:Oe,translation:L,unwrappedTileID:W},ft=u?ue(Oe,D,Q):$e(Oe.x,Oe.y,Be),Tt=U(p.cameraToCenterDistance,ft.signedDistanceFromCamera);let cn=x.ai(v.textSizeData,A,oe)*Tt/x.ap;u&&(cn*=v.tilePixelRatio/S);const{width:sn,height:At,anchor:zt,textOffset:Cn,textBoxScale:Jn}=Me,Vt=Rc(zt,sn,At,Cn,Jn,cn),Xt=B.getPitchedTextCorrection(p,Oe.add(new x.P(L[0],L[1])),W),zn=Ht(ft.point,Be,o,Vt,p.angle,Xt),pr=v.allowVerticalPlacement&&oe.placedOrientation===x.ah.vertical?Math.PI/2:0;for(let yi=0;yi<oe.numGlyphs;yi++)x.aj(de,zn,pr);R&&oe.associatedIconIndex>=0&&(he[oe.associatedIconIndex]={shiftedAnchor:zn,angle:pr})}else tn(oe.numGlyphs,de)}if(R){se.clear();const Ee=v.icon.placedSymbolArray;for(let oe=0;oe<Ee.length;oe++){const Me=Ee.get(oe);if(Me.hidden)tn(Me.numGlyphs,se);else{const Oe=he[oe];if(Oe)for(let Be=0;Be<Me.numGlyphs;Be++)x.aj(se,Oe.shiftedAnchor,Oe.angle);else tn(Me.numGlyphs,se)}}v.icon.dynamicLayoutVertexBuffer.updateData(se)}v.text.dynamicLayoutVertexBuffer.updateData(de)}function Ft(v,o,u){return u.iconsInText&&o?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function ds(v,o,u,f,p,_,D,S,A,R,B,L){const W=v.context,Q=W.gl,ne=v.transform,de=ii(),se="map"===S,he="map"===A,Ee="viewport"!==S&&"point"!==u.layout.get("symbol-placement"),oe=se&&!he&&!Ee,Me=!he&&Ee,Oe=!u.layout.get("symbol-sort-key").isConstant();let Be=!1;const ft=v.depthModeForSublayer(0,gi.ReadOnly),Tt=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),cn=[],sn=de.getCircleRadiusCorrection(ne);for(const At of f){const zt=o.getTile(At),Cn=zt.getBucket(u);if(!Cn)continue;const Jn=p?Cn.text:Cn.icon;if(!Jn||!Jn.segments.get().length||!Jn.hasVisibleVertices)continue;const Vt=Jn.programConfigurations.get(u.id),Xt=p||Cn.sdfIcons,zn=p?Cn.textSizeData:Cn.iconSizeData,pr=he||0!==ne.pitch,yi=v.useProgram(Ft(Xt,p,Cn),Vt),Ai=x.ag(zn,ne.zoom),Lr=v.style.map.terrain&&v.style.map.terrain.getTerrainData(At);let Vo,ha,Ar,is,Ro=[0,0],jo=null;if(p)ha=zt.glyphAtlasTexture,Ar=Q.LINEAR,Vo=zt.glyphAtlasTexture.size,Cn.iconsInText&&(Ro=zt.imageAtlasTexture.size,jo=zt.imageAtlasTexture,is=pr||v.options.rotating||v.options.zooming||"composite"===zn.kind||"camera"===zn.kind?Q.LINEAR:Q.NEAREST);else{const Bi=1!==u.layout.get("icon-size").constantOr(0)||Cn.iconsNeedLinear;ha=zt.imageAtlasTexture,Ar=Xt||v.options.rotating||v.options.zooming||Bi||pr?Q.LINEAR:Q.NEAREST,Vo=zt.imageAtlasTexture.size}const To=Dn(zt,1,v.transform.zoom),ys=Me?At.posMatrix:Jo,jc=Zr(ys,he,se,v.transform,To),gu=io(ys,he,se,v.transform,To),xl=io(At.posMatrix,he,se,v.transform,To),Za=de.translatePosition(v.transform,zt,_,D),rd=Tt&&Cn.hasTextData(),Yd="none"!==u.layout.get("icon-text-fit")&&rd&&Cn.hasIconData();if(Ee){const Bi=v.style.map.terrain?(Dl,yu)=>v.style.map.terrain.getElevation(At,Dl,yu):null,nc="map"===u.layout.get("text-rotation-alignment");J(Cn,At.posMatrix,v,p,jc,xl,he,R,nc,de,At.toUnwrapped(),ne.width,ne.height,Za,Bi)}const Gs=At.posMatrix,Ws=p&&Tt||Yd,Cl=Ee||Ws?Jo:jc,Zs=gu,rs=Xt&&0!==u.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1);let os;os=Xt?Cn.iconsInText?Ku(zn.kind,Ai,oe,he,Ee,Ws,v,Gs,Cl,Zs,Za,Vo,Ro,sn):jl(zn.kind,Ai,oe,he,Ee,Ws,v,Gs,Cl,Zs,Za,p,Vo,!0,sn):Hs(zn.kind,Ai,oe,he,Ee,Ws,v,Gs,Cl,Zs,Za,p,Vo,sn);const Ls={program:yi,buffers:Jn,uniformValues:os,atlasTexture:ha,atlasTextureIcon:jo,atlasInterpolation:Ar,atlasInterpolationIcon:is,isSDF:Xt,hasHalo:rs};if(Oe&&Cn.canOverlap){Be=!0;const Bi=Jn.segments.get();for(const nc of Bi)cn.push({segments:new x.a0([nc]),sortKey:nc.sortKey,state:Ls,terrainData:Lr})}else cn.push({segments:Jn.segments,sortKey:0,state:Ls,terrainData:Lr})}Be&&cn.sort((At,zt)=>At.sortKey-zt.sortKey);for(const At of cn){const zt=At.state;if(W.activeTexture.set(Q.TEXTURE0),zt.atlasTexture.bind(zt.atlasInterpolation,Q.CLAMP_TO_EDGE),zt.atlasTextureIcon&&(W.activeTexture.set(Q.TEXTURE1),zt.atlasTextureIcon&&zt.atlasTextureIcon.bind(zt.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),zt.isSDF){const Cn=zt.uniformValues;zt.hasHalo&&(Cn.u_is_halo=1,ho(zt.buffers,At.segments,u,v,zt.program,ft,B,L,Cn,At.terrainData)),Cn.u_is_halo=0}ho(zt.buffers,At.segments,u,v,zt.program,ft,B,L,zt.uniformValues,At.terrainData)}}function ho(v,o,u,f,p,_,D,S,A,R){const B=f.context;p.draw(B,B.gl.TRIANGLES,_,D,S,tr.disabled,A,R,u.id,v.layoutVertexBuffer,v.indexBuffer,o,u.paint,f.transform.zoom,v.programConfigurations.get(u.id),v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer)}function $a(v,o,u,f,p){if(!u||!f||!f.imageAtlas)return;const _=f.imageAtlas.patternPositions;let D=_[u.to.toString()],S=_[u.from.toString()];if(!D&&S&&(D=S),!S&&D&&(S=D),!D||!S){const A=p.getPaintProperty(o);D=_[A],S=_[A]}D&&S&&v.setConstantPatternPositions(D,S)}function Oc(v,o,u,f,p,_,D){const S=v.context.gl,A="fill-pattern",R=u.paint.get(A),B=R&&R.constantOr(1),L=u.getCrossfadeParameters();let W,Q,ne,de,se;D?(Q=B&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",W=S.LINES):(Q=B?"fillPattern":"fill",W=S.TRIANGLES);const he=R.constantOr(null);for(const Ee of f){const oe=o.getTile(Ee);if(B&&!oe.patternsLoaded())continue;const Me=oe.getBucket(u);if(!Me)continue;const Oe=Me.programConfigurations.get(u.id),Be=v.useProgram(Q,Oe),ft=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ee);B&&(v.context.activeTexture.set(S.TEXTURE0),oe.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),Oe.updatePaintBuffers(L)),$a(Oe,A,he,oe,u);const Tt=ft?Ee:null,cn=v.translatePosMatrix(Tt?Tt.posMatrix:Ee.posMatrix,oe,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(D){de=Me.indexBuffer2,se=Me.segments2;const sn=[S.drawingBufferWidth,S.drawingBufferHeight];ne="fillOutlinePattern"===Q&&B?al(cn,v,L,oe,sn):zl(cn,sn)}else de=Me.indexBuffer,se=Me.segments,ne=B?Un(cn,v,L,oe):Fi(cn);Be.draw(v.context,W,p,v.stencilModeForClipping(Ee),_,tr.disabled,ne,ft,u.id,Me.layoutVertexBuffer,de,se,u.paint,v.transform.zoom,Oe)}}function hl(v,o,u,f,p,_,D){const S=v.context,A=S.gl,R="fill-extrusion-pattern",B=u.paint.get(R),L=B.constantOr(1),W=u.getCrossfadeParameters(),Q=u.paint.get("fill-extrusion-opacity"),ne=B.constantOr(null);for(const de of f){const se=o.getTile(de),he=se.getBucket(u);if(!he)continue;const Ee=v.style.map.terrain&&v.style.map.terrain.getTerrainData(de),oe=he.programConfigurations.get(u.id),Me=v.useProgram(L?"fillExtrusionPattern":"fillExtrusion",oe);L&&(v.context.activeTexture.set(A.TEXTURE0),se.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),oe.updatePaintBuffers(W)),$a(oe,R,ne,se,u);const Oe=v.translatePosMatrix(de.posMatrix,se,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Be=u.paint.get("fill-extrusion-vertical-gradient"),ft=L?fr(Oe,v,Be,Q,de,W,se):Yo(Oe,v,Be,Q);Me.draw(S,S.gl.TRIANGLES,p,_,D,tr.backCCW,ft,Ee,u.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,u.paint,v.transform.zoom,oe,v.style.map.terrain&&he.centroidVertexBuffer)}}function Ca(v,o,u,f,p,_,D){const S=v.context,A=S.gl,R=u.fbo;if(!R)return;const B=v.useProgram("hillshade"),L=v.style.map.terrain&&v.style.map.terrain.getTerrainData(o);S.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,R.colorAttachment.get()),B.draw(S,A.TRIANGLES,p,_,D,tr.disabled,((W,Q,ne,de)=>{const se=ne.paint.get("hillshade-shadow-color"),he=ne.paint.get("hillshade-highlight-color"),Ee=ne.paint.get("hillshade-accent-color");let oe=ne.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ne.paint.get("hillshade-illumination-anchor")&&(oe-=W.transform.angle);const Me=!W.options.moving;return{u_matrix:de?de.posMatrix:W.transform.calculatePosMatrix(Q.tileID.toUnwrapped(),Me),u_image:0,u_latrange:ai(0,Q.tileID),u_light:[ne.paint.get("hillshade-exaggeration"),oe],u_shadow:se,u_highlight:he,u_accent:Ee}})(v,u,f,L?o:null),L,f.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}function Qo(v,o,u,f,p,_){const D=v.context,S=D.gl,A=o.dem;if(A&&A.data){const R=A.dim,B=A.stride,L=A.getPixels();if(D.activeTexture.set(S.TEXTURE1),D.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||v.getTileTexture(B),o.demTexture){const Q=o.demTexture;Q.update(L,{premultiply:!1}),Q.bind(S.NEAREST,S.CLAMP_TO_EDGE)}else o.demTexture=new Je(D,L,S.RGBA,{premultiply:!1}),o.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);D.activeTexture.set(S.TEXTURE0);let W=o.fbo;if(!W){const Q=new Je(D,{width:R,height:R,data:null},S.RGBA);Q.bind(S.LINEAR,S.CLAMP_TO_EDGE),W=o.fbo=D.createFramebuffer(R,R,!0,!1),W.colorAttachment.set(Q.texture)}D.bindFramebuffer.set(W.framebuffer),D.viewport.set([0,0,R,R]),v.useProgram("hillshadePrepare").draw(D,S.TRIANGLES,f,p,_,tr.disabled,((Q,ne)=>{const de=ne.stride,se=x.H();return x.aP(se,0,x.X,-x.X,0,0,1),x.J(se,se,[0,-x.X,0]),{u_matrix:se,u_image:1,u_dimension:[de,de],u_zoom:Q.overscaledZ,u_unpack:ne.getUnpackVector()}})(o.tileID,A),null,u.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function Da(v,o,u,f,p,_){const D=f.paint.get("raster-fade-duration");if(!_&&D>0){const S=Ae.now(),A=(S-v.timeAdded)/D,R=o?(S-o.timeAdded)/D:-1,B=u.getSource(),L=p.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),W=!o||Math.abs(o.tileID.overscaledZ-L)>Math.abs(v.tileID.overscaledZ-L),Q=W&&v.refreshedUponExpiration?1:x.ac(W?A:1-R,0,1);return v.refreshedUponExpiration&&A>=1&&(v.refreshedUponExpiration=!1),o?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}const yo=new x.aM(1,0,0,1),zo=new x.aM(0,1,0,1),Ni=new x.aM(0,0,1,1),qs=new x.aM(1,0,1,1),es=new x.aM(0,1,1,1);function Wl(v,o,u,f){li(v,0,o+u/2,v.transform.width,u,f)}function Zl(v,o,u,f){li(v,o-u/2,0,u,v.transform.height,f)}function li(v,o,u,f,p,_){const D=v.context,S=D.gl;S.enable(S.SCISSOR_TEST),S.scissor(o*v.pixelRatio,u*v.pixelRatio,f*v.pixelRatio,p*v.pixelRatio),D.clear({color:_}),S.disable(S.SCISSOR_TEST)}function la(v,o,u){const f=v.context,p=f.gl,_=u.posMatrix,D=v.useProgram("debug"),S=gi.disabled,A=er.disabled,R=v.colorModeForRenderPass(),B="$debug",L=v.style.map.terrain&&v.style.map.terrain.getTerrainData(u);f.activeTexture.set(p.TEXTURE0);const W=o.getTileByID(u.key).latestRawTileData,Q=Math.floor((W&&W.byteLength||0)/1024),ne=o.getTile(u).tileSize,de=512/Math.min(ne,512)*(u.overscaledZ/v.transform.zoom)*.5;let se=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(se+=` => ${u.overscaledZ}`),function(he,Ee){he.initDebugOverlayCanvas();const oe=he.debugOverlayCanvas,Me=he.context.gl,Oe=he.debugOverlayCanvas.getContext("2d");Oe.clearRect(0,0,oe.width,oe.height),Oe.shadowColor="white",Oe.shadowBlur=2,Oe.lineWidth=1.5,Oe.strokeStyle="white",Oe.textBaseline="top",Oe.font="bold 36px Open Sans, sans-serif",Oe.fillText(Ee,5,5),Oe.strokeText(Ee,5,5),he.debugOverlayTexture.update(oe),he.debugOverlayTexture.bind(Me.LINEAR,Me.CLAMP_TO_EDGE)}(v,`${se} ${Q}kB`),D.draw(f,p.TRIANGLES,S,A,xr.alphaBlended,tr.disabled,qe(_,x.aM.transparent,de),null,B,v.debugBuffer,v.quadTriangleIndexBuffer,v.debugSegments),D.draw(f,p.LINE_STRIP,S,A,R,tr.disabled,qe(_,x.aM.red),L,B,v.debugBuffer,v.tileBorderIndexBuffer,v.debugSegments)}function Fc(v,o,u){const f=v.context,p=f.gl,_=v.colorModeForRenderPass(),D=new gi(p.LEQUAL,gi.ReadWrite,v.depthRangeFor3D),S=v.useProgram("terrain"),A=o.getTerrainMesh();f.bindFramebuffer.set(null),f.viewport.set([0,0,v.width,v.height]);for(const R of u){const B=v.renderToTexture.getTexture(R),L=o.getTerrainData(R.tileID);f.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,B.texture);const W=v.transform.calculatePosMatrix(R.tileID.toUnwrapped()),Q=o.getMeshFrameDelta(v.transform.zoom),ne=v.transform.calculateFogMatrix(R.tileID.toUnwrapped()),de=Bl(W,Q,ne,v.style.sky,v.transform.pitch);S.draw(f,p.TRIANGLES,D,er.disabled,_,tr.backCCW,de,L,"terrain",A.vertexBuffer,A.indexBuffer,A.segments)}}class Xl{constructor(o,u,f){this.vertexBuffer=o,this.indexBuffer=u,this.segments=f}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class Va{constructor(o,u){this.context=new Pc(o),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:x.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=In.maxUnderzooming+In.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Vi}resize(o,u,f){if(this.width=Math.floor(o*f),this.height=Math.floor(u*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style._order)this.style._layers[p].resize()}setup(){const o=this.context,u=new x.aW;u.emplaceBack(0,0),u.emplaceBack(x.X,0),u.emplaceBack(0,x.X),u.emplaceBack(x.X,x.X),this.tileExtentBuffer=o.createVertexBuffer(u,wa.members),this.tileExtentSegments=x.a0.simpleSegment(0,0,4,2);const f=new x.aW;f.emplaceBack(0,0),f.emplaceBack(x.X,0),f.emplaceBack(0,x.X),f.emplaceBack(x.X,x.X),this.debugBuffer=o.createVertexBuffer(f,wa.members),this.debugSegments=x.a0.simpleSegment(0,0,4,5);const p=new x.$;p.emplaceBack(0,0,0,0),p.emplaceBack(x.X,0,x.X,0),p.emplaceBack(0,x.X,0,x.X),p.emplaceBack(x.X,x.X,x.X,x.X),this.rasterBoundsBuffer=o.createVertexBuffer(p,Ne.members),this.rasterBoundsSegments=x.a0.simpleSegment(0,0,4,2);const _=new x.aW;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(_,wa.members),this.viewportSegments=x.a0.simpleSegment(0,0,4,2);const D=new x.aY;D.emplaceBack(0),D.emplaceBack(1),D.emplaceBack(3),D.emplaceBack(2),D.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(D);const S=new x.aX;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(S);const A=this.context.gl;this.stencilClearMode=new er({func:A.ALWAYS,mask:0},0,255,A.ZERO,A.ZERO,A.ZERO)}clearStencil(){const o=this.context,u=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=x.H();x.aP(f,0,this.width,this.height,0,0,1),x.K(f,f,[u.drawingBufferWidth,u.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,u.TRIANGLES,gi.disabled,this.stencilClearMode,xr.disabled,tr.disabled,Ps(f),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,u){if(this.currentStencilSource===o.source||!o.isTileClipped()||!u||!u.length)return;this.currentStencilSource=o.source;const f=this.context,p=f.gl;this.nextStencilID+u.length>256&&this.clearStencil(),f.setColorMode(xr.disabled),f.setDepthMode(gi.disabled);const _=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const D of u){const S=this._tileClippingMaskIDs[D.key]=this.nextStencilID++,A=this.style.map.terrain&&this.style.map.terrain.getTerrainData(D);_.draw(f,p.TRIANGLES,gi.disabled,new er({func:p.ALWAYS,mask:0},S,255,p.KEEP,p.KEEP,p.REPLACE),xr.disabled,tr.disabled,Ps(D.posMatrix),A,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,u=this.context.gl;return new er({func:u.NOTEQUAL,mask:255},o,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(o){const u=this.context.gl;return new er({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(o){const u=this.context.gl,f=o.sort((D,S)=>S.overscaledZ-D.overscaledZ),p=f[f.length-1].overscaledZ,_=f[0].overscaledZ-p+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();const D={};for(let S=0;S<_;S++)D[S+p]=new er({func:u.GEQUAL,mask:255},S+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=_,[D,f]}return[{[p]:er.disabled},f]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new xr([o.CONSTANT_COLOR,o.ONE],new x.aM(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?xr.unblended:xr.alphaBlended}depthModeForSublayer(o,u,f){if(!this.opaquePassEnabledForLayer())return gi.disabled;const p=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new gi(f||this.context.gl.LEQUAL,u,[p,p])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,u){this.style=o,this.options=u,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(Ae.now()),this.imageManager.beginFrame();const f=this.style._order,p=this.style.sourceCaches,_={},D={},S={};for(const A in p){const R=p[A];R.used&&R.prepare(this.context),_[A]=R.getVisibleCoordinates(),D[A]=_[A].slice().reverse(),S[A]=R.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let A=0;A<f.length;A++)if(this.style._layers[f[A]].is3D()){this.opaquePassCutoff=A;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const A of f){const R=this.style._layers[A];if(!R.hasOffscreenPass()||R.isHidden(this.transform.zoom))continue;const B=D[R.source];("custom"===R.type||B.length)&&this.renderLayer(this,p[R.source],R,B)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?x.aM.black:x.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(A,R){const B=A.context,L=B.gl,W=(Ee=A.style.map.transform,oe=A.pixelRatio,{u_sky_color:(he=R).properties.get("sky-color"),u_horizon_color:he.properties.get("horizon-color"),u_horizon:(Ee.height/2+Ee.getHorizon())*oe,u_sky_horizon_blend:he.properties.get("sky-horizon-blend")*Ee.height/2*oe}),Q=new gi(L.LEQUAL,gi.ReadWrite,[0,1]),ne=er.disabled,de=A.colorModeForRenderPass(),se=A.useProgram("sky");var he,Ee,oe;if(!R.mesh){const he=new x.aW;he.emplaceBack(-1,-1),he.emplaceBack(1,-1),he.emplaceBack(1,1),he.emplaceBack(-1,1);const Ee=new x.aX;Ee.emplaceBack(0,1,2),Ee.emplaceBack(0,2,3),R.mesh=new Xl(B.createVertexBuffer(he,wa.members),B.createIndexBuffer(Ee),x.a0.simpleSegment(0,0,he.length,Ee.length))}se.draw(B,L.TRIANGLES,Q,ne,de,tr.disabled,W,void 0,"sky",R.mesh.vertexBuffer,R.mesh.indexBuffer,R.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=f.length-1;this.currentLayer>=0;this.currentLayer--){const A=this.style._layers[f[this.currentLayer]],R=p[A.source],B=_[A.source];this._renderTileClippingMasks(A,B),this.renderLayer(this,R,A,B)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<f.length;this.currentLayer++){const A=this.style._layers[f[this.currentLayer]],R=p[A.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(A))continue;const B=("symbol"===A.type?S:D)[A.source];this._renderTileClippingMasks(A,_[A.source]),this.renderLayer(this,R,A,B)}if(this.options.showTileBoundaries){const A=function(R,B){let L=null;const W=Object.values(R._layers).flatMap(se=>se.source&&!se.isHidden(B)?[R.sourceCaches[se.source]]:[]),Q=W.filter(se=>"vector"===se.getSource().type),ne=W.filter(se=>"vector"!==se.getSource().type),de=se=>{(!L||L.getSource().maxzoom<se.getSource().maxzoom)&&(L=se)};return Q.forEach(se=>de(se)),L||ne.forEach(se=>de(se)),L}(this.style,this.transform.zoom);A&&function(R,B,L){for(let W=0;W<L.length;W++)la(R,B,L[W])}(this,A,A.getVisibleCoordinates())}this.options.showPadding&&function(A){const R=A.transform.padding;Wl(A,A.transform.height-(R.top||0),3,yo),Wl(A,R.bottom||0,3,zo),Zl(A,R.left||0,3,Ni),Zl(A,A.transform.width-(R.right||0),3,qs);const B=A.transform.centerPoint;var L,W,Q,ne;li(L=A,(W=B.x)-1,(Q=A.transform.height-B.y)-10,2,20,ne=es),li(L,W-10,Q-1,20,2,ne)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(o){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix;let p=this.terrainFacilitator.dirty;p||(p=o?!x.aZ(u,f):!x.a_(u,f)),p||(p=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),p&&(x.a$(u,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(_,D){const S=_.context,A=S.gl,R=xr.unblended,B=new gi(A.LEQUAL,gi.ReadWrite,[0,1]),L=D.getTerrainMesh(),W=D.sourceCache.getRenderableTiles(),Q=_.useProgram("terrainDepth");S.bindFramebuffer.set(D.getFramebuffer("depth").framebuffer),S.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),S.clear({color:x.aM.transparent,depth:1});for(const ne of W){const de=D.getTerrainData(ne.tileID),se={u_matrix:_.transform.calculatePosMatrix(ne.tileID.toUnwrapped()),u_ele_delta:D.getMeshFrameDelta(_.transform.zoom)};Q.draw(S,A.TRIANGLES,B,er.disabled,R,tr.backCCW,se,de,"terrain",L.vertexBuffer,L.indexBuffer,L.segments)}S.bindFramebuffer.set(null),S.viewport.set([0,0,_.width,_.height])}(this,this.style.map.terrain),function(_,D){const S=_.context,A=S.gl,R=xr.unblended,B=new gi(A.LEQUAL,gi.ReadWrite,[0,1]),L=D.getTerrainMesh(),W=D.getCoordsTexture(),Q=D.sourceCache.getRenderableTiles(),ne=_.useProgram("terrainCoords");S.bindFramebuffer.set(D.getFramebuffer("coords").framebuffer),S.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),S.clear({color:x.aM.transparent,depth:1}),D.coordsIndex=[];for(const de of Q){const se=D.getTerrainData(de.tileID);S.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,W.texture);const he={u_matrix:_.transform.calculatePosMatrix(de.tileID.toUnwrapped()),u_terrain_coords_id:(255-D.coordsIndex.length)/255,u_texture:0,u_ele_delta:D.getMeshFrameDelta(_.transform.zoom)};ne.draw(S,A.TRIANGLES,B,er.disabled,R,tr.backCCW,he,se,"terrain",L.vertexBuffer,L.indexBuffer,L.segments),D.coordsIndex.push(de.tileID.key)}S.bindFramebuffer.set(null),S.viewport.set([0,0,_.width,_.height])}(this,this.style.map.terrain))}renderLayer(o,u,f,p){if(!f.isHidden(this.transform.zoom)&&("background"===f.type||"custom"===f.type||(p||[]).length))switch(this.id=f.id,f.type){case"symbol":!function(_,D,S,A,R){if("translucent"!==_.renderPass)return;const B=er.disabled,L=_.colorModeForRenderPass();(S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(W,Q,ne,de,se,he,Ee,oe,Me){const Oe=Q.transform,Be=ii(),ft="map"===se,Tt="map"===he;for(const cn of W){const sn=de.getTile(cn),At=sn.getBucket(ne);if(!At||!At.text||!At.text.segments.get().length)continue;const zt=x.ag(At.textSizeData,Oe.zoom),Cn=Dn(sn,1,Q.transform.zoom),Jn=Zr(cn.posMatrix,Tt,ft,Q.transform,Cn),Vt="none"!==ne.layout.get("icon-text-fit")&&At.hasIconData();if(zt){const Xt=Math.pow(2,Oe.zoom-sn.tileID.overscaledZ),zn=Q.style.map.terrain?(yi,Ai)=>Q.style.map.terrain.getElevation(cn,yi,Ai):null,pr=Be.translatePosition(Oe,sn,Ee,oe);Gl(At,ft,Tt,Me,Oe,Jn,cn.posMatrix,Xt,zt,Vt,Be,pr,cn.toUnwrapped(),zn)}}}(A,_,S,D,S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),R),0!==S.paint.get("icon-opacity").constantOr(1)&&ds(_,D,S,A,!1,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),S.layout.get("icon-rotation-alignment"),S.layout.get("icon-pitch-alignment"),S.layout.get("icon-keep-upright"),B,L),0!==S.paint.get("text-opacity").constantOr(1)&&ds(_,D,S,A,!0,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.layout.get("text-keep-upright"),B,L),D.map.showCollisionBoxes&&(hu(_,D,S,A,!0),hu(_,D,S,A,!1))}(o,u,f,p,this.style.placement.variableOffsets);break;case"circle":!function(_,D,S,A){if("translucent"!==_.renderPass)return;const R=S.paint.get("circle-opacity"),B=S.paint.get("circle-stroke-width"),L=S.paint.get("circle-stroke-opacity"),W=!S.layout.get("circle-sort-key").isConstant();if(0===R.constantOr(1)&&(0===B.constantOr(1)||0===L.constantOr(1)))return;const Q=_.context,ne=Q.gl,de=_.depthModeForSublayer(0,gi.ReadOnly),se=er.disabled,he=_.colorModeForRenderPass(),Ee=[];for(let oe=0;oe<A.length;oe++){const Me=A[oe],Oe=D.getTile(Me),Be=Oe.getBucket(S);if(!Be)continue;const ft=Be.programConfigurations.get(S.id),Tt=_.useProgram("circle",ft),cn=Be.layoutVertexBuffer,sn=Be.indexBuffer,At=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Me),zt={programConfiguration:ft,program:Tt,layoutVertexBuffer:cn,indexBuffer:sn,uniformValues:du(_,Me,Oe,S),terrainData:At};if(W){const Cn=Be.segments.get();for(const Jn of Cn)Ee.push({segments:new x.a0([Jn]),sortKey:Jn.sortKey,state:zt})}else Ee.push({segments:Be.segments,sortKey:0,state:zt})}W&&Ee.sort((oe,Me)=>oe.sortKey-Me.sortKey);for(const oe of Ee){const{programConfiguration:Me,program:Oe,layoutVertexBuffer:Be,indexBuffer:ft,uniformValues:Tt,terrainData:cn}=oe.state;Oe.draw(Q,ne.TRIANGLES,de,se,he,tr.disabled,Tt,cn,S.id,Be,ft,oe.segments,S.paint,_.transform.zoom,Me)}}(o,u,f,p);break;case"heatmap":!function(_,D,S,A){if(0!==S.paint.get("heatmap-opacity"))if("offscreen"===_.renderPass){const R=_.context,B=R.gl,L=er.disabled,W=new xr([B.ONE,B.ONE],x.aM.transparent,[!0,!0,!0,!0]);(function(Q,ne,de){const se=Q.gl;Q.activeTexture.set(se.TEXTURE1),Q.viewport.set([0,0,ne.width/4,ne.height/4]);let he=de.heatmapFbo;if(he)se.bindTexture(se.TEXTURE_2D,he.colorAttachment.get()),Q.bindFramebuffer.set(he.framebuffer);else{const Ee=se.createTexture();se.bindTexture(se.TEXTURE_2D,Ee),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_S,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_T,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MIN_FILTER,se.LINEAR),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MAG_FILTER,se.LINEAR),he=de.heatmapFbo=Q.createFramebuffer(ne.width/4,ne.height/4,!1,!1),function(oe,Me,Oe,Be){var ft,Tt;const cn=oe.gl,sn=null!==(ft=oe.HALF_FLOAT)&&void 0!==ft?ft:cn.UNSIGNED_BYTE,At=null!==(Tt=oe.RGBA16F)&&void 0!==Tt?Tt:cn.RGBA;cn.texImage2D(cn.TEXTURE_2D,0,At,Me.width/4,Me.height/4,0,cn.RGBA,sn,null),Be.colorAttachment.set(Oe)}(Q,ne,Ee,he)}})(R,_,S),R.clear({color:x.aM.transparent});for(let Q=0;Q<A.length;Q++){const ne=A[Q];if(D.hasRenderableParent(ne))continue;const de=D.getTile(ne),se=de.getBucket(S);if(!se)continue;const he=se.programConfigurations.get(S.id),Ee=_.useProgram("heatmap",he),{zoom:oe}=_.transform;Ee.draw(R,B.TRIANGLES,gi.disabled,L,W,tr.disabled,On(ne.posMatrix,de,oe,S.paint.get("heatmap-intensity")),null,S.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,S.paint,_.transform.zoom,he)}R.viewport.set([0,0,_.width,_.height])}else"translucent"===_.renderPass&&(_.context.setColorMode(_.colorModeForRenderPass()),function(R,B){const L=R.context,W=L.gl,Q=B.heatmapFbo;if(!Q)return;L.activeTexture.set(W.TEXTURE0),W.bindTexture(W.TEXTURE_2D,Q.colorAttachment.get()),L.activeTexture.set(W.TEXTURE1);let ne=B.colorRampTexture;ne||(ne=B.colorRampTexture=new Je(L,B.colorRamp,W.RGBA)),ne.bind(W.LINEAR,W.CLAMP_TO_EDGE),R.useProgram("heatmapTexture").draw(L,W.TRIANGLES,gi.disabled,er.disabled,R.colorModeForRenderPass(),tr.disabled,((de,se,he,Ee)=>{const oe=x.H();x.aP(oe,0,de.width,de.height,0,0,1);const Me=de.context.gl;return{u_matrix:oe,u_world:[Me.drawingBufferWidth,Me.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:se.paint.get("heatmap-opacity")}})(R,B),null,B.id,R.viewportBuffer,R.quadTriangleIndexBuffer,R.viewportSegments,B.paint,R.transform.zoom)}(_,S))}(o,u,f,p);break;case"line":!function(_,D,S,A){if("translucent"!==_.renderPass)return;const R=S.paint.get("line-opacity"),B=S.paint.get("line-width");if(0===R.constantOr(1)||0===B.constantOr(1))return;const L=_.depthModeForSublayer(0,gi.ReadOnly),W=_.colorModeForRenderPass(),Q=S.paint.get("line-dasharray"),ne=S.paint.get("line-pattern"),de=ne.constantOr(1),se=S.paint.get("line-gradient"),he=S.getCrossfadeParameters(),Ee=de?"linePattern":Q?"lineSDF":se?"lineGradient":"line",oe=_.context,Me=oe.gl;let Oe=!0;for(const Be of A){const ft=D.getTile(Be);if(de&&!ft.patternsLoaded())continue;const Tt=ft.getBucket(S);if(!Tt)continue;const cn=Tt.programConfigurations.get(S.id),sn=_.context.program.get(),At=_.useProgram(Ee,cn),zt=Oe||At.program!==sn,Cn=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Be),Jn=ne.constantOr(null);if(Jn&&ft.imageAtlas){const zn=ft.imageAtlas,pr=zn.patternPositions[Jn.to.toString()],yi=zn.patternPositions[Jn.from.toString()];pr&&yi&&cn.setConstantPatternPositions(pr,yi)}const Vt=Cn?Be:null,Xt=de?Cc(_,ft,S,he,Vt):Q?ll(_,ft,S,Q,he,Vt):se?$l(_,ft,S,Tt.lineClipsArray.length,Vt):Ba(_,ft,S,Vt);if(de)oe.activeTexture.set(Me.TEXTURE0),ft.imageAtlasTexture.bind(Me.LINEAR,Me.CLAMP_TO_EDGE),cn.updatePaintBuffers(he);else if(Q&&(zt||_.lineAtlas.dirty))oe.activeTexture.set(Me.TEXTURE0),_.lineAtlas.bind(oe);else if(se){const zn=Tt.gradients[S.id];let pr=zn.texture;if(S.gradientVersion!==zn.version){let yi=256;if(S.stepInterpolant){const Ai=D.getSource().maxzoom,Lr=Be.canonical.z===Ai?Math.ceil(1<<_.transform.maxZoom-Be.canonical.z):1;yi=x.ac(x.aU(Tt.maxLineLength/x.X*1024*Lr),256,oe.maxTextureSize)}zn.gradient=x.aV({expression:S.gradientExpression(),evaluationKey:"lineProgress",resolution:yi,image:zn.gradient||void 0,clips:Tt.lineClipsArray}),zn.texture?zn.texture.update(zn.gradient):zn.texture=new Je(oe,zn.gradient,Me.RGBA),zn.version=S.gradientVersion,pr=zn.texture}oe.activeTexture.set(Me.TEXTURE0),pr.bind(S.stepInterpolant?Me.NEAREST:Me.LINEAR,Me.CLAMP_TO_EDGE)}At.draw(oe,Me.TRIANGLES,L,_.stencilModeForClipping(Be),W,tr.disabled,Xt,Cn,S.id,Tt.layoutVertexBuffer,Tt.indexBuffer,Tt.segments,S.paint,_.transform.zoom,cn,Tt.layoutVertexBuffer2),Oe=!1}}(o,u,f,p);break;case"fill":!function(_,D,S,A){const R=S.paint.get("fill-color"),B=S.paint.get("fill-opacity");if(0===B.constantOr(1))return;const L=_.colorModeForRenderPass(),W=S.paint.get("fill-pattern"),Q=_.opaquePassEnabledForLayer()&&!W.constantOr(1)&&1===R.constantOr(x.aM.transparent).a&&1===B.constantOr(0)?"opaque":"translucent";if(_.renderPass===Q){const ne=_.depthModeForSublayer(1,"opaque"===_.renderPass?gi.ReadWrite:gi.ReadOnly);Oc(_,D,S,A,ne,L,!1)}if("translucent"===_.renderPass&&S.paint.get("fill-antialias")){const ne=_.depthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,gi.ReadOnly);Oc(_,D,S,A,ne,L,!0)}}(o,u,f,p);break;case"fill-extrusion":!function(_,D,S,A){const R=S.paint.get("fill-extrusion-opacity");if(0!==R&&"translucent"===_.renderPass){const B=new gi(_.context.gl.LEQUAL,gi.ReadWrite,_.depthRangeFor3D);if(1!==R||S.paint.get("fill-extrusion-pattern").constantOr(1))hl(_,D,S,A,B,er.disabled,xr.disabled),hl(_,D,S,A,B,_.stencilModeFor3D(),_.colorModeForRenderPass());else{const L=_.colorModeForRenderPass();hl(_,D,S,A,B,er.disabled,L)}}}(o,u,f,p);break;case"hillshade":!function(_,D,S,A){if("offscreen"!==_.renderPass&&"translucent"!==_.renderPass)return;const R=_.context,B=_.depthModeForSublayer(0,gi.ReadOnly),L=_.colorModeForRenderPass(),[W,Q]="translucent"===_.renderPass?_.stencilConfigForOverlap(A):[{},A];for(const ne of Q){const de=D.getTile(ne);void 0!==de.needsHillshadePrepare&&de.needsHillshadePrepare&&"offscreen"===_.renderPass?Qo(_,de,S,B,er.disabled,L):"translucent"===_.renderPass&&Ca(_,ne,de,S,B,W[ne.overscaledZ],L)}R.viewport.set([0,0,_.width,_.height])}(o,u,f,p);break;case"raster":!function(_,D,S,A){if("translucent"!==_.renderPass||0===S.paint.get("raster-opacity")||!A.length)return;const R=_.context,B=R.gl,L=D.getSource(),W=_.useProgram("raster"),Q=_.colorModeForRenderPass(),[ne,de]=L instanceof et?[{},A]:_.stencilConfigForOverlap(A),se=de[de.length-1].overscaledZ,he=!_.options.moving;for(const Ee of de){const oe=_.depthModeForSublayer(Ee.overscaledZ-se,1===S.paint.get("raster-opacity")?gi.ReadWrite:gi.ReadOnly,B.LESS),Me=D.getTile(Ee);Me.registerFadeDuration(S.paint.get("raster-fade-duration"));const Oe=D.findLoadedParent(Ee,0),Be=D.findLoadedSibling(Ee),ft=Da(Me,Oe||Be||null,D,S,_.transform,_.style.map.terrain);let Tt,cn;const sn="nearest"===S.paint.get("raster-resampling")?B.NEAREST:B.LINEAR;R.activeTexture.set(B.TEXTURE0),Me.texture.bind(sn,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),R.activeTexture.set(B.TEXTURE1),Oe?(Oe.texture.bind(sn,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),Tt=Math.pow(2,Oe.tileID.overscaledZ-Me.tileID.overscaledZ),cn=[Me.tileID.canonical.x*Tt%1,Me.tileID.canonical.y*Tt%1]):Me.texture.bind(sn,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),Me.texture.useMipmap&&R.extTextureFilterAnisotropic&&_.transform.pitch>20&&B.texParameterf(B.TEXTURE_2D,R.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,R.extTextureFilterAnisotropicMax);const At=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ee),zt=At?Ee:null,Cn=zt?zt.posMatrix:_.transform.calculatePosMatrix(Ee.toUnwrapped(),he),Jn=cl(Cn,cn||[0,0],Tt||1,ft,S);L instanceof et?W.draw(R,B.TRIANGLES,oe,er.disabled,Q,tr.disabled,Jn,At,S.id,L.boundsBuffer,_.quadTriangleIndexBuffer,L.boundsSegments):W.draw(R,B.TRIANGLES,oe,ne[Ee.overscaledZ],Q,tr.disabled,Jn,At,S.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}}(o,u,f,p);break;case"background":!function(_,D,S,A){const R=S.paint.get("background-color"),B=S.paint.get("background-opacity");if(0===B)return;const L=_.context,W=L.gl,Q=_.transform,ne=Q.tileSize,de=S.paint.get("background-pattern");if(_.isPatternMissing(de))return;const se=!de&&1===R.a&&1===B&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==se)return;const he=er.disabled,Ee=_.depthModeForSublayer(0,"opaque"===se?gi.ReadWrite:gi.ReadOnly),oe=_.colorModeForRenderPass(),Me=_.useProgram(de?"backgroundPattern":"background"),Oe=A||Q.coveringTiles({tileSize:ne,terrain:_.style.map.terrain});de&&(L.activeTexture.set(W.TEXTURE0),_.imageManager.bind(_.context));const Be=S.getCrossfadeParameters();for(const ft of Oe){const Tt=A?ft.posMatrix:_.transform.calculatePosMatrix(ft.toUnwrapped()),cn=de?oa(Tt,B,_,de,{tileID:ft,tileSize:ne},Be):Ul(Tt,B,R),sn=_.style.map.terrain&&_.style.map.terrain.getTerrainData(ft);Me.draw(L,W.TRIANGLES,Ee,he,oe,tr.disabled,cn,sn,S.id,_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}(o,0,f,p);break;case"custom":!function(_,D,S){const A=_.context,R=S.implementation;if("offscreen"===_.renderPass){const B=R.prerender;B&&(_.setCustomLayerDefaults(),A.setColorMode(_.colorModeForRenderPass()),B.call(R,A.gl,_.transform.customLayerMatrix()),A.setDirty(),_.setBaseState())}else if("translucent"===_.renderPass){_.setCustomLayerDefaults(),A.setColorMode(_.colorModeForRenderPass()),A.setStencilMode(er.disabled);const B="3d"===R.renderingMode?new gi(_.context.gl.LEQUAL,gi.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,gi.ReadOnly);A.setDepthMode(B),R.render(A.gl,_.transform.customLayerMatrix(),{farZ:_.transform.farZ,nearZ:_.transform.nearZ,fov:_.transform._fov,modelViewProjectionMatrix:_.transform.modelViewProjectionMatrix,projectionMatrix:_.transform.projectionMatrix}),A.setDirty(),_.setBaseState(),A.bindFramebuffer.set(null)}}(o,0,f)}}translatePosMatrix(o,u,f,p,_){if(!f[0]&&!f[1])return o;const D=_?"map"===p?this.transform.angle:0:"viewport"===p?-this.transform.angle:0;if(D){const R=Math.sin(D),B=Math.cos(D);f=[f[0]*B-f[1]*R,f[0]*R+f[1]*B]}const S=[_?f[0]:Dn(u,f[0],this.transform.zoom),_?f[1]:Dn(u,f[1],this.transform.zoom),0],A=new Float32Array(16);return x.J(A,o,S),A}saveTileTexture(o){const u=this._tileTextures[o.size[0]];u?u.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const u=this._tileTextures[o];return u&&u.length>0?u.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const u=this.imageManager.getPattern(o.from.toString()),f=this.imageManager.getPattern(o.to.toString());return!u||!f}useProgram(o,u){this.cache=this.cache||{};const f=o+(u?u.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[f]||(this.cache[f]=new Bo(this.context,Ko[o],u,ul[o],this._showOverdrawInspector,this.style.map.terrain)),this.cache[f]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Je(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:u}=this.context.gl;return this.width!==o||this.height!==u}}class Lc{constructor(o,u){this.points=o,this.planes=u}static fromInvProjectionMatrix(o,u,f){const p=Math.pow(2,f),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const A=1/(S=x.af([],S,o))[3]/u*p;return x.b0(S,S,[A,A,1/S[3],A])}),D=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const A=function(W,Q){var ne=Q[0],de=Q[1],se=Q[2],he=ne*ne+de*de+se*se;return he>0&&(he=1/Math.sqrt(he)),W[0]=Q[0]*he,W[1]=Q[1]*he,W[2]=Q[2]*he,W}([],(W=[],Q=Ze([],_[S[0]],_[S[1]]),ne=Ze([],_[S[2]],_[S[1]]),de=Q[0],Ee=ne[0],W[0]=(se=Q[1])*(Me=ne[2])-(he=Q[2])*(oe=ne[1]),W[1]=he*Ee-de*Me,W[2]=de*oe-se*Ee,W)),R=-((B=A)[0]*(L=_[S[1]])[0]+B[1]*L[1]+B[2]*L[2]);var W,Q,ne,de,se,he,Ee,oe,Me,B,L;return A.concat(R)});return new Lc(_,D)}}class Kl{constructor(o,u){var f,p,_;this.min=o,this.max=u,this.center=function(f,p,_){return f[0]=.5*p[0],f[1]=.5*p[1],f[2]=.5*p[2],f}([],((f=[])[0]=(p=this.min)[0]+(_=this.max)[0],f[1]=p[1]+_[1],f[2]=p[2]+_[2],f))}quadrant(o){const u=[o%2==0,o<2],f=Qe(this.min),p=Qe(this.max);for(let _=0;_<u.length;_++)f[_]=u[_]?this.min[_]:this.center[_],p[_]=u[_]?this.center[_]:this.max[_];return p[2]=this.max[2],new Kl(f,p)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const u=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let f=!0;for(let p=0;p<o.planes.length;p++){const _=o.planes[p];let D=0;for(let S=0;S<u.length;S++)x.b1(_,u[S])>=0&&D++;if(0===D)return 0;D!==u.length&&(f=!1)}if(f)return 2;for(let p=0;p<3;p++){let _=Number.MAX_VALUE,D=-Number.MAX_VALUE;for(let S=0;S<o.points.length;S++){const A=o.points[S][p]-this.min[p];_=Math.min(_,A),D=Math.max(D,A)}if(D<0||_>this.max[p]-this.min[p])return 0}return 1}}class ca{constructor(o=0,u=0,f=0,p=0){if(isNaN(o)||o<0||isNaN(u)||u<0||isNaN(f)||f<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=u,this.left=f,this.right=p}interpolate(o,u,f){return null!=u.top&&null!=o.top&&(this.top=x.y.number(o.top,u.top,f)),null!=u.bottom&&null!=o.bottom&&(this.bottom=x.y.number(o.bottom,u.bottom,f)),null!=u.left&&null!=o.left&&(this.left=x.y.number(o.left,u.left,f)),null!=u.right&&null!=o.right&&(this.right=x.y.number(o.right,u.right,f)),this}getCenter(o,u){const f=x.ac((this.left+o-this.right)/2,0,o),p=x.ac((this.top+u-this.bottom)/2,0,u);return new x.P(f,p)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new ca(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Nc=85.051129;class fl{constructor(o,u,f,p,_){this.tileSize=512,this._renderWorldCopies=void 0===_||!!_,this._minZoom=o||0,this._maxZoom=u||22,this._minPitch=f??0,this._maxPitch=p??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new x.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ca,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const o=new fl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.apply(this),o}apply(o){this.tileSize=o.tileSize,this.latRange=o.latRange,this.width=o.width,this.height=o.height,this._center=o._center,this._elevation=o._elevation,this.minElevationForCurrentTile=o.minElevationForCurrentTile,this.zoom=o.zoom,this.angle=o.angle,this._fov=o._fov,this._pitch=o._pitch,this._unmodified=o._unmodified,this._edgeInsets=o._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){void 0===o?o=!0:null===o&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new x.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const u=-x.b2(o,-180,180)*Math.PI/180;var f;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(f=new x.A(4),x.A!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f),function(f,p,_){var D=p[0],S=p[1],A=p[2],R=p[3],B=Math.sin(_),L=Math.cos(_);f[0]=D*L+A*B,f[1]=S*L+R*B,f[2]=D*-B+A*L,f[3]=S*-B+R*L}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const u=x.ac(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const u=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this.tileZoom=Math.max(0,Math.floor(u)),this.scale=this.zoomScale(u),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,u,f){this._unmodified=!1,this._edgeInsets.interpolate(o,u,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const u=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(o){const u=[new x.b3(0,o)];if(this._renderWorldCopies){const f=this.pointCoordinate(new x.P(0,0)),p=this.pointCoordinate(new x.P(this.width,0)),_=this.pointCoordinate(new x.P(this.width,this.height)),D=this.pointCoordinate(new x.P(0,this.height)),S=Math.floor(Math.min(f.x,p.x,_.x,D.x)),A=Math.floor(Math.max(f.x,p.x,_.x,D.x)),R=1;for(let B=S-R;B<=A+R;B++)0!==B&&u.push(new x.b3(B,o))}return u}coveringTiles(o){var u,f;let p=this.coveringZoomLevel(o);const _=p;if(void 0!==o.minzoom&&p<o.minzoom)return[];void 0!==o.maxzoom&&p>o.maxzoom&&(p=o.maxzoom);const D=this.pointCoordinate(this.getCameraPoint()),S=x.Z.fromLngLat(this.center),A=Math.pow(2,p),R=[A*D.x,A*D.y,0],B=[A*S.x,A*S.y,0],L=Lc.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,p);let W=o.minzoom||0;!o.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(W=p);const Q=o.terrain?2/Math.min(this.tileSize,o.tileSize)*this.tileSize:3,ne=oe=>({aabb:new Kl([oe*A,0,0],[(oe+1)*A,A,0]),zoom:0,x:0,y:0,wrap:oe,fullyVisible:!1}),de=[],se=[],he=p,Ee=o.reparseOverscaled?_:p;if(this._renderWorldCopies)for(let oe=1;oe<=3;oe++)de.push(ne(-oe)),de.push(ne(oe));for(de.push(ne(0));de.length>0;){const oe=de.pop(),Me=oe.x,Oe=oe.y;let Be=oe.fullyVisible;if(!Be){const At=oe.aabb.intersects(L);if(0===At)continue;Be=2===At}const ft=o.terrain?R:B,Tt=oe.aabb.distanceX(ft),cn=oe.aabb.distanceY(ft),sn=Math.max(Math.abs(Tt),Math.abs(cn));if(oe.zoom===he||sn>Q+(1<<he-oe.zoom)-2&&oe.zoom>=W){const At=he-oe.zoom,zt=R[0]-.5-(Me<<At),Cn=R[1]-.5-(Oe<<At);se.push({tileID:new x.S(oe.zoom===he?Ee:oe.zoom,oe.wrap,oe.zoom,Me,Oe),distanceSq:bn([B[0]-.5-Me,B[1]-.5-Oe]),tileDistanceToCamera:Math.sqrt(zt*zt+Cn*Cn)})}else for(let At=0;At<4;At++){const zt=(Me<<1)+At%2,Cn=(Oe<<1)+(At>>1),Jn=oe.zoom+1;let Vt=oe.aabb.quadrant(At);if(o.terrain){const Xt=new x.S(Jn,oe.wrap,Jn,zt,Cn),zn=o.terrain.getMinMaxElevation(Xt),pr=null!==(u=zn.minElevation)&&void 0!==u?u:this.elevation,yi=null!==(f=zn.maxElevation)&&void 0!==f?f:this.elevation;Vt=new Kl([Vt.min[0],Vt.min[1],pr],[Vt.max[0],Vt.max[1],yi])}de.push({aabb:Vt,zoom:Jn,x:zt,y:Cn,wrap:oe.wrap,fullyVisible:Be})}}return se.sort((oe,Me)=>oe.distanceSq-Me.distanceSq).map(oe=>oe.tileID)}resize(o,u){this.width=o,this.height=u,this.pixelsToGLUnits=[2/o,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const u=x.ac(o.lat,-85.051129,Nc);return new x.P(x.O(o.lng)*this.worldSize,x.Q(u)*this.worldSize)}unproject(o){return new x.Z(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(o){const u=this.elevation,f=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,p=this.pointLocation(this.centerPoint,o),_=o.getElevationForLngLatZoom(p,this.tileZoom);if(!(this.elevation-_))return;const D=f+u-_,S=Math.cos(this._pitch)*this.cameraToCenterDistance/D/x.b4(1,p.lat),A=this.scaleZoom(S/this.tileSize);this._elevation=_,this._center=p,this.zoom=A}setLocationAtPoint(o,u){const f=this.pointCoordinate(u),p=this.pointCoordinate(this.centerPoint),_=this.locationCoordinate(o),D=new x.Z(_.x-(f.x-p.x),_.y-(f.y-p.y));this.center=this.coordinateLocation(D),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o,u){return u?this.coordinatePoint(this.locationCoordinate(o),u.getElevationForLngLatZoom(o,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o,u){return this.coordinateLocation(this.pointCoordinate(o,u))}locationCoordinate(o){return x.Z.fromLngLat(o)}coordinateLocation(o){return o&&o.toLngLat()}pointCoordinate(o,u){if(u){const W=u.pointCoordinate(o);if(null!=W)return W}const f=[o.x,o.y,0,1],p=[o.x,o.y,1,1];x.af(f,f,this.pixelMatrixInverse),x.af(p,p,this.pixelMatrixInverse);const _=f[3],D=p[3],S=f[1]/_,A=p[1]/D,R=f[2]/_,B=p[2]/D,L=R===B?0:(0-R)/(B-R);return new x.Z(x.y.number(f[0]/_,p[0]/D,L)/this.worldSize,x.y.number(S,A,L)/this.worldSize)}coordinatePoint(o,u=0,f=this.pixelMatrix){const p=[o.x*this.worldSize,o.y*this.worldSize,u,1];return x.af(p,p,f),new x.P(p[0]/p[3],p[1]/p[3])}getBounds(){const o=Math.max(0,this.height/2-this.getHorizon());return(new ve).extend(this.pointLocation(new x.P(0,o))).extend(this.pointLocation(new x.P(this.width,o))).extend(this.pointLocation(new x.P(this.width,this.height))).extend(this.pointLocation(new x.P(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new ve([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Nc])}calculateTileMatrix(o){const u=o.canonical,f=this.worldSize/this.zoomScale(u.z),p=u.x+Math.pow(2,u.z)*o.wrap,_=x.an(new Float64Array(16));return x.J(_,_,[p*f,u.y*f,0]),x.K(_,_,[f/x.X,f/x.X,1]),_}calculatePosMatrix(o,u=!1){const f=o.key,p=u?this._alignedPosMatrixCache:this._posMatrixCache;if(p[f])return p[f];const _=this.calculateTileMatrix(o);return x.L(_,u?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,_),p[f]=new Float32Array(_),p[f]}calculateFogMatrix(o){const u=o.key,f=this._fogMatrixCache;if(f[u])return f[u];const p=this.calculateTileMatrix(o);return x.L(p,this.fogMatrix,p),f[u]=new Float32Array(p),f[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(o,u){u=x.ac(+u,this.minZoom,this.maxZoom);const f={center:new x.N(o.lng,o.lat),zoom:u};let p=this.lngRange;if(!this._renderWorldCopies&&null===p){const oe=179.9999999999;p=[-oe,oe]}const _=this.tileSize*this.zoomScale(f.zoom);let D=0,S=_,A=0,R=_,B=0,L=0;const{x:W,y:Q}=this.size;if(this.latRange){const oe=this.latRange;D=x.Q(oe[1])*_,S=x.Q(oe[0])*_,S-D<Q&&(B=Q/(S-D))}p&&(A=x.b2(x.O(p[0])*_,0,_),R=x.b2(x.O(p[1])*_,0,_),R<A&&(R+=_),R-A<W&&(L=W/(R-A)));const{x:ne,y:de}=this.project.call({worldSize:_},o);let se,he;const Ee=Math.max(L||0,B||0);if(Ee){const oe=new x.P(L?(R+A)/2:ne,B?(S+D)/2:de);return f.center=this.unproject.call({worldSize:_},oe).wrap(),f.zoom+=this.scaleZoom(Ee),f}if(this.latRange){const oe=Q/2;de-oe<D&&(he=D+oe),de+oe>S&&(he=S-oe)}if(p){const oe=(A+R)/2;let Me=ne;this._renderWorldCopies&&(Me=x.b2(ne,oe-_/2,oe+_/2));const Oe=W/2;Me-Oe<A&&(se=A+Oe),Me+Oe>R&&(se=R-Oe)}if(void 0!==se||void 0!==he){const oe=new x.P(se??ne,he??de);f.center=this.unproject.call({worldSize:_},oe).wrap()}return f}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this._unmodified,{center:u,zoom:f}=this.getConstrained(this.center,this.zoom);this.center=u,this.zoom=f,this._unmodified=o,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,u=this.point.x,f=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=x.b4(1,this.center.lat)*this.worldSize;let p=x.an(new Float64Array(16));x.K(p,p,[this.width/2,-this.height/2,1]),x.J(p,p,[1,-1,0]),this.labelPlaneMatrix=p,p=x.an(new Float64Array(16)),x.K(p,p,[1,-1,1]),x.J(p,p,[-1,-1,0]),x.K(p,p,[2/this.width,2/this.height,1]),this.glCoordMatrix=p;const _=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),D=Math.min(this.elevation,this.minElevationForCurrentTile),S=_-D*this._pixelPerMeter/Math.cos(this._pitch),A=D<0?S:_,R=Math.PI/2+this._pitch,B=this._fov*(.5+o.y/this.height),L=Math.sin(B)*A/Math.sin(x.ac(Math.PI-R-B,.01,Math.PI-.01)),W=this.getHorizon(),Q=2*Math.atan(W/this.cameraToCenterDistance)*(.5+o.y/(2*W)),ne=Math.sin(Q)*A/Math.sin(x.ac(Math.PI-R-Q,.01,Math.PI-.01)),de=Math.min(L,ne);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*de+A),this.nearZ=this.height/50,p=new Float64Array(16),x.b5(p,this._fov,this.width/this.height,this.nearZ,this.farZ),p[8]=2*-o.x/this.width,p[9]=2*o.y/this.height,this.projectionMatrix=x.ae(p),x.K(p,p,[1,-1,1]),x.J(p,p,[0,0,-this.cameraToCenterDistance]),x.b6(p,p,this._pitch),x.ad(p,p,this.angle),x.J(p,p,[-u,-f,0]),this.mercatorMatrix=x.K([],p,[this.worldSize,this.worldSize,this.worldSize]),x.K(p,p,[1,1,this._pixelPerMeter]),this.pixelMatrix=x.L(new Float64Array(16),this.labelPlaneMatrix,p),x.J(p,p,[0,0,-this.elevation]),this.modelViewProjectionMatrix=p,this.invModelViewProjectionMatrix=x.as([],p),this.fogMatrix=new Float64Array(16),x.b5(this.fogMatrix,this._fov,this.width/this.height,_,this.farZ),this.fogMatrix[8]=2*-o.x/this.width,this.fogMatrix[9]=2*o.y/this.height,x.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),x.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),x.b6(this.fogMatrix,this.fogMatrix,this._pitch),x.ad(this.fogMatrix,this.fogMatrix,this.angle),x.J(this.fogMatrix,this.fogMatrix,[-u,-f,0]),x.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),x.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=x.L(new Float64Array(16),this.labelPlaneMatrix,p);const se=this.width%2/2,he=this.height%2/2,Ee=Math.cos(this.angle),oe=Math.sin(this.angle),Me=u-Math.round(u)+Ee*se+oe*he,Oe=f-Math.round(f)+Ee*he+oe*se,Be=new Float64Array(p);if(x.J(Be,Be,[Me>.5?Me-1:Me,Oe>.5?Oe-1:Oe,0]),this.alignedModelViewProjectionMatrix=Be,p=x.as(new Float64Array(16),this.pixelMatrix),!p)throw new Error("failed to invert matrix");this.pixelMatrixInverse=p,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new x.P(0,0)),u=[o.x*this.worldSize,o.y*this.worldSize,0,1];return x.af(u,u,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new x.P(0,o))}getCameraQueryGeometry(o){const u=this.getCameraPoint();if(1===o.length)return[o[0],u];{let f=u.x,p=u.y,_=u.x,D=u.y;for(const S of o)f=Math.min(f,S.x),p=Math.min(p,S.y),_=Math.max(_,S.x),D=Math.max(D,S.y);return[new x.P(f,p),new x.P(_,p),new x.P(_,D),new x.P(f,D),new x.P(f,p)]}}lngLatToCameraDepth(o,u){const f=this.locationCoordinate(o),p=[f.x*this.worldSize,f.y*this.worldSize,u,1];return x.af(p,p,this.modelViewProjectionMatrix),p[2]/p[3]}}function pl(v,o){let u,f=!1,p=null,_=null;const D=()=>{p=null,f&&(v.apply(_,u),p=setTimeout(D,o),f=!1)};return(...S)=>(f=!0,_=this,u=S,p||D(),p)}class ml{constructor(o){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let f;return u.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(f=p)}),(f&&f[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(u.length>=3&&!u.some(f=>isNaN(f))){const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:f,pitch:+(u[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.+)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{const u=this._getCurrentHash();if(0===u.length)return;const f=u.join("/");let p=f;p.split("&").length>0&&(p=p.split("&")[0]),this._hashName&&(p=`${this._hashName}=${f}`);let _=window.location.hash.replace(p,"");_.startsWith("#&")?_=_.slice(0,1)+_.slice(2):"#"===_&&(_="");let D=window.location.href.replace(/(#.+)?$/,_);D=D.replace("&&","&"),window.history.replaceState(window.history.state,null,D)},this._updateHash=pl(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(o){const u=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,p=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,p),D=Math.round(u.lng*_)/_,S=Math.round(u.lat*_)/_,A=this._map.getBearing(),R=this._map.getPitch();let B="";if(B+=o?`/${D}/${S}/${f}`:`${f}/${S}/${D}`,(A||R)&&(B+="/"+Math.round(10*A)/10),R&&(B+=`/${Math.round(R)}`),this._hashName){const L=this._hashName;let W=!1;const Q=window.location.hash.slice(1).split("&").map(ne=>{const de=ne.split("=")[0];return de===L?(W=!0,`${de}=${B}`):ne}).filter(ne=>ne);return W||Q.push(`${L}=${B}`),`#${Q.join("&")}`}return`#${B}`}}const ja={linearity:.3,easing:x.b7(0,0,.3,1)},Yl=x.e({deceleration:2500,maxSpeed:1400},ja),hs=x.e({deceleration:20,maxSpeed:1400},ja),Bc=x.e({deceleration:1e3,maxSpeed:360},ja),Jl=x.e({deceleration:1e3,maxSpeed:90},ja);class fu{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Ae.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,u=Ae.now();for(;o.length>0&&u-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new x.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:_}of this._inertiaBuffer)u.zoom+=_.zoomDelta||0,u.bearing+=_.bearingDelta||0,u.pitch+=_.pitchDelta||0,_.panDelta&&u.pan._add(_.panDelta),_.around&&(u.around=_.around),_.pinchAround&&(u.pinchAround=_.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(u.pan.mag()){const _=gl(u.pan.mag(),f,x.e({},Yl,o||{}));p.offset=u.pan.mult(_.amount/u.pan.mag()),p.center=this._map.transform.center,Ua(p,_)}if(u.zoom){const _=gl(u.zoom,f,hs);p.zoom=this._map.transform.zoom+_.amount,Ua(p,_)}if(u.bearing){const _=gl(u.bearing,f,Bc);p.bearing=this._map.transform.bearing+x.ac(_.amount,-179,179),Ua(p,_)}if(u.pitch){const _=gl(u.pitch,f,Jl);p.pitch=this._map.transform.pitch+_.amount,Ua(p,_)}if(p.zoom||p.bearing){const _=void 0===u.pinchAround?u.around:u.pinchAround;p.around=_?this._map.unproject(_):this._map.getCenter()}return this.clear(),x.e(p,{noMoveStart:!0})}}function Ua(v,o){(!v.duration||v.duration<o.duration)&&(v.duration=o.duration,v.easing=o.easing)}function gl(v,o,u){const{maxSpeed:f,linearity:p,deceleration:_}=u,D=x.ac(v*p/(o/1e3),-f,f),S=Math.abs(D)/(_*p);return{easing:u.easing,duration:1e3*S,amount:D*(S/2)}}class ts extends x.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,f,p={}){const _=De.mousePos(u.getCanvas(),f),D=u.unproject(_);super(o,x.e({point:_,lngLat:D,originalEvent:f},p)),this._defaultPrevented=!1,this.target=u}}class Ha extends x.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,f){const p="touchend"===o?f.changedTouches:f.touches,_=De.touchPos(u.getCanvasContainer(),p),D=_.map(A=>u.unproject(A)),S=_.reduce((A,R,B,L)=>A.add(R.div(L.length)),new x.P(0,0));super(o,{points:_,point:S,lngLats:D,lngLat:u.unproject(S),originalEvent:f}),this._defaultPrevented=!1}}class Ql extends x.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,f){super(o,{originalEvent:f}),this._defaultPrevented=!1}}class zc{constructor(o,u){this._map=o,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new Ql(o.type,this._map,o))}mousedown(o,u){return this._mousedownPos=u,this._firePreventable(new ts(o.type,this._map,o))}mouseup(o){this._map.fire(new ts(o.type,this._map,o))}click(o,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new ts(o.type,this._map,o))}dblclick(o){return this._firePreventable(new ts(o.type,this._map,o))}mouseover(o){this._map.fire(new ts(o.type,this._map,o))}mouseout(o){this._map.fire(new ts(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Ha(o.type,this._map,o))}touchmove(o){this._map.fire(new Ha(o.type,this._map,o))}touchend(o){this._map.fire(new Ha(o.type,this._map,o))}touchcancel(o){this._map.fire(new Ha(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class td{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new ts(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ts("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new ts(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Pt{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.pointLocation(x.P.convert(o),this._map.terrain)}}class ec{constructor(o,u){this._map=o,this._tr=new Pt(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,u){this.isEnabled()&&o.shiftKey&&0===o.button&&(De.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(o,u){if(!this._active)return;const f=u;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=f,this._box||(this._box=De.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const _=Math.min(p.x,f.x),D=Math.max(p.x,f.x),S=Math.min(p.y,f.y),A=Math.max(p.y,f.y);De.setTransform(this._box,`translate(${_}px,${S}px)`),this._box.style.width=D-_+"px",this._box.style.height=A-S+"px"}mouseupWindow(o,u){if(!this._active||0!==o.button)return;const f=this._startPos,p=u;if(this.reset(),De.suppressClick(),f.x!==p.x||f.y!==p.y)return this._map.fire(new x.k("boxzoomend",{originalEvent:o})),{cameraAnimation:_=>_.fitScreenCoordinates(f,p,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&27===o.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(De.remove(this._box),this._box=null),De.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,u){return this._map.fire(new x.k(o,{originalEvent:u}))}}function tc(v,o){if(v.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${v.length}, points ${o.length}`);const u={};for(let f=0;f<v.length;f++)u[v[f].identifier]=o[f];return u}class nd{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,u,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=o.timeStamp),f.length===this.numTouches&&(this.centroid=function(p){const _=new x.P(0,0);for(const D of p)_._add(D);return _.div(p.length)}(u),this.touches=tc(f,u)))}touchmove(o,u,f){if(this.aborted||!this.centroid)return;const p=tc(f,u);for(const _ in this.touches){const D=p[_];(!D||D.dist(this.touches[_])>30)&&(this.aborted=!0)}}touchend(o,u,f){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),0===f.length){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class ro{constructor(o){this.singleTap=new nd(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,u,f){this.singleTap.touchstart(o,u,f)}touchmove(o,u,f){this.singleTap.touchmove(o,u,f)}touchend(o,u,f){const p=this.singleTap.touchend(o,u,f);if(p){const _=o.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(p)<30;if(_&&D||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class $r{constructor(o){this._tr=new Pt(o),this._zoomIn=new ro({numTouches:1,numTaps:2}),this._zoomOut=new ro({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,u,f){this._zoomIn.touchstart(o,u,f),this._zoomOut.touchstart(o,u,f)}touchmove(o,u,f){this._zoomIn.touchmove(o,u,f),this._zoomOut.touchmove(o,u,f)}touchend(o,u,f){const p=this._zoomIn.touchend(o,u,f),_=this._zoomOut.touchend(o,u,f),D=this._tr;return p?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:D.zoom+1,around:D.unproject(p)},{originalEvent:o})}):_?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:D.zoom-1,around:D.unproject(_)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fs{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const u=this._moveFunction(...o);if(u.bearingDelta||u.pitchDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(o,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=u.length?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,u){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const p=u.length?u[0]:u;return!this._moved&&p.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=p,this._move(f,p))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&De.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const yn={0:1,2:2};class oo{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const u=De.mouseButton(o);this._eventButton=u}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(u,f){const p=yn[f];return void 0===u.buttons||(u.buttons&p)!==p}(o,this._eventButton)}isValidEndEvent(o){return De.mouseButton(o)===this._eventButton}}class wi{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return 1===o.targetTouches.length}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}const Xr=v=>{v.mousedown=v.dragStart,v.mousemoveWindow=v.dragMove,v.mouseup=v.dragEnd,v.contextmenu=o=>{o.preventDefault()}},qr=({enable:v,clickTolerance:o,bearingDegreesPerPixelMoved:u=.8})=>{const f=new oo({checkCorrectEvent:p=>0===De.mouseButton(p)&&p.ctrlKey||2===De.mouseButton(p)});return new fs({clickTolerance:o,move:(p,_)=>({bearingDelta:(_.x-p.x)*u}),moveStateManager:f,enable:v,assignEvents:Xr})},Os=({enable:v,clickTolerance:o,pitchDegreesPerPixelMoved:u=-.5})=>{const f=new oo({checkCorrectEvent:p=>0===De.mouseButton(p)&&p.ctrlKey||2===De.mouseButton(p)});return new fs({clickTolerance:o,move:(p,_)=>({pitchDelta:(_.y-p.y)*u}),moveStateManager:f,enable:v,assignEvents:Xr})};class ko{constructor(o,u){this._clickTolerance=o.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new x.P(0,0)}_shouldBePrevented(o){return o<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(o,u,f){return this._calculateTransform(o,u,f)}touchmove(o,u,f){if(this._active){if(!this._shouldBePrevented(f.length))return o.preventDefault(),this._calculateTransform(o,u,f);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",o)}}touchend(o,u,f){this._calculateTransform(o,u,f),this._active&&this._shouldBePrevented(f.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,u,f){f.length>0&&(this._active=!0);const p=tc(f,u),_=new x.P(0,0),D=new x.P(0,0);let S=0;for(const R in p){const B=p[R],L=this._touches[R];L&&(_._add(B),D._add(B.sub(L)),S++,p[R]=B)}if(this._touches=p,this._shouldBePrevented(S)||!D.mag())return;const A=D.div(S);return this._sum._add(A),this._sum.mag()<this._clickTolerance?void 0:{around:_.div(S),panDelta:A}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,u,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([u[0],u[1]]))}touchmove(o,u,f){if(!this._firstTwoTouches)return;o.preventDefault();const[p,_]=this._firstTwoTouches,D=vl(f,u,p),S=vl(f,u,_);if(!D||!S)return;const A=this._aroundCenter?null:D.add(S).div(2);return this._move([D,S],A,o)}touchend(o,u,f){if(!this._firstTwoTouches)return;const[p,_]=this._firstTwoTouches,D=vl(f,u,p),S=vl(f,u,_);D&&S||(this._active&&De.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&"center"===o.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function vl(v,o,u){for(let f=0;f<v.length;f++)if(v[f].identifier===u)return o[f]}function _l(v,o){return Math.log(v/o)/Math.LN2}class pu extends yl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,u){const f=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(_l(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_l(this._distance,f),pinchAround:u}}}function mu(v,o){return 180*v.angleWith(o)/Math.PI}class Ki extends yl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,u,f){const p=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:mu(this._vector,p),pinchAround:u}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const u=25/(Math.PI*this._minDiameter)*360,f=mu(o,this._startVector);return Math.abs(f)<u}}function gn(v){return Math.abs(v.y)>Math.abs(v.x)}class ci extends yl{constructor(o){super(),this._currentTouchCount=0,this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,u,f){super.touchstart(o,u,f),this._currentTouchCount=f.length}_start(o){this._lastPoints=o,gn(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,u,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const p=o[0].sub(this._lastPoints[0]),_=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,_,f.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(p.y+_.y)/2*-.5}):void 0}gestureBeginsVertically(o,u,f){if(void 0!==this._valid)return this._valid;const p=o.mag()>=2,_=u.mag()>=2;if(!p&&!_)return;if(!p||!_)return void 0===this._firstMove&&(this._firstMove=f),f-this._firstMove<100&&void 0;const D=o.y>0==u.y>0;return gn(o)&&gn(u)&&D}}const Cr={panStep:100,bearingStep:15,pitchStep:10};class ns{constructor(o){this._tr=new Pt(o);const u=Cr;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let u=0,f=0,p=0,_=0,D=0;switch(o.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:o.shiftKey?f=-1:(o.preventDefault(),_=-1);break;case 39:o.shiftKey?f=1:(o.preventDefault(),_=1);break;case 38:o.shiftKey?p=1:(o.preventDefault(),D=-1);break;case 40:o.shiftKey?p=-1:(o.preventDefault(),D=1);break;default:return}return this._rotationDisabled&&(f=0,p=0),{cameraAnimation:S=>{const A=this._tr;S.easeTo({duration:300,easeId:"keyboardHandler",easing:ps,zoom:u?Math.round(A.zoom)+u*(o.shiftKey?2:1):A.zoom,bearing:A.bearing+f*this._bearingStep,pitch:A.pitch+p*this._pitchStep,offset:[-_*this._panStep,-D*this._panStep],center:A.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ps(v){return v*(2-v)}const so=4.000244140625;class Ea{constructor(o,u){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=o,this._tr=new Pt(o),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&"center"===o.around)}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(o){return!!this._map.cooperativeGestures.isEnabled()&&!(o.ctrlKey||this._map.cooperativeGestures.isBypassed(o))}wheel(o){if(!this.isEnabled())return;if(this._shouldBePrevented(o))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",o);let u=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const f=Ae.now(),p=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,0!==u&&u%so==0?this._type="wheel":0!==u&&Math.abs(u)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(p*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),o.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=o,this._delta-=u,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=De.mousePos(this._map.getCanvas(),o),f=this._tr;this._around=u.y>f.transform.height/2-f.transform.getHorizon()?x.N.convert(this._aroundCenter?f.center:f.unproject(u)):x.N.convert(f.center),this._aroundPoint=f.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(0!==this._delta){const A="wheel"===this._type&&Math.abs(this._delta)>so?this._wheelZoomRate:this._defaultZoomRate;let R=2/(1+Math.exp(-Math.abs(this._delta*A)));this._delta<0&&0!==R&&(R=1/R);const B="number"==typeof this._targetZoom?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(B*R))),"wheel"===this._type&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u="number"==typeof this._targetZoom?this._targetZoom:o.zoom,f=this._startZoom,p=this._easing;let _,D=!1;const S=Ae.now()-this._lastWheelEventTime;if("wheel"===this._type&&f&&p&&S){const A=Math.min(S/200,1),R=p(A);_=x.y.number(f,u,R),A<1?this._frameId||(this._frameId=!0):D=!0}else _=u,D=!0;return this._active=!0,D&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!D,zoomDelta:_-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let u=x.b8;if(this._prevEase){const f=this._prevEase,p=(Ae.now()-f.start)/f.duration,_=f.easing(p+.01)-f.easing(p),D=.27/Math.sqrt(_*_+1e-4)*.01,S=Math.sqrt(.0729-D*D);u=x.b7(D,S,.25,1)}return this._prevEase={start:Ae.now(),duration:o,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class rr{constructor(o,u){this._clickZoom=o,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ua{constructor(o){this._tr=new Pt(o),this.reset()}reset(){this._active=!1}dblclick(o,u){return o.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class So{constructor(){this._tap=new ro({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,u,f){if(!this._swipePoint)if(this._tapTime){const p=u[0],_=o.timeStamp-this._tapTime<500,D=this._tapPoint.dist(p)<30;_&&D?f.length>0&&(this._swipePoint=p,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(o,u,f)}touchmove(o,u,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const p=u[0],_=p.y-this._swipePoint.y;return this._swipePoint=p,o.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(o,u,f)}touchend(o,u,f){if(this._tapTime)this._swipePoint&&0===f.length&&this.reset();else{const p=this._tap.touchend(o,u,f);p&&(this._tapTime=o.timeStamp,this._tapPoint=p)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hn{constructor(o,u,f){this._el=o,this._mousePan=u,this._touchPan=f}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ia{constructor(o,u,f){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=u,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ms{constructor(o,u,f,p){this._el=o,this._touchZoom=u,this._touchRotate=f,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class gs{constructor(o,u){this._bypassKey=-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey",this._map=o,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const o=this._map.getCanvasContainer();o.classList.add("maplibregl-cooperative-gestures"),this._container=De.create("div","maplibregl-cooperative-gesture-screen",o);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");"metaKey"===this._bypassKey&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),p=document.createElement("div");p.className="maplibregl-desktop-message",p.textContent=u,this._container.appendChild(p);const _=document.createElement("div");_.className="maplibregl-mobile-message",_.textContent=f,this._container.appendChild(_),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(De.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(o){return o[this._bypassKey]}notifyGestureBlocked(o,u){this._enabled&&(this._map.fire(new x.k("cooperativegestureprevented",{gestureType:o,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Tr=v=>v.zoom||v.drag||v.pitch||v.rotate;class $o extends x.k{}function Fs(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class Zi{constructor(o,u){this.handleWindowEvent=p=>{this.handleEvent(p,`${p.type}Window`)},this.handleEvent=(p,_)=>{if("blur"===p.type)return void this.stop(!0);this._updatingCamera=!0;const D="renderFrame"===p.type?void 0:p,S={needsRenderFrame:!1},A={},R={},B=p.touches,L=B?this._getMapTouches(B):void 0,W=L?De.touchPos(this._map.getCanvas(),L):De.mousePos(this._map.getCanvas(),p);for(const{handlerName:de,handler:se,allowed:he}of this._handlers){if(!se.isEnabled())continue;let Ee;this._blockedByActive(R,he,de)?se.reset():se[_||p.type]&&(Ee=se[_||p.type](p,W,L),this.mergeHandlerResult(S,A,Ee,de,D),Ee&&Ee.needsRenderFrame&&this._triggerRenderFrame()),(Ee||se.isActive())&&(R[de]=se)}const Q={};for(const de in this._previousActiveHandlers)R[de]||(Q[de]=D);this._previousActiveHandlers=R,(Object.keys(Q).length||Fs(S))&&(this._changes.push([S,A,Q]),this._triggerRenderFrame()),(Object.keys(R).length||Fs(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ne}=S;ne&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ne(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new fu(o),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,_,D]of this._listeners)De.addEventListener(p,_,p===document?this.handleWindowEvent:this.handleEvent,D)}destroy(){for(const[o,u,f]of this._listeners)De.removeEventListener(o,u,o===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(o){const u=this._map,f=u.getCanvasContainer();this._add("mapEvent",new zc(u,o));const p=u.boxZoom=new ec(u,o);this._add("boxZoom",p),o.interactive&&o.boxZoom&&p.enable();const _=u.cooperativeGestures=new gs(u,o.cooperativeGestures);this._add("cooperativeGestures",_),o.cooperativeGestures&&_.enable();const D=new $r(u),S=new ua(u);u.doubleClickZoom=new rr(S,D),this._add("tapZoom",D),this._add("clickZoom",S),o.interactive&&o.doubleClickZoom&&u.doubleClickZoom.enable();const A=new So;this._add("tapDragZoom",A);const R=u.touchPitch=new ci(u);this._add("touchPitch",R),o.interactive&&o.touchPitch&&u.touchPitch.enable(o.touchPitch);const B=qr(o),L=Os(o);u.dragRotate=new Ia(o,B,L),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]),o.interactive&&o.dragRotate&&u.dragRotate.enable();const W=(({enable:Ee,clickTolerance:oe})=>{const Me=new oo({checkCorrectEvent:Oe=>0===De.mouseButton(Oe)&&!Oe.ctrlKey});return new fs({clickTolerance:oe,move:(Oe,Be)=>({around:Be,panDelta:Be.sub(Oe)}),activateOnStart:!0,moveStateManager:Me,enable:Ee,assignEvents:Xr})})(o),Q=new ko(o,u);u.dragPan=new Hn(f,W,Q),this._add("mousePan",W),this._add("touchPan",Q,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&u.dragPan.enable(o.dragPan);const ne=new Ki,de=new pu;u.touchZoomRotate=new ms(f,de,ne,A),this._add("touchRotate",ne,["touchPan","touchZoom"]),this._add("touchZoom",de,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&u.touchZoomRotate.enable(o.touchZoomRotate);const se=u.scrollZoom=new Ea(u,()=>this._triggerRenderFrame());this._add("scrollZoom",se,["mousePan"]),o.interactive&&o.scrollZoom&&u.scrollZoom.enable(o.scrollZoom);const he=u.keyboard=new ns(u);this._add("keyboard",he),o.interactive&&o.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new td(u))}_add(o,u,f){this._handlers.push({handlerName:o,handler:u,allowed:f}),this._handlersById[o]=u}stop(o){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Tr(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,u,f){for(const p in o)if(p!==f&&(!u||u.indexOf(p)<0))return!0;return!1}_getMapTouches(o){const u=[];for(const f of o)this._el.contains(f.target)&&u.push(f);return u}mergeHandlerResult(o,u,f,p,_){if(!f)return;x.e(o,f);const D={handlerName:p,originalEvent:f.originalEvent||_};void 0!==f.zoomDelta&&(u.zoom=D),void 0!==f.panDelta&&(u.drag=D),void 0!==f.pitchDelta&&(u.pitch=D),void 0!==f.bearingDelta&&(u.rotate=D)}_applyChanges(){const o={},u={},f={};for(const[p,_,D]of this._changes)p.panDelta&&(o.panDelta=(o.panDelta||new x.P(0,0))._add(p.panDelta)),p.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+p.pitchDelta),void 0!==p.around&&(o.around=p.around),void 0!==p.pinchAround&&(o.pinchAround=p.pinchAround),p.noInertia&&(o.noInertia=p.noInertia),x.e(u,_),x.e(f,D);this._updateMapTransform(o,u,f),this._changes=[]}_updateMapTransform(o,u,f){const p=this._map,_=p._getTransformForUpdate(),D=p.terrain;if(!(Fs(o)||D&&this._terrainMovement))return this._fireEvents(u,f,!0);let{panDelta:S,zoomDelta:A,bearingDelta:R,pitchDelta:B,around:L,pinchAround:W}=o;void 0!==W&&(L=W),p._stop(!0),L=L||p.transform.centerPoint;const Q=_.pointLocation(S?L.sub(S):L);R&&(_.bearing+=R),B&&(_.pitch+=B),A&&(_.zoom+=A),D?this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?_.center=_.pointLocation(_.centerPoint.sub(S)):_.setLocationAtPoint(Q,L):(this._terrainMovement=!0,this._map._elevationFreeze=!0,_.setLocationAtPoint(Q,L)):_.setLocationAtPoint(Q,L),p._applyUpdatedTransform(_),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(u,f,!0)}_fireEvents(o,u,f){const p=Tr(this._eventsInProgress),_=Tr(o),D={};for(const L in o){const{originalEvent:W}=o[L];this._eventsInProgress[L]||(D[`${L}start`]=W),this._eventsInProgress[L]=o[L]}!p&&_&&this._fireEvent("movestart",_.originalEvent);for(const L in D)this._fireEvent(L,D[L]);_&&this._fireEvent("move",_.originalEvent);for(const L in o){const{originalEvent:W}=o[L];this._fireEvent(L,W)}const S={};let A;for(const L in this._eventsInProgress){const{handlerName:W,originalEvent:Q}=this._eventsInProgress[L];this._handlersById[W].isActive()||(delete this._eventsInProgress[L],A=u[W]||Q,S[`${L}end`]=A)}for(const L in S)this._fireEvent(L,S[L]);const R=Tr(this._eventsInProgress),B=(p||_)&&!R;if(B&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const L=this._map._getTransformForUpdate();L.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(L)}if(f&&B){this._updatingCamera=!0;const L=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),W=Q=>0!==Q&&-this._bearingSnap<Q&&Q<this._bearingSnap;!L||!L.essential&&Ae.prefersReducedMotion?(this._map.fire(new x.k("moveend",{originalEvent:A})),W(this._map.getBearing())&&this._map.resetNorth()):(W(L.bearing||this._map.getBearing())&&(L.bearing=0),L.freezeElevation=!0,this._map.easeTo(L,{originalEvent:A})),this._updatingCamera=!1}}_fireEvent(o,u){this._map.fire(new x.k(o,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new $o("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class bl extends x.E{constructor(o,u){super(),this._renderFrameCallback=()=>{const f=Math.min((Ae.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=u.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new x.N(this.transform.center.lng,this.transform.center.lat)}setCenter(o,u){return this.jumpTo({center:o},u)}panBy(o,u,f){return o=x.P.convert(o).mult(-1),this.panTo(this.transform.center,x.e({offset:o},u),f)}panTo(o,u,f){return this.easeTo(x.e({center:o},u),f)}getZoom(){return this.transform.zoom}setZoom(o,u){return this.jumpTo({zoom:o},u),this}zoomTo(o,u,f){return this.easeTo(x.e({zoom:o},u),f)}zoomIn(o,u){return this.zoomTo(this.getZoom()+1,o,u),this}zoomOut(o,u){return this.zoomTo(this.getZoom()-1,o,u),this}getBearing(){return this.transform.bearing}setBearing(o,u){return this.jumpTo({bearing:o},u),this}getPadding(){return this.transform.padding}setPadding(o,u){return this.jumpTo({padding:o},u),this}rotateTo(o,u,f){return this.easeTo(x.e({bearing:o},u),f)}resetNorth(o,u){return this.rotateTo(0,x.e({duration:1e3},o),u),this}resetNorthPitch(o,u){return this.easeTo(x.e({bearing:0,pitch:0,duration:1e3},o),u),this}snapToNorth(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this}getPitch(){return this.transform.pitch}setPitch(o,u){return this.jumpTo({pitch:o},u),this}cameraForBounds(o,u){o=ve.convert(o);const f=u&&u.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),f,u)}_cameraForBoxAndBearing(o,u,f,p){const _={top:0,bottom:0,right:0,left:0};if("number"==typeof(p=x.e({padding:_,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding){const At=p.padding;p.padding={top:At,bottom:At,right:At,left:At}}p.padding=x.e(_,p.padding);const D=this.transform,S=D.padding,A=new ve(o,u),R=D.project(A.getNorthWest()),B=D.project(A.getNorthEast()),L=D.project(A.getSouthEast()),W=D.project(A.getSouthWest()),Q=x.b9(-f),ne=R.rotate(Q),de=B.rotate(Q),se=L.rotate(Q),he=W.rotate(Q),Ee=new x.P(Math.max(ne.x,de.x,he.x,se.x),Math.max(ne.y,de.y,he.y,se.y)),oe=new x.P(Math.min(ne.x,de.x,he.x,se.x),Math.min(ne.y,de.y,he.y,se.y)),Me=Ee.sub(oe),Oe=(D.width-(S.left+S.right+p.padding.left+p.padding.right))/Me.x,Be=(D.height-(S.top+S.bottom+p.padding.top+p.padding.bottom))/Me.y;if(Be<0||Oe<0)return void x.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ft=Math.min(D.scaleZoom(D.scale*Math.min(Oe,Be)),p.maxZoom),Tt=x.P.convert(p.offset),cn=new x.P((p.padding.left-p.padding.right)/2,(p.padding.top-p.padding.bottom)/2).rotate(x.b9(f)),sn=Tt.add(cn).mult(D.scale/D.zoomScale(ft));return{center:D.unproject(R.add(L).div(2).sub(sn)),zoom:ft,bearing:f}}fitBounds(o,u,f){return this._fitInternal(this.cameraForBounds(o,u),u,f)}fitScreenCoordinates(o,u,f,p,_){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(x.P.convert(o)),this.transform.pointLocation(x.P.convert(u)),f,p),p,_)}_fitInternal(o,u,f){return o?(delete(u=x.e(o,u)).padding,u.linear?this.easeTo(u,f):this.flyTo(u,f)):this}jumpTo(o,u){this.stop();const f=this._getTransformForUpdate();let p=!1,_=!1,D=!1;return"zoom"in o&&f.zoom!==+o.zoom&&(p=!0,f.zoom=+o.zoom),void 0!==o.center&&(f.center=x.N.convert(o.center)),"bearing"in o&&f.bearing!==+o.bearing&&(_=!0,f.bearing=+o.bearing),"pitch"in o&&f.pitch!==+o.pitch&&(D=!0,f.pitch=+o.pitch),null==o.padding||f.isPaddingEqual(o.padding)||(f.padding=o.padding),this._applyUpdatedTransform(f),this.fire(new x.k("movestart",u)).fire(new x.k("move",u)),p&&this.fire(new x.k("zoomstart",u)).fire(new x.k("zoom",u)).fire(new x.k("zoomend",u)),_&&this.fire(new x.k("rotatestart",u)).fire(new x.k("rotate",u)).fire(new x.k("rotateend",u)),D&&this.fire(new x.k("pitchstart",u)).fire(new x.k("pitch",u)).fire(new x.k("pitchend",u)),this.fire(new x.k("moveend",u))}calculateCameraOptionsFromTo(o,u,f,p=0){const _=x.Z.fromLngLat(o,u),D=x.Z.fromLngLat(f,p),S=D.x-_.x,A=D.y-_.y,R=D.z-_.z,B=Math.hypot(S,A,R);if(0===B)throw new Error("Can't calculate camera options with same From and To");const L=Math.hypot(S,A),W=this.transform.scaleZoom(this.transform.cameraToCenterDistance/B/this.transform.tileSize),Q=180*Math.atan2(S,-A)/Math.PI;let ne=180*Math.acos(L/B)/Math.PI;return ne=R<0?90-ne:90+ne,{center:D.toLngLat(),zoom:W,pitch:ne,bearing:Q}}easeTo(o,u){var f;this._stop(!1,o.easeId),(!1===(o=x.e({offset:[0,0],duration:500,easing:x.b8},o)).animate||!o.essential&&Ae.prefersReducedMotion)&&(o.duration=0);const p=this._getTransformForUpdate(),_=p.zoom,D=p.bearing,S=p.pitch,A=p.padding,R="bearing"in o?this._normalizeBearing(o.bearing,D):D,B="pitch"in o?+o.pitch:S,L="padding"in o?o.padding:p.padding,W=x.P.convert(o.offset);let Q=p.centerPoint.add(W);const ne=p.pointLocation(Q),{center:de,zoom:se}=p.getConstrained(x.N.convert(o.center||ne),null!==(f=o.zoom)&&void 0!==f?f:_);this._normalizeCenter(de,p);const he=p.project(ne),Ee=p.project(de).sub(he),oe=p.zoomScale(se-_);let Me,Oe;o.around&&(Me=x.N.convert(o.around),Oe=p.locationPoint(Me));const Be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||se!==_,this._rotating=this._rotating||D!==R,this._pitching=this._pitching||B!==S,this._padding=!p.isPaddingEqual(L),this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,Be),this.terrain&&this._prepareElevation(de),this._ease(ft=>{if(this._zooming&&(p.zoom=x.y.number(_,se,ft)),this._rotating&&(p.bearing=x.y.number(D,R,ft)),this._pitching&&(p.pitch=x.y.number(S,B,ft)),this._padding&&(p.interpolatePadding(A,L,ft),Q=p.centerPoint.add(W)),this.terrain&&!o.freezeElevation&&this._updateElevation(ft),Me)p.setLocationAtPoint(Me,Oe);else{const Tt=p.zoomScale(p.zoom-_),cn=se>_?Math.min(2,oe):Math.max(.5,oe),sn=Math.pow(cn,1-ft),At=p.unproject(he.add(Ee.mult(ft*sn)).mult(Tt));p.setLocationAtPoint(p.renderWorldCopies?At.wrap():At,Q)}this._applyUpdatedTransform(p),this._fireMoveEvents(u)},ft=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(u,ft)},o),this}_prepareEase(o,u,f={}){this._moving=!0,u||f.moving||this.fire(new x.k("movestart",o)),this._zooming&&!f.zooming&&this.fire(new x.k("zoomstart",o)),this._rotating&&!f.rotating&&this.fire(new x.k("rotatestart",o)),this._pitching&&!f.pitching&&this.fire(new x.k("pitchstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&u!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(f-(u-(f*o+this._elevationStart))/(1-o)),this._elevationTarget=u}this.transform.elevation=x.y.number(this._elevationStart,this._elevationTarget,o)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(o){const u=o.getCameraPosition(),f=this.terrain.getElevationForLngLatZoom(u.lngLat,o.zoom);if(u.altitude<f){const p=this.calculateCameraOptionsFromTo(u.lngLat,f,o.center,o.elevation);return{pitch:p.pitch,zoom:p.zoom}}return{}}_applyUpdatedTransform(o){const u=[];if(this.terrain&&u.push(p=>this._elevateCameraIfInsideTerrain(p)),this.transformCameraUpdate&&u.push(p=>this.transformCameraUpdate(p)),!u.length)return;const f=o.clone();for(const p of u){const _=f.clone(),{center:D,zoom:S,pitch:A,bearing:R,elevation:B}=p(_);D&&(_.center=D),void 0!==S&&(_.zoom=S),void 0!==A&&(_.pitch=A),void 0!==R&&(_.bearing=R),void 0!==B&&(_.elevation=B),f.apply(_)}this.transform.apply(f)}_fireMoveEvents(o){this.fire(new x.k("move",o)),this._zooming&&this.fire(new x.k("zoom",o)),this._rotating&&this.fire(new x.k("rotate",o)),this._pitching&&this.fire(new x.k("pitch",o))}_afterEase(o,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const f=this._zooming,p=this._rotating,_=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new x.k("zoomend",o)),p&&this.fire(new x.k("rotateend",o)),_&&this.fire(new x.k("pitchend",o)),this.fire(new x.k("moveend",o))}flyTo(o,u){var f;if(!o.essential&&Ae.prefersReducedMotion){const Xt=x.M(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Xt,u)}this.stop(),o=x.e({offset:[0,0],speed:1.2,curve:1.42,easing:x.b8},o);const p=this._getTransformForUpdate(),_=p.zoom,D=p.bearing,S=p.pitch,A=p.padding,R="bearing"in o?this._normalizeBearing(o.bearing,D):D,B="pitch"in o?+o.pitch:S,L="padding"in o?o.padding:p.padding,W=x.P.convert(o.offset);let Q=p.centerPoint.add(W);const ne=p.pointLocation(Q),{center:de,zoom:se}=p.getConstrained(x.N.convert(o.center||ne),null!==(f=o.zoom)&&void 0!==f?f:_);this._normalizeCenter(de,p);const he=p.zoomScale(se-_),Ee=p.project(ne),oe=p.project(de).sub(Ee);let Me=o.curve;const Oe=Math.max(p.width,p.height),Be=Oe/he,ft=oe.mag();if("minZoom"in o){const Xt=x.ac(Math.min(o.minZoom,_,se),p.minZoom,p.maxZoom),zn=Oe/p.zoomScale(Xt-_);Me=Math.sqrt(zn/ft*2)}const Tt=Me*Me;function cn(Xt){const zn=(Be*Be-Oe*Oe+(Xt?-1:1)*Tt*Tt*ft*ft)/(2*(Xt?Be:Oe)*Tt*ft);return Math.log(Math.sqrt(zn*zn+1)-zn)}function sn(Xt){return(Math.exp(Xt)-Math.exp(-Xt))/2}function At(Xt){return(Math.exp(Xt)+Math.exp(-Xt))/2}const zt=cn(!1);let Cn=function(Xt){return At(zt)/At(zt+Me*Xt)},Jn=function(Xt){return Oe*((At(zt)*(sn(zn=zt+Me*Xt)/At(zn))-sn(zt))/Tt)/ft;var zn},Vt=(cn(!0)-zt)/Me;if(Math.abs(ft)<1e-6||!isFinite(Vt)){if(Math.abs(Oe-Be)<1e-6)return this.easeTo(o,u);const Xt=Be<Oe?-1:1;Vt=Math.abs(Math.log(Be/Oe))/Me,Jn=()=>0,Cn=zn=>Math.exp(Xt*Me*zn)}return o.duration="duration"in o?+o.duration:1e3*Vt/("screenSpeed"in o?+o.screenSpeed/Me:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=D!==R,this._pitching=B!==S,this._padding=!p.isPaddingEqual(L),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(de),this._ease(Xt=>{const zn=Xt*Vt,pr=1/Cn(zn);p.zoom=1===Xt?se:_+p.scaleZoom(pr),this._rotating&&(p.bearing=x.y.number(D,R,Xt)),this._pitching&&(p.pitch=x.y.number(S,B,Xt)),this._padding&&(p.interpolatePadding(A,L,Xt),Q=p.centerPoint.add(W)),this.terrain&&!o.freezeElevation&&this._updateElevation(Xt);const yi=1===Xt?de:p.unproject(Ee.add(oe.mult(Jn(zn))).mult(pr));p.setLocationAtPoint(p.renderWorldCopies?yi.wrap():yi,Q),this._applyUpdatedTransform(p),this._fireMoveEvents(u)},()=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(u)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,u){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,u)}return o||null===(f=this.handlers)||void 0===f||f.stop(!1),this}_ease(o,u,f){!1===f.animate||0===f.duration?(o(1),u()):(this._easeStart=Ae.now(),this._easeOptions=f,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,u){o=x.b2(o,-180,180);const f=Math.abs(o-u);return Math.abs(o-360-u)<f&&(o-=360),Math.abs(o+360-u)<f&&(o+=360),o}_normalizeCenter(o,u){if(!u.renderWorldCopies||u.lngRange)return;const f=o.lng-u.center.lng;o.lng+=f>180?-360:f<-180?360:0}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(x.N.convert(o),this.transform.tileZoom)-this.transform.elevation:null}}const qa={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class vo{constructor(o=qa){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||"metadata"!==u.sourceDataType&&"visibility"!==u.sourceDataType&&"style"!==u.dataType&&"terrain"!==u.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options.compact,this._container=De.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=De.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=De.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){De.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,u){const f=this._map._getUIString(`AttributionControl.${u}`);o.title=f,o.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(p=>"string"!=typeof p?"":p)):"string"==typeof this.options.customAttribution&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const u=this._map.style.sourceCaches;for(const p in u){const _=u[p];if(_.used||_.usedForTerrain){const D=_.getSource();D.attribution&&o.indexOf(D.attribution)<0&&o.push(D.attribution)}}o=o.filter(p=>String(p).trim()),o.sort((p,_)=>p.length-_.length),o=o.filter((p,_)=>{for(let D=_+1;D<o.length;D++)if(o[D].indexOf(p)>=0)return!1;return!0});const f=o.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,o.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Zt{constructor(o={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const f=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=De.create("div","maplibregl-ctrl");const u=De.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){De.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class wl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const u=++this._id;return this._queue.push({callback:o,id:u,cancelled:!1}),u}remove(o){const u=this._currentlyRunning,f=u?this._queue.concat(u):this._queue;for(const p of f)if(p.id===o)return void(p.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const f of u)if(!f.cancelled&&(f.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Ga=x.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Ei extends x.E{constructor(o){super(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,o.usedForTerrain=!0,o.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(o,u){this.sourceCache.update(o,u),this._renderableTilesKeys=[];const f={};for(const p of o.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u}))f[p.key]=!0,this._renderableTilesKeys.push(p.key),this._tiles[p.key]||(p.posMatrix=new Float64Array(16),x.aP(p.posMatrix,0,x.X,0,x.X,0,1),this._tiles[p.key]=new Hi(p,this.tileSize));for(const p in this._tiles)f[p]||delete this._tiles[p]}freeRtt(o){for(const u in this._tiles){const f=this._tiles[u];(!o||f.tileID.equals(o)||f.tileID.isChildOf(o)||o.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o){const u={};for(const f of this._renderableTilesKeys){const p=this._tiles[f].tileID;if(p.canonical.equals(o.canonical)){const _=o.clone();_.posMatrix=new Float64Array(16),x.aP(_.posMatrix,0,x.X,0,x.X,0,1),u[f]=_}else if(p.canonical.isChildOf(o.canonical)){const _=o.clone();_.posMatrix=new Float64Array(16);const D=p.canonical.z-o.canonical.z,S=p.canonical.x-(p.canonical.x>>D<<D),A=p.canonical.y-(p.canonical.y>>D<<D),R=x.X>>D;x.aP(_.posMatrix,0,R,0,R,0,1),x.J(_.posMatrix,_.posMatrix,[-S*R,-A*R,0]),u[f]=_}else if(o.canonical.isChildOf(p.canonical)){const _=o.clone();_.posMatrix=new Float64Array(16);const D=o.canonical.z-p.canonical.z,S=o.canonical.x-(o.canonical.x>>D<<D),A=o.canonical.y-(o.canonical.y>>D<<D),R=x.X>>D;x.aP(_.posMatrix,0,x.X,0,x.X,0,1),x.J(_.posMatrix,_.posMatrix,[S*R,A*R,0]),x.K(_.posMatrix,_.posMatrix,[1/2**D,1/2**D,0]),u[f]=_}}return u}getSourceTile(o,u){const f=this.sourceCache._source;let p=o.overscaledZ-this.deltaZoom;if(p>f.maxzoom&&(p=f.maxzoom),p<f.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(p).key);let _=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!_||!_.dem)&&u)for(;p>=f.minzoom&&(!_||!_.dem);)_=this.sourceCache.getTileByID(o.scaledTo(p--).key);return _}tilesAfterTime(o=Date.now()){return Object.values(this._tiles).filter(u=>u.timeAdded>=o)}}class $c{constructor(o,u,f){this.painter=o,this.sourceCache=new Ei(u),this.options=f,this.exaggeration="number"==typeof f.exaggeration?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,u,f,p=x.X){var _;if(!(u>=0&&u<p&&f>=0&&f<p))return 0;const D=this.getTerrainData(o),S=null===(_=D.tile)||void 0===_?void 0:_.dem;if(!S)return 0;const A=((ne=[])[0]=(se=D.u_terrain_matrix)[0]*(he=(de=[u/p*x.X,f/p*x.X])[0])+se[4]*(Ee=de[1])+se[12],ne[1]=se[1]*he+se[5]*Ee+se[13],ne),R=[A[0]*S.dim,A[1]*S.dim],B=Math.floor(R[0]),L=Math.floor(R[1]),W=R[0]-B,Q=R[1]-L;var ne,de,se,he,Ee;return S.get(B,L)*(1-W)*(1-Q)+S.get(B+1,L)*W*(1-Q)+S.get(B,L+1)*(1-W)*Q+S.get(B+1,L+1)*W*Q}getElevationForLngLatZoom(o,u){if(!x.ba(u,o.wrap()))return 0;const{tileID:f,mercatorX:p,mercatorY:_}=this._getOverscaledTileIDFromLngLatZoom(o,u);return this.getElevation(f,p%x.X,_%x.X,x.X)}getElevation(o,u,f,p=x.X){return this.getDEMElevation(o,u,f,p)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const p=this.painter.context,_=new x.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Je(p,_,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Je(p,new x.R({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=x.an([])}const u=this.sourceCache.getSourceTile(o,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const p=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new Je(p,u.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),u.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const f=u&&u+u.tileID.key+o.key;if(f&&!this._demMatrixCache[f]){const p=this.sourceCache.sourceCache._source.maxzoom;let _=o.canonical.z-u.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=p?_=o.canonical.z-p:x.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const D=o.canonical.x-(o.canonical.x>>_<<_),S=o.canonical.y-(o.canonical.y>>_<<_),A=x.bb(new Float64Array(16),[1/(x.X<<_),1/(x.X<<_),0]);x.J(A,A,[D*x.X,S*x.X,0]),this._demMatrixCache[o.key]={matrix:A,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(o){const u=this.painter,f=u.width/devicePixelRatio,p=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Je(u.context,{width:f,height:p,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Je(u.context,{width:f,height:p,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(f,p,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,f,p))),this._fbo.colorAttachment.set("coords"===o?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let _=0,D=0;_<this._coordsTextureSize;_++)for(let S=0;S<this._coordsTextureSize;S++,D+=4)u[D+0]=255&S,u[D+1]=255&_,u[D+2]=S>>8<<4|_>>8,u[D+3]=0;const f=new x.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),p=new Je(o,f,o.gl.RGBA,{premultiply:!1});return p.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(o){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),f=this.painter.context,p=f.gl,_=Math.round(o.x*this.painter.pixelRatio/devicePixelRatio),D=Math.round(o.y*this.painter.pixelRatio/devicePixelRatio),S=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),p.readPixels(_,S-D-1,1,1,p.RGBA,p.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null);const A=u[0]+(u[2]>>4<<8),R=u[1]+((15&u[2])<<8),B=this.coordsIndex[255-u[3]],L=B&&this.sourceCache.getTileByID(B);if(!L)return null;const W=this._coordsTextureSize,Q=(1<<L.tileID.canonical.z)*W;return new x.Z((L.tileID.canonical.x*W+A)/Q+L.tileID.wrap,(L.tileID.canonical.y*W+R)/Q,this.getElevation(L.tileID,A,R,W))}depthAtPoint(o){const u=new Uint8Array(4),f=this.painter.context,p=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),p.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,p.RGBA,p.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const o=this.painter.context,u=new x.bc,f=new x.aX,p=this.meshSize,_=x.X/p,D=p*p;for(let L=0;L<=p;L++)for(let W=0;W<=p;W++)u.emplaceBack(W*_,L*_,0);for(let L=0;L<D;L+=p+1)for(let W=0;W<p;W++)f.emplaceBack(W+L,p+W+L+1,p+W+L+2),f.emplaceBack(W+L,p+W+L+2,W+L+1);const S=u.length,A=S+2*(p+1);for(const L of[0,1])for(let W=0;W<=p;W++)for(const Q of[0,1])u.emplaceBack(W*_,L*x.X,Q);for(let L=0;L<2*p;L+=2)f.emplaceBack(A+L,A+L+1,A+L+3),f.emplaceBack(A+L,A+L+3,A+L+2),f.emplaceBack(S+L,S+L+3,S+L+1),f.emplaceBack(S+L,S+L+2,S+L+3);const R=u.length,B=R+2*(p+1);for(const L of[0,1])for(let W=0;W<=p;W++)for(const Q of[0,1])u.emplaceBack(L*x.X,W*_,Q);for(let L=0;L<2*p;L+=2)f.emplaceBack(R+L,R+L+1,R+L+3),f.emplaceBack(R+L,R+L+3,R+L+2),f.emplaceBack(B+L,B+L+3,B+L+1),f.emplaceBack(B+L,B+L+2,B+L+3);return this._mesh=new Xl(o.createVertexBuffer(u,Ga.members),o.createIndexBuffer(f),x.a0.simpleSegment(0,0,u.length,f.length)),this._mesh}getMeshFrameDelta(o){return 2*Math.PI*x.bd/Math.pow(2,o)/5}getMinTileElevationForLngLatZoom(o,u){var f;const{tileID:p}=this._getOverscaledTileIDFromLngLatZoom(o,u);return null!==(f=this.getMinMaxElevation(p).minElevation)&&void 0!==f?f:0}getMinMaxElevation(o){const u=this.getTerrainData(o).tile,f={minElevation:null,maxElevation:null};return u&&u.dem&&(f.minElevation=u.dem.min*this.exaggeration,f.maxElevation=u.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(o,u){const f=x.Z.fromLngLat(o.wrap()),p=(1<<u)*x.X,_=f.x*p,D=f.y*p,S=Math.floor(_/x.X),A=Math.floor(D/x.X);return{tileID:new x.S(u,0,u,S,A),mercatorX:_,mercatorY:D}}}class Sa{constructor(o,u,f){this._context=o,this._size=u,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new Je(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(f.texture),{id:o,fbo:u,texture:f,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>o.id!==u),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some(o=>!o.inUse)}}const da={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Yn{constructor(o,u){this.painter=o,this.terrain=u,this.pool=new Sa(o.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=o._order.filter(f=>!o._layers[f].isHidden(u)),this._coordsDescendingInv={};for(const f in o.sourceCaches){this._coordsDescendingInv[f]={};const p=o.sourceCaches[f].getVisibleCoordinates();for(const _ of p){const D=this.terrain.sourceCache.getTerrainCoords(_);for(const S in D)this._coordsDescendingInv[f][S]||(this._coordsDescendingInv[f][S]=[]),this._coordsDescendingInv[f][S].push(D[S])}}this._coordsDescendingInvStr={};for(const f of o._order){const p=o._layers[f],_=p.source;if(da[p.type]&&!this._coordsDescendingInvStr[_]){this._coordsDescendingInvStr[_]={};for(const D in this._coordsDescendingInv[_])this._coordsDescendingInvStr[_][D]=this._coordsDescendingInv[_][D].map(S=>S.key).sort().join()}}for(const f of this._renderableTiles)for(const p in this._coordsDescendingInvStr){const _=this._coordsDescendingInvStr[p][f.tileID.key];_&&_!==f.rttCoords[p]&&(f.rtt=[])}}renderLayer(o){if(o.isHidden(this.painter.transform.zoom))return!1;const u=o.type,f=this.painter,p=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(da[u]&&(this._prevType&&da[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(o.id),!p))return!0;if(da[this._prevType]||da[u]&&p){this._prevType=u;const _=this._stacks.length-1,D=this._stacks[_]||[];for(const S of this._renderableTiles){if(this.pool.isFull()&&(Fc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(S),S.rtt[_]){const R=this.pool.getObjectForId(S.rtt[_].id);if(R.stamp===S.rtt[_].stamp){this.pool.useObject(R);continue}}const A=this.pool.getOrCreateFreeObject();this.pool.useObject(A),this.pool.stampObject(A),S.rtt[_]={id:A.id,stamp:A.stamp},f.context.bindFramebuffer.set(A.fbo.framebuffer),f.context.clear({color:x.aM.transparent,stencil:0}),f.currentStencilSource=void 0;for(let R=0;R<D.length;R++){const B=f.style._layers[D[R]],L=B.source?this._coordsDescendingInv[B.source][S.tileID.key]:[S.tileID];f.context.viewport.set([0,0,A.fbo.width,A.fbo.height]),f._renderTileClippingMasks(B,L),f.renderLayer(f,f.style.sourceCaches[B.source],B,L),B.source&&(S.rttCoords[B.source]=this._coordsDescendingInvStr[B.source][S.tileID.key])}}return Fc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),da[u]}return!1}}const V={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use \u2318 + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},P={hash:!1,interactive:!0,bearingSnap:7,attributionControl:qa,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:x.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},z=v=>{v.touchstart=v.dragStart,v.touchmoveWindow=v.dragMove,v.touchend=v.dragEnd},me={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ve{constructor(o,u,f=!1){this.mousedown=D=>{this.startMouse(x.e({},D,{ctrlKey:!0,preventDefault:()=>D.preventDefault()}),De.mousePos(this.element,D)),De.addEventListener(window,"mousemove",this.mousemove),De.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=D=>{this.moveMouse(D,De.mousePos(this.element,D))},this.mouseup=D=>{this.mouseRotate.dragEnd(D),this.mousePitch&&this.mousePitch.dragEnd(D),this.offTemp()},this.touchstart=D=>{1!==D.targetTouches.length?this.reset():(this._startPos=this._lastPos=De.touchPos(this.element,D.targetTouches)[0],this.startTouch(D,this._startPos),De.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),De.addEventListener(window,"touchend",this.touchend))},this.touchmove=D=>{1!==D.targetTouches.length?this.reset():(this._lastPos=De.touchPos(this.element,D.targetTouches)[0],this.moveTouch(D,this._lastPos))},this.touchend=D=>{0===D.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const p=o.dragRotate._mouseRotate.getClickTolerance(),_=o.dragRotate._mousePitch.getClickTolerance();this.element=u,this.mouseRotate=qr({clickTolerance:p,enable:!0}),this.touchRotate=(({enable:D,clickTolerance:S,bearingDegreesPerPixelMoved:A=.8})=>{const R=new wi;return new fs({clickTolerance:S,move:(B,L)=>({bearingDelta:(L.x-B.x)*A}),moveStateManager:R,enable:D,assignEvents:z})})({clickTolerance:p,enable:!0}),this.map=o,f&&(this.mousePitch=Os({clickTolerance:_,enable:!0}),this.touchPitch=(({enable:D,clickTolerance:S,pitchDegreesPerPixelMoved:A=-.5})=>{const R=new wi;return new fs({clickTolerance:S,move:(B,L)=>({pitchDelta:(L.y-B.y)*A}),moveStateManager:R,enable:D,assignEvents:z})})({clickTolerance:_,enable:!0})),De.addEventListener(u,"mousedown",this.mousedown),De.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),De.addEventListener(u,"touchcancel",this.reset)}startMouse(o,u){this.mouseRotate.dragStart(o,u),this.mousePitch&&this.mousePitch.dragStart(o,u),De.disableDrag()}startTouch(o,u){this.touchRotate.dragStart(o,u),this.touchPitch&&this.touchPitch.dragStart(o,u),De.disableDrag()}moveMouse(o,u){const f=this.map,{bearingDelta:p}=this.mouseRotate.dragMove(o,u)||{};if(p&&f.setBearing(f.getBearing()+p),this.mousePitch){const{pitchDelta:_}=this.mousePitch.dragMove(o,u)||{};_&&f.setPitch(f.getPitch()+_)}}moveTouch(o,u){const f=this.map,{bearingDelta:p}=this.touchRotate.dragMove(o,u)||{};if(p&&f.setBearing(f.getBearing()+p),this.touchPitch){const{pitchDelta:_}=this.touchPitch.dragMove(o,u)||{};_&&f.setPitch(f.getPitch()+_)}}off(){const o=this.element;De.removeEventListener(o,"mousedown",this.mousedown),De.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),De.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),De.removeEventListener(window,"touchend",this.touchend),De.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){De.enableDrag(),De.removeEventListener(window,"mousemove",this.mousemove),De.removeEventListener(window,"mouseup",this.mouseup),De.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),De.removeEventListener(window,"touchend",this.touchend)}}let Ot;function ui(v,o,u){const f=new x.N(v.lng,v.lat);if(v=new x.N(v.lng,v.lat),o){const p=new x.N(v.lng-360,v.lat),_=new x.N(v.lng+360,v.lat),D=u.locationPoint(v).distSqr(o);u.locationPoint(p).distSqr(o)<D?v=p:u.locationPoint(_).distSqr(o)<D&&(v=_)}for(;Math.abs(v.lng-u.center.lng)>180;){const p=u.locationPoint(v);if(p.x>=0&&p.y>=0&&p.x<=u.width&&p.y<=u.height)break;v.lng>u.center.lng?v.lng-=360:v.lng+=360}return v.lng!==f.lng&&u.locationPoint(v).y>u.height/2-u.getHorizon()?v:f}const Xn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function or(v,o,u){const f=v.classList;for(const p in Xn)f.remove(`maplibregl-${u}-anchor-${p}`);f.add(`maplibregl-${u}-anchor-${o}`)}class _o extends x.E{constructor(o){if(super(),this._onKeyPress=u=>{const f=u.code,p=u.charCode||u.keyCode;"Space"!==f&&"Enter"!==f&&32!==p&&13!==p||this.togglePopup()},this._onMapClick=u=>{const f=u.originalEvent.target,p=this._element;this._popup&&(f===p||p.contains(f))&&this.togglePopup()},this._update=u=>{var f;if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();("terrain"===u?.type||"render"===u?.type&&!p)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?ui(this._lngLat,this._flatPos,this._map.transform):null===(f=this._lngLat)||void 0===f?void 0:f.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let _="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?_=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let D="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?D="rotateX(0deg)":"map"===this._pitchAlignment&&(D=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&"moveend"!==u.type||(this._pos=this._pos.round()),De.setTransform(this._element,`${Xn[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${D} ${_}`),Ae.frameAsync(new AbortController).then(()=>{this._updateOpacity(u&&"moveend"===u.type)}).catch(()=>{})},this._onMove=u=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new x.k("dragstart"))),this.fire(new x.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new x.k("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._subpixelPositioning=o&&o.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&"auto"!==o.pitchAlignment?o.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(o?.opacity,o?.opacityWhenCovered),o&&o.element)this._element=o.element,this._offset=x.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=De.create("div");const u=De.createNS("http://www.w3.org/2000/svg","svg"),f=41,p=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${f}px`),u.setAttributeNS(null,"width",`${p}px`),u.setAttributeNS(null,"viewBox",`0 0 ${p} ${f}`);const _=De.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");const D=De.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"fill-rule","nonzero");const S=De.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const A=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const he of A){const Ee=De.createNS("http://www.w3.org/2000/svg","ellipse");Ee.setAttributeNS(null,"opacity","0.04"),Ee.setAttributeNS(null,"cx","10.5"),Ee.setAttributeNS(null,"cy","5.80029008"),Ee.setAttributeNS(null,"rx",he.rx),Ee.setAttributeNS(null,"ry",he.ry),S.appendChild(Ee)}const R=De.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill",this._color);const B=De.createNS("http://www.w3.org/2000/svg","path");B.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),R.appendChild(B);const L=De.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"opacity","0.25"),L.setAttributeNS(null,"fill","#000000");const W=De.createNS("http://www.w3.org/2000/svg","path");W.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),L.appendChild(W);const Q=De.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Q.setAttributeNS(null,"fill","#FFFFFF");const ne=De.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"transform","translate(8.0, 8.0)");const de=De.createNS("http://www.w3.org/2000/svg","circle");de.setAttributeNS(null,"fill","#000000"),de.setAttributeNS(null,"opacity","0.25"),de.setAttributeNS(null,"cx","5.5"),de.setAttributeNS(null,"cy","5.5"),de.setAttributeNS(null,"r","5.4999962");const se=De.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#FFFFFF"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962"),ne.appendChild(de),ne.appendChild(se),D.appendChild(S),D.appendChild(R),D.appendChild(L),D.appendChild(Q),D.appendChild(ne),u.appendChild(D),u.setAttributeNS(null,"height",f*this._scale+"px"),u.setAttributeNS(null,"width",p*this._scale+"px"),this._element.appendChild(u),this._offset=x.P.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),or(this._element,this._anchor,"marker"),o&&o.className)for(const u of o.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(o){return this.remove(),this._map=o,this._element.setAttribute("aria-label",o._getUIString("Marker.Title")),o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),De.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=x.N.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const p=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(24.6+p)],"bottom-right":[-p,-1*(24.6+p)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(o){return this._subpixelPositioning=o,this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:o?(o.isOpen()?o.remove():(o.setLngLat(this._lngLat),o.addTo(this._map)),this):this}_updateOpacity(o=!1){var u,f;if(null===(u=this._map)||void 0===u||!u.terrain)return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(o)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const p=this._map,_=p.terrain.depthAtPoint(this._pos),D=p.terrain.getElevationForLngLatZoom(this._lngLat,p.transform.tileZoom);if(p.transform.lngLatToCameraDepth(this._lngLat,D)-_<.006)return void(this._element.style.opacity=this._opacity);const S=-this._offset.y/p.transform._pixelPerMeter,A=Math.sin(p.getPitch()*Math.PI/180)*S,R=p.terrain.depthAtPoint(new x.P(this._pos.x,this._pos.y-this._offset.y)),B=p.transform.lngLatToCameraDepth(this._lngLat,D+A)-R>.006;!(null===(f=this._popup)||void 0===f)&&f.isOpen()&&B&&this._popup.remove(),this._element.style.opacity=B?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(o){return this._offset=x.P.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&"auto"!==o?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(o,u){return void 0===o&&void 0===u&&(this._opacity="1",this._opacityWhenCovered="0.2"),void 0!==o&&(this._opacity=o),void 0!==u&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const Xd={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ta=0,sr=!1;const Kd={maxWidth:100,unit:"metric"};function id(v,o,u){const f=u&&u.maxWidth||100,p=v._container.clientHeight/2,_=v.unproject([0,p]),D=v.unproject([f,p]),S=_.distanceTo(D);if(u&&"imperial"===u.unit){const A=3.2808*S;A>5280?Vc(o,f,A/5280,v._getUIString("ScaleControl.Miles")):Vc(o,f,A,v._getUIString("ScaleControl.Feet"))}else u&&"nautical"===u.unit?Vc(o,f,S/1852,v._getUIString("ScaleControl.NauticalMiles")):S>=1e3?Vc(o,f,S/1e3,v._getUIString("ScaleControl.Kilometers")):Vc(o,f,S,v._getUIString("ScaleControl.Meters"))}function Vc(v,o,u,f){const p=function(_){const D=Math.pow(10,`${Math.floor(_)}`.length-1);let S=_/D;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(A){const R=Math.pow(10,Math.ceil(-Math.log(A)/Math.LN10));return Math.round(A*R)/R}(S),D*S}(u);v.style.width=o*(p/u)+"px",v.innerHTML=`${p}&nbsp;${f}`}const Op={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Fp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Lp(v){if(v){if("number"==typeof v){const o=Math.round(Math.abs(v)/Math.SQRT2);return{center:new x.P(0,0),top:new x.P(0,v),"top-left":new x.P(o,o),"top-right":new x.P(-o,o),bottom:new x.P(0,-v),"bottom-left":new x.P(o,-o),"bottom-right":new x.P(-o,-o),left:new x.P(v,0),right:new x.P(-v,0)}}if(v instanceof x.P||Array.isArray(v)){const o=x.P.convert(v);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:x.P.convert(v.center||[0,0]),top:x.P.convert(v.top||[0,0]),"top-left":x.P.convert(v["top-left"]||[0,0]),"top-right":x.P.convert(v["top-right"]||[0,0]),bottom:x.P.convert(v.bottom||[0,0]),"bottom-left":x.P.convert(v["bottom-left"]||[0,0]),"bottom-right":x.P.convert(v["bottom-right"]||[0,0]),left:x.P.convert(v.left||[0,0]),right:x.P.convert(v.right||[0,0])}}return Lp(new x.P(0,0))}X.AJAXError=x.bg,X.Evented=x.E,X.LngLat=x.N,X.MercatorCoordinate=x.Z,X.Point=x.P,X.addProtocol=x.bh,X.config=x.a,X.removeProtocol=x.bi,X.AttributionControl=vo,X.BoxZoomHandler=ec,X.CanvasSource=Fn,X.CooperativeGesturesHandler=gs,X.DoubleClickZoomHandler=rr,X.DragPanHandler=Hn,X.DragRotateHandler=Ia,X.EdgeInsets=ca,X.FullscreenControl=class extends x.E{constructor(v={}){super(),this._onFullscreenChange=()=>{var o;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;null!==(o=u?.shadowRoot)&&void 0!==o&&o.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,v&&v.container&&(v.container instanceof HTMLElement?this._container=v.container:x.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=De.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){De.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const v=this._fullscreenButton=De.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);De.create("span","maplibregl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.title=v}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new x.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new x.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},X.GeoJSONSource=ht,X.GeolocateControl=class extends x.E{constructor(v){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new x.k("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(o),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new x.k("geolocate",o)),this._finish()}},this._updateCamera=o=>{const u=new x.N(o.coords.longitude,o.coords.latitude),f=o.coords.accuracy,p=this._map.getBearing(),_=x.e({bearing:p},this.options.fitBoundsOptions),D=ve.fromLngLat(u,f);this._map.fitBounds(D,_,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const u=new x.N(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=o=>{if(this._map){if(this.options.trackUserLocation)if(1===o.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===o.code&&sr)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new x.k("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=De.create("button","maplibregl-ctrl-geolocate",this._container),De.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=o=>{if(this._map){if(!1===o){x.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=De.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new _o({element:this._dotElement}),this._circleElement=De.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new _o({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||"ACTIVE_LOCK"!==this._watchState||u.originalEvent&&"resize"===u.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new x.k("trackuserlocationend")),this.fire(new x.k("userlocationlostfocus")))})}},this.options=x.e({},Xd,v)}onAdd(v){return this._map=v,this._container=De.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return x._(this,arguments,void 0,function*(o=!1){if(void 0!==Ot&&!o)return Ot;if(void 0===window.navigator.permissions)return Ot=!!window.navigator.geolocation,Ot;try{Ot="denied"!==(yield window.navigator.permissions.query({name:"geolocation"})).state}catch{Ot=!!window.navigator.geolocation}return Ot})}().then(o=>this._finishSetupUI(o)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),De.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ta=0,sr=!1}_isOutOfMapMaxBounds(v){const o=this._map.getMaxBounds(),u=v.coords;return o&&(u.longitude<o.getWest()||u.longitude>o.getEast()||u.latitude<o.getSouth()||u.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const v=this._map.getBounds(),o=v.getSouthEast(),u=v.getNorthEast(),f=o.distanceTo(u),p=Math.ceil(this._accuracy/(f/this._map._container.clientHeight)*2);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}trigger(){if(!this._setup)return x.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new x.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ta--,sr=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new x.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new x.k("trackuserlocationstart")),this.fire(new x.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let v;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ta++,Ta>1?(v={maximumAge:6e5,timeout:0},sr=!0):(v=this.options.positionOptions,sr=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,v)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},X.Hash=ml,X.ImageSource=et,X.KeyboardHandler=ns,X.LngLatBounds=ve,X.LogoControl=Zt,X.Map=class extends bl{constructor(v){x.be.mark(x.bf.create);const o=Object.assign(Object.assign({},P),v);if(null!=o.minZoom&&null!=o.maxZoom&&o.minZoom>o.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=o.minPitch&&null!=o.maxPitch&&o.minPitch>o.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=o.minPitch&&o.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=o.maxPitch&&o.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new fl(o.minZoom,o.maxZoom,o.minPitch,o.maxPitch,o.renderWorldCopies),{bearingSnap:o.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new wl,this._controls=[],this._mapId=x.a4(),this._contextLost=u=>{u.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new x.k("webglcontextlost",{originalEvent:u}))},this._contextRestored=u=>{this._setupPainter(),this.resize(),this._update(),this.fire(new x.k("webglcontextrestored",{originalEvent:u}))},this._onMapScroll=u=>{if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=o.interactive,this._maxTileCacheSize=o.maxTileCacheSize,this._maxTileCacheZoomLevels=o.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=!0===o.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=!0===o.preserveDrawingBuffer,this._antialias=!0===o.antialias,this._trackResize=!0===o.trackResize,this._bearingSnap=o.bearingSnap,this._refreshExpiredTiles=!0===o.refreshExpiredTiles,this._fadeDuration=o.fadeDuration,this._crossSourceCollisions=!0===o.crossSourceCollisions,this._collectResourceTiming=!0===o.collectResourceTiming,this._locale=Object.assign(Object.assign({},V),o.locale),this._clickTolerance=o.clickTolerance,this._overridePixelRatio=o.pixelRatio,this._maxCanvasSize=o.maxCanvasSize,this.transformCameraUpdate=o.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=!0===o.cancelPendingTileRequestsWhileZooming,this._imageQueueHandle=pt.addThrottleControl(()=>this.isMoving()),this._requestManager=new mt(o.transformRequest),"string"==typeof o.container){if(this._container=document.getElementById(o.container),!this._container)throw new Error(`Container '${o.container}' not found.`)}else{if(!(o.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=o.container}if(o.maxBounds&&this.setMaxBounds(o.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let u=!1;const f=pl(p=>{this._trackResize&&!this._removed&&this.resize(p)._update()},50);this._resizeObserver=new ResizeObserver(p=>{u?f(p):u=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Zi(this,o),this._hash=o.hash&&new ml("string"==typeof o.hash&&o.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:o.center,zoom:o.zoom,bearing:o.bearing,pitch:o.pitch}),o.bounds&&(this.resize(),this.fitBounds(o.bounds,x.e({},o.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=o.localIdeographFontFamily,this._validateStyle=o.validateStyle,o.style&&this.setStyle(o.style,{localIdeographFontFamily:o.localIdeographFontFamily}),o.attributionControl&&this.addControl(new vo("boolean"==typeof o.attributionControl?void 0:o.attributionControl)),o.maplibreLogo&&this.addControl(new Zt,o.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",u=>{this._update("style"===u.dataType),this.fire(new x.k(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new x.k(`${u.dataType}dataloading`,u))}),this.on("dataabort",u=>{this.fire(new x.k("sourcedataabort",u))})}_getMapId(){return this._mapId}addControl(v,o){if(void 0===o&&(o=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new x.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=v.onAdd(this);this._controls.push(v);const f=this._controlPositions[o];return-1!==o.indexOf("bottom")?f.insertBefore(u,f.firstChild):f.appendChild(u),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new x.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(v);return o>-1&&this._controls.splice(o,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}calculateCameraOptionsFromTo(v,o,u,f){return null==f&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(v,o,u,f)}resize(v){var o;const u=this._containerDimensions(),f=u[0],p=u[1],_=this._getClampedPixelRatio(f,p);if(this._resizeCanvas(f,p,_),this.painter.resize(f,p,_),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const A=this._getClampedPixelRatio(f,p);this._resizeCanvas(f,p,A),this.painter.resize(f,p,A)}this.transform.resize(f,p),null===(o=this._requestedCameraState)||void 0===o||o.resize(f,p);const D=!this._moving;return D&&(this.stop(),this.fire(new x.k("movestart",v)).fire(new x.k("move",v))),this.fire(new x.k("resize",v)),D&&this.fire(new x.k("moveend",v)),this}_getClampedPixelRatio(v,o){const{0:u,1:f}=this._maxCanvasSize,p=this.getPixelRatio(),_=v*p,D=o*p;return Math.min(_>u?u/_:1,D>f?f/D:1)*p}getPixelRatio(){var v;return null!==(v=this._overridePixelRatio)&&void 0!==v?v:devicePixelRatio}setPixelRatio(v){this._overridePixelRatio=v,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(v){return this.transform.setMaxBounds(ve.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this._update()}project(v){return this.transform.locationPoint(x.N.convert(v),this.style&&this.terrain)}unproject(v){return this.transform.pointLocation(x.P.convert(v),this.terrain)}isMoving(){var v;return this._moving||(null===(v=this.handlers)||void 0===v?void 0:v.isMoving())}isZooming(){var v;return this._zooming||(null===(v=this.handlers)||void 0===v?void 0:v.isZooming())}isRotating(){var v;return this._rotating||(null===(v=this.handlers)||void 0===v?void 0:v.isRotating())}_createDelegatedListener(v,o,u){if("mouseenter"===v||"mouseover"===v){let f=!1;return{layer:o,listener:u,delegates:{mousemove:_=>{const D=this.getLayer(o)?this.queryRenderedFeatures(_.point,{layers:[o]}):[];D.length?f||(f=!0,u.call(this,new ts(v,this,_.originalEvent,{features:D}))):f=!1},mouseout:()=>{f=!1}}}}if("mouseleave"===v||"mouseout"===v){let f=!1;return{layer:o,listener:u,delegates:{mousemove:D=>{(this.getLayer(o)?this.queryRenderedFeatures(D.point,{layers:[o]}):[]).length?f=!0:f&&(f=!1,u.call(this,new ts(v,this,D.originalEvent)))},mouseout:D=>{f&&(f=!1,u.call(this,new ts(v,this,D.originalEvent)))}}}}{const f=p=>{const _=this.getLayer(o)?this.queryRenderedFeatures(p.point,{layers:[o]}):[];_.length&&(p.features=_,u.call(this,p),delete p.features)};return{layer:o,listener:u,delegates:{[v]:f}}}}on(v,o,u){if(void 0===u)return super.on(v,o);const f=this._createDelegatedListener(v,o,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(f);for(const p in f.delegates)this.on(p,f.delegates[p]);return this}once(v,o,u){if(void 0===u)return super.once(v,o);const f=this._createDelegatedListener(v,o,u);for(const p in f.delegates)this.once(p,f.delegates[p]);return this}off(v,o,u){return void 0===u?super.off(v,o):(this._delegatedListeners&&this._delegatedListeners[v]&&(f=>{const p=this._delegatedListeners[v];for(let _=0;_<p.length;_++){const D=p[_];if(D.layer===o&&D.listener===u){for(const S in D.delegates)this.off(S,D.delegates[S]);return p.splice(_,1),this}}})(),this)}queryRenderedFeatures(v,o){if(!this.style)return[];let u;const f=v instanceof x.P||Array.isArray(v),p=f?v:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(f?{}:v)||{},p instanceof x.P||"number"==typeof p[0])u=[x.P.convert(p)];else{const _=x.P.convert(p[0]),D=x.P.convert(p[1]);u=[_,new x.P(D.x,_.y),D,new x.P(_.x,D.y),_]}return this.style.queryRenderedFeatures(u,o,this.transform)}querySourceFeatures(v,o){return this.style.querySourceFeatures(v,o)}setStyle(v,o){return!1!==(o=x.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(v,o))}setTransformRequest(v){return this._requestManager.setTransformRequest(v),this}_getUIString(v){const o=this._locale[v];if(null==o)throw new Error(`Missing UI string '${v}'`);return o}_updateStyle(v,o){if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(v,o));const u=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!v)),v?(this.style=new Zn(this,o||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof v?this.style.loadURL(v,o,u):this.style.loadJSON(v,o,u),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Zn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,o){if("string"==typeof v){const u=this._requestManager.transformRequest(v,"Style");x.h(u,new AbortController).then(f=>{this._updateDiff(f.data,o)}).catch(f=>{f&&this.fire(new x.j(f))})}else"object"==typeof v&&this._updateDiff(v,o)}_updateDiff(v,o){try{this.style.setState(v,o)&&this._update(!0)}catch(u){x.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(v,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():x.w("There is no style added to the map.")}addSource(v,o){return this._lazyInitEmptyStyle(),this.style.addSource(v,o),this._update(!0)}isSourceLoaded(v){const o=this.style&&this.style.sourceCaches[v];if(void 0!==o)return o.loaded();this.fire(new x.j(new Error(`There is no source with ID '${v}'`)))}setTerrain(v){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),v){const o=this.style.sourceCaches[v.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${v.source}`);null===this.terrain&&o.reload();for(const u in this.style._layers){const f=this.style._layers[u];"hillshade"===f.type&&f.source===v.source&&x.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new $c(this.painter,o,v),this.painter.renderToTexture=new Yn(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=u=>{"style"===u.dataType?this.terrain.sourceCache.freeRtt():"source"===u.dataType&&u.tile&&(u.sourceId!==v.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new x.k("terrain",{terrain:v})),this}getTerrain(){var v,o;return null!==(o=null===(v=this.terrain)||void 0===v?void 0:v.options)&&void 0!==o?o:null}areTilesLoaded(){const v=this.style&&this.style.sourceCaches;for(const o in v){const u=v[o]._tiles;for(const f in u){const p=u[f];if("loaded"!==p.state&&"errored"!==p.state)return!1}}return!0}removeSource(v){return this.style.removeSource(v),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,o,u={}){const{pixelRatio:f=1,sdf:p=!1,stretchX:_,stretchY:D,content:S,textFitWidth:A,textFitHeight:R}=u;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||x.b(o))){if(void 0===o.width||void 0===o.height)return this.fire(new x.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:B,height:L,data:W}=o,Q=o;return this.style.addImage(v,{data:new x.R({width:B,height:L},new Uint8Array(W)),pixelRatio:f,stretchX:_,stretchY:D,content:S,textFitWidth:A,textFitHeight:R,sdf:p,version:0,userImage:Q}),Q.onAdd&&Q.onAdd(this,v),this}}{const{width:B,height:L,data:W}=Ae.getImageData(o);this.style.addImage(v,{data:new x.R({width:B,height:L},W),pixelRatio:f,stretchX:_,stretchY:D,content:S,textFitWidth:A,textFitHeight:R,sdf:p,version:0})}}updateImage(v,o){const u=this.style.getImage(v);if(!u)return this.fire(new x.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=o instanceof HTMLImageElement||x.b(o)?Ae.getImageData(o):o,{width:p,height:_,data:D}=f;if(void 0===p||void 0===_)return this.fire(new x.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==u.data.width||_!==u.data.height)return this.fire(new x.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const S=!(o instanceof HTMLImageElement||x.b(o));return u.data.replace(D,S),this.style.updateImage(v,u),this}getImage(v){return this.style.getImage(v)}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new x.j(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v){return pt.getImage(this._requestManager.transformRequest(v,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(v,o){return this._lazyInitEmptyStyle(),this.style.addLayer(v,o),this._update(!0)}moveLayer(v,o){return this.style.moveLayer(v,o),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(v,o,u){return this.style.setLayerZoomRange(v,o,u),this._update(!0)}setFilter(v,o,u={}){return this.style.setFilter(v,o,u),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,o,u,f={}){return this.style.setPaintProperty(v,o,u,f),this._update(!0)}getPaintProperty(v,o){return this.style.getPaintProperty(v,o)}setLayoutProperty(v,o,u,f={}){return this.style.setLayoutProperty(v,o,u,f),this._update(!0)}getLayoutProperty(v,o){return this.style.getLayoutProperty(v,o)}setGlyphs(v,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(v,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(v,o,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(v,o,u,f=>{f||this._update(!0)}),this}removeSprite(v){return this._lazyInitEmptyStyle(),this.style.removeSprite(v),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(v,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(v,o,u=>{u||this._update(!0)}),this}setLight(v,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,o),this._update(!0)}getLight(){return this.style.getLight()}setSky(v){return this._lazyInitEmptyStyle(),this.style.setSky(v),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(v,o){return this.style.setFeatureState(v,o),this._update()}removeFeatureState(v,o){return this.style.removeFeatureState(v,o),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let v=0,o=0;return this._container&&(v=this._container.clientWidth||400,o=this._container.clientHeight||300),[v,o]}_setupContainer(){const v=this._container;v.classList.add("maplibregl-map");const o=this._canvasContainer=De.create("div","maplibregl-canvas-container",v);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=De.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),f=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],f);const p=this._controlContainer=De.create("div","maplibregl-control-container",v),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(D=>{_[D]=De.create("div",`maplibregl-ctrl-${D} `,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,o,u){this._canvas.width=Math.floor(u*v),this._canvas.height=Math.floor(u*o),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const v={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let o=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{o={requestedAttributes:v},f&&(o.statusMessage=f.statusMessage,o.type=f.type)},{once:!0});const u=this._canvas.getContext("webgl2",v)||this._canvas.getContext("webgl",v);if(!u){const f="Failed to initialize WebGL";throw o?(o.message=f,new Error(JSON.stringify(o))):new Error(f)}this.painter=new Va(u,this.transform),pn.testSupport(u)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_render(v){const o=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),this._removed)return;let u=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const p=this.transform.zoom,_=Ae.now();this.style.zoomHistory.update(p,_);const D=new x.z(p,{now:_,fadeDuration:o,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),S=D.crossFadingFactor();1===S&&S===this._crossFadingFactor||(u=!0,this._crossFadingFactor=S),this.style.update(D)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,showPadding:this.showPadding}),this.fire(new x.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,x.be.mark(x.bf.load),this.fire(new x.k("load"))),this.style&&(this.style.hasTransitions()||u)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const f=this._sourcesDirty||this._styleDirty||this._placementDirty;return f||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new x.k("idle")),!this._loaded||this._fullyLoaded||f||(this._fullyLoaded=!0,x.be.mark(x.bf.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var v;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),pt.removeThrottleControl(this._imageQueueHandle),null===(v=this._resizeObserver)||void 0===v||v.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o?.loseContext&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),De.remove(this._canvasContainer),De.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),x.be.clearMetrics(),this._removed=!0,this.fire(new x.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,Ae.frameAsync(this._frameRequest).then(v=>{x.be.frame(v),this._frameRequest=null,this._render(v)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get version(){return"4.6.0"}getCameraTargetElevation(){return this.transform.elevation}},X.MapMouseEvent=ts,X.MapTouchEvent=Ha,X.MapWheelEvent=Ql,X.Marker=_o,X.NavigationControl=class{constructor(v){this._updateZoomButtons=()=>{const o=this._map.getZoom(),u=o===this._map.getMaxZoom(),f=o===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=o},this._setButtonTitle=(o,u)=>{const f=this._map._getUIString(`NavigationControl.${u}`);o.title=f,o.setAttribute("aria-label",f)},this.options=x.e({},me,v),this._container=De.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),De.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),De.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=De.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ve(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){De.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(v,o){const u=De.create("button",v,this._container);return u.type="button",u.addEventListener("click",o),u}},X.Popup=class extends x.E{constructor(v){super(),this.remove=()=>(this._content&&De.remove(this._content),this._container&&(De.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new x.k("close"))),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{var u;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=De.create("div","maplibregl-popup",this._map.getContainer()),this._tip=De.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?ui(this._lngLat,this._flatPos,this._map.transform):null===(u=this._lngLat)||void 0===u?void 0:u.wrap(),this._trackPointer&&!o)return;const f=this._flatPos=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&o?o:this._map.transform.locationPoint(this._lngLat));let p=this.options.anchor;const _=Lp(this.options.offset);if(!p){const S=this._container.offsetWidth,A=this._container.offsetHeight;let R;R=f.y+_.bottom.y<A?["top"]:f.y>this._map.transform.height-A?["bottom"]:[],f.x<S/2?R.push("left"):f.x>this._map.transform.width-S/2&&R.push("right"),p=0===R.length?"bottom":R.join("-")}let D=f.add(_[p]);this.options.subpixelPositioning||(D=D.round()),De.setTransform(this._container,`${Xn[p]} translate(${D.x}px,${D.y}px)`),or(this._container,p,"popup")},this._onClose=()=>{this.remove()},this.options=x.e(Object.create(Op),v)}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new x.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(v){return this._lngLat=x.N.convert(v),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(document.createTextNode(v))}setHTML(v){const o=document.createDocumentFragment(),u=document.createElement("body");let f;for(u.innerHTML=v;f=u.firstChild,f;)o.appendChild(f);return this.setDOMContent(o)}getMaxWidth(){var v;return null===(v=this._container)||void 0===v?void 0:v.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=De.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(v),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(v){return this._container&&this._container.classList.add(v),this}removeClassName(v){return this._container&&this._container.classList.remove(v),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){if(this._container)return this._container.classList.toggle(v)}setSubpixelPositioning(v){this.options.subpixelPositioning=v}_createCloseButton(){this.options.closeButton&&(this._closeButton=De.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(Fp);v&&v.focus()}},X.RasterDEMTileSource=Vn,X.RasterTileSource=Pn,X.ScaleControl=class{constructor(v){this._onMove=()=>{id(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,id(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Kd),v)}getDefaultPosition(){return"bottom-left"}onAdd(v){return this._map=v,this._container=De.create("div","maplibregl-ctrl maplibregl-ctrl-scale",v.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){De.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},X.ScrollZoomHandler=Ea,X.Style=Zn,X.TerrainControl=class{constructor(v){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=v}onAdd(v){return this._map=v,this._container=De.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=De.create("button","maplibregl-ctrl-terrain",this._container),De.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){De.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},X.TwoFingersTouchPitchHandler=ci,X.TwoFingersTouchRotateHandler=Ki,X.TwoFingersTouchZoomHandler=pu,X.TwoFingersTouchZoomRotateHandler=ms,X.VectorTileSource=dr,X.VideoSource=wn,X.addSourceType=(v,o)=>x._(void 0,void 0,void 0,function*(){if(ki(v))throw new Error(`A source type called "${v}" already exists.`);$i[v]=o}),X.clearPrewarmedResources=function(){const v=qt;v&&(v.isPreloaded()&&1===v.numActive()?(v.release(fe),qt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},X.getMaxParallelImageRequests=function(){return x.a.MAX_PARALLEL_IMAGE_REQUESTS},X.getRTLTextPluginStatus=function(){return hr().getRTLTextPluginStatus()},X.getVersion=function(){return"4.6.0"},X.getWorkerCount=function(){return Z.workerCount},X.getWorkerUrl=function(){return x.a.WORKER_URL},X.importScriptInWorkers=function(v){return mn().broadcast("IS",v)},X.prewarm=function(){Lt().acquire(fe)},X.setMaxParallelImageRequests=function(v){x.a.MAX_PARALLEL_IMAGE_REQUESTS=v},X.setRTLTextPlugin=function(v,o){return hr().setRTLTextPlugin(v,o)},X.setWorkerCount=function(v){Z.workerCount=v},X.setWorkerUrl=function(v){x.a.WORKER_URL=v}}),qn}()},5861:(zr,qn,Ke)=>{"use strict";function We(X,x,an,hn,st,Ae,De){try{var pn=X[Ae](De),xt=pn.value}catch(Mt){return void an(Mt)}pn.done?x(xt):Promise.resolve(xt).then(hn,st)}function fn(X){return function(){var x=this,an=arguments;return new Promise(function(hn,st){var Ae=X.apply(x,an);function De(xt){We(Ae,hn,st,De,pn,"next",xt)}function pn(xt){We(Ae,hn,st,De,pn,"throw",xt)}De(void 0)})}}Ke.d(qn,{Z:()=>fn})}},zr=>{zr(zr.s=8819)}]);